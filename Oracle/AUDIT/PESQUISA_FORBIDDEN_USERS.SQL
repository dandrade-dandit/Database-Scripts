SET SERVEROUTPUT ON
DECLARE

	CURSOR FORBIDDEN_USERS IS
	SELECT     S.SID
	,          S.USERNAME
	,          'ALTER SYSTEM KILL SESSION '''||S.SID||','||S.SERIAL#||''';' CMD_KILL_ORACLE
	,          'KILL -9 ' || P.SPID CMD_KILL_UNIX
	,          S.OSUSER
	,          S.TERMINAL
	FROM V$SESSION S, V$PROCESS P
	WHERE P.ADDR = S.PADDR
	--AND UPPER(S.OSUSER) NOT LIKE 'PRSI%'
	AND (UPPER(S.PROGRAM) LIKE 'SQLN%' OR UPPER(S.PROGRAM) LIKE '%ACCESS%' OR UPPER(S.PROGRAM) LIKE '%QUERY%');
	
BEGIN
	FOR X IN FORBIDDEN_USERS LOOP
		DBMS_OUTPUT.PUT_LINE ('USUARIO -> (' || X.OSUSER || ') ESTA ACESSANDO O BD (' || X.TERMINAL || '). => COMANDO P/ ELIMINA-LO NO UNIX EH : ' || X.CMD_KILL_UNIX);
	
	END LOOP;
END;
/
