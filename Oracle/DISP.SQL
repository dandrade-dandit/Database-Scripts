COL DISP_NAME FORMAT A20
SELECT decode(d.inst_id, 1, (SELECT UPPER(INSTANCE_NAME) FROM GV$INSTANCE WHERE INSTANCE_NUMBER = 1), 2, (SELECT UPPER(INSTANCE_NAME) FROM GV$INSTANCE WHERE INSTANCE_NUMBER = 2), 3, (SELECT UPPER(INSTANCE_NAME) FROM GV$INSTANCE WHERE INSTANCE_NUMBER = 3), 5, (SELECT UPPER(INSTANCE_NAME) FROM GV$INSTANCE WHERE INSTANCE_NUMBER = 5), 'IFRx') as "Instância"
,   D.NAME AS DISP_NAME
,   COUNT(1) AS "TOTAL SESSION PER DISP"
FROM  GV$CIRCUIT C
,    GV$DISPATCHER D
WHERE C.DISPATCHER = D.PADDR
GROUP BY D.INST_ID
,        D.NAME
ORDER BY 1, 2
/
@T
SELECT 	decode(inst_id, 1, (SELECT UPPER(INSTANCE_NAME) FROM GV$INSTANCE WHERE INSTANCE_NUMBER = 1), 2, (SELECT UPPER(INSTANCE_NAME) FROM GV$INSTANCE WHERE INSTANCE_NUMBER = 2), 3, (SELECT UPPER(INSTANCE_NAME) FROM GV$INSTANCE WHERE INSTANCE_NUMBER = 3), 5, (SELECT UPPER(INSTANCE_NAME) FROM GV$INSTANCE WHERE INSTANCE_NUMBER = 5), 'IFRx') as "Instância"
,	USERNAME
, 	COUNT(1) as total
FROM 	GV$SESSION
WHERE	USERNAME IS NOT NULL 
AND     USERNAME NOT IN ('SYS','DBSNMP')
GROUP BY USERNAME, inst_id
HAVING COUNT(1) > 2
ORDER BY 1, 2
/
