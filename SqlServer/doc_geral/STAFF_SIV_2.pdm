<?xml version="1.0" encoding="UTF-8"?>
<?PowerDesigner ID="{6958C5CF-8FBB-11D8-B6CA-00024416849C}" Name="PhysicalDataModel_4" Objects="254" Symbols="20" Type="{CDE44E21-9669-11D1-9914-006097355D9B}" signature="PDM_DATA_MODEL_XML" version="9.0.0.438 Evaluation"?>
<!-- please do not edit this file -->

<Model xmlns:a="attribute" xmlns:c="collection" xmlns:o="object">

<o:RootObject Id="o1">
<c:Children>
<o:Model Id="o2">
<a:ObjectID>6958C5CF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>PhysicalDataModel_4</a:Name>
<a:Code>PHYSICALDATAMODEL_4</a:Code>
<a:CreationDate>1081601647</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081711143</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PackageOptionsText>
[FolderOptions]

[FolderOptions\Physical Objects]
GenerationCheckModel=Yes
GenerationPath=
RevPkey=Yes
RevFkey=Yes
RevAkey=Yes
RevCheck=Yes
RevIndx=Yes
RevOpts=Yes
RevViewAsTabl=No
RevSystAsTabl=Yes
RevSynmAsTabl=Yes
GenScriptName=crebas
GenScriptName0=
GenScriptName1=
GenScriptName2=
GenScriptName3=
GenScriptName4=
GenScriptName5=
GenScriptName6=
GenScriptName7=
GenScriptName8=
GenScriptName9=
GenPathName=
GenSingleFile=Yes
GenTrgScriptName=cretrg
GenTrgScriptName0=
GenTrgScriptName1=
GenTrgScriptName2=
GenTrgScriptName3=
GenTrgScriptName4=
GenTrgScriptName5=
GenTrgScriptName6=
GenTrgScriptName7=
GenTrgScriptName8=
GenTrgScriptName9=
GenTrgPathName=
GenTrgSingleFile=Yes
GenODBC=No
GenCheckModel=Yes
GenScriptPrev=Yes
GenArchiveModel=No
GenDataPathName=
GenDataSinglefile=Yes
GenDataScriptName=testdata
GenDataScriptName0=
GenDataScriptName1=
GenDataScriptName2=
GenDataScriptName3=
GenDataScriptName4=
GenDataScriptName5=
GenDataScriptName6=
GenDataScriptName7=
GenDataScriptName8=
GenDataScriptName9=
GenDataOdbc=No
GenDataDelOld=No
GenDataTitle=No
GenDataDefNumRows=20
GenDataCommit=0
GenDataPacket=0
GenDataCSV=No
GenDataOwner=No
GenDataProfNumb=
GenDataProfChar=
GenDataProfDate=
GenTspcCrea=Yes
GenTspcDrop=Yes
GenStorCrea=Yes
GenStorDrop=Yes
GenUddtCrea=Yes
GenUddtDval=Yes
GenUddtChck=Yes
GenUddtCmmt=Yes
GenUddtDrop=Yes
GenClssCrea=Yes
GenClssHead=Yes
GenClssFoot=Yes
GenClssCmmt=Yes
GenClssDrop=Yes
GenClssInst=Yes
GenClssSupp=Yes
GenDtbsCrea=Yes
GenDtbsOpts=Yes
GenDtbsHead=Yes
GenDtbsFoot=Yes
GenDtbsOpen=Yes
GenDtbsClose=Yes
GenDtbsDrop=Yes
GenUserCrea=Yes
GenUserGrant=Yes
GenUserDrop=Yes
GenTablCrea=Yes
GenTablChck=Yes
GenTablOpts=Yes
GenTablHead=Yes
GenTablFoot=Yes
GenTablCmmt=Yes
GenTablDrop=Yes
GenColnUddt=Yes
GenColnDval=Yes
GenColnChck=Yes
GenColnOpts=Yes
GenColnCmmt=Yes
GenPkeyCrea=Yes
GenPkeyOpts=Yes
GenPkeyDrop=Yes
GenAkeyCrea=Yes
GenAkeyOpts=Yes
GenAkeyDrop=Yes
GenRefrCrea=Yes
GenRefrIdcl=Yes
GenRefrIDUR=Yes
GenRefrIDUC=Yes
GenRefrIDUN=Yes
GenRefrIDUD=Yes
GenRefrIDDR=Yes
GenRefrIDDC=Yes
GenRefrIDDN=Yes
GenRefrIDDD=Yes
GenRefrDrop=Yes
GenIndxCrea=Yes
GenIndxPkey=Yes
GenIndxFkey=Yes
GenIndxAkey=Yes
GenIndxClus=Yes
GenIndxOthr=Yes
GenIndxOpts=Yes
GenIndxCmmt=Yes
GenIndxDrop=Yes
GenViewCrea=Yes
GenViewHead=Yes
GenViewFoot=Yes
GenViewCmmt=Yes
GenViewDrop=Yes
GenJidxCrea=Yes
GenJidxHead=Yes
GenJidxFoot=Yes
GenJidxDrop=Yes
GenSqncCrea=Yes
GenSqncDrop=Yes
GenTrgrCrea=Yes
GenTrgrDrop=Yes
GenTrgrFIns=Yes
GenTrgrFUpd=Yes
GenTrgrFDel=Yes
GenProcCrea=Yes
GenProcDrop=Yes
GenScriptTitle=Yes
GenScriptNamLabl=No
GenScriptQDtbs=Yes
GenScriptQOwnr=Yes
GenScriptCase=0
GenScriptCharset=0
GenScriptNAcct=No
GenScriptODBC=No
GenUseSync=No
GenSyncChoice=0
GenSyncArch=
GenTmpTablCrea=Yes
GenTmpTablDrop=Yes
GenTrgrStdMsg=Yes
GenTrgrMsgTab=
GenTrgrMsgNo=
GenTrgrMsgTxt=
GenRuleCrea=Yes
GenRuleDrop=Yes

[FolderOptions\Pdm]
IndxIQName=%COLUMN%_%INDEXTYPE%
IndxPK=Yes
IndxFK=Yes
IndxAK=Yes
IndxPKName=%TABLE%_PK
IndxFKName=%REFR%_FK
IndxAKName=%AKEY%_AK
IndxPreserve=No
IndxThreshold=0
RefrPreserve=No
JidxPreserve=No
RbldMultiFact=Yes
RbldMultiDim=Yes
RbldMultiJidx=Yes
CubePreserve=No
CubeScriptPath=
CubeScriptCase=0
CubeScriptCharset=0
CubeScriptNacct=No
CubeScriptHeader=No
CubeScriptExt=csv
CubeScriptExt0=txt
CubeScriptExt1=
CubeScriptExt2=
CubeScriptSep=,
CubeScriptDeli=&quot;
TrgrPreserve=No
TrgrIns=Yes
TrgrUpd=Yes
TrgrDel=Yes
TrgrC2Ins=Yes
TrgrC2Upd=Yes
TrgrC3=Yes
TrgrC4=Yes
TrgrC5=Yes
TrgrC6=Yes
TrgrC7=Yes
TrgrC8=Yes
TrgrC9=Yes
TrgrC10=Yes
TrgrC11=Yes
TrgrC1=Yes
TrgrC12Ins=Yes
TrgrC12Upd=Yes
TrgrC13=Yes
</a:PackageOptionsText>
<a:ModelOptionsText>
[ModelOptions]

[ModelOptions\Physical Objects]
DisplayName=Yes
DefaultDttp=&lt;Undefined&gt;
IgnoreOwner=No
RefrUnique=No
RefrAutoMigrate=Yes
RefrMigrateReuse=Yes
RefrMigrateDomain=Yes
RefrMigrateCheck=Yes
RefrMigrateRule=Yes
RefrMigrateExtd=No
RefrMigrDefaultLink=No
DomnForbDivg=No
DomnCopyDttp=Yes
DomnCopyChck=No
DomnCopyRule=No
DomnCopyMand=No
DomnCopyExtd=No
DomnCopyProf=No

[ModelOptions\Connection]

[ModelOptions\Pdm]

[ModelOptions\Generate]

[ModelOptions\Generate\Cdm]
CheckModel=1
SaveLinks=1
NameToCode=0
Notation=2

[ModelOptions\Generate\Oom]
CheckModel=1
SaveLinks=1
ORMapping=0
NameToCode=0
ClassPrefix=

[ModelOptions\ClssNamingOptions]

[ModelOptions\ClssNamingOptions\PDMPCKG]

[ModelOptions\ClssNamingOptions\PDMPCKG\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\PDMPCKG\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\PDMDOMN]

[ModelOptions\ClssNamingOptions\PDMDOMN\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\PDMDOMN\Code]
Template=
MaxLen=128
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\TABL]

[ModelOptions\ClssNamingOptions\TABL\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\TABL\Code]
Template=
MaxLen=128
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\COLN]

[ModelOptions\ClssNamingOptions\COLN\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\COLN\Code]
Template=
MaxLen=128
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\REFR]

[ModelOptions\ClssNamingOptions\REFR\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\REFR\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\VREF]

[ModelOptions\ClssNamingOptions\VREF\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\VREF\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\VIEW]

[ModelOptions\ClssNamingOptions\VIEW\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\VIEW\Code]
Template=
MaxLen=128
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\FACT]

[ModelOptions\ClssNamingOptions\FACT\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\FACT\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\DIMN]

[ModelOptions\ClssNamingOptions\DIMN\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\DIMN\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\CUBE]

[ModelOptions\ClssNamingOptions\CUBE\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\CUBE\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\MEAS]

[ModelOptions\ClssNamingOptions\MEAS\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\MEAS\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\DATTR]

[ModelOptions\ClssNamingOptions\DATTR\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\DATTR\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\FILO]

[ModelOptions\ClssNamingOptions\FILO\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;\/:*?&lt;&gt;|&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\FILO\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_.&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\DefaultClass]

[ModelOptions\ClssNamingOptions\DefaultClass\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\DefaultClass\Code]
Template=
MaxLen=254
Case=M
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\NamingOptionsTemplates]

[ModelOptions\Default Opts]

[ModelOptions\Default Opts\TABL]
PhysOpts=

[ModelOptions\Default Opts\COLN]
PhysOpts=

[ModelOptions\Default Opts\INDX]
PhysOpts=

[ModelOptions\Default Opts\AKEY]
PhysOpts=

[ModelOptions\Default Opts\PKEY]
PhysOpts=

[ModelOptions\Default Opts\STOR]
PhysOpts=

[ModelOptions\Default Opts\TSPC]
PhysOpts=

[ModelOptions\Default Opts\SQNC]
PhysOpts=

[ModelOptions\Default Opts\DTBS]
PhysOpts=
</a:ModelOptionsText>
<c:DBMS>
<o:Shortcut Id="o3">
<a:ObjectID>6958C5D5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Microsoft SQL Server 7.x</a:Name>
<a:Code>SQL SERVER 7</a:Code>
<a:CreationDate>1081601647</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601647</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:TargetID>986CB218-1936-4245-823C-883D7AF59B86</a:TargetID>
<a:TargetClassID>4BA9F647-DAB1-11D1-9944-006097355D9B</a:TargetClassID>
<a:TargetPackagePath/>
</o:Shortcut>
</c:DBMS>
<c:PhysicalDiagrams>
<o:PhysicalDiagram Id="o4">
<a:ObjectID>6958C5D1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>PhysicalDiagram_1</a:Name>
<a:Code>PHYSICALDIAGRAM_1</a:Code>
<a:CreationDate>1081601645</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1082148563</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DisplayPreferences>
[DisplayPreferences]

[DisplayPreferences\PDM]

[DisplayPreferences\General]
Adjust to text=Yes
Snap Grid=No
Display Grid=No
Show Page Delimiter=Yes
Grid size=800
Graphic unit=0
Window color=255 255 255

[DisplayPreferences\Object]
Mode=0
Trunc Length=80
Word Length=80
Word Text=!&quot;&quot;#$%&amp;&#39;()*+,-./:;&lt;=&gt;?@[\]^_`{|}~
Shortcut IntIcon=Yes
Shortcut IntLoct=No
Shortcut ExtIcon=Yes
Shortcut ExtLoct=No
File Location=No
TablColn=No
ColnMode=0
ColnMax=5
TablIndx=No
TablKey=No
TablTrgr=Yes
TablOwnr=No
ColnDttp=Yes
ColnDomn=No
ColnShowDomn=Yes
ColnKey=Yes
ColnIndx=Yes
ColnMand=Yes
ViewTabl=Yes
ViewColn=Yes
ViewOwnr=No
VColName=Yes
VColExpr=No
VColDttp=No
VColCMod=1
VColCMax=5
RefrName=No
RefrJoin=Yes
RefrCnam=No
RefrIntg=No
RefrImpl=No
RefrCard=No
RefrMode=2
VRefName=No
VRefJoin=No
VRefMode=0

[DisplayPreferences\Symbol]

[DisplayPreferences\Symbol\PDMPCKG]
DISPNAMEFont=arial,8,N
DISPNAMEFont color=0, 0, 0
AutoAdjustToText=Yes
Width=4800
Height=3600
Brush color=255 255 255
Fill Color=Yes
Pen=1 0 0, 0, 255
Shadow color=192 192 192
Shadow=No

[DisplayPreferences\Symbol\TABL]
DISPNAMEFont=arial,8,N
DISPNAMEFont color=0, 0, 0
TableColumnsFont=arial,8,N
TableColumnsFont color=0, 0, 0
TablePkColumnsFont=arial,8,N
TablePkColumnsFont color=0, 0, 0
TableIndexsFont=arial,8,N
TableIndexsFont color=0, 0, 0
TableKeysFont=arial,8,N
TableKeysFont color=0, 0, 0
TableTriggersFont=arial,8,N
TableTriggersFont color=0, 0, 0
AutoAdjustToText=Yes
Width=4800
Height=3600
Brush color=255 255 255
Fill Color=Yes
Pen=1 0 0, 0, 255
Shadow color=192 192 192
Shadow=No

[DisplayPreferences\Symbol\REFR]
DISPNAMEFont=arial,8,N
DISPNAMEFont color=0, 0, 0
CARDFont=arial,8,N
CARDFont color=0, 0, 0
Line style=0
Brush color=255 255 255
Fill Color=Yes
Pen=1 0 0, 0, 255
Shadow color=192 192 192
Shadow=No

[DisplayPreferences\Symbol\VREF]
DISPNAMEFont=arial,8,N
DISPNAMEFont color=0, 0, 0
Line style=0
Brush color=255 255 255
Fill Color=Yes
Pen=1 0 0, 0, 255
Shadow color=192 192 192
Shadow=No

[DisplayPreferences\Symbol\VIEW]
DISPNAMEFont=arial,8,N
DISPNAMEFont color=0, 0, 0
ViewColumnnFont=arial,8,N
ViewColumnnFont color=0, 0, 0
ViewTablesFont=arial,8,N
ViewTablesFont color=0, 0, 0
AutoAdjustToText=Yes
Width=4800
Height=3600
Brush color=255 255 255
Fill Color=Yes
Pen=1 0 0, 0, 255
Shadow color=192 192 192
Shadow=No

[DisplayPreferences\Symbol\FILO]
NAMEFont=arial,8,N
NAMEFont color=0, 0, 0
AutoAdjustToText=Yes
Width=2400
Height=2400
Brush color=255 255 255
Fill Color=No
Pen=1 0 0, 0, 255
Shadow color=192 192 192
Shadow=No

[DisplayPreferences\Symbol\USRDEPD]
OBJXSTRFont=arial,8,N
OBJXSTRFont color=0, 0, 0
Line style=0
Brush color=255 255 255
Fill Color=Yes
Pen=2 0 0 0 0
Shadow color=192 192 192
Shadow=No

[DisplayPreferences\Symbol\Free Symbol]
Free TextFont=arial,8,N
Free TextFont color=0, 0, 0
Line style=0
Brush color=255 255 255
Fill Color=Yes
Pen=1 0 0, 0, 255
Shadow color=192 192 192
Shadow=No
</a:DisplayPreferences>
<a:PaperSize>(8268, 11689)</a:PaperSize>
<a:PageMargins>((315,354), (433,354))</a:PageMargins>
<a:PageSize>9</a:PageSize>
<a:PaperSource>7</a:PaperSource>
<c:Symbols>
<o:ReferenceSymbol Id="o5">
<a:CenterTextOffset>(3, 0)</a:CenterTextOffset>
<a:Rect>((-742765,664300), (-734891,686673))</a:Rect>
<a:ListOfPoints>((-738822,686673),(-738844,664300))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>8388672</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Id="o6">
<a:Rect>((-740412,685173), (-733632,688773))</a:Rect>
<a:LineColor>8388672</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o7">
<a:ObjectID>6958C554-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_MCH</a:Name>
<a:Code>T_MCH</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o8">
<a:ObjectID>6958C502-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_MCH</a:Name>
<a:Code>CD_MCH</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o9">
<a:ObjectID>6958C503-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_CHG</a:Name>
<a:Code>CD_CHG</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o10">
<a:ObjectID>6958C504-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_USR</a:Name>
<a:Code>CD_USR</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o11">
<a:ObjectID>6958C505-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DH_MCH</a:Name>
<a:Code>DH_MCH</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>smalldatetime</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o12">
<a:ObjectID>6958C506-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DH_MCH_EFE</a:Name>
<a:Code>DH_MCH_EFE</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>smalldatetime</a:DataType>
</o:Column>
<o:Column Id="o13">
<a:ObjectID>6958C507-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_SIT</a:Name>
<a:Code>CD_SIT</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o14">
<a:ObjectID>6958C508-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_MCH_COM_SIT</a:Name>
<a:Code>NM_MCH_COM_SIT</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>varchar(30)</a:DataType>
<a:Length>30</a:Length>
</o:Column>
<o:Column Id="o15">
<a:ObjectID>6958C509-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_TPA</a:Name>
<a:Code>CD_TPA</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o16">
<a:ObjectID>6958C50A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_IFT</a:Name>
<a:Code>CD_IFT</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o17">
<a:ObjectID>6958C50B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DS_MCH_EST</a:Name>
<a:Code>DS_MCH_EST</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>varchar(255)</a:DataType>
<a:Length>255</a:Length>
</o:Column>
<o:Column Id="o18">
<a:ObjectID>6958C50C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_MCH_AEN</a:Name>
<a:Code>NR_MCH_AEN</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(10)</a:DataType>
<a:Length>10</a:Length>
</o:Column>
<o:Column Id="o19">
<a:ObjectID>6958C50D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TT_MCH_OBS</a:Name>
<a:Code>TT_MCH_OBS</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>varchar(255)</a:DataType>
<a:Length>255</a:Length>
</o:Column>
<o:Column Id="o20">
<a:ObjectID>6958C50E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_MCH</a:Name>
<a:Code>TP_MCH</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o21">
<a:ObjectID>6958C50F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_MCH_TEL</a:Name>
<a:Code>FL_MCH_TEL</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>tinyint</a:DataType>
</o:Column>
<o:Column Id="o22">
<a:ObjectID>6958C510-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o23">
<a:ObjectID>6958C518-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_MCH</a:Name>
<a:Code>Pk_T_MCH</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_MCH</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o8"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o24">
<a:ObjectID>6958C512-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_MCH_CHG</a:Name>
<a:Code>I_MCH_CHG</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o25">
<a:ObjectID>6958C513-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o9"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o26">
<a:ObjectID>6958C514-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_MCH_DH</a:Name>
<a:Code>I_MCH_DH</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o27">
<a:ObjectID>6958C515-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o11"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o28">
<a:ObjectID>6958C516-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_MCH_TP</a:Name>
<a:Code>I_MCH_TP</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o29">
<a:ObjectID>6958C517-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o20"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Id="o30">
<a:ObjectID>6958C5DA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>dbo</a:Name>
<a:Code>dbo</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
</o:User>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o31">
<a:ObjectID>6958C558-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_MCH_TRI</a:Name>
<a:Code>T_MCH_TRI</a:Code>
<a:Text>Create Trigger T_MCH_TRI On T_MCH
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Situação»Mensagem de Chegada: Situação da Mensagem de Chegada */
If (Select Count(*) From T_SIT, Inserted
Where T_SIT.CD_SIT = Inserted.CD_SIT)
 &lt;&gt;(Select Count(CD_SIT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Situação&gt; que se deseja incluir na tabela &lt;Mensagem de Chegada&gt; não está cadastrada&#39;
  Return
End
/* Informante da Situação de Vôo»Mensagem de Chegada: Informante da Mensagem de Chegada */
If (Select Count(*) From T_IFT, Inserted
Where T_IFT.CD_IFT = Inserted.CD_IFT)
 &lt;&gt;(Select Count(CD_IFT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Informante da Situação de Vôo&gt; que se deseja incluir na tabela &lt;Mensagem de Chegada&gt; não está cadastrada&#39;
  Return
End
/* Chegadas»Mensagem de Chegada: Chegada da Mensagem */
If (Select Count(*) From T_CHG, Inserted
Where T_CHG.CD_CHG = Inserted.CD_CHG)
 &lt;&gt;(Select Count(CD_CHG) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Chegadas&gt; que se deseja incluir na tabela &lt;Mensagem de Chegada&gt; não está cadastrada&#39;
  Return
End
/* Usuários»Mensagem de Chegada: Usuário da Mensagem de Chegada */
If (Select Count(*) From T_USR, Inserted
Where T_USR.CD_USR = Inserted.CD_USR)
 &lt;&gt;(Select Count(CD_USR) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Usuários&gt; que se deseja incluir na tabela &lt;Mensagem de Chegada&gt; não está cadastrada&#39;
  Return
End
/* Tipo de Anuncio»Mensagem de Chegada: Tipo de Anúncio da Mensagem de Chegada */
If (Select Count(*) From T_TPA, Inserted
Where T_TPA.CD_TPA = Inserted.CD_TPA)
 &lt;&gt;(Select Count(CD_TPA) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Tipo de Anuncio&gt; que se deseja incluir na tabela &lt;Mensagem de Chegada&gt; não está cadastrada&#39;
  Return
End
/* Domínio de: Status de Mensagem de Chegada */
/* 1 - Pendente */
/* 2 - Lida */
/* 3 - Executada */
/* 4 - Cancelada */
If (Select Count(*) From Inserted
    Where TP_MCH In (1,2,3,4))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Status de Mensagem de Chegada&gt; que se deseja incluir na tabela &lt;Mensagem de Chegada&gt; não é uma opção válida&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o32">
<a:ObjectID>6958C55A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_MCH_TRU</a:Name>
<a:Code>T_MCH_TRU</a:Code>
<a:Text>Create Trigger T_MCH_TRU On T_MCH
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_MCH)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código da Mensagem de Chegada&gt; da tabela &lt;Mensagem de Chegada&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_SIT)
/* Situação»Mensagem de Chegada: Situação da Mensagem de Chegada */
If (Select Count(*) From T_SIT, Inserted
Where T_SIT.CD_SIT = Inserted.CD_SIT)
 &lt;&gt;(Select Count(CD_SIT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Situação&gt; que se deseja incluir na tabela &lt;Mensagem de Chegada&gt; não está cadastrada&#39;
  Return
End
If Update (CD_IFT)
/* Informante da Situação de Vôo»Mensagem de Chegada: Informante da Mensagem de Chegada */
If (Select Count(*) From T_IFT, Inserted
Where T_IFT.CD_IFT = Inserted.CD_IFT)
 &lt;&gt;(Select Count(CD_IFT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Informante da Situação de Vôo&gt; que se deseja incluir na tabela &lt;Mensagem de Chegada&gt; não está cadastrada&#39;
  Return
End
If Update (CD_CHG)
/* Chegadas»Mensagem de Chegada: Chegada da Mensagem */
If (Select Count(*) From T_CHG, Inserted
Where T_CHG.CD_CHG = Inserted.CD_CHG)
 &lt;&gt;(Select Count(CD_CHG) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Chegadas&gt; que se deseja incluir na tabela &lt;Mensagem de Chegada&gt; não está cadastrada&#39;
  Return
End
If Update (CD_USR)
/* Usuários»Mensagem de Chegada: Usuário da Mensagem de Chegada */
If (Select Count(*) From T_USR, Inserted
Where T_USR.CD_USR = Inserted.CD_USR)
 &lt;&gt;(Select Count(CD_USR) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Usuários&gt; que se deseja incluir na tabela &lt;Mensagem de Chegada&gt; não está cadastrada&#39;
  Return
End
If Update (CD_TPA)
/* Tipo de Anuncio»Mensagem de Chegada: Tipo de Anúncio da Mensagem de Chegada */
If (Select Count(*) From T_TPA, Inserted
Where T_TPA.CD_TPA = Inserted.CD_TPA)
 &lt;&gt;(Select Count(CD_TPA) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Tipo de Anuncio&gt; que se deseja incluir na tabela &lt;Mensagem de Chegada&gt; não está cadastrada&#39;
  Return
End
If Update (TP_MCH)
/* Domínio de: Status de Mensagem de Chegada */
/* 1 - Pendente */
/* 2 - Lida */
/* 3 - Executada */
/* 4 - Cancelada */
If (Select Count(*) From Inserted
    Where TP_MCH In (1,2,3,4))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Status de Mensagem de Chegada&gt; que se deseja incluir na tabela &lt;Mensagem de Chegada&gt; não é uma opção válida&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o23"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o33">
<a:Rect>((-740355,662170), (-733651,666716))</a:Rect>
<a:LineColor>8388672</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o34">
<a:ObjectID>6958C511-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_CHG</a:Name>
<a:Code>T_CHG</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081711143</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o35">
<a:ObjectID>6958C5C7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_CHG</a:Name>
<a:Code>CD_CHG</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o36">
<a:ObjectID>6958C5C8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DT_CHG</a:Name>
<a:Code>DT_CHG</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_DAT    Script Date: 7/8/2000 12:14:35 ******/
Create Rule        RU_DAT As
DATEPART(hh,@data) = 0 AND
DATEPART(mi,@data) = 0 AND
DATEPART(ss,@data) = 0 AND
DATEPART(ms,@data) = 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>smalldatetime</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o37">
<a:ObjectID>6958C5C9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_AER</a:Name>
<a:Code>CD_AER</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o38">
<a:ObjectID>6958C5CA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_CHG_VOO</a:Name>
<a:Code>NR_CHG_VOO</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(10)</a:DataType>
<a:Length>10</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o39">
<a:ObjectID>6958C5CB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_CHG_HOT</a:Name>
<a:Code>NR_CHG_HOT</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(9)</a:DataType>
<a:Length>9</a:Length>
</o:Column>
<o:Column Id="o40">
<a:ObjectID>6958C5CC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_CHG_GRU</a:Name>
<a:Code>TP_CHG_GRU</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o41">
<a:ObjectID>6958C5CD-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_CHG</a:Name>
<a:Code>TP_CHG</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o42">
<a:ObjectID>6958C5CE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_CHG_NAT</a:Name>
<a:Code>TP_CHG_NAT</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o43">
<a:ObjectID>6958C5D0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_CHG_CTG</a:Name>
<a:Code>TP_CHG_CTG</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o44">
<a:ObjectID>6958C5D2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_COM</a:Name>
<a:Code>CD_COM</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o45">
<a:ObjectID>6958C5D4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_CHG_VIN</a:Name>
<a:Code>CD_CHG_VIN</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o46">
<a:ObjectID>6958C5D6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_CHG_ANU</a:Name>
<a:Code>FL_CHG_ANU</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o47">
<a:ObjectID>6958C5D7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_CHG_TEL</a:Name>
<a:Code>FL_CHG_TEL</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o48">
<a:ObjectID>6958C5D9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_EQP_CHG</a:Name>
<a:Code>CD_EQP_CHG</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o49">
<a:ObjectID>6958C5DB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_AEN_CHG</a:Name>
<a:Code>CD_AEN_CHG</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o50">
<a:ObjectID>6958C5DC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_BOX</a:Name>
<a:Code>CD_BOX</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o51">
<a:ObjectID>6958C5DD-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_CHG_PER_MIN</a:Name>
<a:Code>QT_CHG_PER_MIN</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o52">
<a:ObjectID>6958C5DE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DH_CHG_NRM</a:Name>
<a:Code>DH_CHG_NRM</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>smalldatetime</a:DataType>
</o:Column>
<o:Column Id="o53">
<a:ObjectID>6958C5DF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DH_CHG_EFE</a:Name>
<a:Code>DH_CHG_EFE</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>smalldatetime</a:DataType>
</o:Column>
<o:Column Id="o54">
<a:ObjectID>6958C5E0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DH_CHG_EST</a:Name>
<a:Code>DH_CHG_EST</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>smalldatetime</a:DataType>
</o:Column>
<o:Column Id="o55">
<a:ObjectID>6958C5E1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_CHG_COM_SIT</a:Name>
<a:Code>NM_CHG_COM_SIT</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>varchar(30)</a:DataType>
<a:Length>30</a:Length>
</o:Column>
<o:Column Id="o56">
<a:ObjectID>6958C5E2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DH_CHG_SIT</a:Name>
<a:Code>DH_CHG_SIT</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>smalldatetime</a:DataType>
</o:Column>
<o:Column Id="o57">
<a:ObjectID>6958C5E3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_CHG_CAN</a:Name>
<a:Code>FL_CHG_CAN</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_ZRO    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_ZRO As
0</a:DefaultValue>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o58">
<a:ObjectID>6958C5E4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_CHG_STA</a:Name>
<a:Code>TP_CHG_STA</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
</o:Column>
<o:Column Id="o59">
<a:ObjectID>6958C5E5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_CHG_PAR_ORI</a:Name>
<a:Code>FL_CHG_PAR_ORI</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_ZRO    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_ZRO As
0</a:DefaultValue>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o60">
<a:ObjectID>6958C5E6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o61">
<a:ObjectID>6958C5FA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_CHG</a:Name>
<a:Code>Pk_T_CHG</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_CHG</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o35"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o62">
<a:ObjectID>6958C5E7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_CHG_EFE</a:Name>
<a:Code>I_CHG_EFE</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o63">
<a:ObjectID>6958C5E8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o58"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o64">
<a:ObjectID>6958C5E9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_1&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o53"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o65">
<a:ObjectID>6958C5EA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_2&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o35"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o66">
<a:ObjectID>6958C5EB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_CHG_GRU</a:Name>
<a:Code>I_CHG_GRU</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o67">
<a:ObjectID>6958C5EC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o58"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o68">
<a:ObjectID>6958C5ED-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_1&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o40"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o69">
<a:ObjectID>6958C5EE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_2&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o35"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o70">
<a:ObjectID>6958C5EF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_CHG_STA</a:Name>
<a:Code>I_CHG_STA</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o71">
<a:ObjectID>6958C5F0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o58"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o72">
<a:ObjectID>6958C5F1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_1&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o35"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o73">
<a:ObjectID>6958C5F2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_CHG_STA_DAT</a:Name>
<a:Code>I_CHG_STA_DAT</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o74">
<a:ObjectID>6958C5F3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o58"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o75">
<a:ObjectID>6958C5F4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_1&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o36"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o76">
<a:ObjectID>6958C5F5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_2&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o35"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o77">
<a:ObjectID>6958C5F6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_CHG_TP</a:Name>
<a:Code>I_CHG_TP</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o78">
<a:ObjectID>6958C5F7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o41"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o79">
<a:ObjectID>6958C5F8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_CHG_VIN</a:Name>
<a:Code>I_CHG_VIN</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o80">
<a:ObjectID>6958C5F9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o45"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Ref="o30"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o81">
<a:ObjectID>6958C5AE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_CHG_TRD</a:Name>
<a:Code>T_CHG_TRD</a:Code>
<a:Text>Create Trigger T_CHG_TRD On T_CHG
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Chegadas»Chegadas: Chegada Vinculada (Restrict) */
If (Select Count(*) From T_CHG dep, Deleted pri
 Where dep.CD_CHG_VIN = pri.CD_CHG) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Chegadas&gt; está sendo referenciada na tabela &lt;Chegadas&gt;&#39;
  Return
End
/* Chegadas»Chamadas de Anuncio: Chamada da Chegada (Cascade) */
Delete T_CHA From T_CHA dep, Deleted pri
 Where dep.CD_CHG = pri.CD_CHG
/* Chegadas»Mensagem de Chegada: Chegada da Mensagem (Cascade) */
Delete T_MCH From T_MCH dep, Deleted pri
 Where dep.CD_CHG = pri.CD_CHG
/* Chegadas»Histórico de Situação de Vôo de Chegada: Chegada do HSC (Cascade) */
Delete T_HSC From T_HSC dep, Deleted pri
 Where dep.CD_CHG = pri.CD_CHG
/* Chegadas»Log da Programação de Anúncios: Chegadas do Log de Programação (Cascade) */
Delete T_PRALOG From T_PRALOG dep, Deleted pri
 Where dep.CD_CHG = pri.CD_CHG
/* Chegadas»Dados Estatísticos de Chegada: Dados Estatísticos da Chegada (Cascade) */
Delete T_DEC From T_DEC dep, Deleted pri
 Where dep.CD_CHG = pri.CD_CHG
/* Chegadas»Escala da Chegada de Vôo: Escalas de Chegada (Cascade) */
Delete T_ECC001 From T_ECC001 dep, Deleted pri
 Where dep.CD_CHG = pri.CD_CHG
/* Chegadas»Esteira da Chegada de Vôo: Esteiras de Chegada (Cascade) */
Delete T_ESV001 From T_ESV001 dep, Deleted pri
 Where dep.CD_CHG = pri.CD_CHG
/* Chegadas»Histórico de Permanência de Aeronaves: Histórico de Permanência dos Vôos de Chegada (Cascade) */
Delete T_HPA001 From T_HPA001 dep, Deleted pri
 Where dep.CD_CHG = pri.CD_CHG
/* Chegadas»Chegadas Candidatas a Vôo Antecessor: Vôo de Chegada candidato a antecessor (Cascade) */
Delete T_CHGANT From T_CHGANT dep, Deleted pri
 Where dep.CD_CHG = pri.CD_CHG
/* Chegadas»Partidas: Chegada Antecessora (Set Null) */
Update T_PAR Set CD_CHG_ANT = Null
 From T_PAR dep, Deleted pri
 Where dep.CD_CHG_ANT = pri.CD_CHG
/* Chegadas»Partidas: Chegada da Aeronave Sucessora (Set Null) */
Update T_PAR Set CD_CHG_AEN_ANT = Null
 From T_PAR dep, Deleted pri
 Where dep.CD_CHG_AEN_ANT = pri.CD_CHG
/* Regra de negócio */
/* INCLUIR REGISTROS EM T_ACH */
INSERT	T_ACH (DH_ACH, CD_CHG)
SELECT GETDATE(), CD_CHG FROM DELETED

End
go</a:Text>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o82">
<a:ObjectID>6958C5B0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_CHG_TRI</a:Name>
<a:Code>T_CHG_TRI</a:Code>
<a:Text>Create Trigger T_CHG_TRI On T_CHG
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Aeroporto»Chegadas: Aeroporto da Chegada */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
/* Aeronave»Chegadas: Aeronave da Chegada */
If (Select Count(*) From T_AEN, Inserted
Where T_AEN.CD_AEN = Inserted.CD_AEN_CHG)
 &lt;&gt;(Select Count(CD_AEN_CHG) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeronave&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
/* Companhia Aérea»Chegadas: Comapanhia Aérea da Chegada */
If (Select Count(*) From T_COM, Inserted
Where T_COM.CD_COM = Inserted.CD_COM)
 &lt;&gt;(Select Count(CD_COM) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Companhia Aérea&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
/* Equipamento»Chegadas: Equipamento da Chegada */
If (Select Count(*) From T_EQP, Inserted
Where T_EQP.CD_EQP = Inserted.CD_EQP_CHG)
 &lt;&gt;(Select Count(CD_EQP_CHG) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Equipamento&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
/* Box»Chegadas: Box da Chegada */
If (Select Count(*) From T_BOX, Inserted
Where T_BOX.CD_BOX = Inserted.CD_BOX)
 &lt;&gt;(Select Count(CD_BOX) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Box&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
/* Situação»Chegadas: Situação da Chegada */
If (Select Count(*) From T_SIT, Inserted
Where T_SIT.CD_SIT = Inserted.CD_SIT)
 &lt;&gt;(Select Count(CD_SIT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Situação&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
/* Informante da Situação de Vôo»Chegadas: Informante da Situação de Chegada */
If (Select Count(*) From T_IFT, Inserted
Where T_IFT.CD_IFT = Inserted.CD_IFT)
 &lt;&gt;(Select Count(CD_IFT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Informante da Situação de Vôo&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
/* Chegadas»Chegadas: Chegada Vinculada */
If (Select Count(*) From T_CHG, Inserted
Where T_CHG.CD_CHG = Inserted.CD_CHG_VIN)
 &lt;&gt;(Select Count(CD_CHG_VIN) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Chegadas&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
/* Usuários»Chegadas: Usuário logado */
If (Select Count(*) From T_USR, Inserted
Where T_USR.CD_USR = Inserted.CD_USR)
 &lt;&gt;(Select Count(CD_USR) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Usuários&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
/* Domínio de: Grupo do Vôo */
/* 1 - Grupo 1 */
/* 2 - Grupo 2 */
If (Select Count(*) From Inserted
    Where TP_CHG_GRU In (1,2))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Grupo do Vôo&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não é uma opção válida&#39;
  Return
End
/* Domínio de: Tipo do Vôo de Chegada */
/* 1 - DOM-Doméstico */
/* 2 - INT-Internacional */
/* 3 - REG-Regional */
If (Select Count(*) From Inserted
    Where TP_CHG In (1,2,3))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Tipo do Vôo de Chegada&gt; quese deseja incluir na tabela &lt;Chegadas&gt; não é uma opção válida&#39;
  Return
End
/* Domínio de: Natureza do Vôo de Chegada */
/* 1 - PAX-Passageiro */
/* 2 - CRG-Carga */
/* 3 - MIS-Misto */
/* 4 - TSL-Translado */
If (Select Count(*) From Inserted
    Where TP_CHG_NAT In (1,2,3,4))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Natureza do Vôo de Chegada&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não é uma opção válida&#39;
  Return
End
/* Domínio de: Categoria do Vôo de Chegada */
/* 1 - RGL-Regular */
/* 2 - CHT-Charter */
/* 3 - CSH-Codeshare */
/* 4 - DPL-Duplicate Leg */
/* 5 - TEC-Pouso Técnico */
/* 6 - TSL-Translado */
/* 7 - AVG-Aviação Geral */
/* 8 - MLT-Militar */
/* 9 - NRG-Não Regular */
/* 10 - TXA-Táxi Aéreo */
If (Select Count(*) From Inserted
    Where TP_CHG_CTG In (1,2,3,4,5,6,7,8,9,10))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Categoria do Vôo de Chegada&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não é uma opção válida&#39;
  Return
End
/* Domínio de: Status de Chegada do Vôo */
/* 1 - Em Aberto */
/* 2 - Concluído */
If (Select Count(*) From Inserted
    Where TP_CHG_STA In (1,2))
 &lt;&gt;(Select Count(*) From Inserted
    Where TP_CHG_STA Is Not Null)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Status de Chegada do Vôo&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não é uma opção válida&#39;
  Return
End
/* Regra de negócio */
/* RESTRIÇÕES */
/*********************************** RETIRADO PELO RONALDO EM 11/3/98 ***********************************************************
/* A data do vôo sendo incluído não pode ser maior do que a data posterior à da última geração nem anterior a data de hoje */
IF (	SELECT 	COUNT(*) 
	FROM 	INSERTED INS
	WHERE	(DATEDIFF(MI, Dateadd(HH, -Datepart(HH, GETDATE()), Dateadd(mi, -datepart(mi, GETDATE()), GETDATE())), INS.DT_CHG) &lt; 0 OR   /* (DATEDIFF(MI, CONVERT(DATETIME, (CONVERT(VARCHAR, DATEPART(MM, GETDATE())) + &#39;/&#39; + CONVERT(VARCHAR, DATEPART(DD, GETDATE()))  + &#39;/&#39; + CONVERT(VARCHAR, DATEPART(YY, GETDATE())) +  &#39; 00:00&#39;)), INS.DT_CHG) &lt; 0 OR */
		DATEADD(DD, -1, INS.DT_CHG) &gt; (SELECT MAX(DT_CHG) FROM T_CHG WHERE CD_CHG &lt;&gt; INS.CD_CHG) ) AND INS.NR_CHG_HOT IS NOT NULL) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: Não é permitida a geração de vôos de datas anteriores à data de hoje ou posteriores à data da última geração mais um dia.&#39;
	ROLLBACK TRANSACTION
	RETURN
END
**********************************************************************************************************************************************/

/* Um vôo não pode ser incluído CANCELADO */
IF (	SELECT 	COUNT(*)
	FROM	INSERTED INS, 
		T_SIT SIT
	WHERE	SIT.CD_SIT = INS.CD_SIT AND
		FL_SIT_CAN_VOO &lt;&gt; 0) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: Não é permitida a inclusão de vôos com situação de chegada cancelada&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Incluir HPA dos registros de Chegada a incluir */
/* Declaração do cursor */
DECLARE INSCHG CURSOR FOR
	SELECT 	CHG.CD_AER,
		CHG.CD_EQP_CHG,
		CHG.CD_AEN_CHG,
		CHG.CD_BOX,
		CHG.CD_CHG,
		CHG.DH_CHG_NRM
	FROM	T_CHG CHG,
		INSERTED INS
	WHERE	CHG.CD_CHG = INS.CD_CHG AND
		CHG.TP_CHG_CTG NOT IN (3, 4)
	ORDER BY CHG.CD_CHG

/* Declaração das variáveis que receberão o cursor */
DECLARE @CD_AER	INT,
	 @CD_EQP_CHG 	INT,
	 @CD_AEN_CHG	INT,
	 @CD_BOX	INT,
	 @CD_CHG	INT,
	 @DH_CHG_NRM	SMALLDATETIME

/* Abertura do cursor */
OPEN INSCHG

/* Ir para o primeiro registro */
FETCH	INSCHG
INTO	@CD_AER,
	 @CD_EQP_CHG,
	 @CD_AEN_CHG,
	 @CD_BOX,
	 @CD_CHG,
	 @DH_CHG_NRM

/* Processar todos os registros de INSCHG*/
WHILE @@FETCH_STATUS = 0
BEGIN

	/* Lançar Histórico de Permanência de Aeronaves */
	INSERT T_HPA001 (
		CD_HPA,
		NR_HPA_SEQ,
		CD_AER,
		CD_EQP,
		CD_AEN,
		CD_BOX,
		CD_CHG,
		DH_HPA_ENT)
	SELECT	ISNULL(MAX(CD_HPA), 0) +1,
		1, 
		@CD_AER,
		@CD_EQP_CHG,
		@CD_AEN_CHG,
		@CD_BOX,
		@CD_CHG,
		@DH_CHG_NRM
	FROM	T_HPA001 HPA

	/* Ir para o próximo registro */
	FETCH NEXT FROM INSCHG
	INTO	@CD_AER,
		@CD_EQP_CHG,
		@CD_AEN_CHG,
		@CD_BOX,
		@CD_CHG,
		@DH_CHG_NRM

END
CLOSE INSCHG
DEALLOCATE INSCHG


/* Milena 14/01/98 - Inserir vôo que está sendo incluído na tabela de Vôos candidatos a vôo Antecessor se 
o vôo não for Codeshare ou Duplicate Leg */
INSERT T_CHGANT (
	CD_CHG)
SELECT	CD_CHG
FROM	INSERTED INS
WHERE	INS.TP_CHG_CTG NOT IN (3,4)

/* PROVOCAR A EXECUÇÃO DA TRIGGER DE UPDATE PARA A COMPLEMENTAÇÃO DAS VERIFICAÇÕES
    E PROCESSAR OUTRAS ATUALIZAÇÕES */
UPDATE	T_CHG
SET	CD_SIT = CHG.CD_SIT,
	DH_CHG_SIT = CHG.DH_CHG_NRM
FROM	T_CHG CHG,
	INSERTED INS

WHERE	CHG.CD_CHG = INS.CD_CHG
End
go</a:Text>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o83">
<a:ObjectID>6958C5B2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_CHG_TRU</a:Name>
<a:Code>T_CHG_TRU</a:Code>
<a:Text>CREATE Trigger T_CHG_TRU On T_CHG
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_CHG)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Vôo de Chegada&gt; da tabela &lt;Chegadas&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_AER)
/* Aeroporto Chegadas: Aeroporto da Chegada */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
If Update (CD_AEN_CHG)
/* Aeronave»Chegadas: Aeronave da Chegada */
If (Select Count(*) From T_AEN, Inserted
Where T_AEN.CD_AEN = Inserted.CD_AEN_CHG)
 &lt;&gt;(Select Count(CD_AEN_CHG) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeronave&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
If Update (CD_COM)
/* Companhia Aérea»Chegadas: Comapanhia Aérea da Chegada */
If (Select Count(*) From T_COM, Inserted
Where T_COM.CD_COM = Inserted.CD_COM)
 &lt;&gt;(Select Count(CD_COM) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Companhia Aérea&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
If Update (CD_EQP_CHG)
/* Equipamento»Chegadas: Equipamento da Chegada */
If (Select Count(*) From T_EQP, Inserted
Where T_EQP.CD_EQP = Inserted.CD_EQP_CHG)
 &lt;&gt;(Select Count(CD_EQP_CHG) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Equipamento&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
If Update (CD_BOX)
/* Box»Chegadas: Box da Chegada */
If (Select Count(*) From T_BOX, Inserted
Where T_BOX.CD_BOX = Inserted.CD_BOX)
 &lt;&gt;(Select Count(CD_BOX) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Box&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
If Update (CD_SIT)
/* Situação»Chegadas: Situação da Chegada */
If (Select Count(*) From T_SIT, Inserted
Where T_SIT.CD_SIT = Inserted.CD_SIT)
 &lt;&gt;(Select Count(CD_SIT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Situação&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
If Update (CD_IFT)
/* Informante da Situação de Vôo»Chegadas: Informante da Situação de Chegada */
If (Select Count(*) From T_IFT, Inserted
Where T_IFT.CD_IFT = Inserted.CD_IFT)
 &lt;&gt;(Select Count(CD_IFT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Informante da Situação de Vôo&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
If Update (CD_CHG_VIN)
/* Chegadas»Chegadas: Chegada Vinculada */
If (Select Count(*) From T_CHG, Inserted
Where T_CHG.CD_CHG = Inserted.CD_CHG_VIN)
 &lt;&gt;(Select Count(CD_CHG_VIN) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Chegadas&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
If Update (CD_USR)
/* Usuários»Chegadas: Usuário logado */
If (Select Count(*) From T_USR, Inserted
Where T_USR.CD_USR = Inserted.CD_USR)
 &lt;&gt;(Select Count(CD_USR) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Usuários&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
If Update (TP_CHG_GRU)
Or Update (TP_CHG)
Or Update (TP_CHG_NAT)
Or Update (TP_CHG_CTG)
Or Update (TP_CHG_STA)
/* Domínio de: Grupo do Vôo */
/* 1 - Grupo 1 */
/* 2 - Grupo 2 */
If (Select Count(*) From Inserted
    Where TP_CHG_GRU In (1,2))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBackTransaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Grupo do Vôo&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não é uma opção válida&#39;
  Return
End
/* Domínio de: Tipo do Vôo de Chegada */
/* 1 - DOM-Doméstico */
/* 2 - INT-Internacional */
/* 3 - REG-Regional */
If (Select Count(*) From Inserted
    Where TP_CHG In (1,2,3))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Tipo do Vôo de Chegada&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não é uma opção válida&#39;
  Return
End
/* Domínio de: Natureza do Vôo de Chegada */
/* 1 - PAX-Passageiro */
/* 2 - CRG-Carga */
/* 3 - MIS-Misto */
/* 4 - TSL-Translado */
If (Select Count(*) From Inserted
    Where TP_CHG_NAT In (1,2,3,4))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Natureza do Vôo de Chegada&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não é uma opção válida&#39;
  Return
End
/* Domínio de: Categoria do Vôo de Chegada */
/* 1 - RGL-Regular */
/* 2 - CHT-Charter */
/* 3 - CSH-Codeshare */
/* 4 - DPL-Duplicate Leg */
/* 5 - TEC-Pouso Técnico */
/* 6 - TSL-Translado */
/* 7 - AVG-Aviação Geral */
/* 8 - MLT-Militar */
/* 9 - NRG-Não Regular */
/* 10 - TXA-Táxi Aéreo */
If (Select Count(*) From Inserted
    Where TP_CHG_CTG In (1,2,3,4,5,6,7,8,9,10))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Categoria do Vôo de Chegada&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não é uma opção válida&#39;
  Return
End
/* Domínio de: Status de Chegada do Vôo */
/* 1 - Em Aberto */
/* 2 - Concluído */
If (Select Count(*) From Inserted
    Where TP_CHG_STA In (1,2))
 &lt;&gt;(Select Count(*) From Inserted
    Where TP_CHG_STA Is Not Null)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Status de Chegada do Vôo&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não é uma opção válida&#39;
  Return
End
/* Regra de negócio */
--CSH OU DPL
IF UPDATE(TP_CHG_CTG) OR UPDATE(CD_CHG_VIN)
	--Um vôo do tipo normal ou charter não pode ter vôo vinculado e um vôo do tipo CSH ou DPL tem de ter vôo vinculado
	IF (	SELECT 	COUNT(*) FROM INSERTED
		WHERE	(TP_CHG_CTG NOT IN (3,4) AND CD_CHG_VIN IS NOT NULL) OR (TP_CHG_CTG IN (3,4) AND CD_CHG_VIN IS NULL)) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: Um vôo do tipo Normal ou Charter não pode ter vôo vinculado, e um vôo do tipo Codeshare ou Duplicate Leg tem de ter vôo vinculado.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
IF UPDATE(TP_CHG_CTG)
	--Um vôo do tipo CSH ou DPL não pode ter vôo de PAR associado
	IF (	SELECT 	COUNT(*) FROM	INSERTED INS
		WHERE	TP_CHG_CTG IN (3,4) AND 
			EXISTS (SELECT * FROM T_PAR PAR WHERE PAR.CD_CHG_AEN_ANT = INS.CD_CHG)) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: Um vôo do tipo Codeshare ou Duplicate Leg não pode ter vôo de partida associado.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
--Não permitir que um vôo de CHG que tenha sido alterado para concluído, sem estar Cancelado e sem ser CSH ou DPL, possua o campo de aeronave nulo
IF (	SELECT 	COUNT(*) FROM 	INSERTED INS, T_SIT SIT
	WHERE	SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CON_VOO = 1 AND INS.FL_CHG_CAN = 0 AND INS.TP_CHG_CTG NOT IN (3, 4) AND INS.CD_AEN_CHG IS NULL) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: &lt;Hora de Entrada de Estacionamento&gt; ou &lt;Aeronave&gt; não informados.&#39;
	ROLLBACK TRANSACTION
	RETURN
END
IF UPDATE(CD_SIT)
BEGIN
	--Verificar se a situação informada é uma situação de CHG
	IF (SELECT COUNT(*) FROM	INSERTED INS, T_SIT SIT WHERE SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CHG &lt;&gt; 1) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: A situação informada não é uma situação de chegada.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
END
--Atualizar o complemento de chegada
IF UPDATE(CD_SIT) OR UPDATE(DH_CHG_EFE)
BEGIN
	--Hora
	UPDATE	T_CHG SET NM_CHG_COM_SIT = CONVERT(CHAR(5), CHG.DH_CHG_EFE, 8)
	FROM	T_CHG CHG, INSERTED INS, T_SIT SIT
	WHERE	CHG.CD_CHG = INS.CD_CHG AND SIT.CD_SIT = CHG.CD_SIT AND SIT.TP_SIT_COM = 1
	--Nenhum
	UPDATE	T_CHG SET NM_CHG_COM_SIT = NULL
	FROM	T_CHG CHG, INSERTED INS, T_SIT SIT
	WHERE	CHG.CD_CHG = INS.CD_CHG AND SIT.CD_SIT = CHG.CD_SIT AND SIT.TP_SIT_COM = 3
	--Caso a Data e Hora da Situação não já tenha sido alerada
	IF NOT UPDATE(DH_CHG_SIT)
	BEGIN
		--Atualizar hora da alteração da situação do vôo de CHG
		UPDATE	T_CHG SET DH_CHG_SIT = GETDATE()
		FROM	T_CHG CHG, INSERTED INS
		WHERE	CHG.CD_CHG = INS.CD_CHG
	END
END
IF UPDATE(CD_SIT)
BEGIN
	--Um vôo de PAR não pode ser cancelado se existir algum registro em T_DEC para este vôo ou para um dos seus vôos vinculados
	IF (	SELECT	COUNT(*) FROM INSERTED INS, T_SIT SIT
		WHERE	SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CAN_VOO = 1 AND
			(EXISTS (SELECT CD_CHG FROM T_DEC WHERE CD_CHG = INS.CD_CHG) OR
			EXISTS (SELECT DEC.CD_CHG FROM T_DEC DEC, T_CHG CHG WHERE CHG.CD_CHG_VIN = INS.CD_CHG AND DEC.CD_CHG = CHG.CD_CHG))) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: O vôo de Chegada não pode ser cancelado pois existe registro de &lt;Dados Estatísticos de Chegada&gt; para este vôo ou para algum de seus vôos vinculados.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
	--A alteração da situação de vôo de CHG de Etapa Concluída para outra qualquer não pode ser efetuada se o HPA do vôo estiver associado a mais de um Status
	IF (	SELECT 	COUNT(*)
		FROM 	T_STA STA, T_HPA001 HPA, INSERTED INS, DELETED DEL, T_SIT SITDEL, T_SIT SITINS
		WHERE 	STA.CD_STA = HPA.CD_STA AND HPA.CD_CHG = INS.CD_CHG AND
			DEL.CD_CHG = INS.CD_CHG AND SITDEL.CD_SIT = DEL.CD_SIT AND
			SITDEL.FL_SIT_CON_VOO = 1 AND SITINS.CD_SIT = INS.CD_SIT AND
			SITINS.FL_SIT_CON_VOO = 0) &gt; 1
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: A situação do vôo não pode ser alterada de Etapa Concluída para outra qualquer se este vôo estiver associado a mais de um Status de Aeronave.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
	--Atualizar Flag de CHG Cancelada em vôo
	UPDATE 	T_CHG SET FL_CHG_CAN = SIT.FL_SIT_CAN_VOO
	FROM 	T_CHG CHG, INSERTED INS, T_SIT SIT
	WHERE 	CHG.CD_CHG = INS.CD_CHG AND SIT.CD_SIT = INS.CD_SIT AND (SIT.FL_SIT_CAN_VOO = 1 OR SIT.FL_SIT_CON_VOO = 0)
	--Setar CD_CHG_ANT do vôo sucessor para nulo caso a CHG seja cancelada
	IF (	SELECT 	COUNT(*) FROM T_PAR PAR, INSERTED INS, T_SIT SIT
		WHERE 	PAR.CD_CHG_ANT = INS.CD_CHG AND SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CAN_VOO = 1) &gt; 0
	BEGIN
		UPDATE 	T_PAR SET CD_CHG_ANT = NULL
		FROM 	T_PAR PAR, INSERTED INS, T_SIT SIT
		WHERE 	PAR.CD_CHG_ANT = INS.CD_CHG AND SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CAN_VOO = 1
	END
	--Setar CD_CHG_AEN_ANT do vôo da aeronave sucessora para nulo caso a CHG seja cancelada
	IF (	SELECT 	COUNT(*) FROM T_PAR PAR, INSERTED INS, T_SIT SIT
		WHERE 	PAR.CD_CHG_AEN_ANT = INS.CD_CHG AND SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CAN_VOO = 1) &gt;0
	BEGIN
		UPDATE 	T_PAR SET CD_CHG_AEN_ANT = NULL
		FROM 	T_PAR PAR, INSERTED INS, T_SIT SIT
		WHERE 	PAR.CD_CHG_AEN_ANT = INS.CD_CHG AND SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CAN_VOO = 1
	END
	--Atualizar o Código da Aeronave para Null caso a CHG tenha sido cancelado
	IF (	SELECT COUNT(*) 	FROM T_CHG CHG, INSERTED INS, T_SIT SIT
		WHERE  	CHG.CD_CHG = INS.CD_CHG AND SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CAN_VOO = 1) &gt; 0
	BEGIN
		UPDATE 	T_CHG SET CD_AEN_CHG = NULL
		FROM 	T_CHG CHG, INSERTED INS, T_SIT SIT
		WHERE  	CHG.CD_CHG = INS.CD_CHG AND SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CAN_VOO = 1
	END
	--Apagar os HPA&#39;s de CHG caso a CHG tenha sido cancelada
	IF (	SELECT	COUNT(*) FROM T_HPA001 HPA, T_SIT SIT, INSERTED INS
		WHERE  	HPA.CD_CHG = INS.CD_CHG AND SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CAN_VOO = 1) &gt; 0
	BEGIN
		DELETE 	T_HPA001
		FROM 	T_HPA001 HPA, T_SIT SIT, INSERTED INS
		WHERE  	HPA.CD_CHG = INS.CD_CHG AND SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CAN_VOO = 1
	END
	--Excluir vôo da tabela de vôos candidatos a vôos Antecessores se a CHG tiver sido cancelada
	IF (	SELECT 	COUNT(*) FROM T_CHGANT CHGANT, T_SIT SIT, INSERTED INS
		WHERE	CHGANT.CD_CHG = INS.CD_CHG AND SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CAN_VOO = 1) &gt; 0
	BEGIN
		DELETE	T_CHGANT
		FROM	T_CHGANT CHGANT, T_SIT SIT, INSERTED INS
		WHERE	CHGANT.CD_CHG = INS.CD_CHG AND SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CAN_VOO = 1
	END
	--Incluir vôo na tabela de vôos candidatos a vôos Antecessores se a CHG estiver cancelada e for alterada para uma situação diferente de Etapa Concluída  e Cancelado
	IF (	SELECT 	COUNT(*) FROM T_CHG CHG, T_SIT SIT, INSERTED INS, DELETED DEL
		WHERE	CHG.CD_CHG = INS.CD_CHG AND INS.CD_CHG = DEL.CD_CHG AND
			DEL.FL_CHG_CAN = 1 AND SIT.CD_SIT = INS.CD_SIT AND
			SIT.FL_SIT_CON_VOO = 0 AND SIT.FL_SIT_CAN_VOO = 0) &gt; 0
	BEGIN
		INSERT	T_CHGANT (CD_CHG)
		SELECT	CHG.CD_CHG FROM T_CHG CHG, T_SIT SIT, INSERTED INS, DELETED DEL
		WHERE	CHG.CD_CHG = INS.CD_CHG AND INS.CD_CHG = DEL.CD_CHG AND
			DEL.FL_CHG_CAN = 1 AND SIT.CD_SIT = INS.CD_SIT AND
			SIT.FL_SIT_CON_VOO = 0 AND SIT.FL_SIT_CAN_VOO = 0
	END
	--Deletar da tabela T_REP todos os registros que tiverem os campos companhia e número do vôo iguais aos do registro atualizado e o aeroporto destino igual ao aeroporto usuário, caso a situação	do vôo tenha sido alterada para &quot;Etapa Concluída&quot;
	DELETE	T_REP001 FROM INSERTED INS, T_REP001 REP, T_COM COM, T_SIT SIT
	WHERE	SIT.CD_SIT = INS.CD_SIT AND
		SIT.FL_SIT_CON_VOO = 1 AND	--Etapa Concluída
		COM.CD_COM = INS.CD_COM AND
		RTRIM(REP.SG_COM_IAT_003) = RTRIM(COM.SG_COM_IAT_003) AND
		RTRIM(REP.NR_VOO) = RTRIM(INS.NR_CHG_VOO) AND
		REP.SG_AER_ICA_DES = (SELECT SG_AER_ICA FROM T_AER WHERE CD_AER = (SELECT CD_AER FROM T_PSI))
	--Setar flag de vôo não concluído ou concluído
	UPDATE 	T_CHG SET TP_CHG_STA = SIT.FL_SIT_CON_VOO + 1   --2=Concluída
	FROM 	T_CHG CHG, T_SIT SIT, INSERTED INS
	WHERE 	CHG.CD_CHG = INS.CD_CHG AND SIT.CD_SIT = INS.CD_SIT
	--Atualizar Flag de entrada concluída em T_HPA
	UPDATE 	T_HPA001 SET FL_HPA_ENT = SIT.FL_SIT_CON_VOO 
	FROM 	T_HPA001 HPA, T_SIT SIT, INSERTED INS
	WHERE  	HPA.CD_CHG = INS.CD_CHG AND SIT.CD_SIT = INS.CD_SIT 
	--INCLUSÃO DE STATUS DA AERONAVE
	DECLARE INSSTA CURSOR FOR
		SELECT 	INS.CD_CHG, INS.CD_SIT, INS.DH_CHG_EFE, AEN.FL_AEN_ISE, 
			COM.FL_COM_TAR_RED, PSI.QT_PSI_ISE, PSI.QT_PSI_TAR_RED
		FROM	INSERTED INS,  T_AEN AEN, T_COM COM, T_PSI PSI
		WHERE	TP_CHG_CTG NOT IN (3, 4) 	AND AEN.CD_AEN = INS.CD_AEN_CHG AND COM.CD_COM = INS.CD_COM
		ORDER BY CD_CHG
	--Declaração das variáveis
	DECLARE	@CD_CHG INT, @CD_SIT INT, @DH_CHG_EFE SMALLDATETIME, @CD_STA INT,
			@FL_AEN_ISE TINYINT, @FL_COM_TAR_RED TINYINT, 	@QT_PSI_ISE INT, @QT_PSI_TAR_RED INT
	--Abre o curso e posiciona no primeiro registro
	OPEN INSSTA
	FETCH	INSSTA INTO @CD_CHG, @CD_SIT, @DH_CHG_EFE, @FL_AEN_ISE, @FL_COM_TAR_RED, @QT_PSI_ISE, @QT_PSI_TAR_RED
	--Processar todos os registros de INSSTA
	WHILE @@FETCH_STATUS = 0
	BEGIN
		SELECT @CD_STA = (SELECT ISNULL(MAX(CD_STA), 0) +1 FROM T_STA)
		--Inserir o Status caso a situação seja Etapa Concluída e o vôo não esteja Cancelado
		INSERT 	INTO T_STA (
			CD_STA, DH_STA_ABE, MA_STA_ABE, NR_STA,
			DH_STA_FEC, MA_STA_FEC, CD_STA_ANT,
			TP_STA, 	FL_STA_AEN_ISE, FL_STA_COM_TAR_RED, 
			QT_STA_PSI_ISE, 	QT_STA_PSI_TAR_RED)
		SELECT	@CD_STA,
			@DH_CHG_EFE, 
			DATEADD(DD, 1- DATEPART(DD, Dateadd(HH, -Datepart(HH, @DH_CHG_EFE), Dateadd(mi, -datepart(mi, @DH_CHG_EFE), @DH_CHG_EFE))), Dateadd(HH, -Datepart(HH, @DH_CHG_EFE), Dateadd(mi, -datepart(mi, @DH_CHG_EFE), @DH_CHG_EFE))), --Primeiro dia do mês da Data da CHG
			(SELECT ISNULL(MAX(NR_STA), 0) + 1 FROM T_STA STA WHERE STA.MA_STA_ABE = DATEADD(DD, 1- DATEPART(DD, Dateadd(HH, -Datepart(HH, @DH_CHG_EFE), Dateadd(mi, -datepart(mi, @DH_CHG_EFE), @DH_CHG_EFE))), Dateadd(HH, -Datepart(HH, @DH_CHG_EFE), Dateadd(mi, -datepart(mi, @DH_CHG_EFE), @DH_CHG_EFE)))),
			NULL, NULL, NULL, 1, --Em Aberto
			@FL_AEN_ISE, @FL_COM_TAR_RED, @QT_PSI_ISE, @QT_PSI_TAR_RED
		FROM	T_CHG CHG, T_SIT SIT
		WHERE	SIT.CD_SIT = CHG.CD_SIT AND CHG.CD_CHG = @CD_CHG AND

			CHG.FL_CHG_CAN = 0 AND 		--CHG não Cancelada
			SIT.FL_SIT_CON_VOO = 1		--Situação Etapa Concluída
		IF @@ROWCOUNT &lt;&gt; 0 
		BEGIN
			--Atualizar CD_STA em T_HPA caso a situação seja Etapa Concluída e o vôo não esteja Cancelado
			UPDATE 	HPA SET CD_STA = @CD_STA
			FROM	T_CHG CHG, T_SIT SIT, T_HPA001 HPA
			WHERE	HPA.CD_CHG = CHG.CD_CHG AND
				SIT.CD_SIT = CHG.CD_SIT AND CHG.CD_CHG = @CD_CHG AND
				CHG.FL_CHG_CAN = 0 AND 		--CHG não Cancelada
				SIT.FL_SIT_CON_VOO = 1		--Situação Etapa Concluída
		END
		--Próximo registro
		FETCH NEXT FROM INSSTA
		INTO	@CD_CHG, @CD_SIT, @DH_CHG_EFE, @FL_AEN_ISE, @FL_COM_TAR_RED, @QT_PSI_ISE, @QT_PSI_TAR_RED
	END
	CLOSE INSSTA
	DEALLOCATE INSSTA
	--Cancelar o Status caso a CHG esteja concluída e a situação seja alterada para outra qualquer
	IF (	SELECT COUNT(*) 	FROM T_STA STA, INSERTED INS, DELETED DEL, T_SIT SITDEL, T_SIT SITINS, T_HPA001 HPA
		WHERE 	STA.CD_STA = HPA.CD_STA AND HPA.CD_CHG = INS.CD_CHG AND
			DEL.CD_CHG = INS.CD_CHG AND SITDEL.CD_SIT = DEL.CD_SIT AND
			SITDEL.FL_SIT_CON_VOO = 1 AND SITINS.CD_SIT = INS.CD_SIT AND
			SITINS.FL_SIT_CON_VOO = 0) &gt; 0
	BEGIN
		UPDATE 	STA
		SET 	TP_STA = 3,  --Cancelado
			DH_STA_FEC = NULL, MA_STA_FEC = NULL,
			CD_STA_ANT = NULL, FL_STA_AEN_ISE = NULL,
			FL_STA_COM_TAR_RED = NULL, QT_STA_PSI_ISE = NULL,
			QT_STA_PSI_TAR_RED = NULL
		FROM 	T_STA STA, INSERTED INS, DELETED DEL, T_SIT SITDEL, T_SIT SITINS, T_HPA001 HPA
		WHERE 	STA.CD_STA = HPA.CD_STA AND HPA.CD_CHG = INS.CD_CHG AND
			DEL.CD_CHG = INS.CD_CHG AND SITDEL.CD_SIT = DEL.CD_SIT AND
			SITDEL.FL_SIT_CON_VOO = 1 AND SITINS.CD_SIT = INS.CD_SIT AND
			SITINS.FL_SIT_CON_VOO = 0
	END
	--Alterar CD_STA de HPA para NULL caso a CHG esteja concluída e a situação seja alterada para outra qualquer
	IF (	SELECT COUNT(*) 	FROM T_HPA001 HPA, INSERTED INS, DELETED DEL, T_SIT SITDEL, T_SIT SITINS
		WHERE 	HPA.CD_CHG = INS.CD_CHG AND DEL.CD_CHG = INS.CD_CHG AND
			SITDEL.CD_SIT = DEL.CD_SIT AND SITDEL.FL_SIT_CON_VOO = 1 AND
			SITINS.CD_SIT = INS.CD_SIT AND SITINS.FL_SIT_CON_VOO = 0) &gt; 0
	BEGIN
		UPDATE 	HPA SET CD_STA = NULL
		FROM 	T_HPA001 HPA, INSERTED INS, DELETED DEL, T_SIT SITDEL, T_SIT SITINS
		WHERE 	HPA.CD_CHG = INS.CD_CHG AND DEL.CD_CHG = INS.CD_CHG AND
			SITDEL.CD_SIT = DEL.CD_SIT AND SITDEL.FL_SIT_CON_VOO = 1 AND
			SITINS.CD_SIT = INS.CD_SIT AND SITINS.FL_SIT_CON_VOO = 0
	END
END
IF UPDATE(NR_CHG_VOO)
BEGIN
	--Atualizar o prefixo da aeronave dos vôos do grupo 2 caso o número do vôo tenha sido alterado
	UPDATE	CHG
	SET	CD_AEN_CHG = (	SELECT 	CD_AEN 
					FROM 	T_AEN AEN WHERE RTRIM(AEN.NR_AEN) = RTRIM(INS.NR_CHG_VOO))
	FROM	T_CHG CHG, INSERTED INS
	WHERE	CHG.CD_CHG = INS.CD_CHG AND INS.TP_CHG_GRU = 2
	--Atualizar o número do vôo de PAR associado caso este voo seja do Grupo 2
	IF (	SELECT COUNT(*) 	FROM T_PAR PAR, INSERTED INS
		WHERE	PAR.CD_CHG_AEN_ANT = INS.CD_CHG AND
			INS.TP_CHG_GRU = 2 AND PAR.TP_PAR_GRU = 2) &gt; 0
	BEGIN
		UPDATE	PAR SET NR_PAR_VOO = INS.NR_CHG_VOO
		FROM	T_PAR PAR, INSERTED INS
		WHERE	PAR.CD_CHG_AEN_ANT = INS.CD_CHG AND
			INS.TP_CHG_GRU = 2 AND PAR.TP_PAR_GRU = 2
	END
	--Atualizar em HPA o prefixo da aeronave dos vôos do grupo 2 caso o número do vôo tenha sido alterado
	IF (	SELECT 	COUNT(*) FROM T_HPA001 HPA, INSERTED INS
		WHERE	HPA.CD_CHG = INS.CD_CHG AND INS.TP_CHG_GRU = 2) &gt; 0
	BEGIN
		UPDATE	T_HPA001
		SET	CD_AEN = (	SELECT 	CD_AEN 
					FROM 	T_AEN AEN WHERE RTRIM(AEN.NR_AEN) = RTRIM(INS.NR_CHG_VOO))
		FROM	T_HPA001 HPA, INSERTED INS
		WHERE	HPA.CD_CHG = INS.CD_CHG AND INS.TP_CHG_GRU = 2 
	END
END
IF UPDATE(TP_CHG_CTG)
BEGIN
	--Apagar os hpa dos vôos de CHG que passaram a ser CSH ou DPL
	DELETE	T_HPA001 FROM T_HPA001 HPA, INSERTED INS
	WHERE	HPA.CD_CHG = INS.CD_CHG AND INS.TP_CHG_CTG IN (3,4)
	--Anular o tipo de equipamento, o box e a aeronave dos vôos que passaram a ser CSH ou DPL
	UPDATE	T_CHG
	SET	CD_EQP_CHG = NULL, CD_AEN_CHG = NULL, CD_BOX = NULL
	FROM	T_CHG CHG, INSERTED INS
	WHERE	CHG.CD_CHG = INS.CD_CHG AND INS.TP_CHG_CTG IN (3,4)
	--Incluir vôo na tabela de vôos candidatos a vôos Antecessores se TP_CHG_CTG mudar de 3 ou 4 para uma categoria que seja diferente de 3 ou 4
	INSERT	T_CHGANT(CD_CHG)
	SELECT	INS.CD_CHG FROM INSERTED INS, DELETED DEL
	WHERE	INS.CD_CHG = DEL.CD_CHG AND DEL.TP_CHG_CTG IN (3,4) AND INS.TP_CHG_CTG NOT IN (3,4)
	--Excluir vôo da tabela de vôos candidatos a vôos Antecessores se TP_CHG_CTG mudar para 3 ou 4
	DELETE	T_CHGANT FROM T_CHGANT CHGANT, INSERTED INS
	WHERE	CHGANT.CD_CHG = INS.CD_CHG AND INS.TP_CHG_CTG IN (3,4)
END
IF UPDATE(DH_CHG_EFE)
BEGIN
	--Atualizar a hora do vôo de PAR caso a diferença entre a hora da PAR e a hora da CHG seja menor que o tempo mínimo de permanência do vôo.
	IF (	SELECT COUNT(*) 	FROM T_PAR PAR, INSERTED INS
		WHERE	PAR.CD_CHG_AEN_ANT = INS.CD_CHG AND 
			(DATEDIFF(MI, INS.DH_CHG_EFE, PAR.DH_PAR_EFE) &lt; INS.QT_CHG_PER_MIN OR PAR.DH_PAR_EFE &gt; PAR.DH_PAR_NRM)) &gt;0
	BEGIN
		UPDATE 	T_PAR
		SET 	DH_PAR_SIT = GETDATE(),
			DH_PAR_EFE  =  DATEADD( MI, INS.QT_CHG_PER_MIN, INS.DH_CHG_EFE),
			DH_PAR_EST  =  DATEADD( MI, INS.QT_CHG_PER_MIN, INS.DH_CHG_EFE)
		FROM 	T_PAR PAR, INSERTED INS
		WHERE	PAR.CD_CHG_AEN_ANT = INS.CD_CHG AND (DATEDIFF(MI, INS.DH_CHG_EFE, PAR.DH_PAR_EFE) &lt; INS.QT_CHG_PER_MIN OR PAR.DH_PAR_EFE &gt; PAR.DH_PAR_NRM)
	END
	--Atualizar a hora prevista e de estacionamento dos vôos que ficaram com estas horas menores que a hora normal
	IF (	SELECT	COUNT(*) FROM T_PAR PAR, INSERTED INS
		WHERE	PAR.CD_CHG_AEN_ANT = INS.CD_CHG AND PAR.DH_PAR_EFE &lt; PAR.DH_PAR_NRM) &gt; 0
	BEGIN
		UPDATE 	T_PAR
		SET	DH_PAR_EFE = PAR.DH_PAR_NRM, DH_PAR_EST = PAR.DH_PAR_NRM
		FROM 	T_PAR PAR, INSERTED INS
		WHERE	PAR.CD_CHG_AEN_ANT = INS.CD_CHG AND PAR.DH_PAR_EFE &lt; PAR.DH_PAR_NRM
	END
	--Atualizar os campos DH_STA_ABE e MA_STA_ABE do Status de Aeronave associado ao primeiro HPA do vôo alterado, se houver alteração na Data/Hora Efetiva do Vôo de CHG, e o Status associado ao primeiro HPA desse vôo, estiver aberto
	UPDATE	STA
	SET	DH_STA_ABE = INS.DH_CHG_EFE,
		MA_STA_ABE = DATEADD(DD, 1- DATEPART(DD, Dateadd(HH, -Datepart(HH, INS.DH_CHG_EFE), Dateadd(mi, -datepart(mi, INS.DH_CHG_EFE), INS.DH_CHG_EFE))), Dateadd(HH, -Datepart(HH, INS.DH_CHG_EFE), Dateadd(mi, -datepart(mi, INS.DH_CHG_EFE), INS.DH_CHG_EFE))) --Primeiro dia do mês da Data da CHG
	FROM	T_STA STA, T_CHG CHG, INSERTED INS, T_HPA001 HPA
	WHERE	CHG.CD_CHG = INS.CD_CHG AND HPA.CD_CHG = INS.CD_CHG AND
		HPA.NR_HPA_SEQ = 1 AND 	STA.CD_STA = HPA.CD_STA AND STA.TP_STA = 1
END
--Se o vôo possuir CHG e atualizarmos a aeronave de CHG do vôo, temos que atualizá-la também em HPA
IF UPDATE(CD_AEN_CHG)
BEGIN
	IF (	SELECT 	COUNT(*) FROM INSERTED INS, T_CHG CHG
		WHERE	CHG.CD_CHG = INS.CD_CHG AND CHG.FL_CHG_CAN = 1 AND INS.CD_AEN_CHG IS NOT NULL) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: Não é permitido definir aeronave para vôos cancelados.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
	--Não permitir que o prefixo da aeronave seja nulo para vôos do grupo 2
	IF (	SELECT 	COUNT(*) FROM INSERTED INS
		WHERE	INS.TP_CHG_GRU = 2 AND INS.CD_AEN_CHG IS NULL) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: O &lt;Prefixo da Aeronave&gt; para vôos da Aviação Geral não deve ser nulo, e sim igual ao &lt;Número do Vôo&gt;.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
	--Atualizar o número do vôo de CHG para vôos do grupo 2 caso o prefixo da aeronave tenha sido alterado
	UPDATE	CHG
	SET	NR_CHG_VOO = (SELECT NR_AEN FROM T_AEN AEN WHERE AEN.CD_AEN = INS.CD_AEN_CHG)
	FROM	T_CHG CHG, INSERTED INS
	WHERE	CHG.CD_CHG = INS.CD_CHG AND INS.TP_CHG_GRU = 2

	--Atualizar o número do vôo de PAR para vôos do grupo 2 caso o prefixo da aeronave tenha sido alterado
	IF (	SELECT	COUNT(*) FROM T_PAR PAR, INSERTED INS
		WHERE	PAR.CD_CHG_AEN_ANT = INS.CD_CHG AND
			INS.TP_CHG_GRU = 2 AND PAR.TP_PAR_GRU = 2) &gt;0
	BEGIN
		UPDATE	PAR
		SET	NR_PAR_VOO = (SELECT NR_AEN FROM T_AEN AEN WHERE AEN.CD_AEN = INS.CD_AEN_CHG)
		FROM	T_PAR PAR, INSERTED INS
		WHERE	PAR.CD_CHG_AEN_ANT = INS.CD_CHG AND
			INS.TP_CHG_GRU = 2 AND 	PAR.TP_PAR_GRU = 2
	END
	--Atualizar aeronave em HPA
	UPDATE 	T_HPA001 SET CD_AEN = INS.CD_AEN_CHG
	FROM 	T_HPA001 HPA, T_CHG CHG, INSERTED INS
	WHERE  	HPA.CD_CHG = INS.CD_CHG AND CHG.CD_CHG = INS.CD_CHG
END
--Se atualizarmos a aeronave de CHG do vôo para outra que não seja Null e a situação do vôo for etapa concluída, temos que atualizar as informações referentes à aeronave em STA
IF UPDATE(CD_AEN_CHG) 
BEGIN
	UPDATE 	T_STA SET FL_STA_AEN_ISE = AEN.FL_AEN_ISE
	FROM 	T_STA STA, T_CHG CHG, T_HPA001 HPA, T_AEN AEN, T_SIT SIT, INSERTED INS
	WHERE  STA.CD_STA = HPA.CD_STA AND HPA.CD_CHG = INS.CD_CHG AND
		CHG.CD_CHG = INS.CD_CHG AND AEN.CD_AEN = INS.CD_AEN_CHG AND
		INS.CD_AEN_CHG is not Null AND SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CON_VOO = 1
END
--Se atualizarmos a companhia aérea do vôo de CHG e a situação do vôo for etapa concluída, temos que atualizar as informações referentes à companhia aérea em STA
IF UPDATE(CD_COM) 
BEGIN
	UPDATE 	T_STA SET FL_STA_COM_TAR_RED = COM.FL_COM_TAR_RED
	FROM 	T_STA STA, T_CHG CHG, T_HPA001 HPA, T_COM COM, T_SIT SIT, INSERTED INS
	WHERE  STA.CD_STA = HPA.CD_STA AND HPA.CD_CHG = INS.CD_CHG AND
		CHG.CD_CHG = INS.CD_CHG AND COM.CD_COM = INS.CD_COM AND
		SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CON_VOO = 1 
END
IF UPDATE(DH_CHG_EST)
BEGIN
	--Não permitir alteração na Data ou Hora de Estacionamento de um Vôo de CHG, se o Status de Aeronave associado ao primeiro HPA desse vôo, estiver Fechado
	IF (	SELECT	COUNT(*)
		FROM 	T_CHG CHG, INSERTED INS, T_HPA001 HPA, T_STA STA
		WHERE	CHG.CD_CHG = INS.CD_CHG AND HPA.CD_CHG = INS.CD_CHG AND
			HPA.NR_HPA_SEQ = 1 AND STA.CD_STA = HPA.CD_STA AND STA.TP_STA = 2) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: A &lt;Data ou Hora de Estacionamento&gt; do vôo de Chegada não pode ser alterada, se o Status de Aeronave associado ao primeiro HPA desse vôo, estiver Fechado.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
	--Atualizamos Hora de Entrada em HPA como Hora de Estacionamento de CHG, no registro que possue o Vôo sendo atualizado como Vôo de CHG
	UPDATE 	T_HPA001 SET DH_HPA_ENT = CHG.DH_CHG_EST
	FROM	T_HPA001 HPA, T_CHG CHG, INSERTED INS
	WHERE 	CHG.CD_CHG = INS.CD_CHG AND HPA.CD_CHG = INS.CD_CHG AND HPA.NR_HPA_SEQ = 1
END
--CONSISTÊNCIAS A SEREM FEITAS APÓS AS ATUALIZAÇÕES
--Verificar se há horas de CHG maiores que as horas de PAR
IF   (	SELECT COUNT(*) FROM T_CHG CHG, T_PAR PAR, INSERTED INS
	WHERE 	CHG.CD_CHG = INS.CD_CHG AND PAR.CD_CHG_AEN_ANT = CHG.CD_CHG AND
		( (CHG.DH_CHG_EFE &gt;= PAR.DH_PAR_EFE) OR (CHG.DH_CHG_EST &gt;= PAR.DH_PAR_EST))) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: A hora de chegada não pode ser maior nem igual à hora de partida.&#39;
	ROLLBACK TRANSACTION
	RETURN
END
--Alexei 18/06/01
IF UPDATE(FL_CHG_TEL)
BEGIN
	--Se desmarcar da tela desmarcar do anunciador automático
	Update	T_CHG
	set	FL_CHG_ANU = 0
	FROM	T_CHG CHG
	JOIN	INSERTED INS ON INS.CD_CHG = CHG.CD_CHG
	WHERE	INS.FL_CHG_TEL = 0
END

--Verificar se são satisfeitas as condições para a nova situação de CHG
--Alexei 18/06/01
IF UPDATE(CD_SIT) OR UPDATE(DH_CHG_EFE)
BEGIN
	--Lançar Histórico de Situação de Vôo
	INSERT T_HSC (DH_HSC, CD_CHG, CD_IFT, CD_SIT, DH_HSC_CHG, CD_USR) SELECT GETDATE(), INS.CD_CHG, INS.CD_IFT, INS.CD_SIT, INS.DH_CHG_EFE, INS.CD_USR FROM INSERTED INS

	--Deleta todos os registros da programação não anunciados e que estejam vinculados a este vôo
	DELETE T_PRALOG FROM T_PRALOG JOIN INSERTED INS ON INS.CD_CHG = T_PRALOG.CD_CHG WHERE T_PRALOG.FL_LOG = 0

	--Inserir programação de Log
	--Antes da Hora Prevista
	INSERT INTO T_PRALOG (CD_PRA, CD_CHG, CD_PAR, DH_LOG, FL_LOG)
	SELECT 	CD_PRA, INS.CD_CHG, NULL, DATEADD(MI, -PRA.QT_PRA_TMP, INS.DH_CHG_EFE), 0
	FROM	T_PRA PRA JOIN INSERTED INS ON INS.CD_SIT = PRA.CD_SIT AND INS.FL_CHG_TEL = 1 AND INS.FL_CHG_ANU = 1
	JOIN	T_TPA TPA ON TPA.CD_TPA = PRA.CD_TPA AND TPA.TP_TPA = 1 JOIN T_SIT SIT ON SIT.CD_SIT = INS.CD_SIT AND FL_SIT_CON_VOO = 0
	WHERE	PRA.TP_PRA = 1 AND NOT EXISTS (SELECT * FROM T_PRALOG WHERE CD_PRA = PRA.CD_PRA AND CD_CHG = INS.CD_CHG) 

	 --Após a Alteração da Situação
	INSERT INTO T_PRALOG (CD_PRA, CD_CHG, CD_PAR, DH_LOG, FL_LOG)
	SELECT 	CD_PRA, INS.CD_CHG, NULL, DATEADD(MI, PRA.QT_PRA_TMP, GETDATE()), 0
	FROM	T_PRA PRA JOIN INSERTED INS ON INS.CD_SIT = PRA.CD_SIT AND INS.FL_CHG_TEL = 1 AND INS.FL_CHG_ANU = 1
	JOIN	T_TPA TPA ON TPA.CD_TPA = PRA.CD_TPA AND TPA.TP_TPA = 1 JOIN T_SIT SIT ON SIT.CD_SIT = INS.CD_SIT AND FL_SIT_CON_VOO = 0
	WHERE	PRA.TP_PRA = 2 AND NOT EXISTS (SELECT * FROM T_PRALOG WHERE CD_PRA = PRA.CD_PRA AND CD_CHG = INS.CD_CHG)
END
IF UPDATE(CD_SIT)
BEGIN
	IF (	SELECT	COUNT(*) FROM INSERTED INS, T_PAR AEN, T_SIT SITAEN
		WHERE	AEN.CD_CHG_AEN_ANT = INS.CD_CHG AND 
			SITAEN.CD_SIT = AEN.CD_SIT AND SITAEN.FL_SIT_TOD = 1 AND 
			EXISTS (SELECT * FROM T_SCA SCA WHERE SCA.CD_SIT = AEN.CD_SIT) AND 
			INS.CD_SIT NOT IN (SELECT CD_SIT_ANT FROM T_SCA SCA WHERE SCA.CD_SIT = AEN.CD_SIT)) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: A nova situação do vôo de chegada é incompatível com as situações dos vôos sucessores.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END

	--Antes da Hora Prevista
	INSERT INTO T_PRALOG (CD_PRA, CD_CHG, CD_PAR, DH_LOG, FL_LOG)
	SELECT 	CD_PRA, NULL, NULL, DATEADD(MI, -PRA.QT_PRA_TMP, INS.DH_CHG_EFE), 0
	FROM	T_PRA PRA JOIN INSERTED INS ON INS.CD_SIT = PRA.CD_SIT AND INS.FL_CHG_TEL = 1 AND INS.FL_CHG_ANU = 1
	JOIN	T_TPA TPA ON TPA.CD_TPA = PRA.CD_TPA AND TPA.TP_TPA = 3 JOIN T_SIT SIT ON SIT.CD_SIT = INS.CD_SIT AND FL_SIT_CON_VOO = 0
	WHERE	PRA.TP_PRA = 1 AND NOT EXISTS (SELECT * FROM T_PRALOG WHERE CD_PRA = PRA.CD_PRA AND CD_CHG = INS.CD_CHG) AND TP_PRA_TPA = 1

	--Após a Alteração da Situação
	INSERT INTO T_PRALOG (CD_PRA, CD_CHG, CD_PAR, DH_LOG, FL_LOG)
	SELECT 	CD_PRA, NULL, NULL, DATEADD(MI, PRA.QT_PRA_TMP, GETDATE()), 0
	FROM	T_PRA PRA JOIN INSERTED INS ON INS.CD_SIT = PRA.CD_SIT AND INS.FL_CHG_TEL = 1 AND INS.FL_CHG_ANU = 1
	JOIN	T_TPA TPA ON TPA.CD_TPA = PRA.CD_TPA AND TPA.TP_TPA = 3 JOIN T_SIT SIT ON SIT.CD_SIT = INS.CD_SIT AND FL_SIT_CON_VOO = 0
	WHERE	PRA.TP_PRA = 2 AND NOT EXISTS (SELECT * FROM T_PRALOG WHERE CD_PRA = PRA.CD_PRA AND CD_CHG = INS.CD_CHG) AND TP_PRA_TPA = 1
END
--JOGAR os dados dos vôos do tipo Normal, nos vôos do tipo Codeshare
IF (	SELECT 	COUNT(*)  FROM T_CHG CHG, T_CHG CHGVIN, INSERTED INS
	WHERE	CHG.CD_CHG_VIN = INS.CD_CHG AND CHGVIN.CD_CHG = INS.CD_CHG) &gt;0
BEGIN
	UPDATE	CHG
	SET	CD_EQP_CHG = CHGVIN.CD_EQP_CHG, CD_BOX = CHGVIN.CD_BOX,
		QT_CHG_PER_MIN = CHGVIN.QT_CHG_PER_MIN, DH_CHG_NRM = CHGVIN.DH_CHG_NRM,
		DH_CHG_EFE = CHGVIN.DH_CHG_EFE, DH_CHG_EST = CHGVIN.DH_CHG_EST,
		NM_CHG_COM_SIT = CHGVIN.NM_CHG_COM_SIT, DH_CHG_SIT  = CHGVIN.DH_CHG_SIT,
		FL_CHG_CAN = CHGVIN.FL_CHG_CAN, CD_SIT = CHGVIN.CD_SIT,
		TP_CHG_STA = CHGVIN.TP_CHG_STA, CD_USR = CHGVIN.CD_USR
	FROM	T_CHG CHG, T_CHG CHGVIN, INSERTED INS
	WHERE	CHG.CD_CHG_VIN = INS.CD_CHG AND CHGVIN.CD_CHG = INS.CD_CHG
END
--PUXAR os dados dos vôos do tipo Normal, nos vôos do tipo Codeshare
IF (	SELECT 	COUNT(*) FROM T_CHG CHG, T_CHG CHGVIN, INSERTED INS
	WHERE	CHG.CD_CHG = INS.CD_CHG AND CHGVIN.CD_CHG = INS.CD_CHG_VIN) &gt; 0
BEGIN
	UPDATE	CHG
	SET	CD_EQP_CHG = CHGVIN.CD_EQP_CHG, CD_BOX = CHGVIN.CD_BOX,
		QT_CHG_PER_MIN = CHGVIN.QT_CHG_PER_MIN, DH_CHG_NRM = CHGVIN.DH_CHG_NRM,
		DH_CHG_EFE = CHGVIN.DH_CHG_EFE, DH_CHG_EST = CHGVIN.DH_CHG_EST,
		NM_CHG_COM_SIT = CHGVIN.NM_CHG_COM_SIT, DH_CHG_SIT  = CHGVIN.DH_CHG_SIT,
		FL_CHG_CAN = CHGVIN.FL_CHG_CAN, CD_SIT = CHGVIN.CD_SIT,
		TP_CHG_STA = CHGVIN.TP_CHG_STA, CD_USR = CHGVIN.CD_USR
	FROM	T_CHG CHG, T_CHG CHGVIN, INSERTED INS
	WHERE	CHG.CD_CHG = INS.CD_CHG AND CHGVIN.CD_CHG = INS.CD_CHG_VIN
END
--Lançar registro para Replicação na tabela T_REP001
IF UPDATE(CD_SIT) OR UPDATE(CD_AEN_CHG)
BEGIN
	DECLARE @HR_REP_ZUL INT
	DECLARE @HR_HOR_NRM INT
	DECLARE @HR_HOR_VER INT

	--Verifica Defazagem em relação ao horário Zulu
	SELECT 	@HR_HOR_NRM = HR_HOR_NRM, @HR_HOR_VER = HR_HOR_VER
	FROM 	T_HOR HOR, T_AER AER, T_CID CID, T_PSI PSI
	WHERE 	CID.CD_CID = AER.CD_CID And HOR.CD_HOR = CID.CD_HOR And AER.CD_AER = PSI.CD_AER
   
	--Verifica se o Aeroporto está no Horário de Verão
	IF (SELECT COUNT(*) FROM T_HRV WHERE GETDATE() BETWEEN DT_HRV_INI AND DT_HRV_FIM) &gt; 0
		SELECT @HR_REP_ZUL = @HR_HOR_VER
	ELSE
		SELECT @HR_REP_ZUL = @HR_HOR_NRM
END
IF UPDATE(CD_SIT)
BEGIN
	--Vôos de CHG cujas situações estão sendo atualizadas para &quot;Etapa Concluída&quot; e cuja primeira escala posterior do vôo de PAR associado é um dos aeroportos ativos existentes na tabela T_RED
	DECLARE REP1 CURSOR FOR
	SELECT 	PAR.CD_PAR, SG_COM_IAT_003, NR_VOO = PAR.NR_PAR_VOO, 
		DH_VOO_EFE = INS.DH_CHG_EFE, QT_VOO_DIF = DATEDIFF(MI, INS.DH_CHG_NRM, INS.DH_CHG_EFE)
	FROM 	INSERTED INS, T_CHG CHG, T_SIT SIT, T_PAR PAR, T_COM COM
	WHERE	INS.CD_CHG = CHG.CD_CHG AND SIT.CD_SIT = INS.CD_SIT AND
		SIT.FL_SIT_CON_VOO = 1 AND CHG.FL_CHG_CAN = 0 AND
		PAR.CD_CHG_AEN_ANT = INS.CD_CHG AND
		PAR.CD_PAR IN (	SELECT	CD_PAR FROM T_ECP001 ECP
				WHERE	ECP.CD_PAR = PAR.CD_PAR AND
					ECP.CD_ECP = (SELECT MIN(CD_ECP) FROM T_ECP001 ECP1 WHERE ECP1.CD_PAR = ECP.CD_PAR) AND
					ECP.CD_AER IN (SELECT CD_AER FROM T_AER WHERE SG_AER_ICA IN (SELECT SG_AER_ICA FROM T_RED WHERE FL_RED_ATI = 1))) AND
		COM.CD_COM = PAR.CD_COM
	--Declaração das variáveis
	DECLARE @CD_PAR INT, @SG_COM_IAT_003 CHAR(3), 	@NR_VOO CHAR(10), @DH_VOO_EFE SMALLDATETIME, @QT_VOO_DIF INT
	--Abre cursor e posiciona no primeiro registro
	OPEN REP1
	FETCH REP1 INTO	@CD_PAR, @SG_COM_IAT_003, @NR_VOO, @DH_VOO_EFE, @QT_VOO_DIF
	--Processar todos os registros de REP1
	WHILE @@FETCH_STATUS = 0
	BEGIN
		--Inserir registro na tabela T_REP001
		INSERT INTO T_REP001 (
			SG_AER_ICA_ORI, SG_AER_ICA_DES, SG_COM_IAT_003, NR_VOO, 
			DH_VOO_EFE, QT_VOO_DIF, NM_SIT, NR_AEN,
			FL_CHG_CON, FL_PAR_CON, FL_AEN, DH_REP, DH_REP_ORI, HR_REP_ZUL)
		SELECT 	(SELECT SG_AER_ICA FROM T_AER WHERE CD_AER = (SELECT CD_AER FROM T_PSI)),
			(SELECT SG_AER_ICA FROM T_ECP001 ECP, T_AER AER WHERE ECP.CD_PAR = @CD_PAR AND ECP.CD_ECP = (SELECT MIN(CD_ECP) FROM T_ECP001 WHERE CD_PAR = @CD_PAR) AND ECP.CD_AER = AER.CD_AER),
			@SG_COM_IAT_003, @NR_VOO,
			@DH_VOO_EFE, @QT_VOO_DIF,
			NULL, NULL, 1, 0, 0, GETDATE(), GETDATE(), @HR_REP_ZUL
		--Ir para o próximo registro
		FETCH NEXT FROM REP1
		INTO	@CD_PAR, @SG_COM_IAT_003, @NR_VOO, @DH_VOO_EFE, @QT_VOO_DIF
	END
	CLOSE REP1
	DEALLOCATE REP1
END
IF UPDATE(CD_AEN_CHG)
BEGIN
	--Vôos de CHG cujas prefixos das aeronaves estão sendo atualizadas e cuja primeira escala posterior do vôo de PAR associado é um dos aeroportos ativos existentes na tabela T_RED
	DECLARE REP2 CURSOR FOR
	SELECT 	PAR.CD_PAR, SG_COM_IAT_003, NR_VOO = PAR.NR_PAR_VOO, NR_AEN
	FROM 	INSERTED INS, T_PAR PAR, T_COM COM, T_AEN AEN
	WHERE	PAR.CD_CHG_AEN_ANT = INS.CD_CHG AND
		PAR.CD_PAR IN (	SELECT	CD_PAR 	FROM T_ECP001 ECP
				WHERE	ECP.CD_PAR = PAR.CD_PAR AND
					ECP.CD_ECP = (SELECT MIN(CD_ECP) FROM T_ECP001 ECP1 WHERE ECP1.CD_PAR = ECP.CD_PAR) AND
					ECP.CD_AER IN (SELECT CD_AER FROM T_AER WHERE SG_AER_ICA IN (SELECT SG_AER_ICA FROM T_RED WHERE FL_RED_ATI = 1))) AND
		COM.CD_COM = PAR.CD_COM AND AEN.CD_AEN =* INS.CD_AEN_CHG
	--Declaração das variáveis
	DECLARE @NR_AEN CHAR(10)
	--Abre curso e posiciona no primeiro registro
	OPEN REP2
	FETCH REP2 INTO @CD_PAR, @SG_COM_IAT_003, @NR_VOO, @NR_AEN
	--Processar todos os registros de REP2
	WHILE @@FETCH_STATUS = 0
	BEGIN
		--Inserir registro na tabela T_REP001
		INSERT INTO T_REP001 (
			SG_AER_ICA_ORI, SG_AER_ICA_DES, SG_COM_IAT_003, NR_VOO, 
			DH_VOO_EFE, QT_VOO_DIF, NM_SIT, NR_AEN,
			FL_CHG_CON, FL_PAR_CON, FL_AEN, DH_REP, DH_REP_ORI, HR_REP_ZUL)
		SELECT 	(SELECT SG_AER_ICA FROM T_AER WHERE CD_AER = (SELECT CD_AER FROM T_PSI)),
			(SELECT SG_AER_ICA FROM T_ECP001 ECP, T_AER AER WHERE ECP.CD_PAR = @CD_PAR AND ECP.CD_ECP = (SELECT MIN(CD_ECP) FROM T_ECP001 WHERE CD_PAR = @CD_PAR) AND ECP.CD_AER = AER.CD_AER),
			@SG_COM_IAT_003, @NR_VOO,
			NULL, NULL, NULL, @NR_AEN, 0, 0, 1, GETDATE(), GETDATE(), @HR_REP_ZUL

		--Ir para o próximo registro
		FETCH NEXT FROM REP2 INTO @CD_PAR, @SG_COM_IAT_003, @NR_VOO, @NR_AEN
	END
	CLOSE REP2
	DEALLOCATE REP2
END
--INCLUIR REGISTROS EM T_ACH
INSERT	T_ACH (DH_ACH, CD_CHG)
SELECT GETDATE(), CD_CHG FROM INSERTED

IF 	UPDATE(NR_CHG_VOO) OR UPDATE(TP_CHG_GRU) OR UPDATE(TP_CHG) OR 
	UPDATE(TP_CHG_NAT) OR UPDATE(TP_CHG_CTG) OR UPDATE(CD_COM)
BEGIN
	--Incluir registros em T_AHP
	INSERT	T_AHP (CD_HPA, DH_AHP)
	Select 	DISTINCT CD_HPA, GETDATE()
	From 	T_HPA001 HPA, T_CHG CHG, T_SIT SIT, INSERTED INS
	Where	HPA.CD_CHG = CHG.CD_CHG AND SIT.CD_SIT = CHG.CD_SIT AND
		HPA.CD_AER = (Select CD_AER From T_PSI) AND
		(HPA.FL_HPA_ENT = 1 OR SIT.FL_SIT_AEN_PAT = 1) AND HPA.FL_HPA_SAI = 0 AND
		HPA.CD_AEN IS NOT NULL AND CHG.CD_CHG = INS.CD_CHG
END
IF 	UPDATE(CD_AEN_CHG)
BEGIN
	--Incluir registros em T_APA
	INSERT	T_APA (CD_PAR, DH_APA)
	Select 	DISTINCT CD_PAR, GETDATE()
	From 	T_PAR PAR, INSERTED INS
	Where	PAR.CD_CHG_AEN_ANT = INS.CD_CHG AND
		PAR.TP_PAR_STA = 1 AND
		PAR.CD_AER = (Select CD_AER From T_PSI)

END
End
go</a:Text>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o61"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o84">
<a:ObjectID>6958C5A5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_1</a:Name>
<a:Code>REFERENCE_1</a:Code>
<a:CreationDate>1081601754</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601754</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o34"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o7"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o61"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o85">
<a:ObjectID>6958C5A7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601754</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601754</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o35"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o9"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o86">
<a:CenterTextOffset>(3, 0)</a:CenterTextOffset>
<a:Rect>((-736870,688226), (-718765,712973))</a:Rect>
<a:ListOfPoints>((-736870,688226),(-718765,712973))</a:ListOfPoints>
<a:ArrowStyle>4881</a:ArrowStyle>
<a:LineColor>8388672</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o6"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o87">
<a:Rect>((-722079,709752), (-715839,714298))</a:Rect>
<a:LineColor>8388672</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o88">
<a:ObjectID>6958C54D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_IFT</a:Name>
<a:Code>T_IFT</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o89">
<a:ObjectID>6958C5FB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_IFT</a:Name>
<a:Code>CD_IFT</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o90">
<a:ObjectID>6958C5FC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_COM</a:Name>
<a:Code>CD_COM</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o91">
<a:ObjectID>6958C5FD-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TT_IFT</a:Name>
<a:Code>TT_IFT</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>varchar(255)</a:DataType>
<a:Length>255</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o92">
<a:ObjectID>6958C5FE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o93">
<a:ObjectID>6958C5FF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_IFT</a:Name>
<a:Code>Pk_T_IFT</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_IFT</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o89"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Owner>
<o:User Ref="o30"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o94">
<a:ObjectID>6958C54E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_IFT_TRD</a:Name>
<a:Code>T_IFT_TRD</a:Code>
<a:Text>Create Trigger T_IFT_TRD On T_IFT
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Informante da Situação de Vôo»Chamadas de Anuncio: Informante da Chamada (Restrict) */
If (Select Count(*) From T_CHA dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Chamadas de Anuncio&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Chamadas de Anuncio - Mirror: Informante da Chamada (Restrict) */
If (Select Count(*) From T_CHA_MIR dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Chamadas de Anuncio - Mirror&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Mensagem de Chegada - Mirror: Informante da Mensagem de Chegada (Restrict) */
If (Select Count(*) From T_MCH_MIR dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Mensagem de Chegada - Mirror&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Mensagem de Chegada: Informante da Mensagem de Chegada (Restrict) */
If (Select Count(*) From T_MCH dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Mensagem de Chegada&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Mensagem de Partida - Mirror: Informante da Mensagem de Partida (Restrict) */
If (Select Count(*) From T_MPA_MIR dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Mensagem de Partida - Mirror&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Mensagem de Partida: Informante da Mensagem de Partida (Restrict) */
If (Select Count(*) From T_MPA dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Mensagem de Partida&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Chegadas - Mirror: Informante da Situação de Chegada (Restrict) */
If (Select Count(*) From T_CHG_MIR dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Chegadas - Mirror&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Chegadas: Informante da Situação de Chegada (Restrict) */
If (Select Count(*) From T_CHG dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Chegadas&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Partidas - Mirror: Informante da Situação de Partida (Restrict) */
If (Select Count(*) From T_PAR_MIR dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Partidas - Mirror&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Partidas: Informante da Situação de Partida (Restrict) */
If (Select Count(*) From T_PAR dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Partidas&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Histórico de Situação de Vôo de Chegada - Mirror: Informante do HSC (Restrict) */
If (Select Count(*) From T_HSC_MIR dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Histórico de Situação de Vôo de Chegada - Mirror&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Histórico de Situação de Vôo de Chegada: Informante do HSC (Restrict) */
If (Select Count(*) From T_HSC dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Histórico de Situação de Vôo de Chegada&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Histórico de Situação de Vôo de Partida - Mirror: Informante do HSP (Restrict) */
If (Select Count(*) From T_HSP_MIR dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Histórico de Situação de Vôo de Partida - Mirror&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Histórico de Situação de Vôo de Partida: Informante do HSP (Restrict) */
If (Select Count(*) From T_HSP dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Histórico de Situação de Vôo de Partida&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Log da Programação de Anúncios: C:IFT-PRALOG (Cascade) */
Delete T_PRALOG From T_PRALOG dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT
End
go</a:Text>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o95">
<a:ObjectID>6958C550-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_IFT_TRI</a:Name>
<a:Code>T_IFT_TRI</a:Code>
<a:Text>Create Trigger T_IFT_TRI On T_IFT
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Companhia Aérea»Informante da Situação de Vôo: possui */
If (Select Count(*) From T_COM, Inserted
Where T_COM.CD_COM = Inserted.CD_COM)
 &lt;&gt;(Select Count(CD_COM) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Companhia Aérea&gt; que se deseja incluir na tabela &lt;Informante da Situação de Vôo&gt; não está cadastrada&#39;
  Return
End
/* Pessoas»Informante da Situação de Vôo: Pessoa do Informante */
If (Select Count(*) From T_PES, Inserted
Where T_PES.CD_PES = Inserted.CD_IFT)
 &lt;&gt;(Select Count(CD_IFT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Pessoas&gt; que se deseja incluir na tabela &lt;Informante da Situação de Vôo&gt; não está cadastrada&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o96">
<a:ObjectID>6958C552-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_IFT_TRU</a:Name>
<a:Code>T_IFT_TRU</a:Code>
<a:Text>Create Trigger T_IFT_TRU On T_IFT
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_IFT)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Informante da Situação de Vôo&gt; da tabela &lt;Informante da Situação de Vôo&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_COM)
/* Companhia Aérea»Informante da Situação de Vôo: possui */
If (Select Count(*) From T_COM, Inserted
Where T_COM.CD_COM = Inserted.CD_COM)
 &lt;&gt;(Select Count(CD_COM) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Companhia Aérea&gt; que se deseja incluir na tabela &lt;Informante da Situação de Vôo&gt; não está cadastrada&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o93"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o97">
<a:ObjectID>6958C5AA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_3</a:Name>
<a:Code>REFERENCE_3</a:Code>
<a:CreationDate>1081601754</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601754</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o88"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o7"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o93"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o98">
<a:ObjectID>6958C5AB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601754</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601754</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o89"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o16"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o99">
<a:CenterTextOffset>(3, 0)</a:CenterTextOffset>
<a:Rect>((-718370,687554), (-702973,712974))</a:Rect>
<a:ListOfPoints>((-702973,687554),(-718370,712974))</a:ListOfPoints>
<a:ArrowStyle>4881</a:ArrowStyle>
<a:LineColor>8388672</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Id="o100">
<a:Rect>((-706624,684598), (-699844,688198))</a:Rect>
<a:LineColor>8388672</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o101">
<a:ObjectID>6958C55F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_MPA</a:Name>
<a:Code>T_MPA</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o102">
<a:ObjectID>6958C519-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_MPA</a:Name>
<a:Code>CD_MPA</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o103">
<a:ObjectID>6958C51A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_PAR</a:Name>
<a:Code>CD_PAR</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o104">
<a:ObjectID>6958C51B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_USR</a:Name>
<a:Code>CD_USR</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o105">
<a:ObjectID>6958C51C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DH_MPA</a:Name>
<a:Code>DH_MPA</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>smalldatetime</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o106">
<a:ObjectID>6958C51D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DH_MPA_EFE</a:Name>
<a:Code>DH_MPA_EFE</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>smalldatetime</a:DataType>
</o:Column>
<o:Column Id="o107">
<a:ObjectID>6958C51E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_SIT</a:Name>
<a:Code>CD_SIT</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o108">
<a:ObjectID>6958C51F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_MPA_COM_SIT</a:Name>
<a:Code>NM_MPA_COM_SIT</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>varchar(30)</a:DataType>
<a:Length>30</a:Length>
</o:Column>
<o:Column Id="o109">
<a:ObjectID>6958C520-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_TPA</a:Name>
<a:Code>CD_TPA</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o110">
<a:ObjectID>6958C521-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_IFT</a:Name>
<a:Code>CD_IFT</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o111">
<a:ObjectID>6958C522-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_POR</a:Name>
<a:Code>CD_POR</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o112">
<a:ObjectID>6958C523-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DS_MPA_CHK</a:Name>
<a:Code>DS_MPA_CHK</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>varchar(255)</a:DataType>
<a:Length>255</a:Length>
</o:Column>
<o:Column Id="o113">
<a:ObjectID>6958C524-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TT_MPA_OBS</a:Name>
<a:Code>TT_MPA_OBS</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>varchar(255)</a:DataType>
<a:Length>255</a:Length>
</o:Column>
<o:Column Id="o114">
<a:ObjectID>6958C525-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_MPA</a:Name>
<a:Code>TP_MPA</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o115">
<a:ObjectID>6958C526-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_MPA_TEL</a:Name>
<a:Code>FL_MPA_TEL</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>tinyint</a:DataType>
</o:Column>
<o:Column Id="o116">
<a:ObjectID>6958C527-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o117">
<a:ObjectID>6958C52E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_MPA</a:Name>
<a:Code>Pk_T_MPA</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_MPA</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o102"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o118">
<a:ObjectID>6958C528-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_MPA_DH</a:Name>
<a:Code>I_MPA_DH</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o119">
<a:ObjectID>6958C529-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o105"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o120">
<a:ObjectID>6958C52A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_MPA_PAR</a:Name>
<a:Code>I_MPA_PAR</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o121">
<a:ObjectID>6958C52B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o103"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o122">
<a:ObjectID>6958C52C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_MPA_TP</a:Name>
<a:Code>I_MPA_TP</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o123">
<a:ObjectID>6958C52D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o114"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Ref="o30"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o124">
<a:ObjectID>6958C56D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_MPA_TRI</a:Name>
<a:Code>T_MPA_TRI</a:Code>
<a:Text>Create Trigger T_MPA_TRI On T_MPA
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Portão»Mensagem de Partida: Portão da Mensagem de Partida */
If (Select Count(*) From T_POR, Inserted
Where T_POR.CD_POR = Inserted.CD_POR)
 &lt;&gt;(Select Count(CD_POR) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Portão&gt; que se deseja incluir na tabela &lt;Mensagem de Partida&gt; não está cadastrada&#39;
  Return
End
/* Situação»Mensagem de Partida: Situação da Mensagem de Partida */
If (Select Count(*) From T_SIT, Inserted
Where T_SIT.CD_SIT = Inserted.CD_SIT)
 &lt;&gt;(Select Count(CD_SIT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Situação&gt; que se deseja incluir na tabela &lt;Mensagem de Partida&gt; não está cadastrada&#39;
  Return
End
/* Informante da Situação de Vôo»Mensagem de Partida: Informante da Mensagem de Partida */
If (Select Count(*) From T_IFT, Inserted
Where T_IFT.CD_IFT = Inserted.CD_IFT)
 &lt;&gt;(Select Count(CD_IFT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Informante da Situação de Vôo&gt; que se deseja incluir na tabela &lt;Mensagem de Partida&gt; não está cadastrada&#39;
  Return
End
/* Partidas»Mensagem de Partida: Partida da Mensagem */
If (Select Count(*) From T_PAR, Inserted
Where T_PAR.CD_PAR = Inserted.CD_PAR)
 &lt;&gt;(Select Count(CD_PAR) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Partidas&gt; que se deseja incluir na tabela &lt;Mensagem de Partida&gt; não está cadastrada&#39;
  Return
End
/* Usuários»Mensagem de Partida: Usuário da Mensagem de Partida */
If (Select Count(*) From T_USR, Inserted
Where T_USR.CD_USR = Inserted.CD_USR)
 &lt;&gt;(Select Count(CD_USR) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Usuários&gt; que se deseja incluir na tabela &lt;Mensagem de Partida&gt; não está cadastrada&#39;
  Return
End
/* Tipo de Anuncio»Mensagem de Partida: Tipo de Anúncio da Mensagem de Partida */
If (Select Count(*) From T_TPA, Inserted
Where T_TPA.CD_TPA = Inserted.CD_TPA)
 &lt;&gt;(Select Count(CD_TPA) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Tipo de Anuncio&gt; que se deseja incluir na tabela &lt;Mensagem de Partida&gt; não está cadastrada&#39;
  Return
End
/* Domínio de: Status de Mensagem de Partida */
/* 1 - Pendente */
/* 2 - Lida */
/* 3 - Executada */
/* 4 - Cancelada */
If (Select Count(*) From Inserted
    Where TP_MPA In (1,2,3,4))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Status de Mensagem de Partida&gt; que se deseja incluir na tabela &lt;Mensagem de Partida&gt; não é uma opção válida&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o125">
<a:ObjectID>6958C56F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_MPA_TRU</a:Name>
<a:Code>T_MPA_TRU</a:Code>
<a:Text>Create Trigger T_MPA_TRU On T_MPA
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_MPA)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código da Mensagem de Partida&gt; da tabela &lt;Mensagem de Partida&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_POR)
/* Portão»Mensagem de Partida: Portão da Mensagem de Partida */
If (Select Count(*) From T_POR, Inserted
Where T_POR.CD_POR = Inserted.CD_POR)
 &lt;&gt;(Select Count(CD_POR) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Portão&gt; que se deseja incluir na tabela &lt;Mensagem de Partida&gt; não está cadastrada&#39;
  Return
End
If Update (CD_SIT)
/* Situação»Mensagem de Partida: Situação da Mensagem de Partida */
If (Select Count(*) From T_SIT, Inserted
Where T_SIT.CD_SIT = Inserted.CD_SIT)
 &lt;&gt;(Select Count(CD_SIT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Situação&gt; que se deseja incluir na tabela &lt;Mensagem de Partida&gt; não está cadastrada&#39;
  Return
End
If Update (CD_IFT)
/* Informante da Situação de Vôo»Mensagem de Partida: Informante da Mensagem de Partida */
If (Select Count(*) From T_IFT, Inserted
Where T_IFT.CD_IFT = Inserted.CD_IFT)
 &lt;&gt;(Select Count(CD_IFT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Informante da Situação de Vôo&gt; que se deseja incluir na tabela &lt;Mensagem de Partida&gt; não está cadastrada&#39;
  Return
End
If Update (CD_PAR)
/* Partidas»Mensagem de Partida: Partida da Mensagem */
If (Select Count(*) From T_PAR, Inserted
Where T_PAR.CD_PAR = Inserted.CD_PAR)
 &lt;&gt;(Select Count(CD_PAR) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Partidas&gt; que se deseja incluir na tabela &lt;Mensagem de Partida&gt; não está cadastrada&#39;
  Return
End
If Update (CD_USR)
/* Usuários»Mensagem de Partida: Usuário da Mensagem de Partida */
If (Select Count(*) From T_USR, Inserted
Where T_USR.CD_USR = Inserted.CD_USR)
 &lt;&gt;(Select Count(CD_USR) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Usuários&gt; que se deseja incluir na tabela &lt;Mensagem de Partida&gt; não está cadastrada&#39;
  Return
End
If Update (CD_TPA)
/* Tipo de Anuncio»Mensagem de Partida: Tipo de Anúncio da Mensagem de Partida */
If (Select Count(*) From T_TPA, Inserted
Where T_TPA.CD_TPA = Inserted.CD_TPA)
 &lt;&gt;(Select Count(CD_TPA) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Tipo de Anuncio&gt; que se deseja incluir na tabela &lt;Mensagem de Partida&gt; não está cadastrada&#39;
  Return
End
If Update (TP_MPA)
/* Domínio de: Status de Mensagem de Partida */
/* 1 - Pendente */
/* 2 - Lida */
/* 3 - Executada */
/* 4 - Cancelada */
If (Select Count(*) From Inserted
    Where TP_MPA In (1,2,3,4))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Status de Mensagem de Partida&gt; que se deseja incluir na tabela &lt;Mensagem de Partida&gt; não é uma opção válida&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o117"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o87"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o126">
<a:ObjectID>6958C5AC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_4</a:Name>
<a:Code>REFERENCE_4</a:Code>
<a:CreationDate>1081601754</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601754</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o88"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o101"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o93"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o127">
<a:ObjectID>6958C5AD-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601754</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601754</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o89"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o110"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o128">
<a:Rect>((-705233,687700), (-697509,713069))</a:Rect>
<a:ListOfPoints>((-701344,687700),(-701407,713069))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>8388672</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o100"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o129">
<a:Rect>((-706733,709946), (-700107,714492))</a:Rect>
<a:LineColor>8388672</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o130">
<a:ObjectID>6958C565-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_PAR</a:Name>
<a:Code>T_PAR</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081711072</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o131">
<a:ObjectID>6958C52F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_PAR</a:Name>
<a:Code>CD_PAR</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o132">
<a:ObjectID>6958C530-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DT_PAR</a:Name>
<a:Code>DT_PAR</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_DAT    Script Date: 7/8/2000 12:14:35 ******/
Create Rule        RU_DAT As
DATEPART(hh,@data) = 0 AND
DATEPART(mi,@data) = 0 AND
DATEPART(ss,@data) = 0 AND
DATEPART(ms,@data) = 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>smalldatetime</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o133">
<a:ObjectID>6958C531-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_AER</a:Name>
<a:Code>CD_AER</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o134">
<a:ObjectID>6958C532-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_PAR_VOO</a:Name>
<a:Code>NR_PAR_VOO</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(10)</a:DataType>
<a:Length>10</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o135">
<a:ObjectID>6958C533-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_PAR_HOT</a:Name>
<a:Code>NR_PAR_HOT</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(9)</a:DataType>
<a:Length>9</a:Length>
</o:Column>
<o:Column Id="o136">
<a:ObjectID>6958C534-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_PAR_GRU</a:Name>
<a:Code>TP_PAR_GRU</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o137">
<a:ObjectID>6958C535-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_PAR</a:Name>
<a:Code>TP_PAR</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o138">
<a:ObjectID>6958C536-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_PAR_NAT</a:Name>
<a:Code>TP_PAR_NAT</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o139">
<a:ObjectID>6958C537-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_PAR_CTG</a:Name>
<a:Code>TP_PAR_CTG</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o140">
<a:ObjectID>6958C538-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_COM</a:Name>
<a:Code>CD_COM</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o141">
<a:ObjectID>6958C539-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_CHG_ANT</a:Name>
<a:Code>CD_CHG_ANT</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o142">
<a:ObjectID>6958C53A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_CHG_AEN_ANT</a:Name>
<a:Code>CD_CHG_AEN_ANT</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o143">
<a:ObjectID>6958C53B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_PAR_VIN</a:Name>
<a:Code>CD_PAR_VIN</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o144">
<a:ObjectID>6958C53C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_PAR_ANU</a:Name>
<a:Code>FL_PAR_ANU</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o145">
<a:ObjectID>6958C53D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_PAR_TEL</a:Name>
<a:Code>FL_PAR_TEL</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o146">
<a:ObjectID>6958C53E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DH_PAR_NRM</a:Name>
<a:Code>DH_PAR_NRM</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>smalldatetime</a:DataType>
</o:Column>
<o:Column Id="o147">
<a:ObjectID>6958C53F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DH_PAR_EFE</a:Name>
<a:Code>DH_PAR_EFE</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>smalldatetime</a:DataType>
</o:Column>
<o:Column Id="o148">
<a:ObjectID>6958C540-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DH_PAR_EST</a:Name>
<a:Code>DH_PAR_EST</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>smalldatetime</a:DataType>
</o:Column>
<o:Column Id="o149">
<a:ObjectID>6958C541-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_PAR_COM_SIT</a:Name>
<a:Code>NM_PAR_COM_SIT</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>varchar(30)</a:DataType>
<a:Length>30</a:Length>
</o:Column>
<o:Column Id="o150">
<a:ObjectID>6958C542-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DH_PAR_SIT</a:Name>
<a:Code>DH_PAR_SIT</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>smalldatetime</a:DataType>
</o:Column>
<o:Column Id="o151">
<a:ObjectID>6958C543-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_PAR_CAN</a:Name>
<a:Code>FL_PAR_CAN</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_ZRO    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_ZRO As
0</a:DefaultValue>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o152">
<a:ObjectID>6958C544-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_PAR_STA</a:Name>
<a:Code>TP_PAR_STA</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
</o:Column>
<o:Column Id="o153">
<a:ObjectID>6958C545-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o154">
<a:ObjectID>6958C568-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_PAR</a:Name>
<a:Code>Pk_T_PAR</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_PAR</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o131"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o155">
<a:ObjectID>6958C546-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_PAR_EFE</a:Name>
<a:Code>I_PAR_EFE</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o156">
<a:ObjectID>6958C547-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o152"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o157">
<a:ObjectID>6958C548-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_1&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o147"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o158">
<a:ObjectID>6958C549-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_2&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o131"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o159">
<a:ObjectID>6958C54A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_PAR_GRU</a:Name>
<a:Code>I_PAR_GRU</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o160">
<a:ObjectID>6958C54B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o152"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o161">
<a:ObjectID>6958C54C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_1&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o136"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o162">
<a:ObjectID>6958C54F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_2&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o131"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o163">
<a:ObjectID>6958C551-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_PAR_POR</a:Name>
<a:Code>I_PAR_POR</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081711042</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o164">
<a:ObjectID>6958C553-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o152"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o165">
<a:ObjectID>6958C555-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_2&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o131"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o166">
<a:ObjectID>6958C556-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_PAR_STA</a:Name>
<a:Code>I_PAR_STA</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o167">
<a:ObjectID>6958C557-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o152"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o168">
<a:ObjectID>6958C559-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_1&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o131"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o169">
<a:ObjectID>6958C55B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_PAR_STA_DAT</a:Name>
<a:Code>I_PAR_STA_DAT</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o170">
<a:ObjectID>6958C55C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o152"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o171">
<a:ObjectID>6958C55D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_1&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o132"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o172">
<a:ObjectID>6958C55E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_2&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o131"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o173">
<a:ObjectID>6958C560-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_PAR_AEN_ANT</a:Name>
<a:Code>I_PAR_AEN_ANT</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o174">
<a:ObjectID>6958C561-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o142"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o175">
<a:ObjectID>6958C562-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_PAR_DAT_COM</a:Name>
<a:Code>I_PAR_DAT_COM</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o176">
<a:ObjectID>6958C563-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o132"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o177">
<a:ObjectID>6958C564-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_1&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o140"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o178">
<a:ObjectID>6958C566-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_PAR_TP</a:Name>
<a:Code>I_PAR_TP</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o179">
<a:ObjectID>6958C567-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o137"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Ref="o30"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o180">
<a:ObjectID>6958C578-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_PAR_TRD</a:Name>
<a:Code>T_PAR_TRD</a:Code>
<a:Text>Create Trigger T_PAR_TRD On T_PAR
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Partidas»Partidas: Partida Vinculada (Restrict) */
If (Select Count(*) From T_PAR dep, Deleted pri
 Where dep.CD_PAR_VIN = pri.CD_PAR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Partidas&gt; está sendo referenciada na tabela &lt;Partidas&gt;&#39;
  Return
End
/* Partidas»Chamadas de Anuncio: Chamadas da Partida (Cascade) */
Delete T_CHA From T_CHA dep, Deleted pri
 Where dep.CD_PAR = pri.CD_PAR
/* Partidas»Checkin da Partida de Vôo: Checkins de Partida (Cascade) */
Delete T_CKV001 From T_CKV001 dep, Deleted pri
 Where dep.CD_PAR = pri.CD_PAR
/* Partidas»Dados Estatísticos de Partida: Dados Estatísticos de Partida (Cascade) */
Delete T_DEP From T_DEP dep, Deleted pri
 Where dep.CD_PAR = pri.CD_PAR
/* Partidas»Escala da Partida de Vôo: Escalas de Partida (Cascade) */
Delete T_ECP001 From T_ECP001 dep, Deleted pri
 Where dep.CD_PAR = pri.CD_PAR
/* Partidas»Mensagem de Partida: Partida da Mensagem (Cascade) */
Delete T_MPA From T_MPA dep, Deleted pri
 Where dep.CD_PAR = pri.CD_PAR
/* Partidas»Histórico de Situação de Vôo de Partida: Partida do HSP (Cascade) */
Delete T_HSP From T_HSP dep, Deleted pri
 Where dep.CD_PAR = pri.CD_PAR
/* Partidas»Log da Programação de Anúncios: Partidas do Log de Programação (Cascade) */
Delete T_PRALOG From T_PRALOG dep, Deleted pri
 Where dep.CD_PAR = pri.CD_PAR
/* Partidas»Histórico de Permanência de Aeronaves: Histórico de Permanência dos Vôos de Partida (Set Null) */
Update T_HPA001 Set CD_PAR = Null
 From T_HPA001 dep, Deleted pri
 Where dep.CD_PAR = pri.CD_PAR
/* Regra de negócio */
/* Milena 14/01/98 - Se o Vôo de partida for excluído e o vôo de chegada antecessor vinculado a ele não for nulo, 
este deve ser incluído na tabela de vôos de chegada candidatos a antecessor */
INSERT	T_CHGANT(
	CD_CHG)
SELECT	DEL.CD_CHG_AEN_ANT
FROM	DELETED DEL
WHERE	DEL.CD_CHG_AEN_ANT IS NOT NULL

/* INCLUIR REGISTROS EM T_APA */
INSERT	T_APA (DH_APA, CD_PAR)
SELECT GETDATE(), CD_PAR FROM DELETED

End
go</a:Text>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o181">
<a:ObjectID>6958C57B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_PAR_TRI</a:Name>
<a:Code>T_PAR_TRI</a:Code>
<a:Text>Create Trigger T_PAR_TRI On T_PAR
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Aeroporto»Partidas: Aeroporto da Partida */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Partidas&gt; não está cadastrada&#39;
  Return
End
/* Companhia Aérea»Partidas: Companhia Aérea da Partida */
If (Select Count(*) From T_COM, Inserted
Where T_COM.CD_COM = Inserted.CD_COM)
 &lt;&gt;(Select Count(CD_COM) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Companhia Aérea&gt; que se deseja incluir na tabela &lt;Partidas&gt; não está cadastrada&#39;
  Return
End
/* Portão»Partidas: Portão da Partida */
If (Select Count(*) From T_POR, Inserted
Where T_POR.CD_POR = Inserted.CD_POR)
 &lt;&gt;(Select Count(CD_POR) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Portão&gt; que se deseja incluir na tabela &lt;Partidas&gt; não está cadastrada&#39;
  Return
End
/* Situação»Partidas: Situação da Partida */
If (Select Count(*) From T_SIT, Inserted
Where T_SIT.CD_SIT = Inserted.CD_SIT)
 &lt;&gt;(Select Count(CD_SIT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Situação&gt; que se deseja incluir na tabela &lt;Partidas&gt; não está cadastrada&#39;
  Return
End
/* Informante da Situação de Vôo»Partidas: Informante da Situação de Partida */
If (Select Count(*) From T_IFT, Inserted
Where T_IFT.CD_IFT = Inserted.CD_IFT)
 &lt;&gt;(Select Count(CD_IFT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Informante da Situação de Vôo&gt; que se deseja incluir na tabela &lt;Partidas&gt; não está cadastrada&#39;
  Return
End
/* Chegadas»Partidas: Chegada Antecessora */
If (Select Count(*) From T_CHG, Inserted
Where T_CHG.CD_CHG = Inserted.CD_CHG_ANT)
 &lt;&gt;(Select Count(CD_CHG_ANT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Chegadas&gt; que se deseja incluir na tabela &lt;Partidas&gt; não está cadastrada&#39;
  Return
End
/* Chegadas»Partidas: Chegada da Aeronave Sucessora */
If (Select Count(*) From T_CHG, Inserted
Where T_CHG.CD_CHG = Inserted.CD_CHG_AEN_ANT)
 &lt;&gt;(Select Count(CD_CHG_AEN_ANT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Chegadas&gt; que se deseja incluir na tabela &lt;Partidas&gt; não está cadastrada&#39;
  Return
End
/* Partidas»Partidas: Partida Vinculada */
If (Select Count(*) From T_PAR, Inserted
Where T_PAR.CD_PAR = Inserted.CD_PAR_VIN)
 &lt;&gt;(Select Count(CD_PAR_VIN) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Partidas&gt; que se deseja incluir na tabela &lt;Partidas&gt; não está cadastrada&#39;
  Return
End
/* Usuários»Partidas: Usuário logado */
If (Select Count(*) From T_USR, Inserted
Where T_USR.CD_USR = Inserted.CD_USR)
 &lt;&gt;(Select Count(CD_USR) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Usuários&gt; que se deseja incluir na tabela &lt;Partidas&gt; não está cadastrada&#39;
  Return
End
/* Domínio de: Grupo do Vôo */
/* 1 - Grupo 1 */
/* 2 - Grupo 2 */
If (Select Count(*) From Inserted
    Where TP_PAR_GRU In (1,2))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Grupo do Vôo&gt; que se deseja incluir na tabela &lt;Partidas&gt; não é uma opção válida&#39;
  Return
End
/* Domínio de: Tipo do Vôo de Partida */
/* 1 - DOM-Doméstico */
/* 2 - INT-Internacional */
/* 3 - REG-Regional */
If (Select Count(*) From Inserted
    Where TP_PAR In (1,2,3))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Tipo do Vôo de Partida&gt; que se deseja incluir na tabela &lt;Partidas&gt; não é uma opção válida&#39;
  Return
End
/* Domínio de: Natureza do Vôo de Partida */
/* 1 - PAX-Passageiro */
/* 2 - CRG-Carga */
/* 3 - MIS-Misto */
/* 4 - TSL-Translado */
If (Select Count(*) From Inserted
    Where TP_PAR_NAT In (1,2,3,4))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Natureza do Vôo de Partida&gt; que se deseja incluir na tabela &lt;Partidas&gt; não é uma opção válida&#39;
  Return
End
/* Domínio de: Categoria do Vôo de Partida */
/* 1 - RGL-Regular */
/* 2 - CHT-Charter */
/* 3 - CSH-Codeshare */
/* 4 - DPL-Duplicate Leg */
/* 5 - TEC-Pouso Técnico */
/* 6 - TSL-Translado */
/* 7 - AVG-Aviação Geral */
/* 8 - MLT-Militar */
/* 9 - NRG-Não Regular */
/* 10 - TXA-Táxi Aéreo */
If (Select Count(*) From Inserted
    Where TP_PAR_CTG In (1,2,3,4,5,6,7,8,9,10))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Categoria do Vôo de Partida&gt; que se deseja incluir na tabela &lt;Partidas&gt; não é uma opção válida&#39;
  Return
End
/* Domínio de: Tipo do Status de Partida do Vôo */
/* 1 - Em Aberto */
/* 2 - Concluído */
If (Select Count(*) From Inserted
    Where TP_PAR_STA In (1,2))
 &lt;&gt;(Select Count(*) From Inserted
    Where TP_PAR_STA Is Not Null)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Tipo do Status de Partida do Vôo&gt; que se deseja incluir na tabela &lt;Partidas&gt; não é uma opção válida&#39;
  Return
End
/* Regra de negócio */
/* RESTRIÇÕES */
/*********************************** RETIRADO PELO RONALDO EM 11/3/98 ***********************************************************
/* A data do vôo sendo incluído não pode ser maior do que a data posterior à da última geração nem anterior a data de hoje */
IF (	SELECT 	COUNT(*) 
	FROM 	INSERTED INS
	WHERE	(DATEDIFF(MI, Dateadd(HH, -Datepart(HH, GETDATE()), Dateadd(mi, -datepart(mi, GETDATE()), GETDATE())), INS.DT_PAR) &lt; 0 OR
		/* (DATEDIFF(MI, CONVERT(DATETIME, (CONVERT(VARCHAR, DATEPART(MM, GETDATE())) + &#39;/&#39; + CONVERT(VARCHAR, DATEPART(DD, GETDATE()))  + &#39;/&#39; + CONVERT(VARCHAR, DATEPART(YY, GETDATE())) +  &#39; 00:00&#39;)), INS.DT_PAR) &lt; 0 OR */
		DATEADD(DD, -1, INS.DT_PAR) &gt; (SELECT MAX(DT_PAR) FROM T_PAR WHERE CD_PAR &lt;&gt; INS.CD_PAR) ) AND INS.NR_PAR_HOT IS NOT NULL) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: Não é permitida a geração de vôos de datas anteriores à data de hoje ou posteriores à data da última geração mais um dia.&#39;
	ROLLBACK TRANSACTION
	RETURN
END
**********************************************************************************************************************************************/
/* Um vôo não pode ser incluído CANCELADO */
IF (	SELECT 	COUNT(*)
	FROM	INSERTED INS, 
		T_SIT SIT
	WHERE	SIT.CD_SIT = INS.CD_SIT AND
		FL_SIT_CAN_VOO &lt;&gt; 0) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: Não é permitida a inclusão de vôos com situação de partida cancelada&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* PROVOCAR A EXECUÇÃO DA TRIGGER DE UPDATE PARA A COMPLEMENTAÇÃO DAS VERIFICAÇÕES
    E PROCESSAR OUTRAS ATUALIZAÇÕES */
UPDATE	T_PAR
SET	CD_SIT = PAR.CD_SIT,
	DH_PAR_SIT = PAR.DH_PAR_NRM,
	CD_CHG_AEN_ANT = PAR.CD_CHG_AEN_ANT
FROM	T_PAR PAR,
	INSERTED INS

WHERE	PAR.CD_PAR = INS.CD_PAR
End
go</a:Text>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o182">
<a:ObjectID>6958C57D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_PAR_TRU</a:Name>
<a:Code>T_PAR_TRU</a:Code>
<a:Text>CREATE Trigger T_PAR_TRU On T_PAR
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_PAR)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Vôo de Partida&gt; da tabela &lt;Partidas&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_AER)
/* Aeroporto»Partidas: Aeroporto da Partida */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Partidas&gt; não está cadastrada&#39;
  Return
End
If Update (CD_COM)
/* Companhia Aérea»Partidas: Companhia Aérea da Partida */
If (Select Count(*) From T_COM, Inserted
Where T_COM.CD_COM = Inserted.CD_COM)
 &lt;&gt;(Select Count(CD_COM) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Companhia Aérea&gt; que se deseja incluir na tabela &lt;Partidas&gt; não está cadastrada&#39;
  Return
End
If Update (CD_POR)
/* Portão»Partidas: Portão da Partida */
If (Select Count(*) From T_POR, Inserted
Where T_POR.CD_POR = Inserted.CD_POR)
 &lt;&gt;(Select Count(CD_POR) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Portão&gt; que se deseja incluir na tabela &lt;Partidas&gt; não está cadastrada&#39;
  Return
End
If Update (CD_SIT)
/* Situação»Partidas: Situação da Partida */
If (Select Count(*) From T_SIT, Inserted
Where T_SIT.CD_SIT = Inserted.CD_SIT)
 &lt;&gt;(Select Count(CD_SIT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Situação&gt; que se deseja incluir na tabela &lt;Partidas&gt; não está cadastrada&#39;
  Return
End
If Update (CD_IFT)
/* Informante da Situação de Vôo»Partidas: Informante da Situação de Partida */
If (Select Count(*) From T_IFT, Inserted
Where T_IFT.CD_IFT = Inserted.CD_IFT)
 &lt;&gt;(Select Count(CD_IFT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Informante da Situação de Vôo&gt; que se deseja incluir na tabela &lt;Partidas&gt; não está cadastrada&#39;
  Return
End
If Update (CD_CHG_ANT)
/* Chegadas»Partidas: Chegada Antecessora */
If (Select Count(*) From T_CHG, Inserted
Where T_CHG.CD_CHG = Inserted.CD_CHG_ANT)
 &lt;&gt;(Select Count(CD_CHG_ANT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Chegadas&gt; que se deseja incluir na tabela &lt;Partidas&gt; não está cadastrada&#39;
  Return
End
If Update (CD_CHG_AEN_ANT)
/* Chegadas»Partidas: Chegada da Aeronave Sucessora */
If (Select Count(*) From T_CHG, Inserted
Where T_CHG.CD_CHG = Inserted.CD_CHG_AEN_ANT)
 &lt;&gt;(Select Count(CD_CHG_AEN_ANT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Chegadas&gt; que se deseja incluir na tabela &lt;Partidas&gt; não está cadastrada&#39;
  Return
End
If Update (CD_PAR_VIN)
/* Partidas»Partidas: Partida Vinculada */
If (Select Count(*) From T_PAR, Inserted
Where T_PAR.CD_PAR = Inserted.CD_PAR_VIN)
 &lt;&gt;(Select Count(CD_PAR_VIN) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Partidas&gt; que se deseja incluir na tabela &lt;Partidas&gt; não está cadastrada&#39;
  Return
End
If Update (CD_USR)
/* Usuários»Partidas: Usuário logado */
If (Select Count(*) From T_USR, Inserted
Where T_USR.CD_USR = Inserted.CD_USR)
 &lt;&gt;(Select Count(CD_USR) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Usuários&gt; que se deseja incluir na tabela &lt;Partidas&gt; não está cadastrada&#39;
  Return
End
If Update (TP_PAR_GRU)
Or Update (TP_PAR)
Or Update (TP_PAR_NAT)
Or Update (TP_PAR_CTG)
Or Update (TP_PAR_STA)
/* Domínio de: Grupo do Vôo */
/* 1 - Grupo 1 */
/* 2 - Grupo 2 */
If (Select Count(*) From Inserted
    Where TP_PAR_GRU In (1,2))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Grupo do Vôo&gt; que se deseja incluir na tabela &lt;Partidas&gt; não é uma opção válida&#39;
  Return
End
/* Domínio de: Tipo do Vôo de Partida */
/* 1 - DOM-Doméstico */
/* 2 - INT-Internacional */
/* 3 - REG-Regional */
If (Select Count(*) From Inserted
    Where TP_PAR In (1,2,3))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Tipo do Vôo de Partida&gt; que se deseja incluir na tabela &lt;Partidas&gt; não é uma opção válida&#39;
  Return
End
/* Domínio de: Natureza do Vôo de Partida */
/* 1 - PAX-Passageiro */
/* 2 - CRG-Carga */
/* 3 - MIS-Misto */
/* 4 - TSL-Translado */
If (Select Count(*) From Inserted
    Where TP_PAR_NAT In (1,2,3,4))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Natureza do Vôo de Partida&gt; que se deseja incluir na tabela &lt;Partidas&gt; não é uma opção válida&#39;
  Return
End
/* Domínio de: Categoria do Vôo de Partida */
/* 1 - RGL-Regular */
/* 2 - CHT-Charter */
/* 3 - CSH-Codeshare */
/* 4 - DPL-Duplicate Leg */
/* 5 - TEC-Pouso Técnico */
/* 6 - TSL-Translado */
/* 7 - AVG-Aviação Geral */
/* 8 - MLT-Militar */
/* 9 - NRG-Não Regular */
/* 10 - TXA-Táxi Aéreo */
If (Select Count(*) From Inserted
    Where TP_PAR_CTG In (1,2,3,4,5,6,7,8,9,10))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Categoria do Vôo de Partida&gt; que se deseja incluir na tabela &lt;Partidas&gt; não é uma opção válida&#39;
  Return
End
/* Domínio de: Tipo do Status de Partida do Vôo */
/* 1 - Em Aberto */
/* 2 - Concluído */
If (Select Count(*) From Inserted
    Where TP_PAR_STA In (1,2))
 &lt;&gt;(Select Count(*) From Inserted
    Where TP_PAR_STA Is Not Null)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Tipo do Status de Partida do Vôo&gt; que se deseja incluir na tabela &lt;Partidas&gt; não é uma opção válida&#39;
  Return
End
/* Regra de negócio */
/* CODESHARE OU DUPLICATE LEG */
IF UPDATE(TP_PAR_CTG) OR UPDATE(CD_PAR_VIN)
	/* Um vôo do tipo normal ou charter não pode ter vôo vinculado e um vôo do tipo codeshare ou duplicate leg tem de ter vôo vinculado */
	IF (	SELECT 	COUNT(*) FROM	INSERTED
		WHERE	(TP_PAR_CTG NOT IN (3,4) AND CD_PAR_VIN IS NOT NULL) OR (TP_PAR_CTG IN (3,4) AND CD_PAR_VIN IS NULL)) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: Um vôo do tipo Normal ou Charter não pode ter vôo vinculado, e um vôo do tipo Codeshare ou Duplicate Leg tem de ter vôo vinculado.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
/* ETAPA CONCLUÍDA */
/* Verificar se a partida foi concluída (sem estar cancelada) sem que o vôo da aeronave antecessora tenha sido informado */
IF UPDATE(CD_SIT)
	IF (	SELECT	COUNT(*) FROM	INSERTED INS, T_SIT SIT
		WHERE	SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CON_VOO = 1 AND INS.FL_PAR_CAN = 0 AND INS.CD_CHG_AEN_ANT IS NULL) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: O vôo de partida não pode ser concluído sem que seja informado o vôo da aeronave antecessora.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
/* VÔO ANTECESSOR */
/* Verificar se o vôo antecessor está se relacionando a outro vôo de Partida */
IF UPDATE(CD_CHG_ANT)
	IF(	SELECT 	COUNT(*) FROM 	T_PAR PAR, INSERTED INS
		WHERE	PAR.CD_CHG_ANT = INS.CD_CHG_ANT AND PAR.CD_PAR &lt;&gt; INS.CD_PAR) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: O Vôo antecessor já está sendo referenciado por outro vôo.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
/* VÔO DA AERONAVE ANTECESSORA */
IF UPDATE(CD_CHG_AEN_ANT)
BEGIN
	/* Verificar se o vôo da aeronave antecessor está se relacionando a outro vôo de Partida */
	IF(	SELECT 	COUNT(*) FROM 	T_PAR PAR, INSERTED INS
		WHERE	PAR.CD_CHG_AEN_ANT = INS.CD_CHG_AEN_ANT AND PAR.CD_PAR &lt;&gt; INS.CD_PAR) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: O vôo do qual se pretende utilizar a aeronave já está sendo referenciado em outro vôo.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END

	/* Verificar se a partida foi concluída (sem estar cancelada) sem que o vôo da aeronave antecessora 
	tenha sido informado */
	IF (	SELECT	COUNT(*) FROM	INSERTED INS, T_SIT SIT
		WHERE	SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CON_VOO = 1 AND INS.FL_PAR_CAN = 0 AND INS.CD_CHG_AEN_ANT IS NULL) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: O vôo de partida não pode ser concluído sem que seja informado o vôo da aeronave antecessora.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END

	/* Para um vôo ter (par) ou ser (chg) vôo antecessor não pode ser da categoria 3 e 4 (codeshare ou duplicate leg) */
	IF (	SELECT COUNT(*) FROM 	INSERTED INS, T_CHG CHG
		WHERE	CHG.CD_CHG = INS.CD_CHG_AEN_ANT AND (CHG.TP_CHG_CTG IN (3, 4) OR INS.TP_PAR_CTG IN (3, 4))) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: Para um vôo ter ou ser vôo antecessor não pode ser codeshare nem duplicate leg.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END

END

/* Se atualizarmos a hora de estacionamento de partida */
IF UPDATE(DH_PAR_EST)
BEGIN
	/* Não permitir alteração na Data ou Hora de Estacionamento de um Vôo de Partida, 
	se o Status de Aeronave associado ao último  HPA desse vôo,  estiver  Fechado e a 
	situação do vôo tanto em PAR quanto em INS for Etapa Concluída */
	IF (	SELECT	COUNT(*)
		FROM 	T_PAR PAR, INSERTED INS, T_HPA001 HPA, T_STA STA, T_SIT SITINS, T_SIT SITPAR
		WHERE	PAR.CD_PAR = INS.CD_PAR AND
			HPA.CD_PAR = INS.CD_PAR AND
			HPA.NR_HPA_SEQ = (	SELECT 	MAX(NR_HPA_SEQ) 
						FROM 	T_HPA001 HPAMAX 
						WHERE 	HPAMAX.CD_HPA = HPA.CD_HPA) AND
			STA.CD_STA = HPA.CD_STA AND
			STA.TP_STA = 2 AND
			SITPAR.CD_SIT = PAR.CD_SIT AND
			SITPAR.FL_SIT_CON_VOO = 1 AND
			SITINS.CD_SIT = INS.CD_SIT AND
			SITINS.FL_SIT_CON_VOO = 1) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: A &lt;Data ou Hora de Estacionamento&gt; do vôo de Partida não pode ser alterada, se o Status de Aeronave associado ao último HPA desse vôo, estiver Fechado.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
END

/* SITUAÇÃO */
/* Verificar as novas situações são válidas */
IF UPDATE(CD_SIT)
BEGIN
	IF (	SELECT	COUNT(*) FROM	INSERTED INS, T_SIT SIT
		WHERE	SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_PAR &lt;&gt; 1) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: A situação informada não é uma situação de partida.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END

	/* Verificar se a nova situação de partida é compatível com a situação de partida do vôo da aeronave antecessora */
	IF (	SELECT	COUNT(*) FROM	INSERTED INS, T_CHG CHGAENANT, T_SIT SIT
		WHERE	CHGAENANT.CD_CHG = INS.CD_CHG_AEN_ANT AND 
			SIT.CD_SIT = INS.CD_SIT AND EXISTS (SELECT * FROM T_SCA SCA WHERE SCA.CD_SIT = INS.CD_SIT) AND
			CHGAENANT.CD_SIT NOT IN (SELECT CD_SIT_ANT FROM T_SCA SCA WHERE SCA.CD_SIT = INS.CD_SIT)) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: A situação do vôo antecessor não permite a nova situação do vôo de partida.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
END

/* Atualizar o complemento de partida */
IF UPDATE(CD_SIT) OR UPDATE(DH_PAR_EFE)
BEGIN
	UPDATE	T_PAR
	SET	NM_PAR_COM_SIT = CONVERT(CHAR(5), PAR.DH_PAR_EFE, 8)
	FROM	T_PAR PAR, INSERTED INS, T_SIT SIT
	WHERE	PAR.CD_PAR = INS.CD_PAR AND SIT.CD_SIT = PAR.CD_SIT AND SIT.TP_SIT_COM = 1	/* hora */

	UPDATE	T_PAR
	SET	NM_PAR_COM_SIT = NULL
	FROM	T_PAR PAR, INSERTED INS, T_SIT SIT
	WHERE	PAR.CD_PAR = INS.CD_PAR AND SIT.CD_SIT = PAR.CD_SIT AND SIT.TP_SIT_COM = 3	/* Nenhum */

	/* Se a Data e Hora da Situação não já tiver sido alterada */
	IF NOT UPDATE(DH_PAR_SIT)
	BEGIN
		/* Atualizar hora da alteração da situação do vôo de partida */
		UPDATE	T_PAR
		SET	DH_PAR_SIT = GETDATE()
		FROM	T_PAR PAR, INSERTED INS
		WHERE	PAR.CD_PAR = INS.CD_PAR
	END

END

/* Se alterarmos a situação de partida de vôo */
IF UPDATE(CD_SIT)
BEGIN

	/* Um vôo de partida não pode ser cancelado se existir algum registro em T_DEP para este vôo ou para um dos seus vôos vinculados */
	IF (	SELECT	COUNT(*)
		FROM	INSERTED INS, T_SIT SIT
		WHERE	SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CAN_VOO = 1 AND
			(EXISTS (SELECT CD_PAR FROM T_DEP WHERE CD_PAR = INS.CD_PAR) OR
			EXISTS (SELECT DEP.CD_PAR FROM T_DEP DEP, T_PAR PAR WHERE PAR.CD_PAR_VIN = INS.CD_PAR AND DEP.CD_PAR = PAR.CD_PAR))) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: O vôo de Partida não pode ser cancelado pois existe registro de &lt;Dados Estatísticos de Partida&gt; para este vôo ou para algum de seus vôos vinculados.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END

	/* Atualizar Flag de partida Cancelada em vôo */
	UPDATE 	T_PAR
	SET 	FL_PAR_CAN = SIT.FL_SIT_CAN_VOO
	FROM 	T_PAR PAR, INSERTED INS,  T_SIT SIT
	WHERE 	PAR.CD_PAR = INS.CD_PAR AND SIT.CD_SIT =  INS.CD_SIT AND (SIT.FL_SIT_CAN_VOO = 1 OR SIT.FL_SIT_CON_VOO = 0)

	/* Setar CD_VOO_ANT e CD_VOO_AEN_ANT para nulo caso a Partida seja cancelado */
	IF (	SELECT	COUNT(*)
		FROM 	T_PAR PAR, INSERTED INS, T_SIT SIT
		WHERE 	PAR.CD_PAR = INS.CD_PAR AND SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CAN_VOO = 1) &gt; 0
	BEGIN
		UPDATE 	T_PAR
		SET 	CD_CHG_ANT = NULL,
			CD_CHG_AEN_ANT = NULL
		FROM 	T_PAR PAR, INSERTED INS, T_SIT SIT
		WHERE 	PAR.CD_PAR = INS.CD_PAR AND SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CAN_VOO = 1
	END

	/* Incluir na tabela de vôos candidatos a vôos Antecessores, o vôo antecessor 
	associado a um vôo de partida caso este vôo de partida seja cancelado */
	IF (	SELECT 	COUNT(*)
		FROM	INSERTED INS, DELETED DEL, T_SIT SIT
		WHERE	INS.CD_PAR = DEL.CD_PAR AND SIT.CD_SIT = INS.CD_SIT AND 
			SIT.FL_SIT_CAN_VOO = 1 AND DEL.CD_CHG_AEN_ANT IS NOT NULL) &gt; 0
	BEGIN
		INSERT	T_CHGANT(
			CD_CHG)
		SELECT	DEL.CD_CHG_AEN_ANT
		FROM	INSERTED INS, DELETED DEL, T_SIT SIT
		WHERE	INS.CD_PAR = DEL.CD_PAR AND SIT.CD_SIT = INS.CD_SIT AND 
			SIT.FL_SIT_CAN_VOO = 1 AND DEL.CD_CHG_AEN_ANT IS NOT NULL
	END

	/* Setar flag de vôo não concluído ou concluído */
	UPDATE 	T_PAR
	SET 	TP_PAR_STA = SIT.FL_SIT_CON_VOO + 1   /* 2=Concluída */
	FROM 	T_PAR PAR, T_SIT SIT, INSERTED INS
	WHERE 	PAR.CD_PAR = INS.CD_PAR AND SIT.CD_SIT = INS.CD_SIT
	 
	/* Atualizar Flag de saída concluída em T_HPA para etapas concluídas e não canceladas */
	UPDATE 	T_HPA001
	SET 	FL_HPA_SAI = SIT.FL_SIT_CON_VOO
	FROM 	T_HPA001 HPA, INSERTED INS, T_SIT SIT
	WHERE  	HPA.CD_PAR = INS.CD_PAR AND SIT.CD_SIT = INS.CD_SIT

	/* Tornar nulo o vôo de partida de HPA e FL_HPA_SAI = 0 em todos os registros relativos ao vôo cancelado */
	IF (	SELECT 	COUNT(*)
		FROM	T_HPA001 HPA, INSERTED INS, T_SIT SIT
		WHERE	HPA.CD_PAR = INS.CD_PAR AND SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CAN_VOO = 1) &gt; 0
	BEGIN
		UPDATE	T_HPA001
		SET	CD_PAR = NULL,
			FL_HPA_SAI = 0
		FROM	T_HPA001 HPA, INSERTED INS, T_SIT SIT
		WHERE	HPA.CD_PAR = INS.CD_PAR AND SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CAN_VOO = 1
	END
END

IF UPDATE(TP_PAR_CTG)
BEGIN
	/* Anular os vôos de partida dos hpa dos vôos de partida que passaram a ser codeshare ou duplicate leg */
	UPDATE	T_HPA001
	SET	CD_PAR = NULL
	FROM	T_HPA001 HPA, INSERTED INS
	WHERE	HPA.CD_PAR = INS.CD_PAR AND INS.TP_PAR_CTG IN (3,4)

	/* Anular vôo antecessor e vôo da aeronave antecessora dos vôos de partida que passaram a ser codeshare ou duplicate leg */
	UPDATE	T_PAR
	SET	CD_CHG_ANT = NULL,
		CD_CHG_AEN_ANT = NULL
	FROM	T_PAR PAR, INSERTED INS
	WHERE	PAR.CD_PAR = INS.CD_PAR AND INS.TP_PAR_CTG IN (3,4)

	/* Incluir na tabela de vôos candidatos a vôos Antecessores, o vôo antecessor associado 
	a um vôo de partida caso este vôo de partida passe a ser Codeshare ou Duplicate Leg */
	INSERT	T_CHGANT(
		CD_CHG)
	SELECT	DEL.CD_CHG_AEN_ANT
	FROM	INSERTED INS, DELETED DEL
	WHERE	INS.CD_PAR = DEL.CD_PAR AND INS.TP_PAR_CTG IN (3,4) AND DEL.CD_CHG_AEN_ANT IS NOT NULL
END

/* Se houve alteração no voo ANTECESSOR de um vôo de partida */
IF UPDATE(CD_CHG_ANT)
BEGIN
	/* O Vôo antecessor não pode estar cancelado */
	IF (	SELECT 	COUNT(*) 
		FROM 	INSERTED INS,
			T_PAR PAR,
			T_CHG CHG
		WHERE	PAR.CD_PAR = INS.CD_PAR AND CHG.CD_CHG = PAR.CD_CHG_ANT AND CHG.FL_CHG_CAN = 1) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: O vôo de partida não pode estar ligado a um vôo antecessor cancelado.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END

END
/* Se houve alteração no Vôo DA AERONAVE antecessora de um vôo de partida */
IF UPDATE(CD_CHG_AEN_ANT)
BEGIN
	/* Tornar nulo o Vôo de partida  dos  registros de HPA que tinham este vôo como vôo de partida */
	UPDATE	T_HPA001
	SET 	CD_PAR = NULL
	FROM	T_HPA001 HPA, INSERTED INS
	WHERE	HPA.CD_PAR = INS.CD_PAR

	/* Atualizar os registros de HPA relativos ao novo vôo antecessor, fazendo o vôo de partida igual a este vôo */
	/* Atualizar Flag de saída concluída em T_HPA para etapas concluídas e não  canceladas */
	UPDATE	T_HPA001
	SET	CD_PAR = INS.CD_PAR,
		FL_HPA_SAI = SIT.FL_SIT_CON_VOO
	FROM	T_HPA001 HPA, INSERTED INS, T_SIT SIT
	WHERE	HPA.CD_CHG = INS.CD_CHG_AEN_ANT AND SIT.CD_SIT = INS.CD_SIT 

	/* O Vôo da aeronave antecessora não pode estar cancelado */
	IF (	SELECT 	COUNT(*) 
		FROM 	INSERTED INS,
			T_PAR PAR,
			T_CHG CHG
		WHERE	PAR.CD_PAR = INS.CD_PAR AND 
			CHG.CD_CHG = PAR.CD_CHG_AEN_ANT AND
			CHG.FL_CHG_CAN = 1) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: O vôo de chegada cuja aeronave será utilizada na partida não pode estar cancelado.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END

	/* O Vôo de Partida ao qual está se querendo vincular um vôo antecessor não pode estar cancelado */
	IF (	SELECT 	COUNT(*)
		FROM 	INSERTED INS,
			T_PAR PAR
		WHERE	PAR.CD_PAR = INS.CD_PAR AND
			PAR.FL_PAR_CAN = 1 AND
			PAR.CD_CHG_AEN_ANT IS NOT NULL) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: O vôo de partida ao qual se está querendo vincular um vôo antecessor não pode estar cancelado.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END

	/* Incluir vôo na tabela de vôos candidatos a vôos Antecessores se 
	este vôo ainda existir na tabela de Chegada e não existir ainda na tabela de vôos candidatos a vôos Antecessores */
	INSERT	T_CHGANT(
		CD_CHG)
	SELECT	DEL.CD_CHG_AEN_ANT
	FROM	DELETED DEL
	WHERE	DEL.CD_CHG_AEN_ANT IS NOT NULL AND
		DEL.CD_CHG_AEN_ANT IN (		SELECT 	CD_CHG 
						FROM 	T_CHG CHG 
						WHERE 	CHG.CD_CHG = DEL.CD_CHG_AEN_ANT) AND
		DEL.CD_CHG_AEN_ANT NOT IN (	SELECT 	CD_CHG 
						FROM 	T_CHGANT CHGANT
						WHERE 	CHGANT.CD_CHG = DEL.CD_CHG_AEN_ANT)

	/* Excluir vôo da tabela de vôos candidatos a vôos Antecessores se o Vôo Antecessor tiver sido alterado */
	DELETE 	CHGANT
	FROM	T_CHGANT CHGANT, INSERTED INS
	WHERE	CHGANT.CD_CHG = INS.CD_CHG_AEN_ANT

END

/* Se atualizarmos a hora de estacionamento de partida */
IF UPDATE(DH_PAR_EST)
BEGIN
	/* Atualizamos Hora de Saída em HPA como Hora de Estacionamento de partida */
	UPDATE 	T_HPA001
	SET 	DH_HPA_SAI = PAR.DH_PAR_EST
	FROM	T_HPA001 HPA,
		T_PAR PAR,
		INSERTED INS
	WHERE 	PAR.CD_PAR = INS.CD_PAR AND
		HPA.CD_PAR = INS.CD_PAR AND
		HPA.NR_HPA_SEQ = (	SELECT 	MAX(NR_HPA_SEQ) 
					FROM 	T_HPA001 HPAMAX 
					WHERE 	HPAMAX.CD_HPA = HPA.CD_HPA)
END

/* CONSISTÊNCIAS QUE SÓ DEVEM SER FEITAS APÓS AS ATUALIZAÇÕES */

IF UPDATE(CD_SIT) OR UPDATE(CD_CHG_ANT)
BEGIN
	/* Um vôo de partida não pode ser concluído se o seu vôo de chegada estiver em aberto */
	IF (	SELECT	COUNT(*)
		FROM	T_PAR PAR,
			T_CHG CHG,
			INSERTED INS
		WHERE	PAR.CD_PAR = INS.CD_PAR AND
			CHG.CD_CHG = PAR.CD_CHG_ANT AND
			PAR.TP_PAR_STA = 2 AND 
			CHG.TP_CHG_STA = 1) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: O vôo de partida não pode ser concluído se o seu vôo de chegada ainda estiver em aberto.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
END

IF UPDATE(CD_SIT) OR UPDATE(CD_CHG_AEN_ANT) OR UPDATE(TP_PAR_CTG)
BEGIN
	/* Um vôo de partida não pode ser concluído se o vôo de chegada que utiliza a mesma aeronave estiver em aberto */
	IF (	SELECT	COUNT(*)
		FROM	T_PAR PAR,
			T_CHG CHG,
			INSERTED INS
		WHERE	PAR.CD_PAR = INS.CD_PAR AND
			CHG.CD_CHG = PAR.CD_CHG_AEN_ANT AND
			PAR.TP_PAR_STA = 2 AND 
			CHG.TP_CHG_STA = 1) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: O vôo de partida não pode ser concluído se o vôo de chegada que utiliza a mesma aeronave ainda estiver em aberto.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END

END

IF UPDATE(DH_PAR_NRM) OR 
    UPDATE(DH_PAR_EFE) OR 
    UPDATE(DH_PAR_EST) OR
    UPDATE(CD_CHG_ANT) OR
    UPDATE(CD_CHG_AEN_ANT)
BEGIN
	/* Verificar se há horas de chegada maiores que as horas de partida */
	IF (	SELECT COUNT(*)
		FROM 	T_PAR PAR,
			T_CHG CHG,
			INSERTED INS
		WHERE 	PAR.CD_PAR = INS.CD_PAR AND
			CHG.CD_CHG = PAR.CD_CHG_AEN_ANT AND
			((CHG.DH_CHG_EFE &gt;= PAR.DH_PAR_EFE) OR 
			(CHG.DH_CHG_EST &gt;= PAR.DH_PAR_EST))) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: A hora de partida não pode ser menor nem igual à hora de chegada.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
END

/* JOGAR os dados dos vôos do tipo Normal, nos vôos do tipo Codeshare */
IF (	SELECT 	COUNT(*)
	FROM	T_PAR PAR,
		T_PAR PARVIN,
		INSERTED INS
	WHERE	PAR.CD_PAR_VIN = INS.CD_PAR AND
		PARVIN.CD_PAR = INS.CD_PAR) &gt; 0
BEGIN
	UPDATE	PAR
	SET	CD_POR = PARVIN.CD_POR,
		DH_PAR_NRM = PARVIN.DH_PAR_NRM,
		DH_PAR_EFE = PARVIN.DH_PAR_EFE,
		DH_PAR_EST = PARVIN.DH_PAR_EST,
		DH_PAR_SIT  = PARVIN.DH_PAR_SIT,
		NM_PAR_COM_SIT = PARVIN.NM_PAR_COM_SIT,
		FL_PAR_CAN = PARVIN.FL_PAR_CAN,
		CD_SIT = PARVIN.CD_SIT,
		TP_PAR_STA = PARVIN.TP_PAR_STA,
		CD_USR = PARVIN.CD_USR
	FROM	T_PAR PAR,
		T_PAR PARVIN,
		INSERTED INS
	WHERE	PAR.CD_PAR_VIN = INS.CD_PAR AND
		PARVIN.CD_PAR = INS.CD_PAR
END

/* PUXAR os dados dos vôos do tipo Normal, nos vôos do tipo Codeshare */
IF (	SELECT 	COUNT(*)
	FROM	T_PAR PAR,
		T_PAR PARVIN,
		INSERTED INS
	WHERE	PAR.CD_PAR = INS.CD_PAR AND
		PARVIN.CD_PAR = INS.CD_PAR_VIN) &gt; 0
BEGIN
	UPDATE	PAR
	SET	CD_POR = PARVIN.CD_POR,
		DH_PAR_NRM = PARVIN.DH_PAR_NRM,
		DH_PAR_EFE = PARVIN.DH_PAR_EFE,
		DH_PAR_EST = PARVIN.DH_PAR_EST,
		DH_PAR_SIT  = PARVIN.DH_PAR_SIT,
		NM_PAR_COM_SIT = PARVIN.NM_PAR_COM_SIT,
		FL_PAR_CAN = PARVIN.FL_PAR_CAN,
		CD_SIT = PARVIN.CD_SIT,
		TP_PAR_STA = PARVIN.TP_PAR_STA,
		CD_USR = PARVIN.CD_USR
	FROM	T_PAR PAR,
		T_PAR PARVIN,
		INSERTED INS
	WHERE	PAR.CD_PAR = INS.CD_PAR AND
		PARVIN.CD_PAR = INS.CD_PAR_VIN
END


IF UPDATE(FL_PAR_TEL)
BEGIN
	--Se desmarcar da tela desmarcar do anunciador automático
	Update	T_PAR
	set	FL_PAR_ANU = 0
	FROM	T_PAR PAR
	JOIN	INSERTED INS ON INS.CD_PAR = PAR.CD_PAR
	WHERE	INS.FL_PAR_TEL = 0
END

IF UPDATE(CD_POR)
BEGIN
	--Deleta todos os registros da programação cujo flag &quot;Reanunciar na alteração de Portão&quot; seja VERDADEIRO ou cujo flag &quot;Somente quando for alteração de Portão&quot; seja VERDADEIRO e que estejam vinculados a este vôo
	DELETE T_PRALOG FROM T_PRALOG LOG JOIN INSERTED INS ON INS.CD_PAR = LOG.CD_PAR
	JOIN T_PRA PRA ON PRA.CD_PRA = LOG.CD_PRA AND (PRA.FL_PRA = 1 OR PRA.FL_PRA_POR = 1)

	--Incluir somente aqueles registros da &quot;Programação de Anúncio&quot;, cujo &quot;Código da Programação&quot; não já exista no Log de Programação deste vôo, e que esteja vinculado à nova situação do vôo, e cujo Tipo de Anúncio seja de Partida e cujo vôo apareça na tela e cujo flag &quot;Somente quando for alteração de Portão&quot; seja VERDADEIRO ou o falg &quot;Reanunciar na alteração de Portão&quot;seja VERDADEIRO
	--Antes da Hora Prevista
	INSERT INTO T_PRALOG (CD_PRA, CD_CHG, CD_PAR, DH_LOG, FL_LOG)
	SELECT 	CD_PRA, NULL, INS.CD_PAR, DATEADD(MI, -PRA.QT_PRA_TMP, INS.DH_PAR_EFE), 0
	FROM	T_PRA PRA JOIN INSERTED INS ON INS.CD_SIT = PRA.CD_SIT AND INS.FL_PAR_TEL = 1 AND INS.FL_PAR_ANU = 1
	JOIN	T_TPA TPA ON TPA.CD_TPA = PRA.CD_TPA AND TPA.TP_TPA = 2 JOIN T_SIT SIT ON SIT.CD_SIT = INS.CD_SIT AND FL_SIT_CON_VOO = 0
	WHERE	PRA.TP_PRA = 1 AND NOT EXISTS (SELECT * FROM T_PRALOG WHERE CD_PRA = PRA.CD_PRA AND CD_PAR = INS.CD_PAR) AND (PRA.FL_PRA = 1 OR PRA.FL_PRA_POR = 1)

	 --Após a Alteração da Situação
	INSERT INTO T_PRALOG (CD_PRA, CD_CHG, CD_PAR, DH_LOG, FL_LOG)
	SELECT 	CD_PRA, NULL, INS.CD_PAR, DATEADD(MI, PRA.QT_PRA_TMP, GETDATE()), 0
	FROM	T_PRA PRA JOIN INSERTED INS ON INS.CD_SIT = PRA.CD_SIT AND INS.FL_PAR_TEL = 1 AND INS.FL_PAR_ANU = 1
	JOIN	T_TPA TPA ON TPA.CD_TPA = PRA.CD_TPA AND TPA.TP_TPA = 2 JOIN T_SIT SIT ON SIT.CD_SIT = INS.CD_SIT AND FL_SIT_CON_VOO = 0
	WHERE	PRA.TP_PRA = 2 AND NOT EXISTS (SELECT * FROM T_PRALOG WHERE CD_PRA = PRA.CD_PRA AND CD_PAR = INS.CD_PAR) AND (PRA.FL_PRA = 1 OR PRA.FL_PRA_POR = 1)
END
--Alexei 18/06/01
IF UPDATE(CD_SIT)  OR UPDATE(DH_PAR_EFE) 
BEGIN
	--Lançar Histórico de Situação de Vôo
	INSERT T_HSP (DH_HSP, CD_PAR, CD_IFT, CD_SIT, DH_HSP_PAR, CD_USR) SELECT GETDATE(), INS.CD_PAR, INS.CD_IFT, INS.CD_SIT, INS.DH_PAR_EFE, INS.CD_USR FROM INSERTED INS

	--Deleta todos os registros da programação não anunciados e que estejam vinculados a este vôo
	DELETE T_PRALOG FROM T_PRALOG LOG JOIN INSERTED INS ON INS.CD_PAR = LOG.CD_PAR WHERE LOG.FL_LOG = 0

	--Inserir programação de Log
	--Antes da Hora Prevista
	INSERT INTO T_PRALOG (CD_PRA, CD_CHG, CD_PAR, DH_LOG, FL_LOG)
	SELECT 	CD_PRA, NULL, INS.CD_PAR, DATEADD(MI, -PRA.QT_PRA_TMP, INS.DH_PAR_EFE), 0
	FROM	T_PRA PRA JOIN INSERTED INS ON INS.CD_SIT = PRA.CD_SIT AND INS.FL_PAR_TEL = 1 AND INS.FL_PAR_ANU = 1 
	JOIN	T_TPA TPA ON TPA.CD_TPA = PRA.CD_TPA AND TPA.TP_TPA = 2 JOIN T_SIT SIT ON SIT.CD_SIT = INS.CD_SIT AND FL_SIT_CON_VOO = 0
 	WHERE	PRA.TP_PRA = 1 AND NOT EXISTS (SELECT * FROM T_PRALOG WHERE CD_PRA = PRA.CD_PRA AND CD_PAR = INS.CD_PAR)  AND PRA.FL_PRA_POR = 0

	 --Após a Alteração da Situação
	INSERT INTO T_PRALOG (CD_PRA, CD_CHG, CD_PAR, DH_LOG, FL_LOG)
	SELECT 	CD_PRA, NULL, INS.CD_PAR, DATEADD(MI, PRA.QT_PRA_TMP, GETDATE()), 0
	FROM	T_PRA PRA JOIN INSERTED INS ON INS.CD_SIT = PRA.CD_SIT AND INS.FL_PAR_TEL = 1 AND INS.FL_PAR_ANU = 1
	JOIN	T_TPA TPA ON TPA.CD_TPA = PRA.CD_TPA AND TPA.TP_TPA = 2 JOIN T_SIT SIT ON SIT.CD_SIT = INS.CD_SIT AND FL_SIT_CON_VOO = 0
	WHERE	PRA.TP_PRA = 2 AND NOT EXISTS (SELECT * FROM T_PRALOG WHERE CD_PRA = PRA.CD_PRA AND CD_PAR = INS.CD_PAR)  AND PRA.FL_PRA_POR = 0

	IF UPDATE(CD_SIT)
	BEGIN
		--Antes da Hora Prevista
		INSERT INTO T_PRALOG (CD_PRA, CD_CHG, CD_PAR, DH_LOG, FL_LOG)
		SELECT 	CD_PRA, NULL, NULL, DATEADD(MI, -PRA.QT_PRA_TMP, INS.DH_PAR_EFE), 0
		FROM	T_PRA PRA JOIN INSERTED INS ON INS.CD_SIT = PRA.CD_SIT AND INS.FL_PAR_TEL = 1 AND INS.FL_PAR_ANU = 1
		JOIN	T_TPA TPA ON TPA.CD_TPA = PRA.CD_TPA AND TPA.TP_TPA = 3 JOIN T_SIT SIT ON SIT.CD_SIT = INS.CD_SIT AND FL_SIT_CON_VOO = 0
		WHERE	PRA.TP_PRA = 1 AND NOT EXISTS (SELECT * FROM T_PRALOG WHERE CD_PRA = PRA.CD_PRA AND CD_PAR = INS.CD_PAR) AND PRA.FL_PRA_POR = 0 AND TP_PRA_TPA = 2

		 --Após a Alteração da Situação
		INSERT INTO T_PRALOG (CD_PRA, CD_CHG, CD_PAR, DH_LOG, FL_LOG)
		SELECT 	CD_PRA, NULL, NULL, DATEADD(MI, PRA.QT_PRA_TMP, GETDATE()), 0
		FROM	T_PRA PRA JOIN INSERTED INS ON INS.CD_SIT = PRA.CD_SIT AND INS.FL_PAR_TEL = 1 AND INS.FL_PAR_ANU = 1
		JOIN	T_TPA TPA ON TPA.CD_TPA = PRA.CD_TPA AND TPA.TP_TPA = 3 JOIN T_SIT SIT ON SIT.CD_SIT = INS.CD_SIT AND FL_SIT_CON_VOO = 0
		WHERE	PRA.TP_PRA = 2 AND NOT EXISTS (SELECT * FROM T_PRALOG WHERE CD_PRA = PRA.CD_PRA AND CD_PAR = INS.CD_PAR) AND PRA.FL_PRA_POR = 0 AND TP_PRA_TPA = 2
	END
END

-- Alexei 12/12/00
-- Milena - 30/06/98 */ /* Alexei - 27/07/98 - Inclusão dos campos DH_REP_ORI e HR_REP_ZUL
-- -------------------------------------------------- Lançar registro para Replicação na tabela T_REP001 -----------
IF	UPDATE(CD_SIT) OR UPDATE(DH_PAR_EFE) OR UPDATE(CD_CHG_AEN_ANT)
BEGIN
	DECLARE @HR_REP_ZUL 	INT
	DECLARE @HR_HOR_NRM 	INT
	DECLARE @HR_HOR_VER 	INT
	DECLARE @CD_PAR 	INT
	DECLARE @SG_COM_IAT_003	CHAR(3)
	DECLARE @NR_VOO		CHAR(10)

	-- Verifica Defazagem em relação ao horário Zulu
	SELECT 	@HR_HOR_NRM = HR_HOR_NRM,
		@HR_HOR_VER = HR_HOR_VER
	FROM 	T_HOR HOR, T_AER AER, T_CID CID, T_PSI PSI
	WHERE 	CID.CD_CID = AER.CD_CID And
		HOR.CD_HOR = CID.CD_HOR And
		AER.CD_AER = PSI.CD_AER
   
	-- Verifica se o Aeroporto está no Horário de Verão
	IF (SELECT COUNT(*) FROM T_HRV WHERE GETDATE() BETWEEN DT_HRV_INI AND DT_HRV_FIM) &gt; 0
		SELECT @HR_REP_ZUL = @HR_HOR_VER
	ELSE
		SELECT @HR_REP_ZUL = @HR_HOR_NRM
END
-- Alexei 12/12/00
IF 	UPDATE(CD_CHG_AEN_ANT)
BEGIN
	-- Vôos de PAR cujas aeronaves antecessoras estão sendo atualizadas e cuja primeira escala 
	-- posterior do vôo de PAR é um dos aeroportos ativos existentes na tabela T_RED
	DECLARE REP2 CURSOR FOR
	SELECT 	INS.CD_PAR, SG_COM_IAT_003, NR_VOO = INS.NR_PAR_VOO, NR_AEN
	FROM 	INSERTED INS, T_CHG CHG, T_COM COM, T_AEN AEN
	WHERE	INS.CD_CHG_AEN_ANT = CHG.CD_CHG AND
		INS.CD_PAR IN (	SELECT	CD_PAR 	FROM T_ECP001 ECP
				WHERE	ECP.CD_PAR = INS.CD_PAR AND
					ECP.CD_ECP = (SELECT MIN(CD_ECP) FROM T_ECP001 ECP1 WHERE ECP1.CD_PAR = ECP.CD_PAR) AND
					ECP.CD_AER IN (SELECT CD_AER FROM T_AER WHERE SG_AER_ICA IN (SELECT SG_AER_ICA FROM T_RED WHERE FL_RED_ATI = 1))) AND
		COM.CD_COM = INS.CD_COM AND AEN.CD_AEN =* CHG.CD_AEN_CHG
	/* Declaração das variáveis */
	DECLARE @NR_AEN CHAR(10)
	/* Abre curso e posiciona no primeiro registro */
	OPEN REP2
	FETCH REP2 INTO @CD_PAR, @SG_COM_IAT_003, @NR_VOO, @NR_AEN
	/* Processar todos os registros de REP2 */
	WHILE @@FETCH_STATUS = 0
	BEGIN
		/* Inserir registro na tabela T_REP001 */
		INSERT INTO T_REP001 (
			SG_AER_ICA_ORI, SG_AER_ICA_DES, SG_COM_IAT_003, NR_VOO, 
			DH_VOO_EFE, QT_VOO_DIF, NM_SIT, NR_AEN,
			FL_CHG_CON, FL_PAR_CON, FL_AEN, DH_REP, DH_REP_ORI, HR_REP_ZUL)
		SELECT 	(SELECT SG_AER_ICA FROM T_AER WHERE CD_AER = (SELECT CD_AER FROM T_PSI)),
			(SELECT SG_AER_ICA FROM T_ECP001 ECP, T_AER AER WHERE ECP.CD_PAR = @CD_PAR AND ECP.CD_ECP = (SELECT MIN(CD_ECP) FROM T_ECP001 WHERE CD_PAR = @CD_PAR) AND ECP.CD_AER = AER.CD_AER),
			@SG_COM_IAT_003, @NR_VOO,
			NULL, NULL, NULL, @NR_AEN, 0, 0, 1, GETDATE(), GETDATE(), @HR_REP_ZUL

		/* Ir para o próximo registro */
		FETCH NEXT FROM REP2 INTO @CD_PAR, @SG_COM_IAT_003, @NR_VOO, @NR_AEN
	END
	CLOSE REP2
	DEALLOCATE REP2
	-- Fim Alexei 12/12/00
END
IF 	UPDATE(CD_SIT) OR UPDATE(DH_PAR_EFE)
BEGIN
	-- -------------------------------------------------- Declaração do Cursor --------------------------------------------------
	-- Vôos de Partida cujas situações estão sendo atualizadas para uma situação diferente de &quot;Etapa Concluída&quot; e 
	-- cuja primeira escala posterior do vôo de Partida associado é um dos aeroportos ativos existentes na tabela T_RED
	DECLARE REP3 CURSOR FOR
	SELECT 	INS.CD_PAR, SG_COM_IAT_003, NR_VOO = INS.NR_PAR_VOO, 
		DH_VOO_EFE = INS.DH_PAR_EFE, QT_VOO_DIF = DATEDIFF(MI, INS.DH_PAR_NRM, INS.DH_PAR_EFE),
		NM_SIT = NM_SIT_LOC
	FROM 	INSERTED INS, T_SIT SIT, T_COM COM
	WHERE	SIT.CD_SIT = INS.CD_SIT AND
		SIT.FL_SIT_CON_VOO = 0 AND	-- Não Concluído
		INS.CD_PAR IN (	SELECT	CD_PAR
				FROM 	T_ECP001 ECP
				WHERE	ECP.CD_PAR = INS.CD_PAR AND
					ECP.CD_ECP = (SELECT MIN(CD_ECP) FROM T_ECP001 ECP1 WHERE ECP1.CD_PAR = ECP.CD_PAR) AND
					ECP.CD_AER IN (SELECT CD_AER FROM T_AER WHERE SG_AER_ICA IN (SELECT SG_AER_ICA FROM T_RED WHERE FL_RED_ATI = 1))) AND
		COM.CD_COM = INS.CD_COM

	-- Declaração das variáveis
	DECLARE	@DH_VOO_EFE		SMALLDATETIME,
			@QT_VOO_DIF		INT,
			@NM_SIT		VARCHAR(30)
		 
	-- Abertura do Cursor
	OPEN REP3

	-- Posiciona no primeiro registro
	FETCH	REP3
	INTO	@CD_PAR, @SG_COM_IAT_003, @NR_VOO, @DH_VOO_EFE, @QT_VOO_DIF, @NM_SIT

	-- Processar todos os registros de REP3
	WHILE @@FETCH_STATUS = 0
	BEGIN
		-- Inserir registro na tabela T_REP001
		INSERT INTO T_REP001 (
			SG_AER_ICA_ORI, SG_AER_ICA_DES, SG_COM_IAT_003, NR_VOO, 
			DH_VOO_EFE, QT_VOO_DIF, NM_SIT, 
			NR_AEN,
			FL_CHG_CON, FL_PAR_CON, FL_AEN, DH_REP, DH_REP_ORI, HR_REP_ZUL)
		SELECT 	(SELECT SG_AER_ICA FROM T_AER WHERE CD_AER = (SELECT CD_AER FROM T_PSI)),
			(SELECT SG_AER_ICA FROM T_ECP001 ECP, T_AER AER WHERE ECP.CD_PAR = @CD_PAR AND ECP.CD_ECP = (SELECT MIN(CD_ECP) FROM T_ECP001 WHERE CD_PAR = @CD_PAR) AND ECP.CD_AER = AER.CD_AER),
			@SG_COM_IAT_003, @NR_VOO,
			@DH_VOO_EFE, @QT_VOO_DIF, @NM_SIT,
			NULL,
			0, 0, 0, GETDATE(), GETDATE(), @HR_REP_ZUL

		-- Ir para o próximo registro
		FETCH NEXT FROM REP3
		INTO	@CD_PAR, @SG_COM_IAT_003, @NR_VOO, @DH_VOO_EFE, @QT_VOO_DIF, @NM_SIT
	END
	CLOSE REP3
	DEALLOCATE REP3
END

IF 	UPDATE(CD_SIT)
BEGIN
	-- -------------------------------------------------- Declaração do Cursor -------------------------------------------------- 
	-- Vôos de Partida cujas situações estão sendo atualizadas para &quot;Etapa Concluída&quot; e cuja primeira 
	-- escala posterior do vôo de Partida associado é um dos aeroportos ativos existentes na tabela T_RED
	DECLARE REP4 CURSOR FOR
	SELECT 	PAR.CD_PAR, SG_COM_IAT_003, NR_VOO = PAR.NR_PAR_VOO, 
		DH_VOO_EFE = INS.DH_PAR_EFE, QT_VOO_DIF = DATEDIFF(MI, INS.DH_PAR_NRM, INS.DH_PAR_EFE),
		NM_SIT = NM_SIT_LOC
	FROM 	INSERTED INS, T_PAR PAR, T_SIT SIT, T_COM COM
	WHERE	INS.CD_PAR = PAR.CD_PAR AND
		SIT.CD_SIT = INS.CD_SIT AND
		SIT.FL_SIT_CON_VOO = 1 AND	-- Concluído
		PAR.FL_PAR_CAN = 0 AND		-- Não Cancelado
		PAR.CD_PAR IN (	SELECT	CD_PAR
				FROM 	T_ECP001 ECP
				WHERE	ECP.CD_PAR = PAR.CD_PAR AND
					ECP.CD_ECP = (SELECT MIN(CD_ECP) FROM T_ECP001 ECP1 WHERE ECP1.CD_PAR = ECP.CD_PAR) AND
					ECP.CD_AER IN (SELECT CD_AER FROM T_AER WHERE SG_AER_ICA IN (SELECT SG_AER_ICA FROM T_RED WHERE FL_RED_ATI = 1))) AND
		COM.CD_COM = PAR.CD_COM

	-- Abertura do Cursor
	OPEN REP4

	-- Posiciona no primeiro registro
	FETCH	REP4
	INTO	@CD_PAR, @SG_COM_IAT_003, @NR_VOO, @DH_VOO_EFE, @QT_VOO_DIF, @NM_SIT

	-- Processar todos os registros de REP4
	WHILE @@FETCH_STATUS = 0
	BEGIN
		-- Inserir registro na tabela T_REP001
		INSERT INTO T_REP001 (
			SG_AER_ICA_ORI, SG_AER_ICA_DES, SG_COM_IAT_003, NR_VOO, 
			DH_VOO_EFE, QT_VOO_DIF, NM_SIT, 
			NR_AEN,
			FL_CHG_CON, FL_PAR_CON, FL_AEN, DH_REP, DH_REP_ORI, HR_REP_ZUL)
		SELECT 	(SELECT SG_AER_ICA FROM T_AER WHERE CD_AER = (SELECT CD_AER FROM T_PSI)),
			(SELECT SG_AER_ICA FROM T_ECP001 ECP, T_AER AER WHERE ECP.CD_PAR = @CD_PAR AND ECP.CD_ECP = (SELECT MIN(CD_ECP) FROM T_ECP001 WHERE CD_PAR = @CD_PAR) AND ECP.CD_AER = AER.CD_AER),
			@SG_COM_IAT_003, @NR_VOO,
			@DH_VOO_EFE, @QT_VOO_DIF, @NM_SIT,
			NULL,
			0, 1, 0, GETDATE(), GETDATE(), @HR_REP_ZUL

		-- Ir para o próximo registro
		FETCH NEXT FROM REP4
		INTO	@CD_PAR, @SG_COM_IAT_003, @NR_VOO, @DH_VOO_EFE, @QT_VOO_DIF, @NM_SIT
	END
	CLOSE REP4
	DEALLOCATE REP4
END

/* INCLUIR REGISTROS EM T_APA */
INSERT	T_APA (DH_APA, CD_PAR)
SELECT GETDATE(), CD_PAR FROM INSERTED

/* Incluir registros em T_AHP */
IF 	UPDATE(NR_PAR_VOO) OR UPDATE(TP_PAR_GRU) OR UPDATE (CD_CHG_AEN_ANT) OR 
	UPDATE(CD_POR) OR UPDATE(CD_COM)
BEGIN
	INSERT	T_AHP (CD_HPA, DH_AHP)
	Select 	DISTINCT CD_HPA, GETDATE()
	From 	T_HPA001 HPA, T_CHG CHG, T_SIT SIT, T_PAR PAR, INSERTED INS
	Where	HPA.CD_CHG = CHG.CD_CHG AND
		SIT.CD_SIT = CHG.CD_SIT AND
		HPA.CD_AER = (Select CD_AER From T_PSI) AND
		(HPA.FL_HPA_ENT = 1 OR SIT.FL_SIT_AEN_PAT = 1) AND
		HPA.FL_HPA_SAI = 0 AND
		HPA.CD_AEN IS NOT NULL AND
		PAR.CD_CHG_AEN_ANT = HPA.CD_CHG AND
		PAR.CD_PAR = INS.CD_PAR
END

End
go</a:Text>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o154"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o183">
<a:ObjectID>6958C5AF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_6</a:Name>
<a:Code>REFERENCE_6</a:Code>
<a:CreationDate>1081601754</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601754</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o130"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o101"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o154"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o184">
<a:ObjectID>6958C5B1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601754</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601754</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o131"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o103"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o185">
<a:CenterTextOffset>(2, 0)</a:CenterTextOffset>
<a:Rect>((-705229,664999), (-697355,687400))</a:Rect>
<a:ListOfPoints>((-701344,687400),(-701251,664999))</a:ListOfPoints>
<a:ArrowStyle>4881</a:ArrowStyle>
<a:LineColor>8388672</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o100"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o186">
<a:Rect>((-706529,662053), (-699825,666599))</a:Rect>
<a:LineColor>8388672</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o187">
<a:ObjectID>6958C56C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_POR</a:Name>
<a:Code>T_POR</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o188">
<a:ObjectID>6958C569-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_POR</a:Name>
<a:Code>CD_POR</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o189">
<a:ObjectID>6958C56A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_POR</a:Name>
<a:Code>NR_POR</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(4)</a:DataType>
<a:Length>4</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o190">
<a:ObjectID>6958C56B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_EMB</a:Name>
<a:Code>CD_EMB</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o191">
<a:ObjectID>6958C56E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_AER</a:Name>
<a:Code>CD_AER</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o192">
<a:ObjectID>6958C570-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o193">
<a:ObjectID>6958C577-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_POR</a:Name>
<a:Code>Pk_T_POR</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_POR</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o188"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o194">
<a:ObjectID>6958C571-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_POR_AER</a:Name>
<a:Code>I_POR_AER</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o195">
<a:ObjectID>6958C572-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o189"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o196">
<a:ObjectID>6958C573-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_1&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o191"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o197">
<a:ObjectID>6958C574-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_2&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o190"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o198">
<a:ObjectID>6958C575-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_AER</a:Name>
<a:Code>I_AER</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o199">
<a:ObjectID>6958C576-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o191"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Ref="o30"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o200">
<a:ObjectID>6958C58D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_POR_TRD</a:Name>
<a:Code>T_POR_TRD</a:Code>
<a:Text>Create Trigger T_POR_TRD On T_POR
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Portão»Hotran - Frequência: É Portão da Frequencia (Restrict) */
If (Select Count(*) From T_HFR dep, Deleted pri
 Where dep.CD_POR = pri.CD_POR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Portão&gt; está sendo referenciada na tabela &lt;Hotran - Frequência&gt;&#39;
  Return
End
/* Portão»FIDS - IST Servidor de Informação: Portão Associado ao IST (Restrict) */
If (Select Count(*) From T_FIDS_IST dep, Deleted pri
 Where dep.CD_POR = pri.CD_POR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Portão&gt; está sendo referenciada na tabela &lt;FIDS - IST Servidor de Informação&gt;&#39;
  Return
End
/* Portão»Mensagem de Partida: Portão da Mensagem de Partida (Restrict) */
If (Select Count(*) From T_MPA dep, Deleted pri
 Where dep.CD_POR = pri.CD_POR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Portão&gt; está sendo referenciada na tabela &lt;Mensagem de Partida&gt;&#39;
  Return
End
/* Portão»Mensagem de Partida - Mirror: Portão da Mensagem de Partida (Restrict) */
If (Select Count(*) From T_MPA_MIR dep, Deleted pri
 Where dep.CD_POR = pri.CD_POR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Portão&gt; está sendo referenciada na tabela &lt;Mensagem de Partida - Mirror&gt;&#39;
  Return
End
/* Portão»Partidas: Portão da Partida (Restrict) */
If (Select Count(*) From T_PAR dep, Deleted pri
 Where dep.CD_POR = pri.CD_POR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Portão&gt; está sendo referenciada na tabela &lt;Partidas&gt;&#39;
  Return
End
/* Portão»Partidas - Mirror: Portão da Partida (Restrict) */
If (Select Count(*) From T_PAR_MIR dep, Deleted pri
 Where dep.CD_POR = pri.CD_POR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Portão&gt; está sendo referenciada na tabela &lt;Partidas - Mirror&gt;&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o201">
<a:ObjectID>6958C58F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_POR_TRI</a:Name>
<a:Code>T_POR_TRI</a:Code>
<a:Text>Create Trigger T_POR_TRI On T_POR
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Aeroporto»Portão: Aeroporto possui Portões */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Portão&gt; não está cadastrada&#39;
  Return
End
/* Sala de Embarque»Portão: Sal.Emb. possui portões Emb. */
If (Select Count(*) From T_EMB, Inserted
Where T_EMB.CD_EMB = Inserted.CD_EMB)
 &lt;&gt;(Select Count(CD_EMB) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Sala de Embarque&gt; que se deseja incluir na tabela &lt;Portão&gt; não está cadastrada&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o202">
<a:ObjectID>6958C591-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_POR_TRU</a:Name>
<a:Code>T_POR_TRU</a:Code>
<a:Text>Create Trigger T_POR_TRU On T_POR
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_POR)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Portão&gt; da tabela &lt;Portão&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_AER)
/* Aeroporto»Portão: Aeroporto possui Portões */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Portão&gt; não está cadastrada&#39;
  Return
End
If Update (CD_EMB)
/* Sala de Embarque»Portão: Sal.Emb. possui portões Emb. */
If (Select Count(*) From T_EMB, Inserted
Where T_EMB.CD_EMB = Inserted.CD_EMB)
 &lt;&gt;(Select Count(CD_EMB) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Sala de Embarque&gt; que se deseja incluir na tabela &lt;Portão&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
IF UPDATE(NR_POR) OR UPDATE(CD_EMB)
BEGIN
	/* Incluir Registros em T_APA */
	INSERT	T_APA (DH_APA, CD_PAR)
	Select 	GETDATE(), CD_PAR
	From 	T_PAR PAR, INSERTED INS
	Where	PAR.TP_PAR_STA = 1 AND
		PAR.CD_AER = (Select CD_AER From T_PSI) AND
		PAR.CD_POR = INS.CD_POR

	/* Incluir Registros em T_AHO */
	INSERT	T_AHO (CD_HOT, DH_AHO)
	Select	DISTINCT CD_HOT, GETDATE()
	From	T_HFR HFR, INSERTED INS
	Where	HFR.CD_POR = INS.CD_POR

	/* Incluir Registros em T_AHP */
	INSERT	T_AHP (CD_HPA, DH_AHP)
	Select 	DISTINCT CD_HPA, GETDATE()
	From 	T_HPA001 HPA, T_CHG CHG, T_SIT SIT, T_PAR PAR, INSERTED INS
	Where	HPA.CD_CHG = CHG.CD_CHG AND
		SIT.CD_SIT = CHG.CD_SIT AND
		HPA.CD_AER = (Select CD_AER From T_PSI) AND
		(HPA.FL_HPA_ENT = 1 OR SIT.FL_SIT_AEN_PAT = 1) AND
		HPA.FL_HPA_SAI = 0 AND
		HPA.CD_AEN IS NOT NULL AND
		PAR.CD_CHG_AEN_ANT = HPA.CD_CHG AND
		PAR.CD_POR = INS.CD_POR
END

End
go</a:Text>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o193"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o203">
<a:ObjectID>6958C5B3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_7</a:Name>
<a:Code>REFERENCE_7</a:Code>
<a:CreationDate>1081601754</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601754</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o187"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o101"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o193"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o204">
<a:ObjectID>6958C5B4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601754</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601754</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o188"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o111"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o205">
<a:CenterTextOffset>(3, 0)</a:CenterTextOffset>
<a:Rect>((-737044,663571), (-721774,686800))</a:Rect>
<a:ListOfPoints>((-737044,686800),(-721774,663571))</a:ListOfPoints>
<a:ArrowStyle>4881</a:ArrowStyle>
<a:LineColor>8388672</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o6"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o206">
<a:Rect>((-723007,661829), (-716691,666375))</a:Rect>
<a:LineColor>8388672</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o207">
<a:ObjectID>6958C57A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_SIT</a:Name>
<a:Code>T_SIT</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o208">
<a:ObjectID>6958C579-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_SIT</a:Name>
<a:Code>CD_SIT</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o209">
<a:ObjectID>6958C57C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_SIT_LOC</a:Name>
<a:Code>NM_SIT_LOC</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>varchar(30)</a:DataType>
<a:Length>30</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o210">
<a:ObjectID>6958C57E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_SIT_EST</a:Name>
<a:Code>NM_SIT_EST</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>varchar(30)</a:DataType>
<a:Length>30</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o211">
<a:ObjectID>6958C57F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_SIT_ORD</a:Name>
<a:Code>NR_SIT_ORD</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_ZRO    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_ZRO As
0</a:DefaultValue>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o212">
<a:ObjectID>6958C580-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SG_SIT</a:Name>
<a:Code>SG_SIT</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>varchar(3)</a:DataType>
<a:Length>3</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o213">
<a:ObjectID>6958C581-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_SIT_PAR</a:Name>
<a:Code>FL_SIT_PAR</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o214">
<a:ObjectID>6958C582-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_SIT_CHG</a:Name>
<a:Code>FL_SIT_CHG</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o215">
<a:ObjectID>6958C583-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_SIT_REA</a:Name>
<a:Code>FL_SIT_REA</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o216">
<a:ObjectID>6958C584-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_SIT_HR1</a:Name>
<a:Code>FL_SIT_HR1</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o217">
<a:ObjectID>6958C586-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_SIT_CON_VOO</a:Name>
<a:Code>FL_SIT_CON_VOO</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o218">
<a:ObjectID>6958C587-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_SIT_CAN_VOO</a:Name>
<a:Code>FL_SIT_CAN_VOO</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o219">
<a:ObjectID>6958C588-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_SIT_AEN_PAT</a:Name>
<a:Code>FL_SIT_AEN_PAT</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o220">
<a:ObjectID>6958C58A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_SIT_TOD</a:Name>
<a:Code>FL_SIT_TOD</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o221">
<a:ObjectID>6958C58B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_SIT_COM</a:Name>
<a:Code>TP_SIT_COM</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o222">
<a:ObjectID>6958C58C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>HR_SIT_ANT</a:Name>
<a:Code>HR_SIT_ANT</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o223">
<a:ObjectID>6958C58E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>HR_SIT_APS</a:Name>
<a:Code>HR_SIT_APS</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o224">
<a:ObjectID>6958C590-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_SIT_STF</a:Name>
<a:Code>FL_SIT_STF</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o225">
<a:ObjectID>6958C592-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o226">
<a:ObjectID>6958C593-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_SIT</a:Name>
<a:Code>Pk_T_SIT</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_SIT</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o208"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Owner>
<o:User Ref="o30"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o227">
<a:ObjectID>6958C5A6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_SIT_TRD</a:Name>
<a:Code>T_SIT_TRD</a:Code>
<a:Text>Create Trigger T_SIT_TRD On T_SIT
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Situação»Situação Sucessora: É Sucessora (Restrict) */
Declare @DBBDsc varchar(255)
Select @DBBDsc = &#39;(&#39;
Select @DBBDsc = @DBBDsc+RTrim(Convert(varchar(255),PRI.NM_SIT_LOC))+&#39;, &#39; From T_SSU dep, Deleted pri
 Where dep.CD_SIT_SUC = pri.CD_SIT
If DataLength(@DBBDsc) &gt; 1
Begin
  RollBack Transaction
  If DataLength(@DBBDsc) &gt; 252
    Select @DBBDsc = Substring(@DBBDsc,1,252)+&#39;...&#39;
  Else
    Select @DBBDsc = Substring(@DBBDsc,1,DataLength(@DBBDsc)-2)
  Select @DBBDsc = &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Situação Sucessora&gt; &#39;+@DBBDsc+&#39;)&#39;
  RaisError 20003 @DBBDsc
  Return
End
/* Situação»Situação Condicionante do Vôo Antecessor: Situação Antecessora (Restrict) */
If (Select Count(*) From T_SCA dep, Deleted pri
 Where dep.CD_SIT_ANT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Situação Condicionante do Vôo Antecessor&gt;&#39;
  Return
End
/* Situação»Chegadas - Mirror: Situação da Chegada (Restrict) */
If (Select Count(*) From T_CHG_MIR dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Chegadas - Mirror&gt;&#39;
  Return
End
/* Situação»Chegadas: Situação da Chegada (Restrict) */
If (Select Count(*) From T_CHG dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Chegadas&gt;&#39;
  Return
End
/* Situação»Mensagem de Chegada: Situação da Mensagem de Chegada (Restrict) */
If (Select Count(*) From T_MCH dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Mensagem de Chegada&gt;&#39;
  Return
End
/* Situação»Mensagem de Partida - Mirror: Situação da Mensagem de Partida (Restrict) */
If (Select Count(*) From T_MPA_MIR dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Mensagem de Partida - Mirror&gt;&#39;
  Return
End
/* Situação»Mensagem de Partida: Situação da Mensagem de Partida (Restrict) */
If (Select Count(*) From T_MPA dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Mensagem de Partida&gt;&#39;
  Return
End
/* Situação»Partidas - Mirror: Situação da Partida (Restrict) */
If (Select Count(*) From T_PAR_MIR dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Partidas - Mirror&gt;&#39;
  Return
End
/* Situação»Partidas: Situação da Partida (Restrict) */
If (Select Count(*) From T_PAR dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Partidas&gt;&#39;
  Return
End
/* Situação»Programação de Anúncios: Situação da Programação (Restrict) */
If (Select Count(*) From T_PRA dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Programação de Anúncios&gt;&#39;
  Return
End
/* Situação»Mensagens: Situação das Mensagens (Restrict) */
If (Select Count(*) From T_MSG dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Mensagens&gt;&#39;
  Return
End
/* Situação»Parâmetros do Sistema: Situação de Confirmação de Chegada (Restrict) */
If (Select Count(*) From T_PSI dep, Deleted pri
 Where dep.CD_SIT_CHG_CON = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Parâmetros do Sistema&gt;&#39;
  Return
End
/* Situação»Parâmetros do Sistema: Situação de Confirmação de Partida (Restrict) */
If (Select Count(*) From T_PSI dep, Deleted pri
 Where dep.CD_SIT_PAR_CON = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Parâmetros do Sistema&gt;&#39;
  Return
End
/* Situação»Mensagem de Chegada - Mirror: Situação de Mensagem de Chegada (Restrict) */
If (Select Count(*) From T_MCH_MIR dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Mensagem de Chegada - Mirror&gt;&#39;
  Return
End
/* Situação»Histórico de Situação de Vôo de Chegada - Mirror: Situação do HSC (Restrict) */
If (Select Count(*) From T_HSC_MIR dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Histórico de Situação de Vôo de Chegada - Mirror&gt;&#39;
  Return
End
/* Situação»Histórico de Situação de Vôo de Chegada: Situação do HSC (Restrict) */
If (Select Count(*) From T_HSC dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Histórico de Situação de Vôo de Chegada&gt;&#39;
  Return
End
/* Situação»Histórico de Situação de Vôo de Partida - Mirror: Situação do HSP (Restrict) */
If (Select Count(*) From T_HSP_MIR dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Histórico de Situação de Vôo de Partida - Mirror&gt;&#39;
  Return
End
/* Situação»Histórico de Situação de Vôo de Partida: Situação do HSP (Restrict) */
If (Select Count(*) From T_HSP dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Histórico de Situação de Vôo de Partida&gt;&#39;
  Return
End
/* Situação»Parâmetros do Sistema: Situação Inicial de Chegada do Grupo 1 (Restrict) */
If (Select Count(*) From T_PSI dep, Deleted pri
 Where dep.CD_SIT_CHG_001 = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Parâmetros do Sistema&gt;&#39;
  Return
End
/* Situação»Parâmetros do Sistema: Situação Inicial de Chegada do Grupo 2 (Restrict) */
If (Select Count(*) From T_PSI dep, Deleted pri
 Where dep.CD_SIT_CHG_002 = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Parâmetros do Sistema&gt;&#39;
  Return
End
/* Situação»Parâmetros do Sistema: Situação Inicial de Partida do Grupo 1 (Restrict) */
If (Select Count(*) From T_PSI dep, Deleted pri
 Where dep.CD_SIT_PAR_001 = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Parâmetros do Sistema&gt;&#39;
  Return
End
/* Situação»Parâmetros do Sistema: Situação Inicial de Partida do Grupo 2 (Restrict) */
If (Select Count(*) From T_PSI dep, Deleted pri
 Where dep.CD_SIT_PAR_002 = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Parâmetros do Sistema&gt;&#39;
  Return
End
/* Situação»Situação Sucessora: Possui Sucessora (Cascade) */
Delete T_SSU From T_SSU dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT
/* Situação»Situação Condicionante do Vôo Antecessor: Situação (Cascade) */
Delete T_SCA From T_SCA dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT
/* Situação»Telas da Situação: Telas da Situação (Cascade) */
Delete T_TSI From T_TSI dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT
End
go</a:Text>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o228">
<a:ObjectID>6958C5A8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_SIT_TRI</a:Name>
<a:Code>T_SIT_TRI</a:Code>
<a:Text>Create Trigger T_SIT_TRI On T_SIT
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Domínio de: Tipo de Complemento da Sitação */
/* 1 - Hora */
/* 2 - Texto */
/* 3 - Nenhum */
If (Select Count(*) From Inserted
    Where TP_SIT_COM In (1,2,3))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Tipo de Complemento da Sitação&gt; que se deseja incluir na tabela &lt;Situação&gt; não é uma opção válida&#39;
  Return
End
/* Regra de negócio */
/* Verificar se há alguma situação que não seja nem de Chegada nem de Partida */
IF (	SELECT	COUNT(*)
	FROM	T_SIT SIT,
		INSERTED INS
	WHERE	SIT.CD_SIT = INS.CD_SIT AND
		INS.FL_SIT_CHG = 0 AND 
		INS.FL_SIT_PAR = 0) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Uma situação deve ser de chegada ou de partida ou de ambas.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Se existir mais de uma situação de ETAPA CONCLUÍDA não atualiza*/
IF (	SELECT 	COUNT(*) 
	FROM 	T_SIT SIT,
		INSERTED INS
	WHERE 	SIT.CD_SIT &lt;&gt; INS.CD_SIT AND
		SIT.FL_SIT_CON_VOO = 1 AND
		(SIT.FL_SIT_CHG = INS.FL_SIT_CHG OR SIT.FL_SIT_PAR = INS.FL_SIT_PAR) AND
		INS.FL_SIT_CON_VOO = 1) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Só pode existir uma única situação de vôo do tipo ETAPA CONCLUÍDA.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Se existir mais de uma situação do tipo CANCELADO não atualiza*/
IF (	SELECT 	COUNT(*) 
	FROM 	T_SIT SIT,
		INSERTED INS
	WHERE 	SIT.CD_SIT &lt;&gt; INS.CD_SIT AND
		SIT.FL_SIT_CAN_VOO = 1 AND
		(SIT.FL_SIT_CHG = INS.FL_SIT_CHG OR SIT.FL_SIT_PAR = INS.FL_SIT_PAR) AND
		INS.FL_SIT_CAN_VOO = 1 ) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Só pode existir uma única  situação de vôo do tipo ETAPA CANCELADA.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Se existir mais de uma situação do tipo AERONAVE NO PÁTIO não atualiza*/
IF (	SELECT 	COUNT(*) 
	FROM 	T_SIT SIT
	WHERE 	SIT.FL_SIT_AEN_PAT = 1) &gt; 1
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Só pode existir uma única  situação de vôo do tipo AERONAVE NO PÁTIO.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

End
go</a:Text>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o229">
<a:ObjectID>6958C5A9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_SIT_TRU</a:Name>
<a:Code>T_SIT_TRU</a:Code>
<a:Text>Create Trigger T_SIT_TRU On T_SIT
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_SIT)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código da Situação do Vôo&gt; da tabela &lt;Situação&gt; não pode ser alterada.&#39;
  Return
End
If Update (TP_SIT_COM)
/* Domínio de: Tipo de Complemento da Sitação */
/* 1 - Hora */
/* 2 - Texto */
/* 3 - Nenhum */
If (Select Count(*) From Inserted
    Where TP_SIT_COM In (1,2,3))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Tipo de Complemento da Sitação&gt; que se deseja incluir na tabela &lt;Situação&gt; não é uma opção válida&#39;
  Return
End
/* Regra de negócio */
/* Verificar se há alguma situação que não seja nem de Chegada nem de Partida */
IF (	SELECT	COUNT(*)
	FROM	T_SIT SIT,
		INSERTED INS
	WHERE	SIT.CD_SIT = INS.CD_SIT AND
		INS.FL_SIT_CHG = 0 AND 
		INS.FL_SIT_PAR = 0) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Uma situação deve ser de chegada ou de partida ou de ambas.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Se existir mais de uma situação de ETAPA CONCLUÍDA não atualiza*/
IF (	SELECT 	COUNT(*) 
	FROM 	T_SIT SIT,
		INSERTED INS
	WHERE 	SIT.CD_SIT &lt;&gt; INS.CD_SIT AND
		SIT.FL_SIT_CON_VOO = 1 AND
		(SIT.FL_SIT_CHG = INS.FL_SIT_CHG OR SIT.FL_SIT_PAR = INS.FL_SIT_PAR) AND
		INS.FL_SIT_CON_VOO = 1) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Só pode existir uma única situação de vôo do tipo ETAPA CONCLUÍDA.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Se existir mais de uma situação do tipo CANCELADO não atualiza*/
IF (	SELECT 	COUNT(*) 
	FROM 	T_SIT SIT,
		INSERTED INS
	WHERE 	SIT.CD_SIT &lt;&gt; INS.CD_SIT AND
		SIT.FL_SIT_CAN_VOO = 1 AND
		(SIT.FL_SIT_CHG = INS.FL_SIT_CHG OR SIT.FL_SIT_PAR = INS.FL_SIT_PAR) AND
		INS.FL_SIT_CAN_VOO = 1 ) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Só pode existir uma única  situação de vôo do tipo ETAPA CANCELADA.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Se existir mais de uma situação do tipo AERONAVE NO PÁTIO não atualiza*/
IF (	SELECT 	COUNT(*) 
	FROM 	T_SIT SIT
	WHERE 	SIT.FL_SIT_AEN_PAT = 1) &gt; 1
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Só pode existir uma única  situação de vôo do tipo AERONAVE NO PÁTIO.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

IF UPDATE (FL_SIT_CHG)
BEGIN
	/* Se uma situação de chegada deixar de ser de chegada */
	/* Verificar se há algum vôo de chegada com esta situação */
	IF (	SELECT	COUNT(*)
		FROM	INSERTED INS,
			DELETED DEL,
			T_CHG CHG
		WHERE	INS.CD_SIT = DEL.CD_SIT AND
			DEL.FL_SIT_CHG &lt;&gt; 0 AND
			INS.FL_SIT_CHG = 0 AND
			CHG.CD_SIT = INS.CD_SIT) &gt; 0
	BEGIN
		RAISERROR 20311 &#39;Operação não executada: Existe um vôo de chegada utilizando esta situação.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END

	/* Se uma situação de chegada deixar de ser de chegada */
	/* Verificar se esta situação é situação condicionante de alguma situação de partida */
	IF (	SELECT	COUNT(*)
		FROM	INSERTED INS,
			DELETED DEL,
			T_SCA SCA
		WHERE	INS.CD_SIT = DEL.CD_SIT AND
			DEL.FL_SIT_CHG &lt;&gt; 0 AND
			INS.FL_SIT_CHG = 0 AND
			SCA.CD_SIT_ANT = INS.CD_SIT) &gt; 0
	BEGIN
		RAISERROR 20311 &#39;Operação não executada: Esta situação é uma situação condicionante de alguma situação de partida.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END

	/* Se uma situação de chegada deixar de ser de chegada */
	/* Verificar se esta situação é situação sucessora de alguma situação de chegada */
	IF (	SELECT	COUNT(*)
		FROM	INSERTED INS,
			T_SSU SSU,
			T_SIT SIT
		WHERE	SSU.CD_SIT_SUC = INS.CD_SIT AND
			SIT.CD_SIT = SSU.CD_SIT AND
			INS.FL_SIT_CHG = 0 AND
			SIT.FL_SIT_CHG = 1) &gt; 0
	BEGIN
		RAISERROR 20311 &#39;Operação não executada: Esta situação é situação sucessora de uma situação de chegada. Por esta razão ela também tem de ser de chegada.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
END

IF UPDATE (FL_SIT_PAR)
BEGIN
	/* Se uma situação de partida deixar de ser de partida */
	/* Verificar se há algum vôo de partida com esta situação */
	IF (	SELECT	COUNT(*)
		FROM	INSERTED INS,
			DELETED DEL,
			T_PAR PAR
		WHERE	INS.CD_SIT = DEL.CD_SIT AND
			DEL.FL_SIT_PAR &lt;&gt; 0 AND
			INS.FL_SIT_PAR = 0 AND
			PAR.CD_SIT = INS.CD_SIT) &gt; 0
	BEGIN
		RAISERROR 20311 &#39;Operação não executada: Existe um vôo de partida utilizando esta situação.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END

	/* Se uma situação de partida deixar de ser de partida */
	/* Verificar se esta situação possui alguma situação de chegada condicionante */
	IF (	SELECT	COUNT(*)
		FROM	INSERTED INS,
			DELETED DEL,
			T_SCA SCA
		WHERE	INS.CD_SIT = DEL.CD_SIT AND
			DEL.FL_SIT_PAR &lt;&gt; 0 AND
			INS.FL_SIT_PAR = 0 AND
			SCA.CD_SIT = INS.CD_SIT) &gt; 0
	BEGIN
		RAISERROR 20311 &#39;Operação não executada: Esta situação possui alguma situação de chegada condicionante.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END

	/* Se uma situação de partida deixar de ser de partida */
	/* Verificar se esta situação é situação sucessora de alguma situação de partida */
	IF (	SELECT	COUNT(*)
		FROM	INSERTED INS,
			T_SSU SSU,
			T_SIT SIT
		WHERE	SSU.CD_SIT_SUC = INS.CD_SIT AND
			SIT.CD_SIT = SSU.CD_SIT AND
			INS.FL_SIT_PAR = 0 AND
			SIT.FL_SIT_PAR = 1) &gt; 0
	BEGIN
		RAISERROR 20311 &#39;Operação não executada: Esta situação é situação sucessora de uma situação de partida. Por esta razão ela também tem de ser de partida.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
END

/* Incluir Registros em T_ACH */
INSERT	T_ACH (DH_ACH, CD_CHG)
Select 	GETDATE(), CD_CHG
From 	T_CHG CHG, INSERTED INS
Where	CHG.TP_CHG_STA = 1 AND
	CHG.CD_AER = (Select CD_AER From T_PSI) AND
	CHG.CD_SIT = INS.CD_SIT

/* Incluir Registros em T_APA */
INSERT	T_APA (DH_APA, CD_PAR)
Select 	GETDATE(), CD_PAR
From 	T_PAR PAR, INSERTED INS
Where	PAR.TP_PAR_STA = 1 AND
	PAR.CD_AER = (Select CD_AER From T_PSI) AND
	PAR.CD_SIT = INS.CD_SIT

End
go</a:Text>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o226"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o230">
<a:ObjectID>6958C5B5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_10</a:Name>
<a:Code>REFERENCE_10</a:Code>
<a:CreationDate>1081601754</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601754</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o207"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o7"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o226"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o231">
<a:ObjectID>6958C5B6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601754</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601754</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o208"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o13"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o232">
<a:CenterTextOffset>(3, 0)</a:CenterTextOffset>
<a:Rect>((-718248,662996), (-703639,686289))</a:Rect>
<a:ListOfPoints>((-703639,686289),(-718248,662996))</a:ListOfPoints>
<a:ArrowStyle>4881</a:ArrowStyle>
<a:LineColor>8388672</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o100"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o206"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o233">
<a:ObjectID>6958C5B7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_11</a:Name>
<a:Code>REFERENCE_11</a:Code>
<a:CreationDate>1081601754</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601754</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o207"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o101"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o226"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o234">
<a:ObjectID>6958C5B8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601754</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601754</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o208"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o107"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o235">
<a:CenterTextOffset>(3, 0)</a:CenterTextOffset>
<a:Rect>((-735704,687740), (-721036,693952))</a:Rect>
<a:ListOfPoints>((-735704,687740),(-721036,693952))</a:ListOfPoints>
<a:ArrowStyle>4881</a:ArrowStyle>
<a:LineColor>8388672</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o6"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o236">
<a:Rect>((-722579,692711), (-715953,697257))</a:Rect>
<a:LineColor>8388672</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o237">
<a:ObjectID>6958C585-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_TPA</a:Name>
<a:Code>T_TPA</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o238">
<a:ObjectID>6958C594-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_TPA</a:Name>
<a:Code>CD_TPA</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o239">
<a:ObjectID>6958C595-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_TPA</a:Name>
<a:Code>NM_TPA</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(30)</a:DataType>
<a:Length>30</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o240">
<a:ObjectID>6958C596-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_TPA</a:Name>
<a:Code>TP_TPA</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o241">
<a:ObjectID>6958C597-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_MSG</a:Name>
<a:Code>TP_MSG</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o242">
<a:ObjectID>6958C598-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o243">
<a:ObjectID>6958C5A0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_TPA</a:Name>
<a:Code>Pk_T_TPA</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_TPA</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o238"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o244">
<a:ObjectID>6958C599-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_TPAMSG</a:Name>
<a:Code>I_TPAMSG</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o245">
<a:ObjectID>6958C59A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o241"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o246">
<a:ObjectID>6958C59B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_TPATPA</a:Name>
<a:Code>I_TPATPA</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o247">
<a:ObjectID>6958C59C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o240"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o248">
<a:ObjectID>6958C59D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_TPATPAMSG</a:Name>
<a:Code>I_TPATPAMSG</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o249">
<a:ObjectID>6958C59E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o240"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o250">
<a:ObjectID>6958C59F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_1&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o241"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Ref="o30"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o251">
<a:ObjectID>6958C5B9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_TPA_TRD</a:Name>
<a:Code>T_TPA_TRD</a:Code>
<a:Text>Create Trigger T_TPA_TRD On T_TPA
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Tipo de Anuncio»Área de Anúncio do Tipo de Anúncio: R:TPA-ATA (Restrict) */
If (Select Count(*) From T_ATA dep, Deleted pri
 Where dep.CD_TPA = pri.CD_TPA) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Tipo de Anuncio&gt; está sendo referenciada na tabela &lt;Área de Anúncio do Tipo de Anúncio&gt;&#39;
  Return
End
/* Tipo de Anuncio»Mensagem de Chegada - Mirror: Tipo de Anúncio da Mensagem de Chegada (Restrict) */
If (Select Count(*) From T_MCH_MIR dep, Deleted pri
 Where dep.CD_TPA = pri.CD_TPA) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Tipo de Anuncio&gt; está sendo referenciada na tabela &lt;Mensagem de Chegada - Mirror&gt;&#39;
  Return
End
/* Tipo de Anuncio»Mensagem de Chegada: Tipo de Anúncio da Mensagem de Chegada (Restrict) */
If (Select Count(*) From T_MCH dep, Deleted pri
 Where dep.CD_TPA = pri.CD_TPA) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Tipo de Anuncio&gt; está sendo referenciada na tabela &lt;Mensagem de Chegada&gt;&#39;
  Return
End
/* Tipo de Anuncio»Mensagem de Partida: Tipo de Anúncio da Mensagem de Partida (Restrict) */
If (Select Count(*) From T_MPA dep, Deleted pri
 Where dep.CD_TPA = pri.CD_TPA) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Tipo de Anuncio&gt; está sendo referenciada na tabela &lt;Mensagem de Partida&gt;&#39;
  Return
End
/* Tipo de Anuncio»Mensagem de Partida - Mirror: Tipo de Anúncio da Mensagem de Partida (Restrict) */
If (Select Count(*) From T_MPA_MIR dep, Deleted pri
 Where dep.CD_TPA = pri.CD_TPA) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Tipo de Anuncio&gt; está sendo referenciada na tabela &lt;Mensagem de Partida - Mirror&gt;&#39;
  Return
End
/* Tipo de Anuncio»Programação de Anúncios: Tipo de anúncio da programação (Restrict) */
If (Select Count(*) From T_PRA dep, Deleted pri
 Where dep.CD_TPA = pri.CD_TPA) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Tipo de Anuncio&gt; está sendo referenciada na tabela &lt;Programação de Anúncios&gt;&#39;
  Return
End
/* Tipo de Anuncio»Mensagens: Tipo de Mensagem (Restrict) */
If (Select Count(*) From T_MSG dep, Deleted pri
 Where dep.CD_TPA = pri.CD_TPA) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Tipo de Anuncio&gt; está sendo referenciada na tabela &lt;Mensagens&gt;&#39;
  Return
End
/* Tipo de Anuncio»Log da Programação de Anúncios: C:TPA-PRALOG (Cascade) */
Delete T_PRALOG From T_PRALOG dep, Deleted pri
 Where dep.CD_TPA = pri.CD_TPA
End
go</a:Text>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o252">
<a:ObjectID>6958C5BA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_TPA_TRI</a:Name>
<a:Code>T_TPA_TRI</a:Code>
<a:Text>Create Trigger T_TPA_TRI On T_TPA
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Domínio de: Tipo do Tipo de Anuncio */
/* 1 - Anuncio de Chegada */
/* 2 - Anuncio de Partida */
/* 3 - Mensagens diversas */
If (Select Count(*) From Inserted
    Where TP_TPA In (1,2,3))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Tipo do Tipo de Anuncio&gt; que se deseja incluir na tabela &lt;Tipo de Anuncio&gt; não é uma opção válida&#39;
  Return
End
/* Domínio de: Mensagem */
/* 1 - Anunciador Automático */
/* 2 - Atendimento Telefônico */
/* 3 - Situação */
If (Select Count(*) From Inserted
    Where TP_MSG In (1,2,3))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Mensagem&gt; que se deseja incluir na tabela &lt;Tipo de Anuncio&gt; não é uma opção válida&#39;
  Return
End
/* Regra de negócio */
IF (	SELECT 	COUNT(*)
	FROM	INSERTED
	WHERE	TP_TPA = 3 AND
		TP_MSG = 3) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: Não pode existir &lt;Mensagens Diversas&gt; para &lt;Mensagem de Situação&gt;.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

End
go</a:Text>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o253">
<a:ObjectID>6958C5BC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_TPA_TRU</a:Name>
<a:Code>T_TPA_TRU</a:Code>
<a:Text>Create Trigger T_TPA_TRU On T_TPA
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_TPA)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Tipo de Anuncio&gt; da tabela &lt;Tipo de Anuncio&gt; não pode ser alterada.&#39;
  Return
End
If Update (TP_TPA)
Or Update (TP_MSG)
/* Domínio de: Tipo do Tipo de Anuncio */
/* 1 - Anuncio de Chegada */
/* 2 - Anuncio de Partida */
/* 3 - Mensagens diversas */
If (Select Count(*) From Inserted
    Where TP_TPA In (1,2,3))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Tipo do Tipo de Anuncio&gt; que se deseja incluir na tabela &lt;Tipo de Anuncio&gt; não é uma opção válida&#39;
  Return
End
/* Domínio de: Mensagem */
/* 1 - Anunciador Automático */
/* 2 - Atendimento Telefônico */
/* 3 - Situação */
If (Select Count(*) From Inserted
    Where TP_MSG In (1,2,3))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Mensagem&gt; que se deseja incluir na tabela &lt;Tipo de Anuncio&gt; não é uma opção válida&#39;
  Return
End
/* Regra de negócio */
IF (	SELECT 	COUNT(*)
	FROM	INSERTED
	WHERE	TP_TPA = 3 AND
		TP_MSG = 3) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: Não pode existir &lt;Mensagens Diversas&gt; para &lt;Mensagem de Situação&gt;.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

if 	Update (TP_TPA) Or 
	Update (TP_MSG)
BEGIN
	IF (	SELECT 	COUNT(*)
		FROM	INSERTED INS, T_MSG MSG
		WHERE	MSG.CD_TPA = INS.CD_TPA) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: Não se pode alterar os tipos de anúncios que já possuem anúncios.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END

END
End
go</a:Text>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o243"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o254">
<a:ObjectID>6958C5BB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_13</a:Name>
<a:Code>REFERENCE_13</a:Code>
<a:CreationDate>1081601754</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601754</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o237"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o7"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o243"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o255">
<a:ObjectID>6958C5BD-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601754</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601754</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o238"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o15"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o256">
<a:CenterTextOffset>(3, 0)</a:CenterTextOffset>
<a:Rect>((-718218,686970), (-703805,693952))</a:Rect>
<a:ListOfPoints>((-703805,686970),(-718218,693952))</a:ListOfPoints>
<a:ArrowStyle>4881</a:ArrowStyle>
<a:LineColor>8388672</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o100"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o236"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o257">
<a:ObjectID>6958C5BE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_14</a:Name>
<a:Code>REFERENCE_14</a:Code>
<a:CreationDate>1081601754</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601754</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o237"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o101"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o243"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o258">
<a:ObjectID>6958C5BF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601754</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601754</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o238"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o109"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o259">
<a:CenterTextOffset>(3, 0)</a:CenterTextOffset>
<a:Rect>((-736842,677384), (-721948,687284))</a:Rect>
<a:ListOfPoints>((-736842,687284),(-721948,677384))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>8388672</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o6"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o260">
<a:Rect>((-722883,677345), (-716257,681891))</a:Rect>
<a:LineColor>8388672</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o261">
<a:ObjectID>6958C589-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_USR</a:Name>
<a:Code>T_USR</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o262">
<a:ObjectID>6958C5A1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_USR</a:Name>
<a:Code>CD_USR</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o263">
<a:ObjectID>6958C5A2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_USR_PAS</a:Name>
<a:Code>NM_USR_PAS</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(30)</a:DataType>
<a:Length>30</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o264">
<a:ObjectID>6958C5A3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o265">
<a:ObjectID>6958C5A4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_USR</a:Name>
<a:Code>Pk_T_USR</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_USR</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o262"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Owner>
<o:User Ref="o30"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o266">
<a:ObjectID>6958C5C0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_USR_TRD</a:Name>
<a:Code>T_USR_TRD</a:Code>
<a:Text>Create Trigger T_USR_TRD On T_USR
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Usuários»Chamadas de Anuncio - Mirror: Usuário da Chamada (Restrict) */
If (Select Count(*) From T_CHA_MIR dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Chamadas de Anuncio - Mirror&gt;&#39;
  Return
End
/* Usuários»Chamadas de Anuncio: Usuário da Chamada (Restrict) */
If (Select Count(*) From T_CHA dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Chamadas de Anuncio&gt;&#39;
  Return
End
/* Usuários»Mensagem de Chegada - Mirror: Usuário da Mensagem de Chegada (Restrict) */
If (Select Count(*) From T_MCH_MIR dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Mensagem de Chegada - Mirror&gt;&#39;
  Return
End
/* Usuários»Mensagem de Chegada: Usuário da Mensagem de Chegada (Restrict) */
If (Select Count(*) From T_MCH dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Mensagem de Chegada&gt;&#39;
  Return
End
/* Usuários»Mensagem de Partida: Usuário da Mensagem de Partida (Restrict) */
If (Select Count(*) From T_MPA dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Mensagem de Partida&gt;&#39;
  Return
End
/* Usuários»Mensagem de Partida - Mirror: Usuário da Mensagem de Partida (Restrict) */
If (Select Count(*) From T_MPA_MIR dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Mensagem de Partida - Mirror&gt;&#39;
  Return
End
/* Usuários»Chegadas - Mirror: Usuário Logado (Restrict) */
If (Select Count(*) From T_CHG_MIR dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Chegadas - Mirror&gt;&#39;
  Return
End
/* Usuários»Partidas - Mirror: Usuário Logado (Restrict) */
If (Select Count(*) From T_PAR_MIR dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Partidas - Mirror&gt;&#39;
  Return
End
/* Usuários»Histórico de Situação de Vôo de Chegada - Mirror: Usuário Logado (Restrict) */
If (Select Count(*) From T_HSC_MIR dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Histórico de Situação de Vôo de Chegada - Mirror&gt;&#39;
  Return
End
/* Usuários»Histórico de Situação de Vôo de Partida - Mirror: Usuário Logado (Restrict) */
If (Select Count(*) From T_HSP_MIR dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Histórico de Situação de Vôo de Partida - Mirror&gt;&#39;
  Return
End
/* Usuários»Histórico de Situação de Vôo de Chegada: Usuário logado (Restrict) */
If (Select Count(*) From T_HSC dep,Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Histórico de Situação de Vôo de Chegada&gt;&#39;
  Return
End
/* Usuários»Histórico de Situação de Vôo de Partida: Usuário logado (Restrict) */
If (Select Count(*) From T_HSP dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Histórico de Situação de Vôo de Partida&gt;&#39;
  Return
End
/* Usuários»Chegadas: Usuário logado (Restrict) */
If (Select Count(*) From T_CHG dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Chegadas&gt;&#39;
  Return
End
/* Usuários»Partidas: Usuário logado (Restrict) */
If (Select Count(*) From T_PAR dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Partidas&gt;&#39;
  Return
End
/* Usuários»Usuários do Grupo: Usuários do Grupo (Restrict) */
If (Select Count(*) From T_USG dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Usuários do Grupo&gt;&#39;
  Return
End
/* Usuários»FIDS - Usuário do Grupo de Displays: Usuários do Grupo de Displays (Restrict) */
If (Select Count(*) From T_FIDS_DGU dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;FIDS - Usuário do Grupo de Displays&gt;&#39;
  Return
End
/* Usuários»Log da Programação de Anúncios: C:USR-PRALOG (Cascade) */
Delete T_PRALOG From T_PRALOG dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR
/* Regra de negócio */
/* INCLUIR REGISTROS EM T_AUS */
INSERT	T_AUS (DH_AUS, CD_USR)
SELECT GETDATE(), CD_USR FROM DELETED

End
go</a:Text>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o267">
<a:ObjectID>6958C5C2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_USR_TRI</a:Name>
<a:Code>T_USR_TRI</a:Code>
<a:Text>Create Trigger T_USR_TRI On T_USR
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Pessoas»Usuários: Pessoa do Usuário */
If (Select Count(*) From T_PES, Inserted
Where T_PES.CD_PES = Inserted.CD_USR)
 &lt;&gt;(Select Count(CD_USR) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Pessoas&gt; que se deseja incluir na tabela &lt;Usuários&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
/* INCLUIR REGISTROS EM T_AUS */
INSERT	T_AUS (DH_AUS, CD_USR)
SELECT GETDATE(), CD_USR FROM INSERTED

End
go</a:Text>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o268">
<a:ObjectID>6958C5C4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_USR_TRU</a:Name>
<a:Code>T_USR_TRU</a:Code>
<a:Text>Create Trigger T_USR_TRU On T_USR
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_USR)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Usuário&gt; da tabela &lt;Usuários&gt; não pode ser alterada.&#39;
  Return
End
/* Regra de negócio */
/* INCLUIR REGISTROS EM T_AUS */
INSERT	T_AUS (DH_AUS, CD_USR)
SELECT GETDATE(), CD_USR FROM INSERTED

End
go</a:Text>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o265"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o269">
<a:ObjectID>6958C5C1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_16</a:Name>
<a:Code>REFERENCE_16</a:Code>
<a:CreationDate>1081601754</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601754</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o261"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o7"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o265"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o270">
<a:ObjectID>6958C5C3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601754</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601754</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o262"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o10"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o271">
<a:CenterTextOffset>(3, 0)</a:CenterTextOffset>
<a:Rect>((-717225,678383), (-703805,686484))</a:Rect>
<a:ListOfPoints>((-703805,686484),(-717225,678383))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>8388672</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o100"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o260"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o272">
<a:ObjectID>6958C5C5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_17</a:Name>
<a:Code>REFERENCE_17</a:Code>
<a:CreationDate>1081601754</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601754</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o261"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o101"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o265"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o273">
<a:ObjectID>6958C5C6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081601754</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601754</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o262"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o104"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:TableSymbol Ref="o33"/>
<o:TableSymbol Ref="o87"/>
<o:TableSymbol Ref="o6"/>
<o:TableSymbol Ref="o100"/>
<o:TableSymbol Ref="o129"/>
<o:TableSymbol Ref="o186"/>
<o:TableSymbol Ref="o206"/>
<o:TableSymbol Ref="o236"/>
<o:TableSymbol Ref="o260"/>
</c:Symbols>
</o:PhysicalDiagram>
</c:PhysicalDiagrams>
<c:DefaultDiagram>
<o:PhysicalDiagram Ref="o4"/>
</c:DefaultDiagram>
<c:Users>
<o:User Ref="o30"/>
</c:Users>
<c:Tables>
<o:Table Ref="o34"/>
<o:Table Ref="o88"/>
<o:Table Ref="o7"/>
<o:Table Ref="o101"/>
<o:Table Ref="o130"/>
<o:Table Ref="o187"/>
<o:Table Ref="o207"/>
<o:Table Ref="o237"/>
<o:Table Ref="o261"/>
</c:Tables>
<c:References>
<o:Reference Ref="o84"/>
<o:Reference Ref="o97"/>
<o:Reference Ref="o126"/>
<o:Reference Ref="o183"/>
<o:Reference Ref="o203"/>
<o:Reference Ref="o230"/>
<o:Reference Ref="o233"/>
<o:Reference Ref="o254"/>
<o:Reference Ref="o257"/>
<o:Reference Ref="o269"/>
<o:Reference Ref="o272"/>
</c:References>
<c:TargetModels>
<o:TargetModel Id="o274">
<a:ObjectID>6958C5D3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Microsoft SQL Server 7.x</a:Name>
<a:Code>SQL SERVER 7</a:Code>
<a:CreationDate>1081601647</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601647</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:TargetModelURL>file:///%_DBMS%/sqlserv7.xdb</a:TargetModelURL>
<a:TargetModelID>986CB218-1936-4245-823C-883D7AF59B86</a:TargetModelID>
<a:TargetModelClassID>4BA9F647-DAB1-11D1-9944-006097355D9B</a:TargetModelClassID>
<c:SessionShortcuts>
<o:Shortcut Ref="o3"/>
<o:Shortcut Id="o275">
<a:ObjectID>6958C5D8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Microsoft SQL Server 7.x</a:Name>
<a:Code>SQL SERVER 7</a:Code>
<a:CreationDate>1081601648</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081601648</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:TargetID>986CB218-1936-4245-823C-883D7AF59B86</a:TargetID>
<a:TargetClassID>4BA9F647-DAB1-11D1-9944-006097355D9B</a:TargetClassID>
<a:TargetPackagePath/>
</o:Shortcut>
</c:SessionShortcuts>
</o:TargetModel>
</c:TargetModels>
</o:Model>
</c:Children>
</o:RootObject>

</Model>