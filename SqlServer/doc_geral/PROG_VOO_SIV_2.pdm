<?xml version="1.0" encoding="UTF-8"?>
<?PowerDesigner ID="{6958BCF8-8FBB-11D8-B6CA-00024416849C}" Name="PhysicalDataModel_8" Objects="312" Symbols="34" Type="{CDE44E21-9669-11D1-9914-006097355D9B}" signature="PDM_DATA_MODEL_XML" version="9.0.0.438 Evaluation"?>
<!-- please do not edit this file -->

<Model xmlns:a="attribute" xmlns:c="collection" xmlns:o="object">

<o:RootObject Id="o1">
<c:Children>
<o:Model Id="o2">
<a:ObjectID>6958BCF8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>PhysicalDataModel_8</a:Name>
<a:Code>PHYSICALDATAMODEL_8</a:Code>
<a:CreationDate>1081540664</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081694964</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PackageOptionsText>
[FolderOptions]

[FolderOptions\Physical Objects]
GenerationCheckModel=Yes
GenerationPath=
RevPkey=Yes
RevFkey=Yes
RevAkey=Yes
RevCheck=Yes
RevIndx=Yes
RevOpts=Yes
RevViewAsTabl=No
RevSystAsTabl=Yes
RevSynmAsTabl=Yes
GenScriptName=crebas
GenScriptName0=
GenScriptName1=
GenScriptName2=
GenScriptName3=
GenScriptName4=
GenScriptName5=
GenScriptName6=
GenScriptName7=
GenScriptName8=
GenScriptName9=
GenPathName=
GenSingleFile=Yes
GenTrgScriptName=cretrg
GenTrgScriptName0=
GenTrgScriptName1=
GenTrgScriptName2=
GenTrgScriptName3=
GenTrgScriptName4=
GenTrgScriptName5=
GenTrgScriptName6=
GenTrgScriptName7=
GenTrgScriptName8=
GenTrgScriptName9=
GenTrgPathName=
GenTrgSingleFile=Yes
GenODBC=No
GenCheckModel=Yes
GenScriptPrev=Yes
GenArchiveModel=No
GenDataPathName=
GenDataSinglefile=Yes
GenDataScriptName=testdata
GenDataScriptName0=
GenDataScriptName1=
GenDataScriptName2=
GenDataScriptName3=
GenDataScriptName4=
GenDataScriptName5=
GenDataScriptName6=
GenDataScriptName7=
GenDataScriptName8=
GenDataScriptName9=
GenDataOdbc=No
GenDataDelOld=No
GenDataTitle=No
GenDataDefNumRows=20
GenDataCommit=0
GenDataPacket=0
GenDataCSV=No
GenDataOwner=No
GenDataProfNumb=
GenDataProfChar=
GenDataProfDate=
GenTspcCrea=Yes
GenTspcDrop=Yes
GenStorCrea=Yes
GenStorDrop=Yes
GenUddtCrea=Yes
GenUddtDval=Yes
GenUddtChck=Yes
GenUddtCmmt=Yes
GenUddtDrop=Yes
GenClssCrea=Yes
GenClssHead=Yes
GenClssFoot=Yes
GenClssCmmt=Yes
GenClssDrop=Yes
GenClssInst=Yes
GenClssSupp=Yes
GenDtbsCrea=Yes
GenDtbsOpts=Yes
GenDtbsHead=Yes
GenDtbsFoot=Yes
GenDtbsOpen=Yes
GenDtbsClose=Yes
GenDtbsDrop=Yes
GenUserCrea=Yes
GenUserGrant=Yes
GenUserDrop=Yes
GenTablCrea=Yes
GenTablChck=Yes
GenTablOpts=Yes
GenTablHead=Yes
GenTablFoot=Yes
GenTablCmmt=Yes
GenTablDrop=Yes
GenColnUddt=Yes
GenColnDval=Yes
GenColnChck=Yes
GenColnOpts=Yes
GenColnCmmt=Yes
GenPkeyCrea=Yes
GenPkeyOpts=Yes
GenPkeyDrop=Yes
GenAkeyCrea=Yes
GenAkeyOpts=Yes
GenAkeyDrop=Yes
GenRefrCrea=Yes
GenRefrIdcl=Yes
GenRefrIDUR=Yes
GenRefrIDUC=Yes
GenRefrIDUN=Yes
GenRefrIDUD=Yes
GenRefrIDDR=Yes
GenRefrIDDC=Yes
GenRefrIDDN=Yes
GenRefrIDDD=Yes
GenRefrDrop=Yes
GenIndxCrea=Yes
GenIndxPkey=Yes
GenIndxFkey=Yes
GenIndxAkey=Yes
GenIndxClus=Yes
GenIndxOthr=Yes
GenIndxOpts=Yes
GenIndxCmmt=Yes
GenIndxDrop=Yes
GenViewCrea=Yes
GenViewHead=Yes
GenViewFoot=Yes
GenViewCmmt=Yes
GenViewDrop=Yes
GenJidxCrea=Yes
GenJidxHead=Yes
GenJidxFoot=Yes
GenJidxDrop=Yes
GenSqncCrea=Yes
GenSqncDrop=Yes
GenTrgrCrea=Yes
GenTrgrDrop=Yes
GenTrgrFIns=Yes
GenTrgrFUpd=Yes
GenTrgrFDel=Yes
GenProcCrea=Yes
GenProcDrop=Yes
GenScriptTitle=Yes
GenScriptNamLabl=No
GenScriptQDtbs=Yes
GenScriptQOwnr=Yes
GenScriptCase=0
GenScriptCharset=0
GenScriptNAcct=No
GenScriptODBC=No
GenUseSync=No
GenSyncChoice=0
GenSyncArch=
GenTmpTablCrea=Yes
GenTmpTablDrop=Yes
GenTrgrStdMsg=Yes
GenTrgrMsgTab=
GenTrgrMsgNo=
GenTrgrMsgTxt=
GenRuleCrea=Yes
GenRuleDrop=Yes

[FolderOptions\Pdm]
IndxIQName=%COLUMN%_%INDEXTYPE%
IndxPK=Yes
IndxFK=Yes
IndxAK=Yes
IndxPKName=%TABLE%_PK
IndxFKName=%REFR%_FK
IndxAKName=%AKEY%_AK
IndxPreserve=No
IndxThreshold=0
RefrPreserve=No
JidxPreserve=No
RbldMultiFact=Yes
RbldMultiDim=Yes
RbldMultiJidx=Yes
CubePreserve=No
CubeScriptPath=
CubeScriptCase=0
CubeScriptCharset=0
CubeScriptNacct=No
CubeScriptHeader=No
CubeScriptExt=csv
CubeScriptExt0=txt
CubeScriptExt1=
CubeScriptExt2=
CubeScriptSep=,
CubeScriptDeli=&quot;
TrgrPreserve=No
TrgrIns=Yes
TrgrUpd=Yes
TrgrDel=Yes
TrgrC2Ins=Yes
TrgrC2Upd=Yes
TrgrC3=Yes
TrgrC4=Yes
TrgrC5=Yes
TrgrC6=Yes
TrgrC7=Yes
TrgrC8=Yes
TrgrC9=Yes
TrgrC10=Yes
TrgrC11=Yes
TrgrC1=Yes
TrgrC12Ins=Yes
TrgrC12Upd=Yes
TrgrC13=Yes
</a:PackageOptionsText>
<a:ModelOptionsText>
[ModelOptions]

[ModelOptions\Physical Objects]
DisplayName=Yes
DefaultDttp=&lt;Undefined&gt;
IgnoreOwner=No
RefrUnique=No
RefrAutoMigrate=Yes
RefrMigrateReuse=Yes
RefrMigrateDomain=Yes
RefrMigrateCheck=Yes
RefrMigrateRule=Yes
RefrMigrateExtd=No
RefrMigrDefaultLink=No
DomnForbDivg=No
DomnCopyDttp=Yes
DomnCopyChck=No
DomnCopyRule=No
DomnCopyMand=No
DomnCopyExtd=No
DomnCopyProf=No

[ModelOptions\Connection]

[ModelOptions\Pdm]

[ModelOptions\Generate]

[ModelOptions\Generate\Cdm]
CheckModel=1
SaveLinks=1
NameToCode=0
Notation=2

[ModelOptions\Generate\Oom]
CheckModel=1
SaveLinks=1
ORMapping=0
NameToCode=0
ClassPrefix=

[ModelOptions\ClssNamingOptions]

[ModelOptions\ClssNamingOptions\PDMPCKG]

[ModelOptions\ClssNamingOptions\PDMPCKG\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\PDMPCKG\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\PDMDOMN]

[ModelOptions\ClssNamingOptions\PDMDOMN\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\PDMDOMN\Code]
Template=
MaxLen=128
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\TABL]

[ModelOptions\ClssNamingOptions\TABL\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\TABL\Code]
Template=
MaxLen=128
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\COLN]

[ModelOptions\ClssNamingOptions\COLN\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\COLN\Code]
Template=
MaxLen=128
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\REFR]

[ModelOptions\ClssNamingOptions\REFR\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\REFR\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\VREF]

[ModelOptions\ClssNamingOptions\VREF\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\VREF\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\VIEW]

[ModelOptions\ClssNamingOptions\VIEW\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\VIEW\Code]
Template=
MaxLen=128
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\FACT]

[ModelOptions\ClssNamingOptions\FACT\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\FACT\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\DIMN]

[ModelOptions\ClssNamingOptions\DIMN\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\DIMN\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\CUBE]

[ModelOptions\ClssNamingOptions\CUBE\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\CUBE\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\MEAS]

[ModelOptions\ClssNamingOptions\MEAS\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\MEAS\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\DATTR]

[ModelOptions\ClssNamingOptions\DATTR\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\DATTR\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\FILO]

[ModelOptions\ClssNamingOptions\FILO\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;\/:*?&lt;&gt;|&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\FILO\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_.&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\DefaultClass]

[ModelOptions\ClssNamingOptions\DefaultClass\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\DefaultClass\Code]
Template=
MaxLen=254
Case=M
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\NamingOptionsTemplates]

[ModelOptions\Default Opts]

[ModelOptions\Default Opts\TABL]
PhysOpts=

[ModelOptions\Default Opts\COLN]
PhysOpts=

[ModelOptions\Default Opts\INDX]
PhysOpts=

[ModelOptions\Default Opts\AKEY]
PhysOpts=

[ModelOptions\Default Opts\PKEY]
PhysOpts=

[ModelOptions\Default Opts\STOR]
PhysOpts=

[ModelOptions\Default Opts\TSPC]
PhysOpts=

[ModelOptions\Default Opts\SQNC]
PhysOpts=

[ModelOptions\Default Opts\DTBS]
PhysOpts=
</a:ModelOptionsText>
<c:DBMS>
<o:Shortcut Id="o3">
<a:ObjectID>6958BCFD-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Microsoft SQL Server 7.x</a:Name>
<a:Code>SQL SERVER 7</a:Code>
<a:CreationDate>1081540664</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540664</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:TargetID>986CB218-1936-4245-823C-883D7AF59B86</a:TargetID>
<a:TargetClassID>4BA9F647-DAB1-11D1-9944-006097355D9B</a:TargetClassID>
<a:TargetPackagePath/>
</o:Shortcut>
</c:DBMS>
<c:PhysicalDiagrams>
<o:PhysicalDiagram Id="o4">
<a:ObjectID>6958BCFA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>PhysicalDiagram_1</a:Name>
<a:Code>PHYSICALDIAGRAM_1</a:Code>
<a:CreationDate>1081540662</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1082145972</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DisplayPreferences>
[DisplayPreferences]

[DisplayPreferences\PDM]

[DisplayPreferences\General]
Adjust to text=Yes
Snap Grid=No
Display Grid=No
Show Page Delimiter=Yes
Grid size=800
Graphic unit=0
Window color=255 255 255

[DisplayPreferences\Object]
Mode=0
Trunc Length=80
Word Length=80
Word Text=!&quot;&quot;#$%&amp;&#39;()*+,-./:;&lt;=&gt;?@[\]^_`{|}~
Shortcut IntIcon=Yes
Shortcut IntLoct=No
Shortcut ExtIcon=Yes
Shortcut ExtLoct=No
File Location=No
TablColn=No
ColnMode=0
ColnMax=5
TablIndx=No
TablKey=No
TablTrgr=Yes
TablOwnr=No
ColnDttp=Yes
ColnDomn=No
ColnShowDomn=Yes
ColnKey=Yes
ColnIndx=Yes
ColnMand=Yes
ViewTabl=Yes
ViewColn=Yes
ViewOwnr=No
VColName=Yes
VColExpr=No
VColDttp=No
VColCMod=1
VColCMax=5
RefrName=No
RefrJoin=Yes
RefrCnam=No
RefrIntg=No
RefrImpl=No
RefrCard=No
RefrMode=2
VRefName=No
VRefJoin=No
VRefMode=0

[DisplayPreferences\Symbol]

[DisplayPreferences\Symbol\PDMPCKG]
DISPNAMEFont=arial,8,N
DISPNAMEFont color=0, 0, 0
AutoAdjustToText=Yes
Width=4800
Height=3600
Brush color=255 255 255
Fill Color=Yes
Pen=1 0 0, 0, 255
Shadow color=192 192 192
Shadow=No

[DisplayPreferences\Symbol\TABL]
DISPNAMEFont=arial,8,N
DISPNAMEFont color=0, 0, 0
TableColumnsFont=arial,8,N
TableColumnsFont color=0, 0, 0
TablePkColumnsFont=arial,8,N
TablePkColumnsFont color=0, 0, 0
TableIndexsFont=arial,8,N
TableIndexsFont color=0, 0, 0
TableKeysFont=arial,8,N
TableKeysFont color=0, 0, 0
TableTriggersFont=arial,8,N
TableTriggersFont color=0, 0, 0
AutoAdjustToText=Yes
Width=4800
Height=3600
Brush color=255 255 255
Fill Color=Yes
Pen=1 0 0, 0, 255
Shadow color=192 192 192
Shadow=No

[DisplayPreferences\Symbol\REFR]
DISPNAMEFont=arial,8,N
DISPNAMEFont color=0, 0, 0
CARDFont=arial,8,N
CARDFont color=0, 0, 0
Line style=0
Brush color=255 255 255
Fill Color=Yes
Pen=1 0 0, 0, 255
Shadow color=192 192 192
Shadow=No

[DisplayPreferences\Symbol\VREF]
DISPNAMEFont=arial,8,N
DISPNAMEFont color=0, 0, 0
Line style=0
Brush color=255 255 255
Fill Color=Yes
Pen=1 0 0, 0, 255
Shadow color=192 192 192
Shadow=No

[DisplayPreferences\Symbol\VIEW]
DISPNAMEFont=arial,8,N
DISPNAMEFont color=0, 0, 0
ViewColumnnFont=arial,8,N
ViewColumnnFont color=0, 0, 0
ViewTablesFont=arial,8,N
ViewTablesFont color=0, 0, 0
AutoAdjustToText=Yes
Width=4800
Height=3600
Brush color=255 255 255
Fill Color=Yes
Pen=1 0 0, 0, 255
Shadow color=192 192 192
Shadow=No

[DisplayPreferences\Symbol\FILO]
NAMEFont=arial,8,N
NAMEFont color=0, 0, 0
AutoAdjustToText=Yes
Width=2400
Height=2400
Brush color=255 255 255
Fill Color=No
Pen=1 0 0, 0, 255
Shadow color=192 192 192
Shadow=No

[DisplayPreferences\Symbol\USRDEPD]
OBJXSTRFont=arial,8,N
OBJXSTRFont color=0, 0, 0
Line style=0
Brush color=255 255 255
Fill Color=Yes
Pen=2 0 0 0 0
Shadow color=192 192 192
Shadow=No

[DisplayPreferences\Symbol\Free Symbol]
Free TextFont=arial,8,N
Free TextFont color=0, 0, 0
Line style=0
Brush color=255 255 255
Fill Color=Yes
Pen=1 0 0, 0, 255
Shadow color=192 192 192
Shadow=No
</a:DisplayPreferences>
<a:PaperSize>(8268, 11689)</a:PaperSize>
<a:PageMargins>((315,354), (433,354))</a:PageMargins>
<a:PageSize>9</a:PageSize>
<a:PaperSource>7</a:PaperSource>
<c:Symbols>
<o:ReferenceSymbol Id="o5">
<a:CenterTextOffset>(2, 0)</a:CenterTextOffset>
<a:Rect>((-702151,698400), (-694277,709800))</a:Rect>
<a:ListOfPoints>((-698216,698400),(-698216,709800))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>128</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Id="o6">
<a:Rect>((-701800,695198), (-695174,698798))</a:Rect>
<a:LineColor>128</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o7">
<a:ObjectID>6958BDA1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HBV</a:Name>
<a:Code>T_HBV</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o8">
<a:ObjectID>6958BDC9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_HBX</a:Name>
<a:Code>CD_HBX</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o9">
<a:ObjectID>6958BDCA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_HBX_SEQ</a:Name>
<a:Code>NR_HBX_SEQ</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o10">
<a:ObjectID>6958BDCB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_BOX</a:Name>
<a:Code>CD_BOX</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o11">
<a:ObjectID>6958BDCC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_HBV</a:Name>
<a:Code>QT_HBV</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>float(15)</a:DataType>
<a:Length>15</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o12">
<a:ObjectID>6958BDCD-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_HBV</a:Name>
<a:Code>Pk_T_HBV</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_HBV</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o8"/>
<o:Column Ref="o9"/>
<o:Column Ref="o10"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Owner>
<o:User Id="o13">
<a:ObjectID>6958BD00-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>dbo</a:Name>
<a:Code>dbo</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
</o:User>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o14">
<a:ObjectID>6958BD6D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HBV_TRI</a:Name>
<a:Code>T_HBV_TRI</a:Code>
<a:Text>Create Trigger T_HBV_TRI On T_HBV
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Box»Hotran - Box x Vôo: Boxes do BOX x VÔO */
If (Select Count(*) From T_BOX, Inserted
Where T_BOX.CD_BOX = Inserted.CD_BOX)
 &lt;&gt;(Select Count(CD_BOX) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Box&gt; que se deseja incluir na tabela &lt;Hotran - Box x Vôo&gt; não está cadastrada&#39;
  Return
End
/* Hotran - Boxes»Hotran - Box x Vôo: Vôos do BOX x VÔO */
If (Select Count(*) From T_HBX001, Inserted
Where T_HBX001.CD_HBX = Inserted.CD_HBX
  And T_HBX001.NR_HBX_SEQ = Inserted.NR_HBX_SEQ)
 &lt;&gt;(Select Count(CD_HBX) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Hotran - Boxes&gt; que se deseja incluir na tabela &lt;Hotran - Box x Vôo&gt; não está cadastrada&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o15">
<a:ObjectID>6958BD6F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HBV_TRU</a:Name>
<a:Code>T_HBV_TRU</a:Code>
<a:Text>Create Trigger T_HBV_TRU On T_HBV
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_HBX)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Hotran - Boxes&gt; da tabela &lt;Hotran - Box x Vôo&gt; não pode ser alterada.&#39;
  Return
End
If Update (NR_HBX_SEQ)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Sequencial da Programação&gt; da tabela &lt;Hotran - Box x Vôo&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_BOX)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Box&gt; da tabela &lt;Hotran - Box x Vôo&gt; não pode ser alterada.&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o12"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o16">
<a:Rect>((-703845,708122), (-697141,712668))</a:Rect>
<a:LineColor>128</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o17">
<a:ObjectID>6958BD58-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_BOX</a:Name>
<a:Code>T_BOX</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081694139</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o18">
<a:ObjectID>6958BD37-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_BOX</a:Name>
<a:Code>CD_BOX</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o19">
<a:ObjectID>6958BD39-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_BOX</a:Name>
<a:Code>NR_BOX</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(4)</a:DataType>
<a:Length>4</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o20">
<a:ObjectID>6958BD3B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_BOX</a:Name>
<a:Code>TP_BOX</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o21">
<a:ObjectID>6958BD3D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_BOX_PES</a:Name>
<a:Code>QT_BOX_PES</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_ZRO    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_ZRO As
0</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o22">
<a:ObjectID>6958BD3F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_BOX_CON</a:Name>
<a:Code>FL_BOX_CON</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_ZRO    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_ZRO As
0</a:DefaultValue>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o23">
<a:ObjectID>6958BD41-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_BOX_PAX</a:Name>
<a:Code>FL_BOX_PAX</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o24">
<a:ObjectID>6958BD43-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_BOX_CRG</a:Name>
<a:Code>FL_BOX_CRG</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o25">
<a:ObjectID>6958BD45-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_DOM</a:Name>
<a:Code>FT_BOX_DOM</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o26">
<a:ObjectID>6958BD47-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_INT</a:Name>
<a:Code>FT_BOX_INT</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o27">
<a:ObjectID>6958BD4A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_REG</a:Name>
<a:Code>FT_BOX_REG</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o28">
<a:ObjectID>6958BD4C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_PAX</a:Name>
<a:Code>FT_BOX_PAX</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o29">
<a:ObjectID>6958BD4E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_CRG</a:Name>
<a:Code>FT_BOX_CRG</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o30">
<a:ObjectID>6958BD4F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_MIS</a:Name>
<a:Code>FT_BOX_MIS</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o31">
<a:ObjectID>6958BD50-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_TSL</a:Name>
<a:Code>FT_BOX_TSL</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o32">
<a:ObjectID>6958BD51-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_RGL</a:Name>
<a:Code>FT_BOX_RGL</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o33">
<a:ObjectID>6958BD52-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_CHT</a:Name>
<a:Code>FT_BOX_CHT</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o34">
<a:ObjectID>6958BD53-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_TEC</a:Name>
<a:Code>FT_BOX_TEC</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o35">
<a:ObjectID>6958BD54-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_AVG</a:Name>
<a:Code>FT_BOX_AVG</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o36">
<a:ObjectID>6958BD55-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_MLT</a:Name>
<a:Code>FT_BOX_MLT</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o37">
<a:ObjectID>6958BD56-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_NRG</a:Name>
<a:Code>FT_BOX_NRG</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o38">
<a:ObjectID>6958BD57-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_TXA</a:Name>
<a:Code>FT_BOX_TXA</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o39">
<a:ObjectID>6958BD59-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o40">
<a:ObjectID>6958BD61-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_BOX</a:Name>
<a:Code>Pk_T_BOX</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_BOX</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o18"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o41">
<a:ObjectID>6958BD5A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_BOX_AER</a:Name>
<a:Code>I_BOX_AER</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081694139</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o42">
<a:ObjectID>6958BD5B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o19"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o43">
<a:ObjectID>6958BD5D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_AER</a:Name>
<a:Code>I_AER</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081694139</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
</o:Index>
<o:Index Id="o44">
<a:ObjectID>6958BD5E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_BOX_TP</a:Name>
<a:Code>I_BOX_TP</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o45">
<a:ObjectID>6958BD5F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o20"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Ref="o13"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o46">
<a:ObjectID>6958BCD2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_BOX_TRD</a:Name>
<a:Code>T_BOX_TRD</a:Code>
<a:Text>Create Trigger T_BOX_TRD On T_BOX
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Box»Chegadas - Mirror: Box da Chegada (Restrict) */
If (Select Count(*) From T_CHG_MIR dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Box&gt; está sendo referenciada na tabela &lt;Chegadas - Mirror&gt;&#39;
  Return
End
/* Box»Chegadas: Box da Chegada (Restrict) */
If (Select Count(*) From T_CHG dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Box&gt; está sendo referenciada na tabela &lt;Chegadas&gt;&#39;
  Return
End
/* Box»Hotran - Boxes: Box do Hotran (Restrict) */
If (Select Count(*) From T_HBX001 dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Box&gt; está sendo referenciada na tabela &lt;Hotran - Boxes&gt;&#39;
  Return
End
/* Box»Histórico de Permanência de Aeronaves - Mirror: Box do HPA (Restrict) */
If (Select Count(*) From T_HPA001_MIR dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Box&gt; está sendo referenciada na tabela &lt;Histórico de Permanência de Aeronaves - Mirror&gt;&#39;
  Return
End
/* Box»Histórico de Permanência de Aeronaves: Box do HPA (Restrict) */
If (Select Count(*) From T_HPA001 dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Box&gt; está sendo referenciada na tabela &lt;Histórico de Permanência de Aeronaves&gt;&#39;
  Return
End
/* Box»Boxes da Companhia Aérea: Boxes da Companhia Aérea (Restrict) */
If (Select Count(*) From T_BCO dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Box&gt; está sendo referenciada na tabela &lt;Boxes da Companhia Aérea&gt;&#39;
  Return
End
/* Box»Boxes do Equipamento: Boxes do Equipamento (Restrict) */
If (Select Count(*) From T_BEQ dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Box&gt; está sendo referenciada na tabela &lt;Boxes do Equipamento&gt;&#39;
  Return
End
/* Box»Hotran - Frequência: É Box da Frequencia (Restrict) */
If (Select Count(*) From T_HFR dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Box&gt; está sendo referenciada na tabela &lt;Hotran - Frequência&gt;&#39;
  Return
End
/* Box»Capacidades do Box: Box da Capacidade do Box (Cascade) */
Delete T_BCP From T_BCP dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX
/* Box»Hotran - Box x Vôo: Boxes do BOX x VÔO (Cascade) */
Delete T_HBV From T_HBV dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX
/* Box»Boxes Indisponíveis: Indisponibilidade de Box (Cascade) */
Delete T_BIN From T_BIN dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX
End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o47">
<a:ObjectID>6958BCD3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_BOX_TRI</a:Name>
<a:Code>T_BOX_TRI</a:Code>
<a:Text>Create Trigger T_BOX_TRI On T_BOX
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Aeroporto»Box: Aeroporto possui Boxes */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Box&gt; não está cadastrada&#39;
  Return
End
/* Domínio de: Tipo de Box */
/* 1 - Estadia */
/* 2 - Isento */
/* 3 - Pátio */
/* 9 - Controle */
If (Select Count(*) From Inserted
    Where TP_BOX In (1,2,3,9))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Tipo de Box&gt; que se deseja incluir na tabela &lt;Box&gt; não é uma opção válida&#39;
  Return
End
/* Regra de negócio */
/* Não pode existir mais de um box do tipo Controle (9) */
IF (	SELECT 	COUNT(*) 
	FROM 	T_BOX BOX,
		INSERTED INS
	WHERE 	BOX.CD_AER = INS.CD_AER AND
		INS.TP_BOX = 9 AND 
		BOX.TP_BOX = 9) &gt; 1
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Só pode existir um único box do tipo &lt;Controle&gt;.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o48">
<a:ObjectID>6958BCD4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_BOX_TRU</a:Name>
<a:Code>T_BOX_TRU</a:Code>
<a:Text>Create Trigger T_BOX_TRU On T_BOX
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_BOX)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Box&gt; da tabela &lt;Box&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_AER)
/* Aeroporto»Box: Aeroporto possui Boxes */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Box&gt; não está cadastrada&#39;
  Return
End
If Update (TP_BOX)
/* Domínio de: Tipo de Box */
/* 1 - Estadia */
/* 2 - Isento */
/* 3 - Pátio */
/* 9 - Controle */
If (Select Count(*) From Inserted
    Where TP_BOX In (1,2,3,9))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Tipo de Box&gt; que se deseja incluir na tabela &lt;Box&gt; não é uma opção válida&#39;
  Return
End
/* Regra de negócio */
/* Não pode existir mais de um box do tipo Controle (9) */
IF (	SELECT 	COUNT(*) 
	FROM 	T_BOX BOX,
		INSERTED INS
	WHERE 	BOX.CD_AER = INS.CD_AER AND
		INS.TP_BOX = 9 AND 
		BOX.TP_BOX = 9) &gt; 1
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Só pode existir um único box do tipo &lt;Controle&gt;.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

IF UPDATE(NR_BOX)
BEGIN
	/* Incluir Registros em T_ACH */
	INSERT	T_ACH (DH_ACH, CD_CHG)
	Select 	GETDATE(), CHG.CD_CHG
	From 	T_CHG CHG, T_HPA001 HPA, INSERTED INS
	Where 	CHG.TP_CHG_STA = 1 AND
		CHG.CD_AER = (Select CD_AER From T_PSI) AND
		CHG.CD_CHG = HPA.CD_CHG AND
		HPA.NR_HPA_SEQ = 1 AND
		HPA.CD_BOX = INS.CD_BOX

	/* Incluir Registros em T_APA */
	INSERT	T_APA (DH_APA, CD_PAR)
	Select 	GETDATE(), PAR.CD_PAR
	From 	T_PAR PAR, T_HPA001 HPA, INSERTED INS
	Where 	PAR.TP_PAR_STA = 1 AND
		PAR.CD_AER = (Select CD_AER From T_PSI) AND
		PAR.CD_PAR = HPA.CD_PAR AND
		HPA.NR_HPA_SEQ = (SELECT MAX(NR_HPA_SEQ) FROM T_HPA001 WHERE CD_HPA = HPA.CD_HPA) AND
		HPA.CD_BOX = INS.CD_BOX

	/* Incluir Registros em T_AHO */
	INSERT	T_AHO (CD_HOT, DH_AHO)
	Select	DISTINCT CD_HOT, GETDATE()
	From	T_HFR HFR, INSERTED INS
	Where	HFR.CD_BOX = INS.CD_BOX
END

IF UPDATE(NR_BOX) OR UPDATE(TP_BOX)
BEGIN
	/* Incluir Registros em T_AHP */
	INSERT	T_AHP (CD_HPA, DH_AHP)
	Select	DISTINCT CD_HPA, GETDATE()
	From	T_HPA001 HPA, T_CHG CHG, T_SIT SIT, INSERTED INS
	Where	HPA.CD_CHG = CHG.CD_CHG AND
		SIT.CD_SIT = CHG.CD_SIT AND
		HPA.CD_AER = (Select CD_AER From T_PSI) AND
		(HPA.FL_HPA_ENT = 1 OR SIT.FL_SIT_AEN_PAT = 1) AND
		HPA.FL_HPA_SAI = 0 AND 
		HPA.CD_AEN IS NOT NULL AND
		HPA.CD_BOX = INS.CD_BOX
END

End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o40"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o49">
<a:ObjectID>6958BD19-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_5</a:Name>
<a:Code>REFERENCE_5</a:Code>
<a:CreationDate>1081540974</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540974</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o17"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o7"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o40"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o50">
<a:ObjectID>6958BD1A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540974</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540974</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o18"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o10"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o51">
<a:Rect>((-712466,686550), (-699416,710400))</a:Rect>
<a:ListOfPoints>((-712466,686550),(-699416,710400))</a:ListOfPoints>
<a:ArrowStyle>4881</a:ArrowStyle>
<a:LineColor>128</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Id="o52">
<a:Rect>((-715265,683287), (-707249,687834))</a:Rect>
<a:LineColor>4210816</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o53">
<a:ObjectID>6958BDA4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HBX001</a:Name>
<a:Code>T_HBX001</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081694471</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o54">
<a:ObjectID>6958BDCE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_HBX</a:Name>
<a:Code>CD_HBX</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o55">
<a:ObjectID>6958BDCF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_HBX_SEQ</a:Name>
<a:Code>NR_HBX_SEQ</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o56">
<a:ObjectID>6958BDD0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_BOX</a:Name>
<a:Code>CD_BOX</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o57">
<a:ObjectID>6958BD8E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_EQP</a:Name>
<a:Code>CD_EQP</a:Code>
<a:CreationDate>1081694471</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081694471</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o58">
<a:ObjectID>6958BDD2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SG_EQP</a:Name>
<a:Code>SG_EQP</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(10)</a:DataType>
<a:Length>10</a:Length>
</o:Column>
<o:Column Id="o59">
<a:ObjectID>6958BDD3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DH_HBX_ENT</a:Name>
<a:Code>DH_HBX_ENT</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>smalldatetime</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o60">
<a:ObjectID>6958BDD4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DH_HBX_SAI</a:Name>
<a:Code>DH_HBX_SAI</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>smalldatetime</a:DataType>
</o:Column>
<o:Column Id="o61">
<a:ObjectID>6958BDD5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DT_HBX_CHG</a:Name>
<a:Code>DT_HBX_CHG</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_DAT    Script Date: 7/8/2000 12:14:35 ******/
Create Rule        RU_DAT As
DATEPART(hh,@data) = 0 AND
DATEPART(mi,@data) = 0 AND
DATEPART(ss,@data) = 0 AND
DATEPART(ms,@data) = 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>smalldatetime</a:DataType>
</o:Column>
<o:Column Id="o62">
<a:ObjectID>6958BDD6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DH_HBX_CHG</a:Name>
<a:Code>DH_HBX_CHG</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>smalldatetime</a:DataType>
</o:Column>
<o:Column Id="o63">
<a:ObjectID>6958BDD7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_HBX_VER_CHG</a:Name>
<a:Code>QT_HBX_VER_CHG</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>smallint</a:DataType>
</o:Column>
<o:Column Id="o64">
<a:ObjectID>6958BDD8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_HOT_CHG</a:Name>
<a:Code>CD_HOT_CHG</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(7)</a:DataType>
<a:Length>7</a:Length>
</o:Column>
<o:Column Id="o65">
<a:ObjectID>6958BDD9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_HVE_CHG</a:Name>
<a:Code>CD_HVE_CHG</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(3)</a:DataType>
<a:Length>3</a:Length>
</o:Column>
<o:Column Id="o66">
<a:ObjectID>6958BDDA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_HFR_CHG</a:Name>
<a:Code>CD_HFR_CHG</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(1)</a:DataType>
<a:Length>1</a:Length>
</o:Column>
<o:Column Id="o67">
<a:ObjectID>6958BDDB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_HET_CHG</a:Name>
<a:Code>CD_HET_CHG</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(2)</a:DataType>
<a:Length>2</a:Length>
</o:Column>
<o:Column Id="o68">
<a:ObjectID>6958BDDC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DT_HBX_PAR</a:Name>
<a:Code>DT_HBX_PAR</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_DAT    Script Date: 7/8/2000 12:14:35 ******/
Create Rule        RU_DAT As
DATEPART(hh,@data) = 0 AND
DATEPART(mi,@data) = 0 AND
DATEPART(ss,@data) = 0 AND
DATEPART(ms,@data) = 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>smalldatetime</a:DataType>
</o:Column>
<o:Column Id="o69">
<a:ObjectID>6958BDDD-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DH_HBX_PAR</a:Name>
<a:Code>DH_HBX_PAR</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>smalldatetime</a:DataType>
</o:Column>
<o:Column Id="o70">
<a:ObjectID>6958BDDE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_HBX_VER_PAR</a:Name>
<a:Code>QT_HBX_VER_PAR</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>smallint</a:DataType>
</o:Column>
<o:Column Id="o71">
<a:ObjectID>6958BDDF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_HOT_PAR</a:Name>
<a:Code>CD_HOT_PAR</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(7)</a:DataType>
<a:Length>7</a:Length>
</o:Column>
<o:Column Id="o72">
<a:ObjectID>6958BDE0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_HVE_PAR</a:Name>
<a:Code>CD_HVE_PAR</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(3)</a:DataType>
<a:Length>3</a:Length>
</o:Column>
<o:Column Id="o73">
<a:ObjectID>6958BDE1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_HFR_PAR</a:Name>
<a:Code>CD_HFR_PAR</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(1)</a:DataType>
<a:Length>1</a:Length>
</o:Column>
<o:Column Id="o74">
<a:ObjectID>6958BDE2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_HET_PAR</a:Name>
<a:Code>CD_HET_PAR</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(2)</a:DataType>
<a:Length>2</a:Length>
</o:Column>
<o:Column Id="o75">
<a:ObjectID>6958BDE3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_HBX_OK</a:Name>
<a:Code>FL_HBX_OK</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.Zero    Script Date: 7/8/2000 12:14:36 ******/
Create Default        Zero As
0</a:DefaultValue>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o76">
<a:ObjectID>6958BDE4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o77">
<a:ObjectID>6958BDE5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_HBX001</a:Name>
<a:Code>Pk_T_HBX001</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_HBX001</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o54"/>
<o:Column Ref="o55"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Owner>
<o:User Ref="o13"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o78">
<a:ObjectID>6958BD71-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HBX001_TRD</a:Name>
<a:Code>T_HBX001_TRD</a:Code>
<a:Text>Create Trigger T_HBX001_TRD On T_HBX001
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Hotran - Boxes»Hotran - Box x Vôo: Vôos do BOX x VÔO (Cascade) */
Delete T_HBV From T_HBV dep, Deleted pri
 Where dep.CD_HBX = pri.CD_HBX
   And dep.NR_HBX_SEQ = pri.NR_HBX_SEQ
/* Regra de negócio */
/* Forçar a execução da trigger de UPDATE */
UPDATE	HBX
SET	NR_HBX_SEQ = HBX.NR_HBX_SEQ
FROM	T_HBX001 HBX, DELETED DEL
WHERE 	HBX.CD_HBX = DEL.CD_HBX

End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o79">
<a:ObjectID>6958BD73-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HBX001_TRI</a:Name>
<a:Code>T_HBX001_TRI</a:Code>
<a:Text>Create Trigger T_HBX001_TRI On T_HBX001
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Equipamento»Hotran - Boxes: Equipamento do HBX */
If (Select Count(*) From T_EQP, Inserted
Where T_EQP.SG_EQP = Inserted.SG_EQP)
 &lt;&gt;(Select Count(SG_EQP) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Equipamento&gt; que se deseja incluir na tabela &lt;Hotran - Boxes&gt; não está cadastrada&#39;
  Return
End
/* Box»Hotran - Boxes: Box do Hotran */
If (Select Count(*) From T_BOX, Inserted
Where T_BOX.CD_BOX = Inserted.CD_BOX)
 &lt;&gt;(Select Count(CD_BOX) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Box&gt; que se deseja incluir na tabela &lt;Hotran - Boxes&gt; não está cadastrada&#39;
  Return
End
/* Hotran - Etapa»Hotran - Boxes: É Etapa de Chegada */
If (Select Count(*) From T_HET, Inserted
Where T_HET.CD_HET = Inserted.CD_HET_CHG
  And T_HET.CD_HOT = Inserted.CD_HOT_CHG
  And T_HET.CD_HVE = Inserted.CD_HVE_CHG
  And T_HET.CD_HFR = Inserted.CD_HFR_CHG)
 &lt;&gt;(Select Count(CD_HET_CHG) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Hotran - Etapa&gt; que se deseja incluir na tabela &lt;Hotran - Boxes&gt; não está cadastrada&#39;
  Return
End
/* Hotran - Etapa»Hotran - Boxes: É Etapa de Partida */
If (Select Count(*) From T_HET, Inserted
Where T_HET.CD_HET = Inserted.CD_HET_PAR
  And T_HET.CD_HOT = Inserted.CD_HOT_PAR
  And T_HET.CD_HVE = Inserted.CD_HVE_PAR
  And T_HET.CD_HFR = Inserted.CD_HFR_PAR)
 &lt;&gt;(Select Count(CD_HET_PAR) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Hotran - Etapa&gt; que se deseja incluir na tabela &lt;Hotran - Boxes&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
/* Forçar a execução da trigger de UPDATE */
UPDATE	HBX
SET	NR_HBX_SEQ = HBX.NR_HBX_SEQ,
	CD_BOX = HBX.CD_BOX,
	SG_EQP = HBX1.SG_EQP,
	DH_HBX_ENT = HBX.DH_HBX_ENT,
	DH_HBX_SAI = HBX.DH_HBX_SAI,
	DT_HBX_CHG = HBX1.DT_HBX_CHG,
	QT_HBX_VER_CHG = HBX1.QT_HBX_VER_CHG,
	CD_HOT_CHG = HBX1.CD_HOT_CHG,
	CD_HVE_CHG = HBX1.CD_HVE_CHG,
	CD_HFR_CHG = HBX1.CD_HFR_CHG,
	CD_HET_CHG = HBX1.CD_HET_CHG,
	DT_HBX_PAR = HBX1.DT_HBX_PAR,
	DH_HBX_PAR = HBX1.DH_HBX_PAR,
	QT_HBX_VER_PAR = HBX1.QT_HBX_VER_PAR,
	CD_HOT_PAR = HBX1.CD_HOT_PAR,
	CD_HVE_PAR = HBX1.CD_HVE_PAR,
	CD_HFR_PAR = HBX1.CD_HFR_PAR,
	CD_HET_PAR = HBX1.CD_HET_PAR,
	FL_HBX_OK = HBX.FL_HBX_OK
FROM	T_HBX001 HBX, INSERTED INS, T_HBX001 HBX1
WHERE 	HBX.CD_HBX = INS.CD_HBX AND
	HBX.NR_HBX_SEQ = INS.NR_HBX_SEQ AND
	HBX1.CD_HBX = INS.CD_HBX AND
	HBX1.NR_HBX_SEQ = 1

End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o80">
<a:ObjectID>6958BD75-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HBX001_TRU</a:Name>
<a:Code>T_HBX001_TRU</a:Code>
<a:Text>Create Trigger T_HBX001_TRU On T_HBX001
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_HBX)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Hotran - Boxes&gt; da tabela &lt;Hotran - Boxes&gt; não pode ser alterada.&#39;
  Return
End
If Update (SG_EQP)
/* Equipamento»Hotran - Boxes: Equipamento do HBX */
If (Select Count(*) From T_EQP, Inserted
Where T_EQP.SG_EQP = Inserted.SG_EQP)
 &lt;&gt;(Select Count(SG_EQP) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Equipamento&gt; que se deseja incluir na tabela &lt;Hotran - Boxes&gt; não está cadastrada&#39;
  Return
End
If Update (CD_BOX)
/* Box»Hotran - Boxes: Box do Hotran */
If (Select Count(*) From T_BOX, Inserted
Where T_BOX.CD_BOX = Inserted.CD_BOX)
 &lt;&gt;(Select Count(CD_BOX) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Box&gt; que se deseja incluir na tabela &lt;Hotran - Boxes&gt; não está cadastrada&#39;
  Return
End
If Update (CD_HET_CHG)
Or Update (CD_HOT_CHG)
Or Update (CD_HVE_CHG)
Or Update (CD_HFR_CHG)
/* Hotran - Etapa»Hotran - Boxes: É Etapa de Chegada */
If (Select Count(*) From T_HET, Inserted
Where T_HET.CD_HET = Inserted.CD_HET_CHG
  And T_HET.CD_HOT = Inserted.CD_HOT_CHG
  And T_HET.CD_HVE = Inserted.CD_HVE_CHG
  And T_HET.CD_HFR = Inserted.CD_HFR_CHG)
 &lt;&gt;(Select Count(CD_HET_CHG) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Hotran - Etapa&gt; que se deseja incluir na tabela &lt;Hotran - Boxes&gt; não está cadastrada&#39;
  Return
End
If Update (CD_HET_PAR)
Or Update (CD_HOT_PAR)
Or Update (CD_HVE_PAR)
Or Update (CD_HFR_PAR)
/* Hotran - Etapa»Hotran - Boxes: É Etapa de Partida */
If (Select Count(*) From T_HET, Inserted
Where T_HET.CD_HET = Inserted.CD_HET_PAR
  And T_HET.CD_HOT = Inserted.CD_HOT_PAR
  And T_HET.CD_HVE = Inserted.CD_HVE_PAR
  And T_HET.CD_HFR = Inserted.CD_HFR_PAR)
 &lt;&gt;(Select Count(CD_HET_PAR) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Hotran - Etapa&gt; que se deseja incluir na tabela &lt;Hotran - Boxes&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
/* Ordenar o atributo NR_HBX_SEQ com base na hora de entrada */

IF UPDATE(NR_HBX_SEQ)
UPDATE	HBX
SET	NR_HBX_SEQ = (SELECT COUNT(*) FROM T_HBX001 HBX1 WHERE HBX1.CD_HBX = HBX.CD_HBX AND HBX1.DH_HBX_ENT &lt;= HBX.DH_HBX_ENT)
FROM	T_HBX001 HBX
WHERE	HBX.CD_HBX IN (SELECT DISTINCT CD_HBX FROM INSERTED)


/* Atualizar a data da saída com a data da entrada do movimento subseqüente. O último deve ser atualizado com a data/hora
   do vôo de partida */

UPDATE	HBX
SET	DH_HBX_SAI = ISNULL((	SELECT 	MIN(DH_HBX_ENT)
					FROM 	T_HBX001 HBX1
					WHERE	HBX1.CD_HBX = HBX.CD_HBX AND
						HBX1.DH_HBX_ENT &gt; HBX.DH_HBX_ENT),  DH_HBX_PAR),
	FL_HBX_OK = 1
FROM	T_HBX001 HBX
WHERE	HBX.CD_HBX IN (SELECT DISTINCT CD_HBX FROM INSERTED)

/* Verificar se a data de entrada do primeiro HBX é igual à data de chegada do vôo */
IF (	SELECT 	COUNT(*) FROM T_HBX001 HBX
	WHERE 	CD_HBX IN (SELECT DISTINCT CD_HBX FROM INSERTED) AND
		NR_HBX_SEQ = 1 AND
		DH_HBX_ENT &lt;&gt; DH_HBX_CHG) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: A hora de entrada no primeiro box tem de ser igual à hora de chegada do vôo.&#39;
	ROLLBACK TRANSACTION
	RETURN
END


End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o77"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o16"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o81">
<a:ObjectID>6958BD1B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_6</a:Name>
<a:Code>REFERENCE_6</a:Code>
<a:CreationDate>1081540974</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540974</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o17"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o53"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o40"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o82">
<a:ObjectID>6958BD1C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540974</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540974</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o18"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o56"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o83">
<a:CenterTextOffset>(3, 0)</a:CenterTextOffset>
<a:Rect>((-715466,695250), (-701516,710550))</a:Rect>
<a:ListOfPoints>((-715466,695250),(-701516,710550))</a:ListOfPoints>
<a:ArrowStyle>4881</a:ArrowStyle>
<a:LineColor>128</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Id="o84">
<a:Rect>((-720017,694675), (-713469,699221))</a:Rect>
<a:LineColor>4210816</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o85">
<a:ObjectID>6958BDAB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HFR</a:Name>
<a:Code>T_HFR</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o86">
<a:ObjectID>6958BCD6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_HOT</a:Name>
<a:Code>CD_HOT</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(7)</a:DataType>
<a:Length>7</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o87">
<a:ObjectID>6958BCD7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_HVE</a:Name>
<a:Code>CD_HVE</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(3)</a:DataType>
<a:Length>3</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o88">
<a:ObjectID>6958BCD8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_HFR</a:Name>
<a:Code>CD_HFR</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(1)</a:DataType>
<a:Length>1</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o89">
<a:ObjectID>6958BCD9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DS_HFR</a:Name>
<a:Code>DS_HFR</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(7)</a:DataType>
<a:Length>7</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o90">
<a:ObjectID>6958BCDA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_POR</a:Name>
<a:Code>CD_POR</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o91">
<a:ObjectID>6958BCDB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_BOX</a:Name>
<a:Code>CD_BOX</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o92">
<a:ObjectID>6958BCDC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_EST</a:Name>
<a:Code>CD_EST</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o93">
<a:ObjectID>6958BCDD-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o94">
<a:ObjectID>6958BCDF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_HFR</a:Name>
<a:Code>Pk_T_HFR</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_HFR</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o86"/>
<o:Column Ref="o87"/>
<o:Column Ref="o88"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Owner>
<o:User Ref="o13"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o95">
<a:ObjectID>6958BD82-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HFR_TRD</a:Name>
<a:Code>T_HFR_TRD</a:Code>
<a:Text>Create Trigger T_HFR_TRD On T_HFR
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Hotran - Frequência»Hotran - Check in: Check-ins da Frequência (Cascade) */
Delete T_HCK From T_HCK dep, Deleted pri
 Where dep.CD_HFR = pri.CD_HFR
   And dep.CD_HVE = pri.CD_HVE
   And dep.CD_HOT = pri.CD_HOT
/* Hotran - Frequência»Hotran - Etapa: Etapas da Freqüência (Cascade) */
Delete T_HET From T_HET dep, Deleted pri
 Where dep.CD_HFR = pri.CD_HFR
   And dep.CD_HVE = pri.CD_HVE
   And dep.CD_HOT = pri.CD_HOT
/* Regra de negócio */
/* INCLUIR REGISTROS EM T_AHO */
INSERT	T_AHO (CD_HOT, DH_AHO)
SELECT 	DISTINCT CD_HOT, GETDATE() FROM DELETED

End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o96">
<a:ObjectID>6958BD85-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HFR_TRI</a:Name>
<a:Code>T_HFR_TRI</a:Code>
<a:Text>Create Trigger T_HFR_TRI On T_HFR
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Esteira»Hotran - Frequência: É Esteira da Frequência */
If (Select Count(*) From T_EST, Inserted
Where T_EST.CD_EST = Inserted.CD_EST)
 &lt;&gt;(Select Count(CD_EST) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Esteira&gt; que se deseja incluir na tabela &lt;Hotran - Frequência&gt; não está cadastrada&#39;
  Return
End
/* Box»Hotran - Frequência: É Box da Frequencia */
If (Select Count(*) From T_BOX, Inserted
Where T_BOX.CD_BOX = Inserted.CD_BOX)
 &lt;&gt;(Select Count(CD_BOX) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Box&gt; que se deseja incluir na tabela &lt;Hotran - Frequência&gt; não está cadastrada&#39;
  Return
End
/* Portão»Hotran - Frequência: É Portão da Frequencia */
If (Select Count(*) From T_POR, Inserted
Where T_POR.CD_POR = Inserted.CD_POR)
 &lt;&gt;(Select Count(CD_POR) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Portão&gt; que se deseja incluir na tabela &lt;Hotran - Frequência&gt; não está cadastrada&#39;
  Return
End
/* Hotran - Versão»Hotran - Frequência: Freqüências da Versão */
If (Select Count(*) From T_HVE, Inserted
Where T_HVE.CD_HVE = Inserted.CD_HVE
  And T_HVE.CD_HOT = Inserted.CD_HOT)
 &lt;&gt;(Select Count(CD_HVE) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Hotran - Versão&gt; que se deseja incluir na tabela &lt;Hotran - Frequência&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
/* Provocar a execução da trigger de update */
UPDATE	T_HFR
SET	DS_HFR = DS_HFR,
	CD_POR = CD_POR,
	CD_BOX = CD_BOX,
	CD_EST = CD_EST
WHERE	CD_HOT + CD_HVE + CD_HFR IN (SELECT CD_HOT + CD_HVE + CD_HFR FROM INSERTED)

End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o97">
<a:ObjectID>6958BD88-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HFR_TRU</a:Name>
<a:Code>T_HFR_TRU</a:Code>
<a:Text>Create Trigger T_HFR_TRU On T_HFR
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_HOT)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Hotran&gt; da tabela &lt;Hotran - Frequência&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_HVE)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código da versão do Hotran à qual pertence esta freqüência&gt; da tabela &lt;Hotran - Frequência&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_HFR)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código da Freqüência do Hotran&gt; da tabela &lt;Hotran - Frequência&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_EST)
/* Esteira»Hotran - Frequência: É Esteira da Frequência */
If (Select Count(*) From T_EST, Inserted
Where T_EST.CD_EST = Inserted.CD_EST)
 &lt;&gt;(Select Count(CD_EST) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Esteira&gt; que se deseja incluir na tabela &lt;Hotran - Frequência&gt; não está cadastrada&#39;
  Return
End
If Update (CD_BOX)
/* Box»Hotran - Frequência: É Box da Frequencia */
If (Select Count(*) From T_BOX, Inserted
Where T_BOX.CD_BOX = Inserted.CD_BOX)
 &lt;&gt;(Select Count(CD_BOX) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Box&gt; que se deseja incluir na tabela &lt;Hotran - Frequência&gt; não está cadastrada&#39;
  Return
End
If Update (CD_POR)
/* Portão»Hotran - Frequência: É Portão da Frequencia */
If (Select Count(*) From T_POR, Inserted
Where T_POR.CD_POR = Inserted.CD_POR)
 &lt;&gt;(Select Count(CD_POR) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Portão&gt; que se deseja incluir na tabela &lt;Hotran - Frequência&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
/* Declarar variáveis */
DECLARE	@DS_HFP		VARCHAR(7),
		@DS_HFP_VIN		VARCHAR(7)

/* Verificar se há alguma frequência que se repita dentro de uma mesma versão */
IF UPDATE(DS_HFR)
IF EXISTS (	SELECT 	COUNT(*) 
		FROM 	T_HFR
		WHERE 	CD_HOT + CD_HVE IN (SELECT DISTINCT CD_HOT + CD_HVE FROM INSERTED) AND 
			PATINDEX(&#39;%1%&#39;, DS_HFR) &lt;&gt; 0 
		GROUP BY CD_HOT + CD_HVE HAVING COUNT(*) &gt; 1) OR
    EXISTS (	SELECT 	COUNT(*) 
		FROM 	T_HFR
		WHERE 	CD_HOT + CD_HVE IN (SELECT DISTINCT CD_HOT + CD_HVE FROM INSERTED) AND 
			PATINDEX(&#39;%2%&#39;, DS_HFR) &lt;&gt; 0 
		GROUP BY CD_HOT + CD_HVE HAVING COUNT(*) &gt; 1) OR
    EXISTS (	SELECT 	COUNT(*) 
		FROM 	T_HFR
		WHERE 	CD_HOT + CD_HVE IN (SELECT DISTINCT CD_HOT + CD_HVE FROM INSERTED) AND 
			PATINDEX(&#39;%3%&#39;, DS_HFR) &lt;&gt; 0 
		GROUP BY CD_HOT + CD_HVE HAVING COUNT(*) &gt; 1) OR
    EXISTS (	SELECT 	COUNT(*) 
		FROM 	T_HFR
		WHERE 	CD_HOT + CD_HVE IN (SELECT DISTINCT CD_HOT + CD_HVE FROM INSERTED) AND 
			PATINDEX(&#39;%4%&#39;, DS_HFR) &lt;&gt; 0 
		GROUP BY CD_HOT + CD_HVE HAVING COUNT(*) &gt; 1) OR
    EXISTS (	SELECT 	COUNT(*) 
		FROM 	T_HFR
		WHERE 	CD_HOT + CD_HVE IN (SELECT DISTINCT CD_HOT + CD_HVE FROM INSERTED) AND 
			PATINDEX(&#39;%5%&#39;, DS_HFR) &lt;&gt; 0 
		GROUP BY CD_HOT + CD_HVE HAVING COUNT(*) &gt; 1) OR
    EXISTS (	SELECT 	COUNT(*) 
		FROM 	T_HFR
		WHERE 	CD_HOT + CD_HVE IN (SELECT DISTINCT CD_HOT + CD_HVE FROM INSERTED) AND 
			PATINDEX(&#39;%6%&#39;, DS_HFR) &lt;&gt; 0 
		GROUP BY CD_HOT + CD_HVE HAVING COUNT(*) &gt; 1) OR
    EXISTS (	SELECT 	COUNT(*) 
		FROM 	T_HFR
		WHERE 	CD_HOT + CD_HVE IN (SELECT DISTINCT CD_HOT + CD_HVE FROM INSERTED) AND 
			PATINDEX(&#39;%7%&#39;, DS_HFR) &lt;&gt; 0 
		GROUP BY CD_HOT + CD_HVE HAVING COUNT(*) &gt; 1)
BEGIN
	RAISERROR 20999 &#39;Operação não executada: Um dia da semana não pode se repetir em mais de uma freqüência de uma mesma versão.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Incluído por Vêka em 12/09/98 */
/* Impedir que o box seja alterado para Null se houver etapa do hotran para essa freqüência com 
    o aeroporto usuário definido como aeroporto destino. */
IF UPDATE (CD_BOX)
IF (	SELECT 	COUNT(*) 
	FROM 	INSERTED INS, T_AER AER, T_PSI PSI, T_HET HET
	WHERE 	HET.CD_HOT = INS.CD_HOT AND
		HET.CD_HVE = INS.CD_HVE AND
		HET.CD_HFR = INS.CD_HFR AND
		AER.SG_AER_ICA = HET.SG_AER_DES AND
		PSI.CD_AER = AER.CD_AER AND
		HET.TP_HET_CTG NOT IN (3, 4) AND

		INS.CD_BOX IS NULL) &gt;0

BEGIN
	RAISERROR 20999 &#39;Operação não executada: O box deve ser definido, pois existe uma Etapa associada a essa Freqüência com o aeroporto destino igual ao aeroporto usuário do sistema.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* FAZER AS VERIFICAÇÕES RELATIVAS AOS CODE-SHARE */

/* Declaração do cursor */
DECLARE INS_CURSOR CURSOR FOR
	SELECT 	DISTINCT 
		HET.CD_HOT,
		HET.CD_HVE,
		HET.CD_HFR,
		HET.TP_HET_CTG

	FROM	T_HET HET, INSERTED INS
	WHERE	HET.CD_HOT + HET.CD_HVE + HET.CD_HFR = INS.CD_HOT + INS.CD_HVE + INS.CD_HFR
	ORDER BY HET.CD_HOT, HET.CD_HVE, HET.CD_HFR, HET.TP_HET_CTG

/* Declaração das variáveis que receberão o cursor */
DECLARE @CD_HOT	CHAR(7),
	 @CD_HVE	CHAR(3),
	 @CD_HFR	CHAR(1),
	 @TP_HET_CTG	TINYINT

/* Abertura do cursor */
OPEN INS_CURSOR

/* Ir para o primeiro registro */
FETCH	INS_CURSOR
INTO	@CD_HOT,
	@CD_HVE,
	@CD_HFR,
	@TP_HET_CTG

/* Processar todos os registros de INS_CURSOR */
WHILE @@FETCH_STATUS = 0
BEGIN

	EXEC SP_VerificaCodeShare @CD_HOT, @CD_HVE, @CD_HFR, @TP_HET_CTG
	IF @@ERROR &lt;&gt; 0
	BEGIN
		CLOSE INS_CURSOR
		DEALLOCATE INS_CURSOR
		ROLLBACK TRANSACTION
		RETURN
	END


	/* Ir para o próximo registro */
	FETCH	NEXT FROM INS_CURSOR
	INTO	@CD_HOT,
		@CD_HVE,
		@CD_HFR,
		@TP_HET_CTG


END
CLOSE INS_CURSOR
DEALLOCATE INS_CURSOR


/* INCLUIR REGISTROS EM T_AHO */
INSERT	T_AHO (CD_HOT, DH_AHO)
SELECT 	DISTINCT CD_HOT, GETDATE() FROM INSERTED

End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o94"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o16"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o98">
<a:ObjectID>6958BD1D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_7</a:Name>
<a:Code>REFERENCE_7</a:Code>
<a:CreationDate>1081540974</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540974</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o17"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o85"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o40"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o99">
<a:ObjectID>6958BD1E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540974</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540974</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o18"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o91"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o100">
<a:CenterTextOffset>(3, 0)</a:CenterTextOffset>
<a:Rect>((-729825,710850), (-722101,720900))</a:Rect>
<a:ListOfPoints>((-725966,710850),(-725966,720900))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>4210816</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Id="o101">
<a:Rect>((-731079,707612), (-724453,712158))</a:Rect>
<a:LineColor>4210816</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o102">
<a:ObjectID>6958BDA6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HCK</a:Name>
<a:Code>T_HCK</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o103">
<a:ObjectID>6958BDE6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_HOT</a:Name>
<a:Code>CD_HOT</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(7)</a:DataType>
<a:Length>7</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o104">
<a:ObjectID>6958BDE7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_HVE</a:Name>
<a:Code>CD_HVE</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(3)</a:DataType>
<a:Length>3</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o105">
<a:ObjectID>6958BDE8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_HFR</a:Name>
<a:Code>CD_HFR</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(1)</a:DataType>
<a:Length>1</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o106">
<a:ObjectID>6958BDE9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_HCK</a:Name>
<a:Code>CD_HCK</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(1)</a:DataType>
<a:Length>1</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o107">
<a:ObjectID>6958BDEA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_CHK</a:Name>
<a:Code>CD_CHK</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o108">
<a:ObjectID>6958BDEB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_CLS</a:Name>
<a:Code>CD_CLS</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o109">
<a:ObjectID>6958BDED-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o110">
<a:ObjectID>6958BDF8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_HCK</a:Name>
<a:Code>Pk_T_HCK</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_HCK</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o103"/>
<o:Column Ref="o104"/>
<o:Column Ref="o105"/>
<o:Column Ref="o106"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o111">
<a:ObjectID>6958BDF0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_HCK_CHK</a:Name>
<a:Code>I_HCK_CHK</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o112">
<a:ObjectID>6958BDF2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o103"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o113">
<a:ObjectID>6958BDF4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_1&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o104"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o114">
<a:ObjectID>6958BDF6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_2&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o105"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o115">
<a:ObjectID>6958BDF7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_3&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o107"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Ref="o13"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o116">
<a:ObjectID>6958BD76-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HCK_TRD</a:Name>
<a:Code>T_HCK_TRD</a:Code>
<a:Text>Create Trigger T_HCK_TRD On T_HCK
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Regra de negócio */
/* INCLUIR REGISTROS EM T_AHO */
INSERT	T_AHO (CD_HOT, DH_AHO)
SELECT 	DISTINCT CD_HOT, GETDATE() FROM DELETED

End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o117">
<a:ObjectID>6958BD77-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HCK_TRI</a:Name>
<a:Code>T_HCK_TRI</a:Code>
<a:Text>Create Trigger T_HCK_TRI On T_HCK
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Checkin»Hotran - Check in: Check-in do Hotran */
If (Select Count(*) From T_CHK, Inserted
Where T_CHK.CD_CHK = Inserted.CD_CHK)
 &lt;&gt;(Select Count(CD_CHK) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Checkin&gt; que se deseja incluir na tabela &lt;Hotran - Check in&gt; não está cadastrada&#39;
  Return
End
/* Classe de Serviço»Hotran - Check in: Classe do Check-in do Hotran */
If (Select Count(*) From T_CLS, Inserted
Where T_CLS.CD_CLS = Inserted.CD_CLS)
 &lt;&gt;(Select Count(CD_CLS) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Classe de Serviço&gt; que se deseja incluir na tabela &lt;Hotran - Check in&gt; não está cadastrada&#39;
  Return
End
/* Hotran - Frequência»Hotran - Check in: Check-ins da Frequência */
If (Select Count(*) From T_HFR, Inserted
Where T_HFR.CD_HFR = Inserted.CD_HFR
  And T_HFR.CD_HVE = Inserted.CD_HVE
  And T_HFR.CD_HOT = Inserted.CD_HOT)
 &lt;&gt;(Select Count(CD_HFR) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Hotran - Frequência&gt; que se deseja incluir na tabela &lt;Hotran - Check in&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
/* INCLUIR REGISTROS EM T_AHO */
INSERT	T_AHO (CD_HOT, DH_AHO)
SELECT 	DISTINCT CD_HOT, GETDATE() FROM INSERTED

End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o118">
<a:ObjectID>6958BD79-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HCK_TRU</a:Name>
<a:Code>T_HCK_TRU</a:Code>
<a:Text>Create Trigger T_HCK_TRU On T_HCK
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_HOT)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Hotran&gt; da tabela &lt;Hotran - Check in&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_HVE)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código da Versão do Hotran&gt; da tabela &lt;Hotran - Check in&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_HFR)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código da Freqüência do Hotran&gt; da tabela &lt;Hotran - Check in&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_HCK)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Checkin do Hotran&gt; da tabela &lt;Hotran - Check in&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_CHK)
/* Checkin»Hotran - Check in: Check-in do Hotran */
If (Select Count(*) From T_CHK, Inserted
Where T_CHK.CD_CHK = Inserted.CD_CHK)
 &lt;&gt;(Select Count(CD_CHK) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Checkin&gt; que se deseja incluir na tabela &lt;Hotran - Check in&gt; não está cadastrada&#39;
  Return
End
If Update (CD_CLS)
/* Classe de Serviço»Hotran - Check in: Classe do Check-in do Hotran */
If (Select Count(*) From T_CLS, Inserted
Where T_CLS.CD_CLS = Inserted.CD_CLS)
 &lt;&gt;(Select Count(CD_CLS) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Classe de Serviço&gt; que se deseja incluir na tabela &lt;Hotran - Check in&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
/* INCLUIR REGISTROS EM T_AHO */
INSERT	T_AHO (CD_HOT, DH_AHO)
SELECT 	DISTINCT CD_HOT, GETDATE() FROM INSERTED

End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o110"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o119">
<a:Rect>((-730592,718667), (-723966,723213))</a:Rect>
<a:LineColor>4210816</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o120">
<a:ObjectID>6958BD5C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_CHK</a:Name>
<a:Code>T_CHK</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081694089</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o121">
<a:ObjectID>6958BD63-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_CHK</a:Name>
<a:Code>CD_CHK</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o122">
<a:ObjectID>6958BD64-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_CHK</a:Name>
<a:Code>NR_CHK</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(4)</a:DataType>
<a:Length>4</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o123">
<a:ObjectID>6958BD65-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_CHK_ORD</a:Name>
<a:Code>NR_CHK_ORD</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o124">
<a:ObjectID>6958BD66-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o125">
<a:ObjectID>6958BD6A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_CHK</a:Name>
<a:Code>Pk_T_CHK</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_CHK</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o121"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o126">
<a:ObjectID>6958BD67-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_CHK_AER</a:Name>
<a:Code>I_CHK_AER</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081694089</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o127">
<a:ObjectID>6958BD68-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o122"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Ref="o13"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o128">
<a:ObjectID>6958BCDE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_CHK_TRD</a:Name>
<a:Code>T_CHK_TRD</a:Code>
<a:Text>Create Trigger T_CHK_TRD On T_CHK
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Checkin»FIDS - IST Servidor de Informação: Check-in Associado ao IST (Restrict) */
If (Select Count(*) From T_FIDS_IST dep, Deleted pri
 Where dep.CD_CHK = pri.CD_CHK) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Checkin&gt; está sendo referenciada na tabela &lt;FIDS - IST Servidor de Informação&gt;&#39;
  Return
End
/* Checkin»Hotran - Check in: Check-in do Hotran (Restrict) */
If (Select Count(*) From T_HCK dep, Deleted pri
 Where dep.CD_CHK = pri.CD_CHK) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Checkin&gt; está sendo referenciada na tabela &lt;Hotran - Check in&gt;&#39;
  Return
End
/* Checkin»Checkin da Partida de Vôo - Mirror: Check-in integra Check-ins da Partida (Restrict) */
If (Select Count(*) From T_CKV001_MIR dep, Deleted pri
 Where dep.CD_CHK = pri.CD_CHK) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Checkin&gt; está sendo referenciada na tabela &lt;Checkin da Partida de Vôo - Mirror&gt;&#39;
  Return
End
/* Checkin»Checkin da Partida de Vôo: Checkin integra Checkins da Partida (Restrict) */
If (Select Count(*) From T_CKV001 dep, Deleted pri
 Where dep.CD_CHK = pri.CD_CHK) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Checkin&gt; está sendo referenciada na tabela &lt;Checkin da Partida de Vôo&gt;&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o129">
<a:ObjectID>6958BCE0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_CHK_TRI</a:Name>
<a:Code>T_CHK_TRI</a:Code>
<a:Text>Create Trigger T_CHK_TRI On T_CHK
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Aeroporto»Checkin: Aeroporto possui Checkins */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Checkin&gt; não está cadastrada&#39;
  Return
End
/* Companhia Aérea»Checkin: Companhia Aér. possui Checkins */
If (Select Count(*) From T_COM, Inserted
Where T_COM.CD_COM = Inserted.CD_COM)
 &lt;&gt;(Select Count(CD_COM) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Companhia Aérea&gt; que se deseja incluir na tabela &lt;Checkin&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
/* -------------------- Colocado e Comentado por Milena em 22/06/99 --------------------

/* Declaração do cursor */
DECLARE INSCHK CURSOR FOR
	SELECT 	INS.CD_CHK,
		INS.NR_CHK_ORD,
		INS.CD_AER
	FROM	INSERTED INS
	ORDER BY NR_CHK_ORD

/* Declaração das variáveis  */
DECLARE	@CD_CHK	INT,
		@NR_CHK_ORD	INT,
	 	@CD_AER	INT,
		@CD_CHK_ATU 	INT
		 
/* Abertura do cursor */
OPEN INSCHK

/* Ir para o primeiro registro */
FETCH	INSCHK
INTO	@CD_CHK,
	@NR_CHK_ORD,
	@CD_AER

/* Processar todos os registros de INSCHK */
WHILE @@FETCH_STATUS = 0
BEGIN

	IF (	SELECT 	COUNT(*) 
		FROM 	T_CHK 
		WHERE 	CD_CHK &lt;&gt; @CD_CHK  AND NR_CHK_ORD = @NR_CHK_ORD AND CD_AER = @CD_AER) &gt; 0
	BEGIN
		SELECT	@CD_CHK_ATU = CD_CHK 
		FROM 	T_CHK
		WHERE 	CD_CHK &lt;&gt; @CD_CHK AND NR_CHK_ORD = @NR_CHK_ORD AND CD_AER = @CD_AER

		UPDATE	T_CHK
		SET	NR_CHK_ORD = NR_CHK_ORD + 1
		WHERE	CD_CHK = @CD_CHK_ATU

		SELECT @NR_CHK_ORD = @NR_CHK_ORD + 1, @CD_CHK = @CD_CHK_ATU
	END
	ELSE
	BEGIN
		/* Ir para o próximo registro */
		FETCH NEXT FROM INSCHK
		INTO	@CD_CHK,
			@NR_CHK_ORD,
			@CD_AER
	END

END
CLOSE INSCHK
DEALLOCATE INSCHK

-------------------- Colocado e Comentado por Milena em 22/06/99 -------------------- */

End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o130">
<a:ObjectID>6958BCE2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_CHK_TRU</a:Name>
<a:Code>T_CHK_TRU</a:Code>
<a:Text>Create Trigger T_CHK_TRU On T_CHK
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_CHK)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Checkin&gt; da tabela &lt;Checkin&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_AER)
/* Aeroporto»Checkin: Aeroporto possui Checkins */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Checkin&gt; não está cadastrada&#39;
  Return
End
If Update (CD_COM)
/* Companhia Aérea»Checkin: Companhia Aér. possui Checkins */
If (Select Count(*) From T_COM, Inserted
Where T_COM.CD_COM = Inserted.CD_COM)
 &lt;&gt;(Select Count(CD_COM) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Companhia Aérea&gt; que se deseja incluir na tabela &lt;Checkin&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
IF UPDATE(NR_CHK) OR UPDATE(NR_CHK_ORD)
BEGIN
	/* Incluir registros em T_APA */
	INSERT	T_APA (DH_APA, CD_PAR)
	Select	GETDATE(), CKV.CD_PAR
	From	T_CKV001 CKV, T_CHK CHK, INSERTED INS
	Where	CKV.CD_PAR IN (	Select 	CD_PAR
				From 	T_PAR PAR
				Where	PAR.TP_PAR_STA = 1 And
					PAR.CD_AER = (Select CD_AER From T_PSI)) And
		CHK.CD_CHK = CKV.CD_CHK And
		CHK.CD_CHK = INS.CD_CHK

	/* Incluir registros em T_AHO */
	INSERT	T_AHO (CD_HOT, DH_AHO)
	Select	DISTINCT HCK.CD_HOT, GETDATE()
	From	T_HCK HCK, T_CHK CHK, INSERTED INS
	Where	CHK.CD_CHK = HCK.CD_CHK And
		CHK.CD_CHK = INS.CD_CHK
END

/* -------------------- Colocado e Comentado por Milena em 22/06/99 --------------------

/* Declaração do cursor */
DECLARE INSCHK CURSOR FOR
	SELECT 	INS.CD_CHK,
		INS.NR_CHK_ORD,
		INS.CD_AER
	FROM	INSERTED INS
	ORDER BY NR_CHK_ORD

/* Declaração das variáveis  */
DECLARE	@CD_CHK	INT,
		@NR_CHK_ORD	INT,
	 	@CD_AER	INT,
		@CD_CHK_ATU 	INT
		 
/* Abertura do cursor */
OPEN INSCHK

/* Ir para o primeiro registro */
FETCH	INSCHK
INTO	@CD_CHK,
	@NR_CHK_ORD,
	@CD_AER

/* Processar todos os registros de INSCHK */
WHILE @@FETCH_STATUS = 0
BEGIN

	IF (	SELECT 	COUNT(*) 
		FROM 	T_CHK 
		WHERE 	CD_CHK &lt;&gt; @CD_CHK  AND NR_CHK_ORD = @NR_CHK_ORD AND CD_AER = @CD_AER) &gt; 0
	BEGIN
		SELECT	@CD_CHK_ATU = CD_CHK 
		FROM 	T_CHK
		WHERE 	CD_CHK &lt;&gt; @CD_CHK AND NR_CHK_ORD = @NR_CHK_ORD AND CD_AER = @CD_AER

		UPDATE	T_CHK
		SET	NR_CHK_ORD = NR_CHK_ORD + 1
		WHERE	CD_CHK = @CD_CHK_ATU

		SELECT @NR_CHK_ORD = @NR_CHK_ORD + 1, @CD_CHK = @CD_CHK_ATU
	END
	ELSE
	BEGIN
		/* Ir para o próximo registro */
		FETCH NEXT FROM INSCHK
		INTO	@CD_CHK,
			@NR_CHK_ORD,
			@CD_AER
	END

END
CLOSE INSCHK
DEALLOCATE INSCHK

-------------------- Colocado e Comentado por Milena em 22/06/99 -------------------- */

End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o125"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o131">
<a:ObjectID>6958BD20-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_8</a:Name>
<a:Code>REFERENCE_8</a:Code>
<a:CreationDate>1081540974</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540974</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o120"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o102"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o125"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o132">
<a:ObjectID>6958BD22-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540974</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540974</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o121"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o107"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o133">
<a:CenterTextOffset>(-598, 600)</a:CenterTextOffset>
<a:Rect>((-740500,710645), (-728468,721733))</a:Rect>
<a:ListOfPoints>((-728468,710645),(-740500,721733))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>4210816</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o101"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o134">
<a:Rect>((-742853,719366), (-736305,722966))</a:Rect>
<a:LineColor>4210816</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o135">
<a:ObjectID>6958BD60-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_CLS</a:Name>
<a:Code>T_CLS</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o136">
<a:ObjectID>6958BD6C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_CLS</a:Name>
<a:Code>CD_CLS</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o137">
<a:ObjectID>6958BD6E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_CLS_LOC</a:Name>
<a:Code>NM_CLS_LOC</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>varchar(60)</a:DataType>
<a:Length>60</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o138">
<a:ObjectID>6958BD70-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_CLS_EST</a:Name>
<a:Code>NM_CLS_EST</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>varchar(60)</a:DataType>
<a:Length>60</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o139">
<a:ObjectID>6958BD72-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SG_CLS</a:Name>
<a:Code>SG_CLS</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>varchar(5)</a:DataType>
<a:Length>5</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o140">
<a:ObjectID>6958BD74-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o141">
<a:ObjectID>6958BD7C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_CLS</a:Name>
<a:Code>Pk_T_CLS</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_CLS</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o136"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o142">
<a:ObjectID>6958BD78-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_SGCLS</a:Name>
<a:Code>I_SGCLS</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o143">
<a:ObjectID>6958BD7A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o139"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Ref="o13"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o144">
<a:ObjectID>6958BCEB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_CLS_TRD</a:Name>
<a:Code>T_CLS_TRD</a:Code>
<a:Text>Create Trigger T_CLS_TRD On T_CLS
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Classe de Serviço»Checkin da Partida de Vôo: Classe do Check-in da Partida (Restrict) */
If (Select Count(*) From T_CKV001 dep, Deleted pri
 Where dep.CD_CLS = pri.CD_CLS) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Classe de Serviço&gt; está sendo referenciada na tabela &lt;Checkin da Partida de Vôo&gt;&#39;
  Return
End
/* Classe de Serviço»Checkin da Partida de Vôo - Mirror: Classe do Check-in da Partida (Restrict) */
If (Select Count(*) From T_CKV001_MIR dep, Deleted pri
 Where dep.CD_CLS = pri.CD_CLS) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Classe de Serviço&gt; está sendo referenciada na tabela &lt;Checkin da Partida de Vôo - Mirror&gt;&#39;
  Return
End
/* Classe de Serviço»Hotran - Check in: Classe do Check-in do Hotran (Restrict) */
If (Select Count(*) From T_HCK dep, Deleted pri
 Where dep.CD_CLS = pri.CD_CLS) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Classe de Serviço&gt; está sendo referenciada na tabela &lt;Hotran - Check in&gt;&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o145">
<a:ObjectID>6958BCEC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_CLS_TRU</a:Name>
<a:Code>T_CLS_TRU</a:Code>
<a:Text>Create Trigger T_CLS_TRU On T_CLS
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_CLS)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código da Classe de Serviço&gt; da tabela &lt;Classe de Serviço&gt; não pode ser alterada.&#39;
  Return
End
/* Regra de negócio */
IF UPDATE(NM_CLS_LOC) OR UPDATE(NM_CLS_EST)
BEGIN
	/* Incluir registros em T_APA */
	INSERT	T_APA (CD_PAR, DH_APA)
	Select	DISTINCT CKV.CD_PAR, GETDATE()
	From	T_CKV001 CKV, T_CLS CLS, INSERTED INS
	Where	CKV.CD_PAR IN (	Select 	CD_PAR
				From 	T_PAR PAR
				Where	PAR.TP_PAR_STA = 1 And
					PAR.CD_AER = (Select CD_AER From T_PSI)) And
		CLS.CD_CLS = CKV.CD_CLS And
		CLS.CD_CLS = INS.CD_CLS
END

End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o141"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o146">
<a:ObjectID>6958BD24-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_9</a:Name>
<a:Code>REFERENCE_9</a:Code>
<a:CreationDate>1081540974</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540974</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o135"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o102"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o141"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o147">
<a:ObjectID>6958BD26-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540974</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540974</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o136"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o108"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o148">
<a:CenterTextOffset>(3, 0)</a:CenterTextOffset>
<a:Rect>((-721575,697500), (-713851,719850))</a:Rect>
<a:ListOfPoints>((-717716,697500),(-717716,719850))</a:ListOfPoints>
<a:ArrowStyle>4881</a:ArrowStyle>
<a:LineColor>4210816</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o84"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o149">
<a:Rect>((-718857,718505), (-712231,723051))</a:Rect>
<a:LineColor>4210816</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o150">
<a:ObjectID>6958BD6B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_EST</a:Name>
<a:Code>T_EST</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081694106</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o151">
<a:ObjectID>6958BDC0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_EST</a:Name>
<a:Code>CD_EST</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o152">
<a:ObjectID>6958BDC2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_EST</a:Name>
<a:Code>NR_EST</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(4)</a:DataType>
<a:Length>4</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o153">
<a:ObjectID>6958BDC3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_SAL</a:Name>
<a:Code>CD_SAL</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o154">
<a:ObjectID>6958BDC4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o155">
<a:ObjectID>6958BDC8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_EST</a:Name>
<a:Code>Pk_T_EST</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_EST</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o151"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o156">
<a:ObjectID>6958BDC5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_EST_AER</a:Name>
<a:Code>I_EST_AER</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081694106</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o157">
<a:ObjectID>6958BDC6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o152"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o158">
<a:ObjectID>6958BDC7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_1&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o153"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Ref="o13"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o159">
<a:ObjectID>6958BD13-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_EST_TRD</a:Name>
<a:Code>T_EST_TRD</a:Code>
<a:Text>Create Trigger T_EST_TRD On T_EST
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Esteira»Hotran - Frequência: É Esteira da Frequência (Restrict) */
If (Select Count(*) From T_HFR dep, Deleted pri
 Where dep.CD_EST = pri.CD_EST) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Esteira&gt; está sendo referenciada na tabela &lt;Hotran - Frequência&gt;&#39;
  Return
End
/* Esteira»FIDS - IST Servidor de Informação: Esteira Associada ao IST (Restrict) */
If (Select Count(*) From T_FIDS_IST dep, Deleted pri
 Where dep.CD_EST = pri.CD_EST) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Esteira&gt; está sendo referenciada na tabela &lt;FIDS - IST Servidor de Informação&gt;&#39;
  Return
End
/* Esteira»Esteira da Chegada de Vôo - Mirror: Esteira da Chegada (Restrict) */
If (Select Count(*) From T_ESV001_MIR dep, Deleted pri
 Where dep.CD_EST = pri.CD_EST) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Esteira&gt; está sendo referenciada na tabela &lt;Esteira da Chegada de Vôo - Mirror&gt;&#39;
  Return
End
/* Esteira»Esteira da Chegada de Vôo: Esteira integra ESV (Restrict) */
If (Select Count(*) From T_ESV001 dep, Deleted pri
 Where dep.CD_EST = pri.CD_EST) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Esteira&gt; está sendo referenciada na tabela &lt;Esteira da Chegada de Vôo&gt;&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o160">
<a:ObjectID>6958BD15-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_EST_TRI</a:Name>
<a:Code>T_EST_TRI</a:Code>
<a:Text>Create Trigger T_EST_TRI On T_EST
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Aeroporto»Esteira: Aeroporto possui Esteiras */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Esteira&gt; não está cadastrada&#39;
  Return
End
/* Sala de Desembarque»Esteira: Sala Desemb. possui Esteiras */
If (Select Count(*) From T_SAL, Inserted
Where T_SAL.CD_SAL = Inserted.CD_SAL)
 &lt;&gt;(Select Count(CD_SAL) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Sala de Desembarque&gt; que se deseja incluir na tabela &lt;Esteira&gt; não está cadastrada&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o161">
<a:ObjectID>6958BD17-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_EST_TRU</a:Name>
<a:Code>T_EST_TRU</a:Code>
<a:Text>Create Trigger T_EST_TRU On T_EST
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_EST)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código da Esteira&gt; da tabela &lt;Esteira&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_AER)
/* Aeroporto»Esteira: Aeroporto possui Esteiras */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Esteira&gt; não está cadastrada&#39;
  Return
End
If Update (CD_SAL)
/* Sala de Desembarque»Esteira: Sala Desemb. possui Esteiras */
If (Select Count(*) From T_SAL, Inserted
Where T_SAL.CD_SAL = Inserted.CD_SAL)
 &lt;&gt;(Select Count(CD_SAL) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Sala de Desembarque&gt; que se deseja incluir na tabela &lt;Esteira&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
IF UPDATE(NR_EST) OR UPDATE(CD_SAL)
BEGIN
	/* Incluir registros em T_ACH */
	INSERT	T_ACH (DH_ACH, CD_CHG)
	Select	GETDATE(), ESV.CD_CHG
	From	T_ESV001 ESV, T_EST EST, INSERTED INS
	Where	ESV.CD_CHG IN (	Select 	CD_CHG
				From 	T_CHG CHG
				Where	CHG.TP_CHG_STA = 1 And
					CHG.CD_AER = (Select CD_AER From T_PSI)) And
		EST.CD_EST = ESV.CD_EST And
		EST.CD_EST = INS.CD_EST

	/* Incluir Registros em T_AHO */
	INSERT	T_AHO (CD_HOT, DH_AHO)
	Select	DISTINCT CD_HOT, GETDATE()
	From	T_HFR HFR, INSERTED INS
	Where	HFR.CD_EST = INS.CD_EST

	/* Incluir Registros em T_AHP */
	INSERT	T_AHP (CD_HPA, DH_AHP)
	Select	DISTINCT CD_HPA, GETDATE()
	From	T_HPA001 HPA, T_CHG CHG, T_SIT SIT, T_ESV001 ESV, T_EST EST, INSERTED INS
	Where	HPA.CD_CHG = CHG.CD_CHG AND
		SIT.CD_SIT = CHG.CD_SIT AND
		HPA.CD_AER = (Select CD_AER From T_PSI) AND
		(HPA.FL_HPA_ENT = 1 OR SIT.FL_SIT_AEN_PAT = 1) AND
		HPA.FL_HPA_SAI = 0 AND
		HPA.CD_AEN IS NOT NULL AND
		ESV.CD_CHG = HPA.CD_CHG AND 
		EST.CD_EST = ESV.CD_EST And
		EST.CD_EST = INS.CD_EST
END

End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o155"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o162">
<a:ObjectID>6958BD2A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_11</a:Name>
<a:Code>REFERENCE_11</a:Code>
<a:CreationDate>1081540974</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540974</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o150"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o85"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o155"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o163">
<a:ObjectID>6958BD2C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540974</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540974</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o151"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o92"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o164">
<a:Rect>((-709236,684150), (-697312,696450))</a:Rect>
<a:ListOfPoints>((-698216,696450),(-708866,684150))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>128</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o6"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o52"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o165">
<a:ObjectID>6958BD2E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_12</a:Name>
<a:Code>REFERENCE_12</a:Code>
<a:CreationDate>1081540974</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540974</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o53"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o7"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o77"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o166">
<a:ObjectID>6958BD2F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540974</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540974</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o54"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o8"/>
</c:Object2>
</o:ReferenceJoin>
<o:ReferenceJoin Id="o167">
<a:ObjectID>6958BD30-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540974</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540974</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o55"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o9"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o168">
<a:CenterTextOffset>(3, 0)</a:CenterTextOffset>
<a:Rect>((-729116,697050), (-718166,710100))</a:Rect>
<a:ListOfPoints>((-729116,710100),(-718166,697050))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>4210816</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o101"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o84"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o169">
<a:ObjectID>6958BD32-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_13</a:Name>
<a:Code>REFERENCE_13</a:Code>
<a:CreationDate>1081540974</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540974</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o85"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o102"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o94"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o170">
<a:ObjectID>6958BD34-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540974</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540974</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o86"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o103"/>
</c:Object2>
</o:ReferenceJoin>
<o:ReferenceJoin Id="o171">
<a:ObjectID>6958BD36-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540974</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540974</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o87"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o104"/>
</c:Object2>
</o:ReferenceJoin>
<o:ReferenceJoin Id="o172">
<a:ObjectID>6958BD38-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540974</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540974</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o88"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o105"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o173">
<a:CenterTextOffset>(3, 0)</a:CenterTextOffset>
<a:Rect>((-723997,685950), (-716123,697517))</a:Rect>
<a:ListOfPoints>((-723266,685950),(-716129,697517))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>4210816</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Id="o174">
<a:Rect>((-728871,683403), (-722245,687949))</a:Rect>
<a:LineColor>4210816</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o175">
<a:ObjectID>6958BDA9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HET</a:Name>
<a:Code>T_HET</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081694661</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o176">
<a:ObjectID>6958BCC1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_HOT</a:Name>
<a:Code>CD_HOT</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(7)</a:DataType>
<a:Length>7</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o177">
<a:ObjectID>6958BCC2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_HVE</a:Name>
<a:Code>CD_HVE</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(3)</a:DataType>
<a:Length>3</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o178">
<a:ObjectID>6958BCC3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_HFR</a:Name>
<a:Code>CD_HFR</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(1)</a:DataType>
<a:Length>1</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o179">
<a:ObjectID>6958BCC4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_HET</a:Name>
<a:Code>CD_HET</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(2)</a:DataType>
<a:Length>2</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o180">
<a:ObjectID>6958BD94-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_EQP</a:Name>
<a:Code>CD_EQP</a:Code>
<a:CreationDate>1081694495</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081694495</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o181">
<a:ObjectID>6958BCC5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_HET_CTG</a:Name>
<a:Code>TP_HET_CTG</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o182">
<a:ObjectID>6958BCC6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_HOT_VIN</a:Name>
<a:Code>CD_HOT_VIN</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(7)</a:DataType>
<a:Length>7</a:Length>
</o:Column>
<o:Column Id="o183">
<a:ObjectID>6958BCC7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_HOT_AEN_ANT</a:Name>
<a:Code>CD_HOT_AEN_ANT</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(7)</a:DataType>
<a:Length>7</a:Length>
</o:Column>
<o:Column Id="o184">
<a:ObjectID>6958BCC8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SG_EQP</a:Name>
<a:Code>SG_EQP</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(10)</a:DataType>
<a:Length>10</a:Length>
</o:Column>
<o:Column Id="o185">
<a:ObjectID>6958BCC9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SG_AER_ORI</a:Name>
<a:Code>SG_AER_ORI</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(4)</a:DataType>
<a:Length>4</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o186">
<a:ObjectID>6958BCCA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>HR_HET_PAR</a:Name>
<a:Code>HR_HET_PAR</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_HOR    Script Date: 7/8/2000 12:14:35 ******/
Create Rule        RU_HOR As
DATEPART(yy,@data) = 1900 AND
DATEPART(mm,@data) = 1 AND
DATEPART(dd,@data) = 1 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>smalldatetime</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o187">
<a:ObjectID>6958BCCB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_HET_DIA_PAR</a:Name>
<a:Code>QT_HET_DIA_PAR</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>smallint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o188">
<a:ObjectID>6958BCCC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_HET_VER_PAR</a:Name>
<a:Code>QT_HET_VER_PAR</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>smallint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o189">
<a:ObjectID>6958BCCD-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SG_AER_DES</a:Name>
<a:Code>SG_AER_DES</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(4)</a:DataType>
<a:Length>4</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o190">
<a:ObjectID>6958BCCE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>HR_HET_CHG</a:Name>
<a:Code>HR_HET_CHG</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_HOR    Script Date: 7/8/2000 12:14:35 ******/
Create Rule        RU_HOR As
DATEPART(yy,@data) = 1900 AND
DATEPART(mm,@data) = 1 AND
DATEPART(dd,@data) = 1 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>smalldatetime</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o191">
<a:ObjectID>6958BCCF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_HET_DIA_CHG</a:Name>
<a:Code>QT_HET_DIA_CHG</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>smallint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o192">
<a:ObjectID>6958BCD0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_HET_VER_CHG</a:Name>
<a:Code>QT_HET_VER_CHG</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>smallint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o193">
<a:ObjectID>6958BCD1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o194">
<a:ObjectID>6958BCD5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_HET</a:Name>
<a:Code>Pk_T_HET</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_HET</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o176"/>
<o:Column Ref="o177"/>
<o:Column Ref="o178"/>
<o:Column Ref="o179"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Owner>
<o:User Ref="o13"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o195">
<a:ObjectID>6958BD7B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HET_TRD</a:Name>
<a:Code>T_HET_TRD</a:Code>
<a:Text>Create Trigger T_HET_TRD On T_HET
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Hotran - Etapa»Hotran - Boxes: É Etapa de Chegada (Cascade) */
Delete T_HBX001 From T_HBX001 dep, Deleted pri
 Where dep.CD_HET_CHG = pri.CD_HET
   And dep.CD_HOT_CHG = pri.CD_HOT
   And dep.CD_HVE_CHG = pri.CD_HVE
   And dep.CD_HFR_CHG = pri.CD_HFR
/* Hotran - Etapa»Hotran - Boxes: É Etapa de Partida (Cascade) */
Delete T_HBX001 From T_HBX001 dep, Deleted pri
 Where dep.CD_HET_PAR = pri.CD_HET
   And dep.CD_HOT_PAR = pri.CD_HOT
   And dep.CD_HVE_PAR = pri.CD_HVE
   And dep.CD_HFR_PAR = pri.CD_HFR
/* Regra de negócio */
/* Verificar se as etapas que têm este hotran como vôo sucessor continuam válidas */
IF (	SELECT	COUNT(*) 
	FROM 	T_HET HET, DELETED DEL
	WHERE	HET.CD_HOT + HET.CD_HVE + HET.CD_HFR &lt;&gt; DEL.CD_HOT + DEL.CD_HVE + DEL.CD_HFR AND
		HET.CD_HOT_AEN_ANT = DEL.CD_HOT AND
		HET.SG_AER_ORI = DEL.SG_AER_DES) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: Esta operação tornaria inválido seu vôo sucessor.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* REORDENAR CD_HET */

/* Declaração do cursor */
DECLARE DEL_CURSOR CURSOR FOR
	SELECT 	DISTINCT 
		CD_HOT,
		CD_HVE,
		CD_HFR,
		CONVERT(INT, CD_HET)
	FROM	DELETED
	ORDER BY CD_HOT, CD_HVE, CD_HFR, CONVERT(INT, CD_HET) DESC

/* Declaração das variáveis que receberão o cursor */
DECLARE @CD_HOT	CHAR(7),
	 @CD_HVE	CHAR(3),
	 @CD_HFR	CHAR(1),
	 @CD_HET	INT

/* Abertura do cursor */
OPEN DEL_CURSOR

/* Ir para o primeiro registro */
FETCH	DEL_CURSOR
INTO	@CD_HOT,
	@CD_HVE,
	@CD_HFR,
	@CD_HET

/* Processar todos os registros de DEL_CURSOR */
WHILE @@FETCH_STATUS = 0
BEGIN

	UPDATE	T_HET
	SET	CD_HET = CONVERT(CHAR(2), CONVERT(INT, CD_HET) - 1)
	WHERE	CD_HOT + CD_HVE + CD_HFR = @CD_HOT + @CD_HVE + @CD_HFR AND
		CONVERT(INT, CD_HET) &gt; @CD_HET

	/* Ir para o próximo registro */
	FETCH	NEXT FROM DEL_CURSOR
	INTO	@CD_HOT,
		@CD_HVE,
		@CD_HFR,
		@CD_HET

END
CLOSE DEL_CURSOR
DEALLOCATE DEL_CURSOR


/* Atualizar os campos Hora de Partida, Do Dia e Horário de Verão, da etapa 
   imediatamente posterior à que se excluiu com os valores do registro deletado */
UPDATE	HET
SET	HR_HET_PAR = DEL.HR_HET_PAR,
	QT_HET_DIA_PAR = DEL.QT_HET_DIA_PAR,
	QT_HET_VER_PAR = DEL.QT_HET_VER_PAR
FROM	T_HET HET, DELETED DEL
WHERE	HET.CD_HOT + HET.CD_HVE + HET.CD_HFR = DEL.CD_HOT + DEL.CD_HVE + DEL.CD_HFR AND
	HET.CD_HET = DEL.CD_HET

/* FAZER AS VERIFICAÇÕES RELATIVAS AOS CODE-SHARE */

/* Declaração do cursor */
DECLARE DEL_CURSOR CURSOR FOR
	SELECT 	DISTINCT 
		CD_HOT,
		CD_HVE,
		CD_HFR,
		TP_HET_CTG
	FROM	DELETED DEL
	ORDER BY CD_HOT, CD_HVE, CD_HFR, TP_HET_CTG

/* Declaração das variáveis que receberão o cursor */
DECLARE @TP_HET_CTG	TINYINT

/* Abertura do cursor */
OPEN DEL_CURSOR

/* Ir para o primeiro registro */
FETCH	DEL_CURSOR
INTO	@CD_HOT,
	@CD_HVE,
	@CD_HFR,
	@TP_HET_CTG

/* Processar todos os registros de INS_CURSOR */
WHILE @@FETCH_STATUS = 0
BEGIN

	EXEC SP_VerificaCodeShare @CD_HOT, @CD_HVE, @CD_HFR, @TP_HET_CTG
	IF @@ERROR &lt;&gt; 0
	BEGIN
		CLOSE DEL_CURSOR
		DEALLOCATE DEL_CURSOR
		ROLLBACK TRANSACTION
		RETURN
	END


	/* Ir para o próximo registro */
	FETCH	NEXT FROM DEL_CURSOR
	INTO	@CD_HOT,
		@CD_HVE,
		@CD_HFR,
		@TP_HET_CTG

END
CLOSE DEL_CURSOR
DEALLOCATE DEL_CURSOR

/* INCLUIR REGISTROS EM T_AHO */
INSERT	T_AHO (CD_HOT, DH_AHO)
SELECT 	DISTINCT CD_HOT, GETDATE() FROM DELETED

End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o196">
<a:ObjectID>6958BD7D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HET_TRI</a:Name>
<a:Code>T_HET_TRI</a:Code>
<a:Text>Create Trigger T_HET_TRI On T_HET
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Aeroporto»Hotran - Etapa: Aeroporto Destino */
If (Select Count(*) From T_AER, Inserted
Where T_AER.SG_AER_ICA = Inserted.SG_AER_DES)
 &lt;&gt;(Select Count(SG_AER_DES) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Hotran - Etapa&gt; não está cadastrada&#39;
  Return
End
/* Aeroporto»Hotran - Etapa: Aeroporto Origem */
If (Select Count(*) From T_AER, Inserted
Where T_AER.SG_AER_ICA = Inserted.SG_AER_ORI)
 &lt;&gt;(Select Count(SG_AER_ORI) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Hotran - Etapa&gt; não está cadastrada&#39;
  Return
End
/* Equipamento»Hotran - Etapa: É Equipamento da Etapa */
If (Select Count(*) From T_EQP, Inserted
Where T_EQP.SG_EQP = Inserted.SG_EQP)
 &lt;&gt;(Select Count(SG_EQP) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Equipamento&gt; que se deseja incluir na tabela &lt;Hotran - Etapa&gt; não está cadastrada&#39;
  Return
End
/* Hotran - Frequência»Hotran - Etapa: Etapas da Freqüência */
If (Select Count(*) From T_HFR, Inserted
Where T_HFR.CD_HFR = Inserted.CD_HFR
  And T_HFR.CD_HVE = Inserted.CD_HVE
  And T_HFR.CD_HOT = Inserted.CD_HOT)
 &lt;&gt;(Select Count(CD_HFR) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Hotran - Frequência&gt; que se deseja incluir na tabela &lt;Hotran - Etapa&gt; não está cadastrada&#39;
  Return
End
/* Domínio de: Categoria do vôo */
/* 1 - RGL-Regular */
/* 2 - CHT-Charter */
/* 3 - CSH-Codeshare */
/* 4 - DPL-Duplicate Leg */
/* 5 - TEC-Pouso Técnico */
/* 6 - TSL-Translado */
/* 7 - AVG-Aviação Geral */
/* 8 - MLT-Militar */
/* 9 - NRG-Não Regular */
/* 10 - TXA-Táxi Aéreo */
If (Select Count(*) From Inserted
    Where TP_HET_CTG In (1,2,3,4,5,6,7,8,9,10))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Categoria do vôo&gt; que se deseja incluir na tabela &lt;Hotran - Etapa&gt; não é uma opção válida&#39;
  Return
End
/* Regra de negócio */
/* Forçar a execução da trigger de UPDATE */
UPDATE	HET
SET	TP_HET_CTG = HET.TP_HET_CTG,
	CD_HOT_VIN = HET.CD_HOT_VIN,
	CD_HOT_AEN_ANT = HET.CD_HOT_AEN_ANT,
	SG_EQP = HET.SG_EQP,
	SG_AER_ORI = HET.SG_AER_ORI,
	HR_HET_PAR = HET.HR_HET_PAR,
	QT_HET_DIA_PAR = HET.QT_HET_DIA_PAR,
	QT_HET_VER_PAR = HET.QT_HET_VER_PAR,
	SG_AER_DES = HET.SG_AER_DES,
	HR_HET_CHG = HET.HR_HET_CHG,
	QT_HET_DIA_CHG = HET.QT_HET_DIA_CHG,
	QT_HET_VER_CHG = HET.QT_HET_VER_CHG
FROM	T_HET HET, INSERTED INS
WHERE	HET.CD_HOT + HET.CD_HVE + HET.CD_HFR + HET.CD_HET = INS.CD_HOT + INS.CD_HVE + INS.CD_HFR + INS.CD_HET

End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o197">
<a:ObjectID>6958BD7F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HET_TRU</a:Name>
<a:Code>T_HET_TRU</a:Code>
<a:Text>CREATE Trigger T_HET_TRU On T_HET
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_HOT)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Hotran&gt; da tabela &lt;Hotran - Etapa&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_HVE)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código da Versão do Hotran&gt; da tabela &lt;Hotran - Etapa&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_HFR)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código da Freqüência do Hotran&gt; da tabela &lt;Hotran - Etapa&gt; não pode ser alterada.&#39;
  Return
End
If Update (SG_AER_DES)
/* Aeroporto»Hotran - Etapa: Aeroporto Destino */
If (Select Count(*) From T_AER, Inserted
Where T_AER.SG_AER_ICA = Inserted.SG_AER_DES)
 &lt;&gt;(Select Count(SG_AER_DES) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Hotran - Etapa&gt; não está cadastrada&#39;
  Return
End
If Update (SG_AER_ORI)
/* Aeroporto»Hotran - Etapa: Aeroporto Origem */
If (Select Count(*) From T_AER, Inserted
Where T_AER.SG_AER_ICA = Inserted.SG_AER_ORI)
 &lt;&gt;(Select Count(SG_AER_ORI) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Hotran - Etapa&gt; não está cadastrada&#39;
  Return
End
If Update (SG_EQP)
/* Equipamento»Hotran - Etapa: É Equipamento da Etapa */
If (Select Count(*) From T_EQP, Inserted
Where T_EQP.SG_EQP = Inserted.SG_EQP)
 &lt;&gt;(Select Count(SG_EQP) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Equipamento&gt; que se deseja incluir na tabela &lt;Hotran - Etapa&gt; não está cadastrada&#39;
  Return
End
If Update (TP_HET_CTG)
/* Domínio de: Categoria do vôo */
/* 1 - RGL-Regular */
/* 2 - CHT-Charter */
/* 3 - CSH-Codeshare */
/* 4 - DPL-Duplicate Leg */
/* 5 - TEC-Pouso Técnico */
/* 6 - TSL-Translado */
/* 7 - AVG-Aviação Geral */
/* 8 - MLT-Militar */
/* 9 - NRG-Não Regular */
/* 10 - TXA-Táxi Aéreo */
If (Select Count(*) From Inserted
    Where TP_HET_CTG In (1,2,3,4,5,6,7,8,9,10))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Categoria do vôo&gt; que se deseja incluir na tabela &lt;Hotran - Etapa&gt; não é uma opção válida&#39;
  Return
End
/* Regra de negócio */
-- Alexei alterou em 05/01/00
-- Não permitir a inclusão de uma etapa com um aeroporto que não tenha a sigla IATA definida
IF (	Select	Count(*)
	from	Inserted Ins
	,	T_Aer Aer
	where	(Ins.SG_AER_ORI = Aer.SG_AER_ICA
	or	Ins.SG_AER_DES = Aer.SG_AER_ICA)
	and	Aer.SG_AER_IAT is NULL) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: O aeroporto da etapa não tem sigla IATA definida.&#39;
	ROLLBACK TRANSACTION
	RETURN
END
-- Fim Alteração Alexei em 05/01/00

/* Se a etapa for Code-Share ou Duplicate Leg 
	tem de ter vôo vinculado,
	não pode ter vôo antecessor,
	não pode ter equipamento. */
IF (	SELECT	COUNT(*) FROM INSERTED
	WHERE	TP_HET_CTG IN (3, 4) AND
		(CD_HOT_VIN IS NULL OR
		CD_HOT_AEN_ANT IS NOT NULL OR
		SG_EQP IS NOT NULL)) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: Uma etapa do tipo Code-Share ou Duplicate Leg tem de ter vôo vinculado e não pode ter vôo antecessor nem equipamento.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Se a etapa não for Code-Share nem Duplicate Leg 
	não pode ter vôo vinculado e
	tem de ter equipamento. */
IF (	SELECT	COUNT(*) FROM INSERTED
	WHERE	TP_HET_CTG NOT IN (3, 4) AND
		(CD_HOT_VIN IS NOT NULL OR
		SG_EQP IS NULL)) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: Uma etapa que não seja do tipo Code-Share ou Duplicate Leg não pode ter vôo vinculado e tem de ter equipamento.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Se a etapa não for Code-Share nem Duplicate Leg e se não for a primeira etapa do vôo ou se o aeroporto origem 
    for o aeroporto usuário então tem de ter vôo antecessor. */
IF (	SELECT	COUNT(*) FROM INSERTED, T_PSI PSI, T_AER AER
	WHERE	AER.CD_AER = PSI.CD_AER AND
		TP_HET_CTG NOT IN (3, 4) AND
		CD_HOT_AEN_ANT IS NULL AND
		(CD_HET &lt;&gt; &#39;1&#39; OR
		 CD_HET = &#39;1&#39; AND SG_AER_ORI = AER.SG_AER_ICA)) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: Uma etapa que não seja a primeira etapa do vôo ou que tenha o aeroporto usuário como origem, tem de ter vôo antecessor.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Impedir que seja definido o aeroporto usuário como aeroporto destino, caso a freqüência do Hotran
   associada não tiver box definido e a etapa não for Code-Share nem Duplicate Leg. */ 
IF (	SELECT	COUNT(*) 
	FROM 	INSERTED INS, T_PSI PSI, T_AER AER, T_HFR HFR
	WHERE	HFR.CD_HOT = INS.CD_HOT AND
		HFR.CD_HVE = INS.CD_HVE AND
		HFR.CD_HFR = INS.CD_HFR AND
		AER.SG_AER_ICA = INS.SG_AER_DES AND
		PSI.CD_AER = AER.CD_AER AND
		INS.TP_HET_CTG NOT IN (3, 4) AND
		HFR.CD_BOX IS NULL) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: O aeroporto usuário do sistema não pode ser definido como aeroporto destino desta Etapa, pois não existe box definido para a Freqüência associada a esta.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Não permitir que a hora de chegada no destino seja mais que uma hora antes da hora de partida na origem ---------------------------------------
IF (	SELECT	COUNT(*) FROM INSERTED INS
	WHERE	DATEDIFF(HH, DATEADD(DD, QT_HET_DIA_PAR, HR_HET_PAR), DATEADD(DD, QT_HET_DIA_CHG, HR_HET_CHG)) &lt; - 1) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: A hora de chegada no destino não pode ocorrer mais que uma hora antes da hora de partida na origem.&#39;
	ROLLBACK TRANSACTION
	RETURN
END
-------------------------------------------------------------------------- NAO IMPLEMENTADA */

/* Não permitir que a hora de partida de uma etapa seja anterior à hora de chegada da etapa precedente 
    caso a origem da etapa seja o aeroporto usuário e o vôo da Partida seja o próprio vôo */
IF (	SELECT	COUNT(*) 
	FROM 	T_HET ETAPA, T_HET ANTERIOR, INSERTED INS, T_PSI PSI, T_AER AER
	WHERE	AER.CD_AER = PSI.CD_AER AND
		ETAPA.CD_HOT + ETAPA.CD_HVE + ETAPA.CD_HFR = INS.CD_HOT + INS.CD_HVE + INS.CD_HFR AND
		ANTERIOR.CD_HOT + ANTERIOR.CD_HVE + ANTERIOR.CD_HFR = INS.CD_HOT + INS.CD_HVE + INS.CD_HFR AND
		ANTERIOR.CD_HET = CONVERT(CHAR(2), CONVERT(INT, ETAPA.CD_HET) - 1) AND
		ETAPA.TP_HET_CTG NOT IN (3, 4) AND
		ANTERIOR.TP_HET_CTG NOT IN (3, 4) AND
		ETAPA.SG_AER_ORI = AER.SG_AER_ICA AND
		ANTERIOR.CD_HOT = ETAPA.CD_HOT_AEN_ANT AND
		ETAPA.CD_HOT_AEN_ANT IS NOT NULL AND
		DATEADD(DD, ETAPA.QT_HET_DIA_PAR, ETAPA.HR_HET_PAR) &lt; DATEADD(DD, ANTERIOR.QT_HET_DIA_CHG, ANTERIOR.HR_HET_CHG)) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: A hora de partida de uma etapa não pode ser anterior à hora de chegada da etapa precedente.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Atualizar o aeroporto origem das etapas com o aeroporto destino da etapa precedente */
UPDATE	ORIGEM
SET	SG_AER_ORI = DESTINO.SG_AER_DES
FROM	T_HET DESTINO, T_HET ORIGEM, INSERTED INS
WHERE	DESTINO.CD_HOT + DESTINO.CD_HVE + DESTINO.CD_HFR = INS.CD_HOT + INS.CD_HVE + INS.CD_HFR AND
	ORIGEM.CD_HOT + ORIGEM.CD_HVE + ORIGEM.CD_HFR = INS.CD_HOT + INS.CD_HVE + INS.CD_HFR AND
	ORIGEM.CD_HET = CONVERT(CHAR(2), CONVERT(INT, DESTINO.CD_HET) + 1)

/* O vôo antecessor tem de ter pelo menos uma etapa cujo destino seja a origem deste vôo e que não seja code-share ou duplicate leg */
IF (	SELECT	COUNT(*) FROM T_HET HETINS, INSERTED INS
	WHERE	HETINS.CD_HOT + HETINS.CD_HVE + HETINS.CD_HFR = INS.CD_HOT + INS.CD_HVE + INS.CD_HFR AND
		HETINS.TP_HET_CTG NOT IN (3, 4) AND
		HETINS.CD_HOT_AEN_ANT IS NOT NULL AND
		NOT EXISTS (	SELECT  * FROM T_HET HET
				WHERE	HET.CD_HOT = HETINS.CD_HOT_AEN_ANT AND
					HET.TP_HET_CTG NOT IN (3, 4) AND
					HET.SG_AER_DES = HETINS.SG_AER_ORI)) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: O vôo antecessor tem de ter pelo menos uma etapa que não seja Code-Share nem Duplicate Leg e cujo destino seja igual à origem da etapa sucessora.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Verificar se as etapas que têm este hotran como vôo sucessor continuam válidas */
IF (	SELECT	COUNT(*) FROM T_HET HETINS, INSERTED INS
	WHERE	HETINS.CD_HOT + HETINS.CD_HVE + HETINS.CD_HFR = INS.CD_HOT + INS.CD_HVE + INS.CD_HFR AND
		HETINS.TP_HET_CTG NOT IN (3, 4) AND
		EXISTS (	SELECT  * FROM T_HET HET
			WHERE	HET.CD_HOT_AEN_ANT = HETINS.CD_HOT AND
			NOT EXISTS (	SELECT  * FROM T_HET HET1
					WHERE	HET1.CD_HOT = HET.CD_HOT_AEN_ANT AND
						HET1.TP_HET_CTG NOT IN (3, 4) AND
						HET1.SG_AER_DES = HET.SG_AER_ORI))) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: Esta alteração tornaria inválido seu vôo sucessor.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* FAZER AS VERIFICAÇÕES RELATIVAS AOS CODE-SHARE */

/* Declaração do cursor */
DECLARE INS_CURSOR CURSOR FOR
	SELECT 	DISTINCT 
		CD_HOT,
		CD_HVE,
		CD_HFR,
		TP_HET_CTG
	FROM	INSERTED INS
	ORDER BY CD_HOT, CD_HVE, CD_HFR, TP_HET_CTG

/* Declaração das variáveis que receberão o cursor */
DECLARE @CD_HOT	CHAR(7),
	 @CD_HVE	CHAR(3),
	 @CD_HFR	CHAR(1),
	 @TP_HET_CTG	TINYINT

/* Abertura do cursor */
OPEN INS_CURSOR

/* Ir para o primeiro registro */
FETCH	INS_CURSOR
INTO	@CD_HOT,
	@CD_HVE,
	@CD_HFR,
	@TP_HET_CTG

/* Processar todos os registros de INS_CURSOR */
WHILE @@FETCH_STATUS = 0
BEGIN

	EXEC SP_VerificaCodeShare @CD_HOT, @CD_HVE, @CD_HFR, @TP_HET_CTG
	IF @@ERROR &lt;&gt; 0
	BEGIN
		CLOSE INS_CURSOR
		DEALLOCATE INS_CURSOR
		ROLLBACK TRANSACTION
		RETURN
	END
	/* Ir para o próximo registro */
	FETCH	NEXT FROM INS_CURSOR
	INTO	@CD_HOT,
		@CD_HVE,
		@CD_HFR,
		@TP_HET_CTG

END
CLOSE INS_CURSOR
DEALLOCATE INS_CURSOR

/* INCLUIR REGISTROS EM T_AHO */
INSERT	T_AHO (CD_HOT, DH_AHO)
SELECT 	DISTINCT CD_HOT, GETDATE() FROM INSERTED

End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o194"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o84"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o198">
<a:ObjectID>6958BD3A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_14</a:Name>
<a:Code>REFERENCE_14</a:Code>
<a:CreationDate>1081540974</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540974</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o85"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o175"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o94"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o199">
<a:ObjectID>6958BD3C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540974</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540974</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o86"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o176"/>
</c:Object2>
</o:ReferenceJoin>
<o:ReferenceJoin Id="o200">
<a:ObjectID>6958BD3E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540974</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540974</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o87"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o177"/>
</c:Object2>
</o:ReferenceJoin>
<o:ReferenceJoin Id="o201">
<a:ObjectID>6958BD40-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540974</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540974</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o88"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o178"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o202">
<a:CenterTextOffset>(3, 0)</a:CenterTextOffset>
<a:Rect>((-738563,696426), (-716066,697696))</a:Rect>
<a:ListOfPoints>((-716066,697650),(-738563,697696))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>4210816</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o84"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o203">
<a:Rect>((-742460,695122), (-734366,699668))</a:Rect>
<a:LineColor>4210816</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o204">
<a:ObjectID>6958BDB1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HOT001</a:Name>
<a:Code>T_HOT001</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081693901</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o205">
<a:ObjectID>6958BCE1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_HOT</a:Name>
<a:Code>CD_HOT</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(7)</a:DataType>
<a:Length>7</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o206">
<a:ObjectID>6958BD87-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_COM</a:Name>
<a:Code>CD_COM</a:Code>
<a:CreationDate>1081693901</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081693901</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o207">
<a:ObjectID>6958BCE3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SG_COM</a:Name>
<a:Code>SG_COM</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(3)</a:DataType>
<a:Length>3</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o208">
<a:ObjectID>6958BCE4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_HOT_VOO</a:Name>
<a:Code>NR_HOT_VOO</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>smallint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o209">
<a:ObjectID>6958BCE5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_HOT</a:Name>
<a:Code>TP_HOT</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o210">
<a:ObjectID>6958BCE6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_HOT_NAT</a:Name>
<a:Code>TP_HOT_NAT</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o211">
<a:ObjectID>6958BCE7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_HOT_ANU</a:Name>
<a:Code>FL_HOT_ANU</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o212">
<a:ObjectID>6958BCE8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_HOT_TEL</a:Name>
<a:Code>FL_HOT_TEL</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o213">
<a:ObjectID>6958BCE9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_HOT_PER_MIN</a:Name>
<a:Code>QT_HOT_PER_MIN</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o214">
<a:ObjectID>6958BCEA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o215">
<a:ObjectID>6958BCED-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_HOT001</a:Name>
<a:Code>Pk_T_HOT001</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_HOT001</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o205"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Owner>
<o:User Ref="o13"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o216">
<a:ObjectID>6958BD93-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HOT001_TRD</a:Name>
<a:Code>T_HOT001_TRD</a:Code>
<a:Text>Create Trigger T_HOT001_TRD On T_HOT001
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Hotran»Hotran - Versão: Versões do Hotran (Cascade) */
Delete T_HVE From T_HVE dep, Deleted pri
 Where dep.CD_HOT = pri.CD_HOT
/* Regra de negócio */
/* INCLUIR REGISTROS EM T_AHO */
INSERT	T_AHO (CD_HOT, DH_AHO)
SELECT 	DISTINCT CD_HOT, GETDATE() FROM DELETED

End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o217">
<a:ObjectID>6958BD95-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HOT001_TRI</a:Name>
<a:Code>T_HOT001_TRI</a:Code>
<a:Text>Create Trigger T_HOT001_TRI On T_HOT001
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Companhia Aérea»Hotran: É Companhia do Hotran */
If (Select Count(*) From T_COM, Inserted
Where T_COM.SG_COM_IAT_003 = Inserted.SG_COM)
 &lt;&gt;(Select Count(SG_COM) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Companhia Aérea&gt; que se deseja incluir na tabela &lt;Hotran&gt; não está cadastrada&#39;
  Return
End
/* Domínio de: Classe do Vôo */
/* 1 - DOM-Doméstico */
/* 2 - INT-Internacional */
/* 3 - REG-Regional */
If (Select Count(*) From Inserted
    Where TP_HOT In (1,2,3))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Classe do Vôo&gt; que se deseja incluir na tabela &lt;Hotran&gt; não é uma opção válida&#39;
  Return
End
/* Domínio de: Natureza do Vôo */
/* 1 - PAX-Passageiro */
/* 2 - CRG-Carga */
/* 3 - MIS-Misto */
/* 4 - TSL-Translado */
If (Select Count(*) From Inserted
    Where TP_HOT_NAT In (1,2,3,4))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Natureza do Vôo&gt; que se deseja incluir na tabela &lt;Hotran&gt; não é uma opção válida&#39;
  Return
End
/* Regra de negócio */
/* As três primeiras posições do campo CD_HOT, do registro que se está incluindo, deve ser igual ao campo SG_COM */
IF	(SELECT 	COUNT(*)
	FROM	INSERTED INS
	WHERE	SUBSTRING(INS.CD_HOT, 1, 3) &lt;&gt; INS.SG_COM) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: As três primeiras posições do código do Hotran devem ser iguais à Sigla IATA-3 da Companhia Aérea relacionada.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* INCLUIR REGISTROS EM T_AHO */
INSERT	T_AHO (CD_HOT, DH_AHO)
SELECT	DISTINCT CD_HOT, GETDATE() FROM INSERTED

End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o218">
<a:ObjectID>6958BD97-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HOT001_TRU</a:Name>
<a:Code>T_HOT001_TRU</a:Code>
<a:Text>Create Trigger T_HOT001_TRU On T_HOT001
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_HOT)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Hotran&gt; da tabela &lt;Hotran&gt; não pode ser alterada.&#39;
  Return
End
If Update (SG_COM)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Sigla da Companhia Aérea&gt; da tabela &lt;Hotran&gt; não pode ser alterada.&#39;
  Return
End
If Update (NR_HOT_VOO)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Número do Vôo&gt; da tabela &lt;Hotran&gt; não pode ser alterada.&#39;
  Return
End
If Update (TP_HOT)
Or Update (TP_HOT_NAT)
/* Domínio de: Classe do Vôo */
/* 1 - DOM-Doméstico */
/* 2 - INT-Internacional */
/* 3 - REG-Regional */
If (Select Count(*) From Inserted
    Where TP_HOT In (1,2,3))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Classe do Vôo&gt; que se deseja incluir na tabela &lt;Hotran&gt; não é uma opção válida&#39;
  Return
End
/* Domínio de: Natureza do Vôo */
/* 1 - PAX-Passageiro */
/* 2 - CRG-Carga */
/* 3 - MIS-Misto */
/* 4 - TSL-Translado */
If (Select Count(*) From Inserted
    Where TP_HOT_NAT In (1,2,3,4))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Natureza do Vôo&gt; que se deseja incluir na tabela &lt;Hotran&gt; não é uma opção válida&#39;
  Return
End
/* Regra de negócio */
/* INCLUIR REGISTROS EM T_AHO */
INSERT	T_AHO (CD_HOT, DH_AHO)
SELECT	DISTINCT CD_HOT, GETDATE() FROM INSERTED

End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o215"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o219">
<a:ObjectID>6958BD42-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_15</a:Name>
<a:Code>REFERENCE_15</a:Code>
<a:CreationDate>1081540974</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540974</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o204"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o85"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o215"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o220">
<a:ObjectID>6958BD44-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540974</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540974</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o205"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o86"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o221">
<a:CenterTextOffset>(1952, 150)</a:CenterTextOffset>
<a:Rect>((-743330,672750), (-735456,697112))</a:Rect>
<a:ListOfPoints>((-741116,672750),(-741565,697112))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>4210816</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Id="o222">
<a:Rect>((-742231,670866), (-735605,675412))</a:Rect>
<a:LineColor>4210816</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o223">
<a:ObjectID>6958BDBC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HVE</a:Name>
<a:Code>T_HVE</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o224">
<a:ObjectID>6958BCEF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_HOT</a:Name>
<a:Code>CD_HOT</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(7)</a:DataType>
<a:Length>7</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o225">
<a:ObjectID>6958BCF1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_HVE</a:Name>
<a:Code>CD_HVE</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(3)</a:DataType>
<a:Length>3</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o226">
<a:ObjectID>6958BCF3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DT_HVE_INI</a:Name>
<a:Code>DT_HVE_INI</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_DAT    Script Date: 7/8/2000 12:14:35 ******/
Create Rule        RU_DAT As
DATEPART(hh,@data) = 0 AND
DATEPART(mi,@data) = 0 AND
DATEPART(ss,@data) = 0 AND
DATEPART(ms,@data) = 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>smalldatetime</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o227">
<a:ObjectID>6958BCF4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DT_HVE_FIM</a:Name>
<a:Code>DT_HVE_FIM</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_DAT    Script Date: 7/8/2000 12:14:35 ******/
Create Rule        RU_DAT As
DATEPART(hh,@data) = 0 AND
DATEPART(mi,@data) = 0 AND
DATEPART(ss,@data) = 0 AND
DATEPART(ms,@data) = 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>smalldatetime</a:DataType>
</o:Column>
<o:Column Id="o228">
<a:ObjectID>6958BCF5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o229">
<a:ObjectID>6958BCF6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_HVE</a:Name>
<a:Code>Pk_T_HVE</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_HVE</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o224"/>
<o:Column Ref="o225"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Owner>
<o:User Ref="o13"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o230">
<a:ObjectID>6958BDBD-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HVE_TRD</a:Name>
<a:Code>T_HVE_TRD</a:Code>
<a:Text>Create Trigger T_HVE_TRD On T_HVE
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Hotran - Versão»Hotran - Frequência: Freqüências da Versão (Cascade) */
Delete T_HFR From T_HFR dep, Deleted pri
 Where dep.CD_HVE = pri.CD_HVE
   And dep.CD_HOT = pri.CD_HOT
/* Regra de negócio */
/* INCLUIR REGISTROS EM T_AHO */
INSERT	T_AHO (CD_HOT, DH_AHO)
SELECT 	DISTINCT CD_HOT, GETDATE()FROM DELETED

End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o231">
<a:ObjectID>6958BDBF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HVE_TRI</a:Name>
<a:Code>T_HVE_TRI</a:Code>
<a:Text>Create Trigger T_HVE_TRI On T_HVE
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Hotran»Hotran - Versão: Versões do Hotran */
If (Select Count(*) From T_HOT001, Inserted
Where T_HOT001.CD_HOT = Inserted.CD_HOT)
 &lt;&gt;(Select Count(CD_HOT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Hotran&gt; que se deseja incluir na tabela &lt;Hotran - Versão&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
/* Provocar a execução da trigger de update */
UPDATE	T_HVE
SET	DT_HVE_INI = DT_HVE_INI,
	DT_HVE_FIM = DT_HVE_FIM

WHERE	CD_HOT + CD_HVE IN (SELECT CD_HOT + CD_HVE FROM INSERTED)
End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o232">
<a:ObjectID>6958BDC1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HVE_TRU</a:Name>
<a:Code>T_HVE_TRU</a:Code>
<a:Text>Create Trigger T_HVE_TRU On T_HVE
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_HOT)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Hotran&gt; da tabela &lt;Hotran - Versão&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_HVE)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código da Versão do Hotran&gt; da tabela &lt;Hotran - Versão&gt; não pode ser alterada.&#39;
  Return
End
/* Regra de negócio */
/* A Versão cresce com a data inicial de validade, isto é, a data inicial de uma versão tem de ser maior que a da versão anterior.
    Verificar se há alguma versão com data anterior ou igual à da versão anterior */
IF UPDATE(DT_HVE_INI)
IF (SELECT COUNT(*) FROM T_HVE HVE, INSERTED INS
	WHERE	HVE.CD_HOT = INS.CD_HOT AND
		(HVE.CD_HVE &gt; INS.CD_HVE AND HVE.DT_HVE_INI &lt;= INS.DT_HVE_INI OR
		 HVE.CD_HVE &lt; INS.CD_HVE AND HVE.DT_HVE_INI &gt;= INS.DT_HVE_INI)) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: A data inicial de uma versão tem de ser maior que a data inicial da versão anterior.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* A data final (quando existir) tem de ser maior ou igual à data inicial */
IF UPDATE(DT_HVE_INI) OR UPDATE(DT_HVE_FIM)
IF (SELECT COUNT(*) FROM INSERTED 
	WHERE	DT_HVE_INI &gt; DT_HVE_FIM) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: A data final, quando existir, tem de ser maior ou igual à data inicial.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* FAZER AS VERIFICAÇÕES RELATIVAS AOS CODE-SHARE */

/* Declaração do cursor */
DECLARE INS_CURSOR CURSOR FOR
	SELECT 	DISTINCT 
		HET.CD_HOT,
		HET.CD_HVE,
		HET.CD_HFR,
		HET.TP_HET_CTG

	FROM	T_HET HET, INSERTED INS
	WHERE	HET.CD_HOT + HET.CD_HVE = INS.CD_HOT + INS.CD_HVE
	ORDER BY HET.CD_HOT, HET.CD_HVE, HET.CD_HFR, HET.TP_HET_CTG

/* Declaração das variáveis que receberão o cursor */
DECLARE @CD_HOT	CHAR(7),
	 @CD_HVE	CHAR(3),
	 @CD_HFR	CHAR(1),
	 @TP_HET_CTG	TINYINT

/* Abertura do cursor */
OPEN INS_CURSOR

/* Ir para o primeiro registro */
FETCH	INS_CURSOR
INTO	@CD_HOT,
	@CD_HVE,
	@CD_HFR,
	@TP_HET_CTG

/* Processar todos os registros de INS_CURSOR */
WHILE @@FETCH_STATUS = 0
BEGIN

	EXEC SP_VerificaCodeShare @CD_HOT, @CD_HVE, @CD_HFR, @TP_HET_CTG
	IF @@ERROR &lt;&gt; 0
	BEGIN
		CLOSE INS_CURSOR
		DEALLOCATE INS_CURSOR
		ROLLBACK TRANSACTION
		RETURN
	END


	/* Ir para o próximo registro */
	FETCH	NEXT FROM INS_CURSOR
	INTO	@CD_HOT,
		@CD_HVE,
		@CD_HFR,
		@TP_HET_CTG


END
CLOSE INS_CURSOR
DEALLOCATE INS_CURSOR


/* INCLUIR REGISTROS EM T_AHO */
INSERT	T_AHO (CD_HOT, DH_AHO)
SELECT 	DISTINCT CD_HOT, GETDATE() FROM INSERTED

End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o229"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o203"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o233">
<a:ObjectID>6958BD46-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_16</a:Name>
<a:Code>REFERENCE_16</a:Code>
<a:CreationDate>1081540974</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540974</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o204"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o223"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o215"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o234">
<a:ObjectID>6958BD48-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540974</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540974</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o205"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o224"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o235">
<a:CenterTextOffset>(3, 0)</a:CenterTextOffset>
<a:Rect>((-715688,698298), (-702116,721350))</a:Rect>
<a:ListOfPoints>((-715688,698298),(-702116,721350))</a:ListOfPoints>
<a:ArrowStyle>4881</a:ArrowStyle>
<a:LineColor>4210816</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o84"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o236">
<a:Rect>((-703945,718330), (-697241,722876))</a:Rect>
<a:LineColor>4210816</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o237">
<a:ObjectID>6958BDD1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_POR</a:Name>
<a:Code>T_POR</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081694164</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o238">
<a:ObjectID>6958BCF7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_POR</a:Name>
<a:Code>CD_POR</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o239">
<a:ObjectID>6958BCF9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_POR</a:Name>
<a:Code>NR_POR</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(4)</a:DataType>
<a:Length>4</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o240">
<a:ObjectID>6958BCFB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_EMB</a:Name>
<a:Code>CD_EMB</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o241">
<a:ObjectID>6958BCFE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o242">
<a:ObjectID>6958BD0A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_POR</a:Name>
<a:Code>Pk_T_POR</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_POR</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o238"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o243">
<a:ObjectID>6958BD01-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_POR_AER</a:Name>
<a:Code>I_POR_AER</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081694164</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o244">
<a:ObjectID>6958BD02-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o239"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o245">
<a:ObjectID>6958BD05-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_2&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o240"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o246">
<a:ObjectID>6958BD07-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_AER</a:Name>
<a:Code>I_AER</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081694164</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Ref="o13"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o247">
<a:ObjectID>6958BDEC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_POR_TRD</a:Name>
<a:Code>T_POR_TRD</a:Code>
<a:Text>Create Trigger T_POR_TRD On T_POR
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Portão»Hotran - Frequência: É Portão da Frequencia (Restrict) */
If (Select Count(*) From T_HFR dep, Deleted pri
 Where dep.CD_POR = pri.CD_POR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Portão&gt; está sendo referenciada na tabela &lt;Hotran - Frequência&gt;&#39;
  Return
End
/* Portão»FIDS - IST Servidor de Informação: Portão Associado ao IST (Restrict) */
If (Select Count(*) From T_FIDS_IST dep, Deleted pri
 Where dep.CD_POR = pri.CD_POR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Portão&gt; está sendo referenciada na tabela &lt;FIDS - IST Servidor de Informação&gt;&#39;
  Return
End
/* Portão»Mensagem de Partida: Portão da Mensagem de Partida (Restrict) */
If (Select Count(*) From T_MPA dep, Deleted pri
 Where dep.CD_POR = pri.CD_POR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Portão&gt; está sendo referenciada na tabela &lt;Mensagem de Partida&gt;&#39;
  Return
End
/* Portão»Mensagem de Partida - Mirror: Portão da Mensagem de Partida (Restrict) */
If (Select Count(*) From T_MPA_MIR dep, Deleted pri
 Where dep.CD_POR = pri.CD_POR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Portão&gt; está sendo referenciada na tabela &lt;Mensagem de Partida - Mirror&gt;&#39;
  Return
End
/* Portão»Partidas: Portão da Partida (Restrict) */
If (Select Count(*) From T_PAR dep, Deleted pri
 Where dep.CD_POR = pri.CD_POR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Portão&gt; está sendo referenciada na tabela &lt;Partidas&gt;&#39;
  Return
End
/* Portão»Partidas - Mirror: Portão da Partida (Restrict) */
If (Select Count(*) From T_PAR_MIR dep, Deleted pri
 Where dep.CD_POR = pri.CD_POR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Portão&gt; está sendo referenciada na tabela &lt;Partidas - Mirror&gt;&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o248">
<a:ObjectID>6958BDEE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_POR_TRI</a:Name>
<a:Code>T_POR_TRI</a:Code>
<a:Text>Create Trigger T_POR_TRI On T_POR
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Aeroporto»Portão: Aeroporto possui Portões */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Portão&gt; não está cadastrada&#39;
  Return
End
/* Sala de Embarque»Portão: Sal.Emb. possui portões Emb. */
If (Select Count(*) From T_EMB, Inserted
Where T_EMB.CD_EMB = Inserted.CD_EMB)
 &lt;&gt;(Select Count(CD_EMB) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Sala de Embarque&gt; que se deseja incluir na tabela &lt;Portão&gt; não está cadastrada&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o249">
<a:ObjectID>6958BDEF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_POR_TRU</a:Name>
<a:Code>T_POR_TRU</a:Code>
<a:Text>Create Trigger T_POR_TRU On T_POR
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_POR)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Portão&gt; da tabela &lt;Portão&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_AER)
/* Aeroporto»Portão: Aeroporto possui Portões */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Portão&gt; não está cadastrada&#39;
  Return
End
If Update (CD_EMB)
/* Sala de Embarque»Portão: Sal.Emb. possui portões Emb. */
If (Select Count(*) From T_EMB, Inserted
Where T_EMB.CD_EMB = Inserted.CD_EMB)
 &lt;&gt;(Select Count(CD_EMB) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Sala de Embarque&gt; que se deseja incluir na tabela &lt;Portão&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
IF UPDATE(NR_POR) OR UPDATE(CD_EMB)
BEGIN
	/* Incluir Registros em T_APA */
	INSERT	T_APA (DH_APA, CD_PAR)
	Select 	GETDATE(), CD_PAR
	From 	T_PAR PAR, INSERTED INS
	Where	PAR.TP_PAR_STA = 1 AND
		PAR.CD_AER = (Select CD_AER From T_PSI) AND
		PAR.CD_POR = INS.CD_POR

	/* Incluir Registros em T_AHO */
	INSERT	T_AHO (CD_HOT, DH_AHO)
	Select	DISTINCT CD_HOT, GETDATE()
	From	T_HFR HFR, INSERTED INS
	Where	HFR.CD_POR = INS.CD_POR

	/* Incluir Registros em T_AHP */
	INSERT	T_AHP (CD_HPA, DH_AHP)
	Select 	DISTINCT CD_HPA, GETDATE()
	From 	T_HPA001 HPA, T_CHG CHG, T_SIT SIT, T_PAR PAR, INSERTED INS
	Where	HPA.CD_CHG = CHG.CD_CHG AND
		SIT.CD_SIT = CHG.CD_SIT AND
		HPA.CD_AER = (Select CD_AER From T_PSI) AND
		(HPA.FL_HPA_ENT = 1 OR SIT.FL_SIT_AEN_PAT = 1) AND
		HPA.FL_HPA_SAI = 0 AND
		HPA.CD_AEN IS NOT NULL AND
		PAR.CD_CHG_AEN_ANT = HPA.CD_CHG AND
		PAR.CD_POR = INS.CD_POR
END

End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o242"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o250">
<a:ObjectID>6958BD4B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_17</a:Name>
<a:Code>REFERENCE_17</a:Code>
<a:CreationDate>1081540974</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540974</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o237"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o85"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o242"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o251">
<a:ObjectID>6958BD4D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540974</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540974</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o238"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o90"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o252">
<a:CenterTextOffset>(2, 0)</a:CenterTextOffset>
<a:Rect>((-743764,696975), (-735590,709398))</a:Rect>
<a:ListOfPoints>((-739888,696975),(-739501,709398))</a:ListOfPoints>
<a:ArrowStyle>4881</a:ArrowStyle>
<a:LineColor>4210816</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o203"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o253">
<a:Rect>((-742408,707621), (-735550,712167))</a:Rect>
<a:LineColor>4210816</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o254">
<a:ObjectID>6958BD62-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_COM</a:Name>
<a:Code>T_COM</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o255">
<a:ObjectID>6958BD7E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_COM</a:Name>
<a:Code>CD_COM</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o256">
<a:ObjectID>6958BD80-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_COM</a:Name>
<a:Code>NM_COM</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(30)</a:DataType>
<a:Length>30</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o257">
<a:ObjectID>6958BD83-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SG_COM_IAT_003</a:Name>
<a:Code>SG_COM_IAT_003</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(3)</a:DataType>
<a:Length>3</a:Length>
</o:Column>
<o:Column Id="o258">
<a:ObjectID>6958BD86-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SG_COM_IAT_002</a:Name>
<a:Code>SG_COM_IAT_002</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(2)</a:DataType>
<a:Length>2</a:Length>
</o:Column>
<o:Column Id="o259">
<a:ObjectID>6958BD89-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_COM_GR1</a:Name>
<a:Code>FL_COM_GR1</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o260">
<a:ObjectID>6958BD8B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_COM_GR2</a:Name>
<a:Code>FL_COM_GR2</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o261">
<a:ObjectID>6958BD8D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_COM_TAR_RED</a:Name>
<a:Code>FL_COM_TAR_RED</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o262">
<a:ObjectID>6958BD8F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_COM_MAT</a:Name>
<a:Code>CD_COM_MAT</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o263">
<a:ObjectID>6958BD91-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o264">
<a:ObjectID>6958BDA2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_COM</a:Name>
<a:Code>Pk_T_COM</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_COM</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o255"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o265">
<a:ObjectID>6958BD98-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_COM_GR1</a:Name>
<a:Code>I_COM_GR1</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o266">
<a:ObjectID>6958BD9A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o259"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o267">
<a:ObjectID>6958BD9B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_COM_GR2</a:Name>
<a:Code>I_COM_GR2</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o268">
<a:ObjectID>6958BD9C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o260"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o269">
<a:ObjectID>6958BD9D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_COM_IAT_002</a:Name>
<a:Code>I_COM_IAT_002</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o270">
<a:ObjectID>6958BD9E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o258"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o271">
<a:ObjectID>6958BD9F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_COM_IAT_003</a:Name>
<a:Code>I_COM_IAT_003</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o272">
<a:ObjectID>6958BDA0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o257"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Ref="o13"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o273">
<a:ObjectID>6958BCEE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_COM_TRD</a:Name>
<a:Code>T_COM_TRD</a:Code>
<a:Text>Create Trigger T_COM_TRD On T_COM
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Companhia Aérea»Chegadas: Comapanhia Aérea da Chegada (Restrict) */
If (Select Count(*) From T_CHG dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;Chegadas&gt;&#39;
  Return
End
/* Companhia Aérea»Chegadas - Mirror: Companhia Aérea da Chegada (Restrict) */
If (Select Count(*) From T_CHG_MIR dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;Chegadas - Mirror&gt;&#39;
  Return
End
/* Companhia Aérea»Partidas - Mirror: Companhia Aérea da Partida (Restrict) */
If (Select Count(*) From T_PAR_MIR dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;Partidas - Mirror&gt;&#39;
  Return
End
/* Companhia Aérea»Partidas: Companhia Aérea da Partida (Restrict) */
If (Select Count(*) From T_PAR dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;Partidas&gt;&#39;
  Return
End
/* Companhia Aérea»FIDS - IST Companhia: Companhia do ISC (Restrict) */
If (Select Count(*) From T_FIDS_ISC dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;FIDS - IST Companhia&gt;&#39;
  Return
End
/* Companhia Aérea»FIDS - Usuário do Grupo de Displays: DGT-COM:R (Restrict) */
If (Select Count(*) From T_FIDS_DGU dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;FIDS - Usuário do Grupo de Displays&gt;&#39;
  Return
End
/* Companhia Aérea»Hotran: É Companhia do Hotran (Restrict) */
If (Select Count(*) From T_HOT001 dep, Deleted pri
 Where dep.SG_COM = pri.SG_COM_IAT_003) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;Hotran&gt;&#39;
  Return
End
/* Companhia Aérea»Companhia Aérea: É Matriz de (Restrict) */
If (Select Count(*) From T_COM dep, Deleted pri
 Where dep.CD_COM_MAT = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;Companhia Aérea&gt;&#39;
  Return
End
/* Companhia Aérea»Informante da Situação de Vôo: possui (Restrict) */
If (Select Count(*) From T_IFT dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;Informante da Situação de Vôo&gt;&#39;
  Return
End
/* Companhia Aérea»Tarifas Pagas no Bilhete: Se Relaciona (Restrict) */
If (Select Count(*) From T_TFB001 dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;Tarifas Pagas no Bilhete&gt;&#39;
  Return
End
/* Companhia Aérea»Tarifas Pagas no Bilhete - Mirror: Se relaciona (Restrict) */
If (Select Count(*) From T_TFB001_MIR dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;Tarifas Pagas no Bilhete - Mirror&gt;&#39;
  Return
End
/* Companhia Aérea»Boxes da Companhia Aérea: Boxes da Companhia Aérea (Cascade) */
Delete T_BCO From T_BCO dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM
/* Companhia Aérea»Aeronave: Companh Aérea possui Aeronaves (Cascade) */
Delete T_AEN From T_AEN dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM
/* Companhia Aérea»Checkin: Companhia Aér. possui Checkins (Cascade) */
Delete T_CHK From T_CHK dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM
End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o274">
<a:ObjectID>6958BCF0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_COM_TRI</a:Name>
<a:Code>T_COM_TRI</a:Code>
<a:Text>Create Trigger T_COM_TRI On T_COM
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Companhia Aérea»Companhia Aérea: É Matriz de */
If (Select Count(*) From T_COM, Inserted
Where T_COM.CD_COM = Inserted.CD_COM_MAT)
 &lt;&gt;(Select Count(CD_COM_MAT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Companhia Aérea&gt; que se deseja incluir na tabela &lt;Companhia Aérea&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
/* Verificar se há alguma situação que não seja do Grupo 1 nem do Grupo 2 */
IF (	SELECT	COUNT(*)
	FROM	INSERTED INS,
		T_COM COM
	WHERE	COM.CD_COM = INS.CD_COM AND
		INS.FL_COM_GR1 = 0 AND 
		INS.FL_COM_GR2 = 0) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Uma Companhia Aérea deve pertencer a pelo menos um Grupo .&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Verificar se quando a companhia for do Grupo 1, existe sigla IATA-3 */
IF (	SELECT	COUNT(*)
	FROM	INSERTED INS,
		T_COM COM
	WHERE	COM.CD_COM = INS.CD_COM AND
		INS.FL_COM_GR1 = 1 AND 
		INS.SG_COM_IAT_003 = &#39;&#39;) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Uma Companhia Aérea do Grupo 1 deve possuir sigla IATA-3.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Verificar se quando a companhia for do Grupo 1, existe sigla IATA-2 */
IF (	SELECT	COUNT(*)
	FROM	INSERTED INS,
		T_COM COM
	WHERE	COM.CD_COM = INS.CD_COM AND
		INS.FL_COM_GR1 = 1 AND 
		INS.SG_COM_IAT_002 = &#39;&#39;) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Uma Companhia Aérea do Grupo 1 deve possuir sigla IATA-2.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Verificar se já existe alguma companhia cadastrada com a sigla IATA-3 da companhia que se está incluindo */
IF (	SELECT	COUNT(*)
	FROM	T_COM COM, 
		INSERTED INS
	WHERE	COM.CD_COM &lt;&gt; INS.CD_COM AND
		COM.SG_COM_IAT_003 = INS.SG_COM_IAT_003 AND
		INS.SG_COM_IAT_003 &lt;&gt; &#39;&#39;) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Já existe uma Companhia Áerea cadastrada com esta sigla IATA-3.&#39;
	ROLLBACK TRANSACTION
	RETURN
END


/* Verificar se já existe alguma companhia cadastrada com a sigla IATA-2 da companhia que se está incluindo */
IF (	SELECT	COUNT(*)
	FROM	T_COM COM, 
		INSERTED INS
	WHERE	COM.CD_COM &lt;&gt; INS.CD_COM AND
		COM.SG_COM_IAT_002 = INS.SG_COM_IAT_002 AND
		INS.SG_COM_IAT_002 &lt;&gt; &#39;&#39;) &gt; 0
BEGIN 
	RAISERROR 20310 &#39;Operação não executada: Já existe uma Companhia Áerea cadastrada com esta sigla IATA-2.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o275">
<a:ObjectID>6958BCF2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_COM_TRU</a:Name>
<a:Code>T_COM_TRU</a:Code>
<a:Text>Create Trigger T_COM_TRU On T_COM
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_COM)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código da Companhia Aérea&gt; da tabela &lt;Companhia Aérea&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_COM_MAT)
/* Companhia Aérea»Companhia Aérea: É Matriz de */
If (Select Count(*) From T_COM, Inserted
Where T_COM.CD_COM = Inserted.CD_COM_MAT)
 &lt;&gt;(Select Count(CD_COM_MAT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Companhia Aérea&gt; que se deseja incluir na tabela &lt;Companhia Aérea&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
/* Verificar se há alguma Companhia que não seja do Grupo 1 nem do Grupo 2 */
IF (	SELECT	COUNT(*)
	FROM	INSERTED
	WHERE	FL_COM_GR1 = 0 AND FL_COM_GR2 = 0) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Uma Companhia Aérea deve pertencer a pelo menos um Grupo.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Verificar se quando a companhia for do Grupo 1, existe sigla IATA-3 */
IF (	SELECT	COUNT(*)
	FROM	INSERTED INS,
		T_COM COM
	WHERE	COM.CD_COM = INS.CD_COM AND
		INS.FL_COM_GR1 = 1 AND 
		INS.SG_COM_IAT_003 = &#39;&#39;) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Uma Companhia Aérea do Grupo 1 deve possuir sigla IATA-3.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Verificar se quando a companhia for do Grupo 1, existe sigla IATA-2 */
IF (	SELECT	COUNT(*)
	FROM	INSERTED INS,
		T_COM COM
	WHERE	COM.CD_COM = INS.CD_COM AND
		INS.FL_COM_GR1 = 1 AND 
		INS.SG_COM_IAT_002 = &#39;&#39;) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Uma Companhia Aérea do Grupo 1 deve possuir sigla IATA-2.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Não permitir que o campo SG_COM_IAT_003 seja alterado se existir alguma referência a esta sigla na tabela T_HOT001 */
IF UPDATE(SG_COM_IAT_003)
BEGIN
	IF (	SELECT	COUNT(*)
		FROM	DELETED DEL, T_HOT001 HOT
		WHERE	HOT.SG_COM = DEL.SG_COM_IAT_003) &gt; 0
	BEGIN 
		RAISERROR 20310 &#39;Operação não executada: A sigla IATA-3 dessa Companhia Aérea não pode ser alterada pois está sendo referenciada em pelo menos um Hotran.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
END

/* Verificar se já existe alguma companhia cadastrada com a sigla IATA-3 da companhia que se está alterando */
IF (	SELECT	COUNT(*)
	FROM	T_COM COM, 
		INSERTED INS
	WHERE	COM.CD_COM &lt;&gt; INS.CD_COM AND
		COM.SG_COM_IAT_003 = INS.SG_COM_IAT_003 AND
		INS.SG_COM_IAT_003 &lt;&gt; &#39;&#39;) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Já existe uma Companhia Áerea cadastrada com esta sigla IATA-3.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Verificar se já existe alguma companhia cadastrada com a sigla IATA-2 da companhia que se está alterando */
IF (	SELECT	COUNT(*)
	FROM	T_COM COM, 
		INSERTED INS
	WHERE	COM.CD_COM &lt;&gt; INS.CD_COM AND
		COM.SG_COM_IAT_002 = INS.SG_COM_IAT_002 AND
		INS.SG_COM_IAT_002 &lt;&gt; &#39;&#39;) &gt; 0
BEGIN 
	RAISERROR 20310 &#39;Operação não executada: Já existe uma Companhia Áerea cadastrada com esta sigla IATA-2.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

IF UPDATE(SG_COM_IAT_003)
BEGIN
	/* Incluir Registros em T_ACH */
	INSERT	T_ACH (DH_ACH, CD_CHG)
	Select 	GETDATE(), CD_CHG
	From 	T_CHG CHG, INSERTED INS
	Where	CHG.TP_CHG_STA = 1 AND
		CHG.CD_AER = (Select CD_AER From T_PSI) AND
		CHG.CD_COM = INS.CD_COM

	/* Incluir Registros em T_APA */
	INSERT	T_APA (DH_APA, CD_PAR)
	Select 	GETDATE(), CD_PAR
	From 	T_PAR PAR, INSERTED INS
	Where	PAR.TP_PAR_STA = 1 AND
		PAR.CD_AER = (Select CD_AER From T_PSI) AND
		PAR.CD_COM = INS.CD_COM

	/* Incluir Registros em T_AHP - Chegadas */
	INSERT	T_AHP (CD_HPA, DH_AHP)
	Select 	DISTINCT CD_HPA, GETDATE()
	From 	T_HPA001 HPA, T_CHG CHG, T_SIT SIT, INSERTED INS
	Where	HPA.CD_CHG = CHG.CD_CHG AND
		SIT.CD_SIT = CHG.CD_SIT AND
		HPA.CD_AER = (Select CD_AER From T_PSI) AND
		(HPA.FL_HPA_ENT = 1 OR SIT.FL_SIT_AEN_PAT = 1) AND
		HPA.FL_HPA_SAI = 0 AND
		HPA.CD_AEN IS NOT NULL AND
		CHG.CD_COM = INS.CD_COM

	/* Incluir Registros em T_AHP - Partidas */
	INSERT	T_AHP (CD_HPA, DH_AHP)
	Select 	DISTINCT CD_HPA, GETDATE()
	From 	T_HPA001 HPA, T_CHG CHG, T_SIT SIT, T_PAR PAR, INSERTED INS
	Where	HPA.CD_CHG = CHG.CD_CHG AND
		SIT.CD_SIT = CHG.CD_SIT AND
		HPA.CD_AER = (Select CD_AER From T_PSI) AND
		(HPA.FL_HPA_ENT = 1 OR SIT.FL_SIT_AEN_PAT = 1) AND
		HPA.FL_HPA_SAI = 0 AND
		HPA.CD_AEN IS NOT NULL AND
		PAR.CD_CHG_AEN_ANT = HPA.CD_CHG AND
		PAR.CD_COM = INS.CD_COM

END
End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o264"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o276">
<a:ObjectID>6958BD81-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_17</a:Name>
<a:Code>REFERENCE_17</a:Code>
<a:CreationDate>1081693901</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081693901</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o254"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o204"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o264"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o277">
<a:ObjectID>6958BD84-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081693901</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081693901</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o255"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o206"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o278">
<a:Rect>((-714453,673950), (-706579,684300))</a:Rect>
<a:ListOfPoints>((-710516,684300),(-710516,673950))</a:ListOfPoints>
<a:ArrowStyle>4881</a:ArrowStyle>
<a:LineColor>4210816</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o52"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o279">
<a:Rect>((-714522,671883), (-707818,675483))</a:Rect>
<a:LineColor>4210816</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o280">
<a:ObjectID>6958BD69-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_EQP</a:Name>
<a:Code>T_EQP</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o281">
<a:ObjectID>6958BDA5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_EQP</a:Name>
<a:Code>CD_EQP</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o282">
<a:ObjectID>6958BDA7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_EQP</a:Name>
<a:Code>NM_EQP</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(20)</a:DataType>
<a:Length>20</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o283">
<a:ObjectID>6958BDAA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SG_EQP</a:Name>
<a:Code>SG_EQP</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(10)</a:DataType>
<a:Length>10</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o284">
<a:ObjectID>6958BDAC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_EQP_ASS_MIN</a:Name>
<a:Code>NR_EQP_ASS_MIN</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o285">
<a:ObjectID>6958BDAE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_EQP_ASS_MAX</a:Name>
<a:Code>NR_EQP_ASS_MAX</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o286">
<a:ObjectID>6958BDB0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_EQP_CRG_MIN</a:Name>
<a:Code>QT_EQP_CRG_MIN</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>float(15)</a:DataType>
<a:Length>15</a:Length>
</o:Column>
<o:Column Id="o287">
<a:ObjectID>6958BDB2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_EQP_CRG_MAX</a:Name>
<a:Code>QT_EQP_CRG_MAX</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>float(15)</a:DataType>
<a:Length>15</a:Length>
</o:Column>
<o:Column Id="o288">
<a:ObjectID>6958BDB4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_EQP_PMD</a:Name>
<a:Code>QT_EQP_PMD</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>float(15)</a:DataType>
<a:Length>15</a:Length>
</o:Column>
<o:Column Id="o289">
<a:ObjectID>6958BDB5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_EQP_ENV</a:Name>
<a:Code>QT_EQP_ENV</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>float(15)</a:DataType>
<a:Length>15</a:Length>
</o:Column>
<o:Column Id="o290">
<a:ObjectID>6958BDB7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_EQP_COM</a:Name>
<a:Code>QT_EQP_COM</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>float(15)</a:DataType>
<a:Length>15</a:Length>
</o:Column>
<o:Column Id="o291">
<a:ObjectID>6958BDB8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_EQP_HLC</a:Name>
<a:Code>FL_EQP_HLC</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o292">
<a:ObjectID>6958BDB9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o293">
<a:ObjectID>6958BDBE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_EQP</a:Name>
<a:Code>Pk_T_EQP</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_EQP</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o281"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o294">
<a:ObjectID>6958BDBA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_EQP_SGL</a:Name>
<a:Code>I_EQP_SGL</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o295">
<a:ObjectID>6958BDBB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o283"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Ref="o13"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o296">
<a:ObjectID>6958BD0E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_EQP_TRD</a:Name>
<a:Code>T_EQP_TRD</a:Code>
<a:Text>Create Trigger T_EQP_TRD On T_EQP
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Equipamento»Hotran - Etapa: É Equipamento da Etapa (Restrict) */
If (Select Count(*) From T_HET dep, Deleted pri
 Where dep.SG_EQP = pri.SG_EQP) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Equipamento&gt; está sendo referenciada na tabela &lt;Hotran - Etapa&gt;&#39;
  Return
End
/* Equipamento»Aeronave: Equipamento (Restrict) */
If (Select Count(*) From T_AEN dep, Deleted pri
 Where dep.CD_EQP = pri.CD_EQP) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Equipamento&gt; está sendo referenciada na tabela &lt;Aeronave&gt;&#39;
  Return
End
/* Equipamento»Chegadas - Mirror: Equipamento da Chegada (Restrict) */
If (Select Count(*) From T_CHG_MIR dep, Deleted pri
 Where dep.CD_EQP_CHG = pri.CD_EQP) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Equipamento&gt; está sendo referenciada na tabela &lt;Chegadas - Mirror&gt;&#39;
  Return
End
/* Equipamento»Chegadas: Equipamento da Chegada (Restrict) */
If (Select Count(*) From T_CHG dep, Deleted pri
 Where dep.CD_EQP_CHG = pri.CD_EQP) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Equipamento&gt; está sendo referenciada na tabela &lt;Chegadas&gt;&#39;
  Return
End
/* Equipamento»Hotran - Boxes: Equipamento do HBX (Restrict) */
If (Select Count(*) From T_HBX001 dep, Deleted pri
 Where dep.SG_EQP = pri.SG_EQP) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Equipamento&gt; está sendo referenciada na tabela &lt;Hotran - Boxes&gt;&#39;
  Return
End
/* Equipamento»Histórico de Permanência de Aeronaves - Mirror: Equipamento do HPA (Restrict) */
If (Select Count(*) From T_HPA001_MIR dep, Deleted pri
 Where dep.CD_EQP = pri.CD_EQP) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Equipamento&gt; está sendo referenciada na tabela &lt;Histórico de Permanência de Aeronaves - Mirror&gt;&#39;
  Return
End
/* Equipamento»Histórico de Permanência de Aeronaves: Equipamento do HPA (Restrict) */
If (Select Count(*) From T_HPA001 dep, Deleted pri
 Where dep.CD_EQP = pri.CD_EQP) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Equipamento&gt; está sendo referenciada na tabela &lt;Histórico de Permanência de Aeronaves&gt;&#39;
  Return
End
/* Equipamento»Boxes do Equipamento: Boxes do Equipamento (Cascade) */
Delete T_BEQ From T_BEQ dep, Deleted pri
 Where dep.CD_EQP = pri.CD_EQP
End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o297">
<a:ObjectID>6958BD10-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_EQP_TRU</a:Name>
<a:Code>T_EQP_TRU</a:Code>
<a:Text>Create Trigger T_EQP_TRU On T_EQP
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_EQP)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Equipamento&gt; da tabela &lt;Equipamento&gt; não pode ser alterada.&#39;
  Return
End
/* Regra de negócio */
/* Caso a sigla do equipamento seja alterada, alterar os campos correspondente nas tabelas T_HBX001 e T_HET */
IF UPDATE(SG_EQP)
BEGIN
	UPDATE	HBX
	SET	SG_EQP = INS.SG_EQP
	FROM	T_HBX001 HBX, INSERTED INS, DELETED DEL
	WHERE	INS.CD_EQP = DEL.CD_EQP AND
		HBX.SG_EQP = DEL.SG_EQP

	UPDATE	HET
	SET	SG_EQP = INS.SG_EQP
	FROM	T_HET HET, INSERTED INS, DELETED DEL
	WHERE	INS.CD_EQP = DEL.CD_EQP AND
		HET.SG_EQP = DEL.SG_EQP
END

IF UPDATE(SG_EQP)
BEGIN
	/* Incluir Registros em T_ACH */
	INSERT	T_ACH (DH_ACH, CD_CHG)
	Select 	GETDATE(), CD_CHG
	From 	T_CHG CHG, T_EQP EQP, T_AEN AEN, INSERTED INS
	Where	CHG.TP_CHG_STA = 1 AND
		CHG.CD_AER = (Select CD_AER From T_PSI) AND
		AEN.CD_AEN = CHG.CD_AEN_CHG AND
		EQP.CD_EQP = AEN.CD_EQP AND
		EQP.CD_EQP = INS.CD_EQP

	/* Incluir Registros em T_APA */
	INSERT	T_APA (DH_APA, CD_PAR)
	Select 	GETDATE(), CD_PAR
	From 	T_PAR PAR, T_CHG CHG, T_EQP EQP, T_AEN AEN, INSERTED INS
	Where	PAR.TP_PAR_STA = 1 AND
		PAR.CD_AER = (Select CD_AER From T_PSI) AND
		CHG.CD_CHG = PAR.CD_CHG_AEN_ANT AND
		AEN.CD_AEN = CHG.CD_AEN_CHG AND
		EQP.CD_EQP = AEN.CD_EQP AND
		EQP.CD_EQP = INS.CD_EQP

	/* Incluir Registros em T_AHP */
	INSERT	T_AHP (CD_HPA, DH_AHP)
	Select	DISTINCT CD_HPA, GETDATE()
	From	T_HPA001 HPA, T_CHG CHG, T_SIT SIT, T_AEN AEN, T_EQP EQP, INSERTED INS
	Where	HPA.CD_CHG = CHG.CD_CHG AND
		SIT.CD_SIT = CHG.CD_SIT AND
		HPA.CD_AER = (Select CD_AER From T_PSI) AND
		(HPA.FL_HPA_ENT = 1 OR SIT.FL_SIT_AEN_PAT = 1) AND
		HPA.FL_HPA_SAI = 0 AND
		AEN.CD_AEN = HPA.CD_AEN AND
		EQP.CD_EQP = AEN.CD_EQP AND
		EQP.CD_EQP = INS.CD_EQP
END

End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o293"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o298">
<a:ObjectID>6958BD8A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_14</a:Name>
<a:Code>REFERENCE_14</a:Code>
<a:CreationDate>1081694471</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081694471</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o280"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o53"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o293"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o299">
<a:ObjectID>6958BD8C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081694471</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081694471</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o281"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o57"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o300">
<a:CenterTextOffset>(153, 1050)</a:CenterTextOffset>
<a:Rect>((-724028,673312), (-709758,684411))</a:Rect>
<a:ListOfPoints>((-724028,684411),(-709758,673312))</a:ListOfPoints>
<a:ArrowStyle>4881</a:ArrowStyle>
<a:LineColor>4210816</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o174"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o279"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o301">
<a:ObjectID>6958BD90-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_15</a:Name>
<a:Code>REFERENCE_15</a:Code>
<a:CreationDate>1081694495</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081694495</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o280"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o175"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o293"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o302">
<a:ObjectID>6958BD92-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081694495</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081694495</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o281"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o180"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o303">
<a:CenterTextOffset>(1065, -1800)</a:CenterTextOffset>
<a:Rect>((-731580,673688), (-719956,686084))</a:Rect>
<a:ListOfPoints>((-724887,686084),(-724605,673688))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>4210816</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o174"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o304">
<a:Rect>((-728780,670800), (-722154,675368))</a:Rect>
<a:LineColor>4210816</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o305">
<a:ObjectID>6958BD49-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_AER</a:Name>
<a:Code>T_AER</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o306">
<a:ObjectID>6958BD1F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_AER</a:Name>
<a:Code>CD_AER</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o307">
<a:ObjectID>6958BD21-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_AER</a:Name>
<a:Code>NM_AER</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(40)</a:DataType>
<a:Length>40</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o308">
<a:ObjectID>6958BD23-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SG_AER_ICA</a:Name>
<a:Code>SG_AER_ICA</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(4)</a:DataType>
<a:Length>4</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o309">
<a:ObjectID>6958BD25-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SG_AER_IAT</a:Name>
<a:Code>SG_AER_IAT</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(3)</a:DataType>
<a:Length>3</a:Length>
</o:Column>
<o:Column Id="o310">
<a:ObjectID>6958BD27-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_AER_TEL_CHG</a:Name>
<a:Code>NR_AER_TEL_CHG</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o311">
<a:ObjectID>6958BD28-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_AER_TEL_PAR</a:Name>
<a:Code>NR_AER_TEL_PAR</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o312">
<a:ObjectID>6958BD29-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_AER_CTG</a:Name>
<a:Code>TP_AER_CTG</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o313">
<a:ObjectID>6958BD2B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_CID</a:Name>
<a:Code>CD_CID</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o314">
<a:ObjectID>6958BD2D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o315">
<a:ObjectID>6958BD35-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_AER</a:Name>
<a:Code>Pk_T_AER</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_AER</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o306"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o316">
<a:ObjectID>6958BD31-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_AER_ICA</a:Name>
<a:Code>I_AER_ICA</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o317">
<a:ObjectID>6958BD33-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o308"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Ref="o13"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o318">
<a:ObjectID>6958BDF1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_AER_TRD</a:Name>
<a:Code>T_AER_TRD</a:Code>
<a:Text>Create Trigger T_AER_TRD On T_AER
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Aeroporto»Chegadas - Mirror: Aeroporto da Chegada (Restrict) */
If (Select Count(*) From T_CHG_MIR dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Chegadas - Mirror&gt;&#39;
  Return
End
/* Aeroporto»Chegadas: Aeroporto da Chegada (Restrict) */
If (Select Count(*) From T_CHG dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Chegadas&gt;&#39;
  Return
End
/* Aeroporto»Escala da Chegada de Vôo - Mirror: Aeroporto da Escala de Partida (Restrict) */
If (Select Count(*) From T_ECC001_MIR dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Escala da Chegada de Vôo - Mirror&gt;&#39;
  Return
End
/* Aeroporto»Escala da Partida de Vôo - Mirror: Aeroporto da Escala de Partida (Restrict) */
If (Select Count(*) From T_ECP001_MIR dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Escala da Partida de Vôo - Mirror&gt;&#39;
  Return
End
/* Aeroporto»Partidas - Mirror: Aeroporto da Partida (Restrict) */
If (Select Count(*) From T_PAR_MIR dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Partidas - Mirror&gt;&#39;
  Return
End
/* Aeroporto»Partidas: Aeroporto da Partida (Restrict) */
If (Select Count(*) From T_PAR dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Partidas&gt;&#39;
  Return
End
/* Aeroporto»Tela: Aeroporto das Telas (Restrict) */
If (Select Count(*) From T_TEL dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Tela&gt;&#39;
  Return
End
/* Aeroporto»Hotran - Etapa: Aeroporto Destino (Restrict) */
If (Select Count(*) From T_HET dep, Deleted pri
 Where dep.SG_AER_DES = pri.SG_AER_ICA) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Hotran - Etapa&gt;&#39;
  Return
End
/* Aeroporto»Histórico de Permanência de Aeronaves - Mirror: Aeroporto do HPA (Restrict) */
If (Select Count(*) From T_HPA001_MIR dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Histórico de Permanência de Aeronaves - Mirror&gt;&#39;
  Return
End
/* Aeroporto»Histórico de Permanência de Aeronaves: Aeroporto do HPA (Restrict) */
If (Select Count(*) From T_HPA001 dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Histórico de Permanência de Aeronaves&gt;&#39;
  Return
End
/* Aeroporto»Dados Estatísticos de Partida - Mirror: Aeroporto está em (Restrict) */
If (Select Count(*) From T_DEP_MIR dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Dados Estatísticos de Partida - Mirror&gt;&#39;
  Return
End
/* Aeroporto»Escala da Chegada de Vôo: Aeroporto integra ECC (Restrict) */
If (Select Count(*) From T_ECC001 dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Escala da Chegada de Vôo&gt;&#39;
  Return
End
/* Aeroporto»Escala da Partida de Vôo: Aeroporto integra ECP (Restrict) */
If (Select Count(*) From T_ECP001 dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Escala da Partida de Vôo&gt;&#39;
  Return
End
/* Aeroporto»Parâmetros do Sistema: Aeroporto Integra Par. Sistema (Restrict) */
If (Select Count(*) From T_PSI dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Parâmetros do Sistema&gt;&#39;
  Return
End
/* Aeroporto»Hotran - Etapa: Aeroporto Origem (Restrict) */
If (Select Count(*) From T_HET dep, Deleted pri
 Where dep.SG_AER_ORI = pri.SG_AER_ICA) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Hotran - Etapa&gt;&#39;
  Return
End
/* Aeroporto»Propaganda: Aeroporto Possui Propagandas (Restrict) */
If (Select Count(*) From T_PRG dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Propaganda&gt;&#39;
  Return
End
/* Aeroporto»Dados Estatísticos de Partida: Está em (Restrict) */
If (Select Count(*) From T_DEP dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Dados Estatísticos de Partida&gt;&#39;
  Return
End
/* Aeroporto»Horário Comercial: Aer. possui Horário Comercial (Cascade) */
Delete T_HRC From T_HRC dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER
/* Aeroporto»Box: Aeroporto possui Boxes (Cascade) */
Delete T_BOX From T_BOX dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER
/* Aeroporto»Checkin: Aeroporto possui Checkins (Cascade) */
Delete T_CHK From T_CHK dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER
/* Aeroporto»Esteira: Aeroporto possui Esteiras (Cascade) */
Delete T_EST From T_EST dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER
/* Aeroporto»Pistas de Decolagem: Aeroporto possui Pista (Cascade) */
Delete T_PIS From T_PIS dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER
/* Aeroporto»Ponte de Embarque: Aeroporto possui Pista de Embarque (Cascade) */
Delete T_PON From T_PON dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER
/* Aeroporto»Portão: Aeroporto possui Portões (Cascade) */
Delete T_POR From T_POR dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER
/* Aeroporto»Sala de Desembarque: Aeroporto possui Sal.Desemb. (Cascade) */
Delete T_SAL From T_SAL dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER
/* Aeroporto»Sala de Embarque: Aeroporto possui SalasEmbarque (Cascade) */
Delete T_EMB From T_EMB dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER
End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o319">
<a:ObjectID>6958BDF3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_AER_TRI</a:Name>
<a:Code>T_AER_TRI</a:Code>
<a:Text>Create Trigger T_AER_TRI On T_AER
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Cidade»Aeroporto: Cidade possui Aeroportos */
If (Select Count(*) From T_CID, Inserted
Where T_CID.CD_CID = Inserted.CD_CID)
 &lt;&gt;(Select Count(CD_CID) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Cidade&gt; que se deseja incluir na tabela &lt;Aeroporto&gt; não está cadastrada&#39;
  Return
End
/* Domínio de: Categoria do Aeroporto */
/* 1 - Não se aplica */
/* 2 - 1ª Categoria */
/* 3 - 2ª Categoria */
/* 4 - 3ª Categoria */
/* 5 - 4ª Categoria */
If (Select Count(*) From Inserted
    Where TP_AER_CTG In (1,2,3,4,5))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Categoria do Aeroporto&gt; que se deseja incluir na tabela &lt;Aeroporto&gt; não é uma opção válida&#39;
  Return
End
/* Regra de negócio */
/* Verificar se já existe algum Aeroporto com a sigla IATA do Aeroporto que se está incluindo */
IF (	SELECT	COUNT(*)
	FROM	T_AER AER, 
		INSERTED INS
	WHERE	AER.CD_AER &lt;&gt; INS.CD_AER AND
		AER.SG_AER_IAT = INS.SG_AER_IAT AND
		INS.SG_AER_IAT IS NOT NULL) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Já existe um Aeroporto cadastrado com esta sigla IATA.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o320">
<a:ObjectID>6958BDF5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_AER_TRU</a:Name>
<a:Code>T_AER_TRU</a:Code>
<a:Text>Create Trigger T_AER_TRU On T_AER
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_AER)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Aeroporto&gt; da tabela &lt;Aeroporto&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_CID)
/* Cidade»Aeroporto: Cidade possui Aeroportos */
If (Select Count(*) From T_CID, Inserted
Where T_CID.CD_CID = Inserted.CD_CID)
 &lt;&gt;(Select Count(CD_CID) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Cidade&gt; que se deseja incluir na tabela &lt;Aeroporto&gt; não está cadastrada&#39;
  Return
End
If Update (TP_AER_CTG)
/* Domínio de: Categoria do Aeroporto */
/* 1 - Não se aplica */
/* 2 - 1ª Categoria */
/* 3 - 2ª Categoria */
/* 4 - 3ª Categoria */
/* 5 - 4ª Categoria */
If (Select Count(*) From Inserted
    Where TP_AER_CTG In (1,2,3,4,5))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Categoria do Aeroporto&gt; que se deseja incluir na tabela &lt;Aeroporto&gt; não é uma opção válida&#39;
  Return
End
/* Regra de negócio */
/* Verificar se já existe algum Aeroporto cadastrado com a sigla IATA do Aeroporto que se está alterando */
IF (	SELECT	COUNT(*)
	FROM	T_AER AER, 
		INSERTED INS
	WHERE	AER.CD_AER &lt;&gt; INS.CD_AER AND
		AER.SG_AER_IAT = INS.SG_AER_IAT AND
		INS.SG_AER_IAT IS NOT NULL) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Já existe um Aeroporto cadastrado com esta sigla IATA.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Caso a sigla ICAO do aeroporto seja alterada, alterar os campos SG_AER_DES E SG_AER_ORI da tabela T_HET */
IF UPDATE(SG_AER_ICA)
BEGIN
	UPDATE	HET
	SET	SG_AER_DES = INS.SG_AER_ICA
	FROM	T_HET HET, INSERTED INS, DELETED DEL
	WHERE	INS.CD_AER = DEL.CD_AER AND
		HET.SG_AER_DES = DEL.SG_AER_ICA

	UPDATE	HET
	SET	SG_AER_ORI = INS.SG_AER_ICA
	FROM	T_HET HET, INSERTED INS, DELETED DEL
	WHERE	INS.CD_AER = DEL.CD_AER AND
		HET.SG_AER_ORI = DEL.SG_AER_ICA
END

IF UPDATE(SG_AER_ICA) OR UPDATE(SG_AER_IAT)
BEGIN
	/* Incluir registros em T_ACH */
	INSERT	T_ACH (DH_ACH, CD_CHG)
	Select	GETDATE(), ECC.CD_CHG
	From	T_ECC001 ECC, T_AER AER, INSERTED INS
	Where	ECC.CD_CHG IN (	Select 	CD_CHG
				From 	T_CHG CHG
				Where	CHG.TP_CHG_STA = 1 And
					CHG.CD_AER = (Select CD_AER From T_PSI)) AND
		AER.CD_AER = ECC.CD_AER AND
		AER.CD_AER = INS.CD_AER

	/* Incluir registros em T_APA */
	INSERT	T_APA (DH_APA, CD_PAR)
	Select	GETDATE(), ECP.CD_PAR
	From	T_ECP001 ECP, T_AER AER, INSERTED INS
	Where	ECP.CD_PAR IN (	Select 	CD_PAR
				From 	T_PAR PAR
				Where	PAR.TP_PAR_STA = 1 And
					PAR.CD_AER = (Select CD_AER From T_PSI)) AND
		AER.CD_AER = ECP.CD_AER AND
		AER.CD_AER = INS.CD_AER
END

IF UPDATE(SG_AER_IAT)
BEGIN
	/* Incluir registros em T_AHO */
	INSERT	T_AHO (CD_HOT, DH_AHO)
	Select	DISTINCT CD_HOT, GETDATE()
	From	T_HET HET, INSERTED INS
	Where	HET.SG_AER_ORI = INS.SG_AER_ICA OR
		HET.SG_AER_DES = INS.SG_AER_ICA

	-- Alexei alterou em 05/01/00
	-- Não permitir a alteração da sigla IATA para NULO se o aeroporto estiver em alguma etapa de hotran
	IF (	Select	Count(*)
		from	T_Het Het
		,	Inserted Ins
		where	(Het.SG_AER_ORI = Ins.SG_AER_ICA
		or	Het.SG_AER_DES = Ins.SG_AER_ICA)
		and	Ins.SG_AER_IAT is NULL) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: O aeroporto não pode ter sigla IATA nula pois está sendo utilizado em etapa de hotran.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
	-- Fim Alteração Alexei em 05/01/00

END
End
go</a:Text>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o315"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o321">
<a:ObjectID>6958BD96-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_16</a:Name>
<a:Code>REFERENCE_16</a:Code>
<a:CreationDate>1081694573</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081694661</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o305"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o175"/>
</c:Object2>
<c:Joins>
<o:ReferenceJoin Id="o322">
<a:ObjectID>6958BD99-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081694573</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081694768</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o308"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o189"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o323">
<a:CenterTextOffset>(-1950, 750)</a:CenterTextOffset>
<a:Rect>((-734552,674234), (-723152,686433))</a:Rect>
<a:ListOfPoints>((-727918,686433),(-727719,674234))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>4210816</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o174"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o304"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o324">
<a:ObjectID>6958BDA3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_17</a:Name>
<a:Code>REFERENCE_17</a:Code>
<a:CreationDate>1081694798</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081694821</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o305"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o175"/>
</c:Object2>
<c:Joins>
<o:ReferenceJoin Id="o325">
<a:ObjectID>6958BDA8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081694821</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081694821</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o308"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o185"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o326">
<a:CenterTextOffset>(-150, 1200)</a:CenterTextOffset>
<a:Rect>((-737846,686700), (-726116,698309))</a:Rect>
<a:ListOfPoints>((-726116,686700),(-737846,698309))</a:ListOfPoints>
<a:ArrowStyle>4881</a:ArrowStyle>
<a:LineColor>4210816</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o174"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o203"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o327">
<a:ObjectID>6958BDAD-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_18</a:Name>
<a:Code>REFERENCE_18</a:Code>
<a:CreationDate>1081694946</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081695045</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o204"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o175"/>
</c:Object2>
<c:Joins>
<o:ReferenceJoin Id="o328">
<a:ObjectID>6958BDB3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081695045</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081695045</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o205"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o182"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o329">
<a:CenterTextOffset>(-743, -1500)</a:CenterTextOffset>
<a:Rect>((-740355,684286), (-727508,696000))</a:Rect>
<a:ListOfPoints>((-727508,684286),(-739316,696000))</a:ListOfPoints>
<a:ArrowStyle>4881</a:ArrowStyle>
<a:LineColor>4210816</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o174"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o203"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o330">
<a:ObjectID>6958BDAF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_19</a:Name>
<a:Code>REFERENCE_19</a:Code>
<a:CreationDate>1081694964</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081695061</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o204"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o175"/>
</c:Object2>
<c:Joins>
<o:ReferenceJoin Id="o331">
<a:ObjectID>6958BDB6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081695061</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081695061</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o205"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o183"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:TableSymbol Ref="o279"/>
<o:TableSymbol Ref="o149"/>
<o:TableSymbol Ref="o6"/>
<o:TableSymbol Ref="o52"/>
<o:TableSymbol Ref="o101"/>
<o:TableSymbol Ref="o174"/>
<o:TableSymbol Ref="o84"/>
<o:TableSymbol Ref="o203"/>
<o:TableSymbol Ref="o222"/>
<o:TableSymbol Ref="o253"/>
<o:TableSymbol Ref="o134"/>
<o:TableSymbol Ref="o119"/>
<o:TableSymbol Ref="o236"/>
<o:TableSymbol Ref="o16"/>
<o:TableSymbol Ref="o304"/>
</c:Symbols>
</o:PhysicalDiagram>
</c:PhysicalDiagrams>
<c:DefaultDiagram>
<o:PhysicalDiagram Ref="o4"/>
</c:DefaultDiagram>
<c:Users>
<o:User Ref="o13"/>
</c:Users>
<c:Procedures>
<o:Procedure Id="o332">
<a:ObjectID>6958BD03-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_BCL_DEL</a:Name>
<a:Code>SP_BCL_DEL</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_BCL_DEL    Script Date: 7/8/2000 12:15:32 ******/
Create Procedure SP_BCL_DEL
(@CD_BCP	INT, @CD_BCP_LIM	INT) As
/* Deletar todos os BCL  que sejam limitantes de CD_BCP de mesmo BOX e tipo e com valor menor que o deletado */
DELETE BCL
FROM	T_BCL BCL,
	T_BCP BCP,
	T_BCP BCPLIM
WHERE	BCL.CD_BCP = @CD_BCP AND
	BCL.CD_BCP_LIM = BCPLIM.CD_BCP AND
	BCP.CD_BCP = @CD_BCP_LIM AND
	BCPLIM.CD_BOX = BCP.CD_BOX AND
	BCPLIM.TP_BCP = BCP.TP_BCP AND
	BCPLIM.VL_BCP &lt; BCP.VL_BCP

/* Deletar todos os BCL  que sejam limitantes de CD_BCP_LIM de mesmo BOX e tipo e com valor menor que o deletado */
DELETE BCL
FROM	T_BCL BCL,
	T_BCP BCP,
	T_BCP BCPLIM
WHERE	BCL.CD_BCP = @CD_BCP_LIM AND
	BCL.CD_BCP_LIM = BCPLIM.CD_BCP AND
	BCP.CD_BCP = @CD_BCP AND
	BCPLIM.CD_BOX = BCP.CD_BOX AND
	BCPLIM.TP_BCP = BCP.TP_BCP AND
	BCPLIM.VL_BCP &lt; BCP.VL_BCP
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o13"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o333">
<a:ObjectID>6958BD04-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_BCL_INS</a:Name>
<a:Code>SP_BCL_INS</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_BCL_INS    Script Date: 7/8/2000 12:15:32 ******/
Create Procedure SP_BCL_INS
(@CD_BCP	INT, @CD_BCP_LIM	INT) As
/* Verificar se há BCLs cujos boxes de BCP e BCP_LIM sejam iguais */
IF	(SELECT COUNT(*) FROM T_BCP BCP, T_BCP BCPLIM
	WHERE	BCP.CD_BCP = @CD_BCP AND
		BCPLIM.CD_BCP = @CD_BCP_LIM AND
		BCP.CD_BOX = BCPLIM.CD_BOX) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: Um box não pode ser referenciado como limitante do próprio box&#39;
	RETURN
END

/* Inserir como limitante de CD_BCP todos os CD_BCP do mesmo tipo e de valor maior ao inserido */
INSERT INTO T_BCL(CD_BCP, CD_BCP_LIM)
SELECT 	@CD_BCP, BCPLIM.CD_BCP
FROM	T_BCP BCP,
	T_BCP BCPLIM
WHERE	BCP.CD_BCP = @CD_BCP_LIM AND
	BCPLIM.CD_BOX = BCP.CD_BOX AND
	BCPLIM.TP_BCP = BCP.TP_BCP AND
	BCPLIM.VL_BCP &gt; BCP.VL_BCP


/* Inserir como limitante de CD_BCP_LIM todos os CD_BCP do mesmo tipo e de valor maior ao inserido */
INSERT INTO T_BCL(CD_BCP, CD_BCP_LIM)
SELECT 	@CD_BCP_LIM, BCPLIM.CD_BCP
FROM	T_BCP BCP,
	T_BCP BCPLIM
WHERE	BCP.CD_BCP = @CD_BCP AND
	BCPLIM.CD_BOX = BCP.CD_BOX AND
	BCPLIM.TP_BCP = BCP.TP_BCP AND
	BCPLIM.VL_BCP &gt; BCP.VL_BCP
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o13"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o334">
<a:ObjectID>6958BD06-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_CriaStatus</a:Name>
<a:Code>SP_CriaStatus</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_CriaStatus    Script Date: 7/8/2000 12:15:31 ******/
Create Procedure SP_CriaStatus As
/* Verificar se existe algum registro em T_STA */
IF EXISTS (SELECT * FROM T_STA)
BEGIN
	RAISERROR 30000 &#39;OPERAÇÃO NÃO EXECUTADA: HÁ REGISTROS NA TABELA DE STATUS&#39;
	RETURN
END

/* CRIAR CURSOR COM OS DADOS PARA GERAÇÃO DOS STATUS */
/* Declaração do cursor */
/* Criar um cursor com dados do primeiro e do último registro de cada HPA cuja entrada 
   esteja concluída */
DECLARE CRIAR_STATUS CURSOR FOR
	SELECT	HPA1.CD_HPA,
		HPA1.DH_HPA_ENT,
		MA_STA_ABE = DATEADD(SS, -DATEPART(SS, HPA1.DH_HPA_ENT) - 60*DATEPART(MI, HPA1.DH_HPA_ENT) - 60*60*DATEPART(HH, HPA1.DH_HPA_ENT) - 24*60*60*DATEPART(DD, HPA1.DH_HPA_ENT) + 24*60*60, HPA1.DH_HPA_ENT),
		HPA2.DH_HPA_SAI,
		MA_STA_FEC = DATEADD(SS, -DATEPART(SS, HPA2.DH_HPA_SAI) - 60*DATEPART(MI, HPA2.DH_HPA_SAI) - 60*60*DATEPART(HH, HPA2.DH_HPA_SAI) - 24*60*60*DATEPART(DD, HPA2.DH_HPA_SAI) + 24*60*60, HPA2.DH_HPA_SAI),
		TP_STA = CONVERT(INT, HPA2.FL_HPA_SAI) + 1
	FROM	T_HPA001 HPA1,
		T_HPA001 HPA2
	WHERE	HPA2.CD_HPA = HPA1.CD_HPA AND
		HPA2.NR_HPA_SEQ = (SELECT MAX(NR_HPA_SEQ) FROM T_HPA001 HPA3 WHERE HPA3.CD_HPA = HPA1.CD_HPA) AND
		HPA1.NR_HPA_SEQ = 1 AND
		HPA1.FL_HPA_ENT = 1
	ORDER BY HPA1.DH_HPA_ENT


/* Declaração de variáveis */
DECLARE	@CD_HPA 	INT,
	@DH_STA_ABE	SMALLDATETIME,
	@MA_STA_ABE	SMALLDATETIME,
	@DH_STA_FEC	SMALLDATETIME,
	@MA_STA_FEC	SMALLDATETIME,
	@TP_STA		INT,
	@CD_STA		INT,
	@NR_STA		INT

/* Abrir cursor */
OPEN CRIAR_STATUS

/* Ir para o primeiro registro */
FETCH	CRIAR_STATUS
INTO	@CD_HPA,
	@DH_STA_ABE,
	@MA_STA_ABE,
	@DH_STA_FEC,
	@MA_STA_FEC,
	@TP_STA

/* Processar todos os registros de CRIAR_STATUS */
WHILE @@FETCH_STATUS = 0
BEGIN

	/* Anular @DH_STA_FEC e @MA_STA_FEC caso @TP_STA = 1 */
	IF @TP_STA = 1 	SELECT  @DH_STA_FEC = NULL, @MA_STA_FEC = NULL

	/* Identificar o próximo número de STATUS disponível */
	SELECT @CD_STA = (SELECT ISNULL(MAX(CD_STA),0) + 1 FROM T_STA)

	/* Incluir um novo status */
	INSERT	INTO T_STA (
		CD_STA,
		DH_STA_ABE,

		MA_STA_ABE,
		NR_STA,
		DH_STA_FEC,
		MA_STA_FEC,
		TP_STA)
	SELECT	@CD_STA,
		@DH_STA_ABE,
		@MA_STA_ABE,
		(SELECT ISNULL(MAX(NR_STA), 0) + 1 FROM T_STA WHERE MA_STA_ABE = @MA_STA_ABE),
		@DH_STA_FEC,
		@MA_STA_FEC,
		@TP_STA

	/* Atualizar HPA */
	UPDATE	T_HPA001
	SET	CD_STA = @CD_STA
	WHERE	CD_HPA = @CD_HPA

	/* Ir para o próximo registro */
	FETCH	NEXT FROM CRIAR_STATUS
	INTO	@CD_HPA,
		@DH_STA_ABE,
		@MA_STA_ABE,
		@DH_STA_FEC,
		@MA_STA_FEC,
		@TP_STA

END
CLOSE CRIAR_STATUS
DEALLOCATE CRIAR_STATUS
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o13"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o335">
<a:ObjectID>6958BD08-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_DIA</a:Name>
<a:Code>SP_DIA</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_DIA    Script Date: 7/8/2000 12:15:32 ******/
Create Procedure SP_DIA
(@DS_FRQ_IN CHAR(30), @DS_FRQ_OUT CHAR(30) OUTPUT, @DS_DIA CHAR(03) OUTPUT) As
DECLARE @NR_POS INTEGER

SELECT @DS_DIA = &#39;&#39;
SELECT @DS_FRQ_OUT = &#39;&#39;
SELECT @NR_POS = CHARINDEX(&#39;,&#39;, @DS_FRQ_IN)
IF (@NR_POS &gt; 0)
BEGIN
	SELECT @DS_DIA = SUBSTRING(@DS_FRQ_IN, 1, @NR_POS)
	SELECT @DS_FRQ_OUT = SUBSTRING(@DS_FRQ_IN, @NR_POS + 1, 30 - (@NR_POS + 1))
END
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o13"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o336">
<a:ObjectID>6958BD09-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_ExcTabPrincipal</a:Name>
<a:Code>SP_ExcTabPrincipal</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_ExcTabPrincipal    Script Date: 7/8/2000 12:15:32 ******/
Create Procedure SP_ExcTabPrincipal
(@pTipo INT) As
/* Objetivo:  Excluir das tabelas principais registros associados ao vôo de Chegada selecionado : 
T_CHG, T_CHA, T_HSC, T_DEC, T_ECC001, T_ESV001, T_CHGANT, T_STA, T_HPA001 */
   
/* Chegada com partida associada */
If @pTipo = 1
BEGIN
	/* &#39;Exclui vôos Codeshare ou Duplicate Leg vinculados ao vôo de Partida associado ao vôo de Chegada selecionado */
	Delete T_HSP Where CD_PAR IN (SELECT CD_PAR FROM T_MIR_LOG_PAR_001)
	IF @@ERROR &gt; 0 RETURN
       
         	/* Exclui vôos Codeshare ou Duplicate Leg vinculados ao vôo de Partida associado ao vôo de Chegada selecionado */
	Delete T_PAR Where CD_PAR IN (SELECT CD_PAR FROM T_MIR_LOG_PAR_001)
	IF @@ERROR &gt; 0 RETURN

	/* Exclui movimentação de situação dos vôos de Partida associadoS ao vôo de Chegada selecionado */
	Delete T_HSP Where CD_PAR IN (SELECT CD_PAR FROM T_MIR_LOG_PAR)
	IF @@ERROR &gt; 0 RETURN

	/* Exclui vôos de Partida associadoS ao vôo de Chegada selecionado */
	Delete T_PAR Where CD_PAR IN (SELECT CD_PAR FROM T_MIR_LOG_PAR)
	IF @@ERROR &gt; 0 RETURN
     
	/* Exclui histórico de situação dos vôos Codeshare ou Duplicate Leg vinculados ao vôo de Chegada selecionado */
	Delete T_HSC Where CD_CHG IN (SELECT CD_CHG FROM T_MIR_LOG_CHG_001)
	IF @@ERROR &gt; 0 RETURN

	/* Exclui vôos Codeshare ou Duplicate Leg vinculados ao vôo de Chegada selecionado */
	Delete T_CHG Where CD_CHG IN (SELECT CD_CHG FROM T_MIR_LOG_CHG_001)
	IF @@ERROR &gt; 0 RETURN

	/* Exclui movimentação de situação do vôo de Chegada selecionado */
	Delete T_HSC Where CD_CHG IN (SELECT CD_CHG FROM T_MIR_LOG_CHG)
	IF @@ERROR &gt; 0 RETURN

	/* Exclui vôo de Chegada selecionado */
	Delete T_CHG Where CD_CHG IN (SELECT CD_CHG FROM T_MIR_LOG_CHG)
	IF @@ERROR &gt; 0 RETURN
END
ELSE
BEGIN
	/* &#39;Vôos de Chegada Cancelados 2*/
	IF @pTipo = 2

	BEGIN
		/* Exclui movimentação de situação do vôo de Chegada selecionado */
		Delete T_HSC Where CD_CHG IN (SELECT CD_CHG FROM T_MIR_LOG_CHG_001)
		IF @@ERROR &gt; 0 RETURN

		/* Exclui vôo de Chegada selecionado */
		Delete T_CHG Where CD_CHG IN (SELECT CD_CHG FROM T_MIR_LOG_CHG_001)
		IF @@ERROR &gt; 0 RETURN
	END
	/* Vôos de Partida Cancelados 3*/
	ELSE
	BEGIN
		/* Exclui movimentação de situação do vôo de Partida selecionado */
		Delete T_HSP Where CD_PAR IN (SELECT CD_PAR FROM T_MIR_LOG_PAR_001)
		IF @@ERROR &gt; 0 RETURN

		/* Exclui vôo de Partida selecionado */
		Delete T_PAR Where CD_PAR IN (SELECT CD_PAR FROM T_MIR_LOG_PAR_001)
		IF @@ERROR &gt; 0 RETURN
	END
END
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o13"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o337">
<a:ObjectID>6958BD0B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_IncTabEspRelCHG</a:Name>
<a:Code>SP_IncTabEspRelCHG</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_IncTabEspRelCHG    Script Date: 7/8/2000 12:15:32 ******/
Create Procedure SP_IncTabEspRelCHG As
Insert Into T_CHG_MIR (
	CD_CHG
	, DT_CHG
	, CD_AER
	, NR_CHG_VOO
	, NR_CHG_HOT
	, TP_CHG_GRU
	, TP_CHG
	, TP_CHG_NAT
	, TP_CHG_CTG
	, CD_COM
	, CD_CHG_VIN
	, FL_CHG_TEL
	, CD_EQP_CHG
	, CD_AEN_CHG
	, CD_BOX
	, QT_CHG_PER_MIN
	, DH_CHG_NRM
	, DH_CHG_EFE
	, DH_CHG_EST
	, CD_SIT
	, NM_CHG_COM_SIT
	, DH_CHG_SIT

	, FL_CHG_CAN
	, TP_CHG_STA
	, CD_IFT
	, CD_USR
	, FL_CHG_PAR_ORI)
Select	CHG.CD_CHG
	, DT_CHG
	, CD_AER
	, NR_CHG_VOO
	, NR_CHG_HOT
	, TP_CHG_GRU
	, TP_CHG
	, TP_CHG_NAT
	, TP_CHG_CTG
	, CD_COM
	, CD_CHG_VIN
	, FL_CHG_TEL
	, CD_EQP_CHG
	, CD_AEN_CHG
	, CD_BOX
	, QT_CHG_PER_MIN
	, DH_CHG_NRM
	, DH_CHG_EFE
	, DH_CHG_EST
	, CD_SIT
	, NM_CHG_COM_SIT
	, DH_CHG_SIT
	, FL_CHG_CAN
	, TP_CHG_STA
	, CD_IFT
	, CD_USR
	, FL_CHG_PAR_ORI
From	T_CHG CHG, T_MIR_LOG_CHG CHGTMP
Where	CHG.CD_CHG = CHGTMP.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_CHA, associados ao vôo de Chegada selecionado, para a tabela T_CHA espelho */
Insert Into T_CHA_MIR (
	CD_CHA
	, CD_CHG
	, CD_PAR

	, CD_IFT
	, DH_CHA
	, CD_MSG
	, CD_USR)
Select	CD_CHA
	, CHA.CD_CHG
	, CD_PAR
	, CD_IFT
	, DH_CHA
	, CD_MSG
	, CD_USR
From	T_CHA CHA, T_MIR_LOG_CHG CHG
Where	CHA.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_HSC, associados ao vôo de Chegada selecionado, para a tabela T_HSC espelho */
Insert Into T_HSC_MIR (
	DH_HSC
	, CD_CHG
	, CD_IFT

	, CD_SIT
	, DH_HSC_CHG
	, CD_USR
	, NM_HSC_USR)
Select	DH_HSC
	, HSC.CD_CHG
	, CD_IFT
	, CD_SIT
	, DH_HSC_CHG

	, CD_USR
	, NM_HSC_USR
From	T_HSC HSC, T_MIR_LOG_CHG CHG
Where	HSC.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_DEC, associados ao vôo de Chegada selecionado, para a tabela T_DEC espelho */
Insert Into T_DEC_MIR (
	CD_CHG
	, QT_DEC_DES_DOM
	, QT_DEC_DES_INT
	, QT_DEC_DES_BAG_DOM
	, QT_DEC_DES_BAG_INT
	, QT_DEC_DES_CAR_DOM
	, QT_DEC_DES_CAR_INT
	, QT_DEC_DES_COR_DOM
	, QT_DEC_DES_COR_INT
	, QT_DEC_TRA_BAG_DOM
	, QT_DEC_TRA_BAG_INT
	, QT_DEC_TRA_CAR_DOM
	, QT_DEC_TRA_CAR_INT
	, QT_DEC_TRA_COR_DOM
	, QT_DEC_TRA_COR_INT)
Select	DEC.CD_CHG
	, QT_DEC_DES_DOM
	, QT_DEC_DES_INT
	, QT_DEC_DES_BAG_DOM
	, QT_DEC_DES_BAG_INT

	, QT_DEC_DES_CAR_DOM
	, QT_DEC_DES_CAR_INT
	, QT_DEC_DES_COR_DOM
	, QT_DEC_DES_COR_INT
	, QT_DEC_TRA_BAG_DOM
	, QT_DEC_TRA_BAG_INT
	, QT_DEC_TRA_CAR_DOM
	, QT_DEC_TRA_CAR_INT
	, QT_DEC_TRA_COR_DOM
	, QT_DEC_TRA_COR_INT
From	T_DEC DEC, T_MIR_LOG_CHG CHG
Where	DEC.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
  
/* Transfere dados da tabela T_ECC001, associados ao vôo de Chegada selecionado, para a tabela T_ECC001 espelho */
Insert Into T_ECC001_MIR (
	CD_CHG
	, CD_ECC
	, CD_AER)
Select	ECC.CD_CHG
	, CD_ECC
	, CD_AER
From	T_ECC001 ECC, T_MIR_LOG_CHG CHG
Where	ECC.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_ESV001, associados ao vôo de Chegada selecionado, para a tabela T_ESV001 espelho */
Insert Into T_ESV001_MIR (
	CD_CHG
	, CD_EST)
Select	ESV.CD_CHG
	, CD_EST
From	T_ESV001 ESV, T_MIR_LOG_CHG CHG
Where	ESV.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_CHGANT, associados ao vôo de Chegada selecionado, para a tabela T_CHGANT espelho */
Insert Into T_CHGANT_MIR (CD_CHG)
Select	CHGANT.CD_CHG
From	T_CHGANT CHGANT, T_MIR_LOG_CHG CHG
Where	CHGANT.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_STA, associados ao vôo de Chegada selecionado, para a tabela T_STA espelho */
Insert Into T_STA_MIR (
	CD_STA
	, DH_STA_ABE
	, MA_STA_ABE
	, NR_STA
	, DH_STA_FEC
	, MA_STA_FEC
	, CD_STA_ANT
	, TP_STA
	, FL_STA_AEN_ISE
	, FL_STA_COM_TAR_RED
	, QT_STA_PSI_ISE
	, QT_STA_PSI_TAR_RED)
Select	CD_STA
	, DH_STA_ABE
	, MA_STA_ABE
	, NR_STA
	, DH_STA_FEC
	, MA_STA_FEC
	, CD_STA_ANT
	, TP_STA
	, FL_STA_AEN_ISE
	, FL_STA_COM_TAR_RED
	, QT_STA_PSI_ISE
	, QT_STA_PSI_TAR_RED
From	T_STA
Where	CD_STA In (  Select CD_STA
	             From  T_HPA001 HPA, T_MIR_LOG_CHG CHG
	             Where HPA.CD_CHG = CHG.CD_CHG)
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_HPA001 associados ao vôo de Chegada selecionado, para a tabela T_HPA001 espelho */
Insert Into T_HPA001_MIR (
	CD_HPA

	, NR_HPA_SEQ
	, CD_AER
	, CD_EQP
	, CD_AEN
	, CD_BOX
	, CD_CHG
	, DH_HPA_ENT
	, CD_PAR
	, DH_HPA_SAI
	, FL_HPA_ENT
	, FL_HPA_SAI
	, FL_HPA_TOK
	, CD_STA)
Select	CD_HPA
	, NR_HPA_SEQ
	, CD_AER
	, CD_EQP

	, CD_AEN
	, CD_BOX
	, HPA.CD_CHG
	, DH_HPA_ENT
	, CD_PAR
	, DH_HPA_SAI
	, FL_HPA_ENT
	, FL_HPA_SAI
	, FL_HPA_TOK
	, CD_STA
From	T_HPA001 HPA, T_MIR_LOG_CHG CHG
Where	HPA.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_PRALOG, associados ao vôo de Chegada selecionado, para a tabela T_PRALOG espelho */
Insert Into T_PRALOG_MIR (
	CD_PRA
	, CD_CHG
	, CD_PAR
	, QT_LOG_POR)
Select  	CD_PRA
	, LOG.CD_CHG
	, CD_PAR
	, QT_LOG_POR
From	T_PRALOG LOG, T_MIR_LOG_CHG CHG
Where	LOG.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_MCH, associados ao vôo de Chegada selecionado, para a tabela T_MCH espelho */
Insert Into T_MCH_MIR (
	CD_MCH
	, CD_CHG
	, CD_USR
	, DH_MCH
	, DH_MCH_EFE
	, CD_SIT
	, NM_MCH_COM_SIT
	, CD_TPA
	, CD_IFT
	, DS_MCH_EST
	, DS_MCH_EST_001
	, NR_MCH_AEN
	, TT_MCH_OBS
	, TP_MCH
	, FL_MCH_TEL)
Select	CD_MCH
	, MCH.CD_CHG
	, CD_USR
	, DH_MCH
	, DH_MCH_EFE
	, CD_SIT
	, NM_MCH_COM_SIT
	, CD_TPA
	, CD_IFT
	, DS_MCH_EST
	, DS_MCH_EST_001
	, NR_MCH_AEN
	, TT_MCH_OBS
	, TP_MCH
	, FL_MCH_TEL
From	T_MCH MCH, T_MIR_LOG_CHG CHG
Where	MCH.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o13"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o338">
<a:ObjectID>6958BD0C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_IncTabEspRelCHG001</a:Name>
<a:Code>SP_IncTabEspRelCHG001</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_IncTabEspRelCHG001    Script Date: 7/8/2000 12:15:33 ******/
Create Procedure SP_IncTabEspRelCHG001 As
Insert Into T_CHG_MIR (
	CD_CHG
	, DT_CHG
	, CD_AER
	, NR_CHG_VOO
	, NR_CHG_HOT
	, TP_CHG_GRU
	, TP_CHG
	, TP_CHG_NAT
	, TP_CHG_CTG
	, CD_COM
	, CD_CHG_VIN
	, FL_CHG_TEL
	, CD_EQP_CHG
	, CD_AEN_CHG

	, CD_BOX
	, QT_CHG_PER_MIN
	, DH_CHG_NRM
	, DH_CHG_EFE
	, DH_CHG_EST
	, CD_SIT
	, NM_CHG_COM_SIT
	, DH_CHG_SIT

	, FL_CHG_CAN
	, TP_CHG_STA
	, CD_IFT
	, CD_USR
	, FL_CHG_PAR_ORI)
Select	CHG.CD_CHG
	, DT_CHG
	, CD_AER
	, NR_CHG_VOO
	, NR_CHG_HOT
	, TP_CHG_GRU
	, TP_CHG
	, TP_CHG_NAT
	, TP_CHG_CTG
	, CD_COM
	, CD_CHG_VIN
	, FL_CHG_TEL
	, CD_EQP_CHG
	, CD_AEN_CHG
	, CD_BOX
	, QT_CHG_PER_MIN
	, DH_CHG_NRM
	, DH_CHG_EFE
	, DH_CHG_EST
	, CD_SIT
	, NM_CHG_COM_SIT
	, DH_CHG_SIT
	, FL_CHG_CAN
	, TP_CHG_STA
	, CD_IFT
	, CD_USR
	, FL_CHG_PAR_ORI
From	T_CHG CHG, T_MIR_LOG_CHG_001 CHGTMP
Where	CHG.CD_CHG = CHGTMP.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_CHA, associados ao vôo de Chegada selecionado, para a tabela T_CHA espelho */
Insert Into T_CHA_MIR (
	CD_CHA
	, CD_CHG
	, CD_PAR

	, CD_IFT
	, DH_CHA
	, CD_MSG
	, CD_USR)
Select	CD_CHA
	, CHA.CD_CHG
	, CD_PAR
	, CD_IFT
	, DH_CHA
	, CD_MSG
	, CD_USR
From	T_CHA CHA, T_MIR_LOG_CHG_001 CHG
Where	CHA.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_HSC, associados ao vôo de Chegada selecionado, para a tabela T_HSC espelho */
Insert Into T_HSC_MIR (
	DH_HSC
	, CD_CHG
	, CD_IFT

	, CD_SIT
	, DH_HSC_CHG
	, CD_USR
	, NM_HSC_USR)
Select	DH_HSC
	, HSC.CD_CHG
	, CD_IFT
	, CD_SIT
	, DH_HSC_CHG

	, CD_USR
	, NM_HSC_USR
From	T_HSC HSC, T_MIR_LOG_CHG_001 CHG
Where	HSC.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_DEC, associados ao vôo de Chegada selecionado, para a tabela T_DEC espelho */
Insert Into T_DEC_MIR (
	CD_CHG
	, QT_DEC_DES_DOM
	, QT_DEC_DES_INT
	, QT_DEC_DES_BAG_DOM
	, QT_DEC_DES_BAG_INT
	, QT_DEC_DES_CAR_DOM
	, QT_DEC_DES_CAR_INT
	, QT_DEC_DES_COR_DOM
	, QT_DEC_DES_COR_INT
	, QT_DEC_TRA_BAG_DOM
	, QT_DEC_TRA_BAG_INT
	, QT_DEC_TRA_CAR_DOM
	, QT_DEC_TRA_CAR_INT
	, QT_DEC_TRA_COR_DOM
	, QT_DEC_TRA_COR_INT)
Select	DEC.CD_CHG
	, QT_DEC_DES_DOM
	, QT_DEC_DES_INT
	, QT_DEC_DES_BAG_DOM
	, QT_DEC_DES_BAG_INT
	, QT_DEC_DES_CAR_DOM
	, QT_DEC_DES_CAR_INT
	, QT_DEC_DES_COR_DOM
	, QT_DEC_DES_COR_INT
	, QT_DEC_TRA_BAG_DOM
	, QT_DEC_TRA_BAG_INT
	, QT_DEC_TRA_CAR_DOM
	, QT_DEC_TRA_CAR_INT
	, QT_DEC_TRA_COR_DOM
	, QT_DEC_TRA_COR_INT
From	T_DEC DEC, T_MIR_LOG_CHG_001 CHG
Where	DEC.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_ECC001, associados ao vôo de Chegada selecionado, para a tabela T_ECC001 espelho 	*/
Insert Into T_ECC001_MIR (
	CD_CHG
	, CD_ECC
	, CD_AER)
Select	ECC.CD_CHG
	, CD_ECC
	, CD_AER
From	T_ECC001 ECC, T_MIR_LOG_CHG_001 CHG
Where	ECC.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_ESV001, associados ao vôo de Chegada selecionado, para a tabela T_ESV001 espelho */
Insert Into T_ESV001_MIR (
	CD_CHG
	, CD_EST)
Select	ESV.CD_CHG
	, CD_EST
From	T_ESV001 ESV, T_MIR_LOG_CHG_001 CHG
Where	ESV.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_CHGANT, associados ao vôo de Chegada selecionado, para a tabela T_CHGANT espelho */
Insert Into T_CHGANT_MIR (CD_CHG)
Select	CHGANT.CD_CHG
From	T_CHGANT CHGANT, T_MIR_LOG_CHG_001 CHG
Where	CHGANT.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_STA, associados ao vôo de Chegada selecionado, para a tabela T_STA espelho */
Insert Into T_STA_MIR (
	CD_STA
	, DH_STA_ABE
	, MA_STA_ABE
	, NR_STA
	, DH_STA_FEC
	, MA_STA_FEC
	, CD_STA_ANT
	, TP_STA
	, FL_STA_AEN_ISE
	, FL_STA_COM_TAR_RED
	, QT_STA_PSI_ISE
	, QT_STA_PSI_TAR_RED)
Select	CD_STA
	, DH_STA_ABE
	,MA_STA_ABE
	, NR_STA
	, DH_STA_FEC
	, MA_STA_FEC
	, CD_STA_ANT
	, TP_STA
	, FL_STA_AEN_ISE
	, FL_STA_COM_TAR_RED
	, QT_STA_PSI_ISE
	, QT_STA_PSI_TAR_RED
From	T_STA
Where	CD_STA In (  Select CD_STA
	             From  T_HPA001 HPA, T_MIR_LOG_CHG_001 CHG
	             Where HPA.CD_CHG = CHG.CD_CHG)
IF @@ERROR &gt; 0 RETURN
  
/* Transfere dados da tabela T_HPA001 associados ao vôo de Chegada selecionado, para a tabela T_HPA001 espelho */
Insert Into T_HPA001_MIR (
	CD_HPA

	, NR_HPA_SEQ
	, CD_AER
	, CD_EQP
	, CD_AEN
	, CD_BOX
	, CD_CHG
	, DH_HPA_ENT
	, CD_PAR
	, DH_HPA_SAI
	, FL_HPA_ENT
	, FL_HPA_SAI
	, FL_HPA_TOK
	, CD_STA)
Select	CD_HPA
	, NR_HPA_SEQ
	, CD_AER
	, CD_EQP

	, CD_AEN
	, CD_BOX
	, HPA.CD_CHG
	, DH_HPA_ENT
	, CD_PAR
	, DH_HPA_SAI
	, FL_HPA_ENT
	, FL_HPA_SAI
	, FL_HPA_TOK
	, CD_STA
From	T_HPA001 HPA, T_MIR_LOG_CHG_001 CHG
Where	HPA.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_PRALOG, associados ao vôo de Chegada selecionado, para a tabela T_PRALOG espelho */
Insert Into T_PRALOG_MIR (
	CD_PRA
	, CD_CHG
	, CD_PAR
	, QT_LOG_POR)
Select  CD_PRA
	, LOG.CD_CHG

	, CD_PAR
	, QT_LOG_POR
From	T_PRALOG LOG, T_MIR_LOG_CHG_001 CHG
Where	LOG.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_MCH, associados ao vôo de Chegada selecionado, para a tabela T_MCH espelho */

Insert Into T_MCH_MIR (
	CD_MCH
	, CD_CHG
	, CD_USR
	, DH_MCH
	, DH_MCH_EFE
	, CD_SIT
	, NM_MCH_COM_SIT
	, CD_TPA
	, CD_IFT
	, DS_MCH_EST
	, DS_MCH_EST_001
	, NR_MCH_AEN
	, TT_MCH_OBS
	, TP_MCH
	, FL_MCH_TEL)
Select	CD_MCH
	, MCH.CD_CHG
	, CD_USR
	, DH_MCH
	, DH_MCH_EFE
	, CD_SIT
	, NM_MCH_COM_SIT
	, CD_TPA
	, CD_IFT
	, DS_MCH_EST
	, DS_MCH_EST_001
	, NR_MCH_AEN
	, TT_MCH_OBS
	, TP_MCH
	, FL_MCH_TEL
From	T_MCH MCH, T_MIR_LOG_CHG_001 CHG
Where	MCH.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o13"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o339">
<a:ObjectID>6958BD0D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_IncTabEspRelPAR</a:Name>
<a:Code>SP_IncTabEspRelPAR</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_IncTabEspRelPAR    Script Date: 7/8/2000 12:15:33 ******/
Create Procedure SP_IncTabEspRelPAR As
/* Objetivo: Incluir registros associados ao vôo de Partida selecionado nas tabelas espelho relacionadas: 
T_PAR, T_CHA, T_CKV001, T_DEP, T_ECP001, T_HSP, T_TFB001, T_PRALOG, T_MPA */   
   
/* Transfere dados da tabela T_PAR, associados ao vôo de Partida selecionado, para a tabela T_PAR espelho */
Insert Into T_PAR_MIR (
	CD_PAR
	, DT_PAR
	, CD_AER
	, NR_PAR_VOO
	, NR_PAR_HOT
	, TP_PAR_GRU
	, TP_PAR
	, TP_PAR_NAT
	, TP_PAR_CTG
	, CD_COM
	, CD_CHG_ANT
	, CD_CHG_AEN_ANT
	, CD_PAR_VIN
	, FL_PAR_TEL
	, DH_PAR_NRM
	, DH_PAR_EFE
	, DH_PAR_EST
	, CD_SIT
	, NM_PAR_COM_SIT
	, DH_PAR_SIT
	, CD_POR
	, FL_PAR_CAN
	, TP_PAR_STA
	, CD_IFT
	, CD_USR)
 Select 	PAR.CD_PAR
	, DT_PAR
	, CD_AER
	, NR_PAR_VOO
	, NR_PAR_HOT
	, TP_PAR_GRU
	, TP_PAR
	, TP_PAR_NAT
	, TP_PAR_CTG
	, CD_COM
	, CD_CHG_ANT
	, CD_CHG_AEN_ANT
	, CD_PAR_VIN
	, FL_PAR_TEL
	, DH_PAR_NRM
	, DH_PAR_EFE
	, DH_PAR_EST
	, CD_SIT
	, NM_PAR_COM_SIT
	, DH_PAR_SIT
	, CD_POR
	, FL_PAR_CAN
	, TP_PAR_STA
	, CD_IFT
	, CD_USR
From	T_PAR PAR, T_MIR_LOG_PAR PARLOG
Where	PAR.CD_PAR = PARLOG.CD_PAR
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_CHA, associados ao vôo de Partida selecionado, para a tabela T_CHA espelho */
Insert Into T_CHA_MIR (
	CD_CHA
	, CD_CHG
	, CD_PAR
	, CD_IFT
	, DH_CHA
	, CD_MSG
	, CD_USR)
Select	CD_CHA
	, CD_CHG
	, CHA.CD_PAR
	, CD_IFT
	, DH_CHA
	, CD_MSG
	, CD_USR
From	T_CHA CHA, T_MIR_LOG_PAR PAR
Where	CHA.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_CKV001, associados ao vôo de Partida selecionado, para a tabela T_CKV001 espelho */
Insert Into T_CKV001_MIR (
	CD_PAR
	, CD_CHK
	, CD_CLS)
Select	CKV.CD_PAR
	, CD_CHK
	, CD_CLS
From	T_CKV001 CKV, T_MIR_LOG_PAR PAR
Where	CKV.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_DEP, associados ao vôo de Partida selecionado, para a tabela T_DEP espelho */
Insert Into T_DEP_MIR (
	CD_PAR

	, CD_AER
	, QT_DEP_TFB_DOM
	, QT_DEP_TFB_INT
	, QT_DEP_TFC_DOM
	, QT_DEP_TFC_INT
	, QT_DEP_ISE_COL
	, QT_DEP_ISE_TRA
	, QT_DEP_ISE_CON_DOM
	, QT_DEP_ISE_CON_INT
	, QT_DEP_ISE_OUT
	, QT_DEP_EMB_BAG_DOM
	, QT_DEP_EMB_BAG_INT

	, QT_DEP_EMB_CAR_DOM
	, QT_DEP_EMB_CAR_INT

	, QT_DEP_EMB_COR_DOM
	, QT_DEP_EMB_COR_INT)
Select	DEP.CD_PAR
	, CD_AER
	, QT_DEP_TFB_DOM
	, QT_DEP_TFB_INT
	, QT_DEP_TFC_DOM
	, QT_DEP_TFC_INT
	, QT_DEP_ISE_COL
	, QT_DEP_ISE_TRA
	, QT_DEP_ISE_CON_DOM
	, QT_DEP_ISE_CON_INT
	, QT_DEP_ISE_OUT
	, QT_DEP_EMB_BAG_DOM
	, QT_DEP_EMB_BAG_INT
	, QT_DEP_EMB_CAR_DOM
	, QT_DEP_EMB_CAR_INT
	, QT_DEP_EMB_COR_DOM
	, QT_DEP_EMB_COR_INT
From	T_DEP DEP, T_MIR_LOG_PAR PAR
Where	DEP.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_ECP001, associados ao vôo de Partida selecionado, para a tabela T_ECP001 espelho */
Insert Into T_ECP001_MIR (
	CD_PAR
	, CD_ECP
	, CD_AER)
Select	ECP.CD_PAR
	, CD_ECP
	, CD_AER
From	T_ECP001 ECP, T_MIR_LOG_PAR PAR
Where	ECP.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_TFB001, associados ao vôo de Partida selecionado, para a tabela T_TFB001 espelho */
Insert Into T_TFB001_MIR (
	CD_TFB
	, CD_COM
	, CD_HTE
	, QT_TFB
	, CD_PAR)
Select	 CD_TFB
	, CD_COM
	, CD_HTE
	, QT_TFB
	, TFB.CD_PAR
From	T_TFB001 TFB, T_MIR_LOG_PAR PAR
Where	TFB.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_HSP, associados ao vôo de Partida selecionado, para a tabela T_HSP espelho */
Insert Into T_HSP_MIR (
	DH_HSP
	, CD_PAR
	, CD_IFT
	, CD_SIT
	, DH_HSP_PAR
	, CD_USR
	, NM_HSP_USR)
Select	DH_HSP
	, HSP.CD_PAR
	, CD_IFT
	, CD_SIT
	, DH_HSP_PAR
	, CD_USR
	, NM_HSP_USR
From	T_HSP HSP, T_MIR_LOG_PAR PAR
Where	HSP.CD_PAR = PAR.CD_PAR

IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_PRALOG, associados ao vôo de Partida selecionado, para a tabela T_PRALOG espelho */
Insert Into T_PRALOG_MIR (CD_PRA
	, CD_CHG
	, CD_PAR
	, QT_LOG_POR)
Select	CD_PRA
	, CD_CHG
	, LOG.CD_PAR
	, QT_LOG_POR
From	T_PRALOG LOG, T_MIR_LOG_PAR PAR
Where	LOG.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_MPA, associados ao vôo de Partida selecionado, para a tabela T_MPA espelho */
Insert Into T_MPA_MIR (
	CD_MPA
	, CD_PAR
	, CD_USR
	, DH_MPA
	, DH_MPA_EFE
	, CD_SIT
	, NM_MPA_COM_SIT
	, CD_TPA
	, CD_IFT
	, CD_POR
	, DS_MPA_CHK
	, DS_MPA_CHK_001
	, TT_MPA_OBS
	, TP_MPA
	, FL_MPA_TEL)
Select	CD_MPA
	, MPA.CD_PAR
	, CD_USR
	, DH_MPA
	, DH_MPA_EFE
	, CD_SIT
	, NM_MPA_COM_SIT
	, CD_TPA

	, CD_IFT
	, CD_POR
	, DS_MPA_CHK
	, DS_MPA_CHK_001
	, TT_MPA_OBS
	, TP_MPA
	, FL_MPA_TEL
From	T_MPA MPA, T_MIR_LOG_PAR PAR
Where	MPA.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o13"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o340">
<a:ObjectID>6958BD0F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_IncTabEspRelPAR001</a:Name>
<a:Code>SP_IncTabEspRelPAR001</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_IncTabEspRelPAR001    Script Date: 7/8/2000 12:15:33 ******/
Create Procedure SP_IncTabEspRelPAR001 As
/* Objetivo: Incluir registros associados ao vôo de Partida selecionado nas tabelas espelho relacionadas:
T_PAR. T_CHA, T_CKV001, T_DEP, T_ECP001, T_HSP, T_TFB001, T_PRALOG, T_MPA */   
   
/* Transfere dados da tabela T_PAR, associados ao vôo de Partida selecionado, para a tabela T_PAR espelho */
Insert Into T_PAR_MIR (
	CD_PAR
	, DT_PAR
	, CD_AER
	, NR_PAR_VOO
	, NR_PAR_HOT
	, TP_PAR_GRU
	, TP_PAR
	, TP_PAR_NAT
	, TP_PAR_CTG
	, CD_COM
	, CD_CHG_ANT
	, CD_CHG_AEN_ANT
	, CD_PAR_VIN
	, FL_PAR_TEL
	, DH_PAR_NRM
	, DH_PAR_EFE
	, DH_PAR_EST
	, CD_SIT
	, NM_PAR_COM_SIT
	, DH_PAR_SIT
	, CD_POR
	, FL_PAR_CAN
	, TP_PAR_STA
	, CD_IFT
	, CD_USR)
 Select 	PAR.CD_PAR
	, DT_PAR
	, CD_AER
	, NR_PAR_VOO
	, NR_PAR_HOT
	, TP_PAR_GRU
	, TP_PAR
	, TP_PAR_NAT
	, TP_PAR_CTG
	, CD_COM
	, CD_CHG_ANT
	, CD_CHG_AEN_ANT
	, CD_PAR_VIN
	, FL_PAR_TEL
	, DH_PAR_NRM
	, DH_PAR_EFE
	, DH_PAR_EST
	, CD_SIT
	, NM_PAR_COM_SIT
	, DH_PAR_SIT
	, CD_POR
	, FL_PAR_CAN
	, TP_PAR_STA
	, CD_IFT
	, CD_USR
From	T_PAR PAR, T_MIR_LOG_PAR_001 PARLOG
Where	PAR.CD_PAR = PARLOG.CD_PAR
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_CHA, associados ao vôo de Partida selecionado, para a tabela T_CHA espelho */
Insert Into T_CHA_MIR (
	CD_CHA
	, CD_CHG
	, CD_PAR
	, CD_IFT
	, DH_CHA
	, CD_MSG
	, CD_USR)
Select	CD_CHA
	, CD_CHG
	, CHA.CD_PAR
	, CD_IFT
	, DH_CHA
	, CD_MSG
	, CD_USR
From	T_CHA CHA, T_MIR_LOG_PAR_001 PAR

Where	CHA.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_CKV001, associados ao vôo de Partida selecionado, para a tabela T_CKV001 espelho */
Insert Into T_CKV001_MIR (
	CD_PAR
	, CD_CHK
	, CD_CLS)
Select	CKV.CD_PAR
	, CD_CHK
	, CD_CLS
From	T_CKV001 CKV, T_MIR_LOG_PAR_001 PAR
Where	CKV.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_DEP, associados ao vôo de Partida selecionado, para a tabela T_DEP espelho */
Insert Into T_DEP_MIR (
	CD_PAR

	, CD_AER
	, QT_DEP_TFB_DOM
	, QT_DEP_TFB_INT
	, QT_DEP_TFC_DOM
	, QT_DEP_TFC_INT
	, QT_DEP_ISE_COL
	, QT_DEP_ISE_TRA
	, QT_DEP_ISE_CON_DOM
	, QT_DEP_ISE_CON_INT
	, QT_DEP_ISE_OUT
	, QT_DEP_EMB_BAG_DOM
	, QT_DEP_EMB_BAG_INT
	, QT_DEP_EMB_CAR_DOM
	, QT_DEP_EMB_CAR_INT
	, QT_DEP_EMB_COR_DOM
	, QT_DEP_EMB_COR_INT)
Select	DEP.CD_PAR
	, CD_AER
	, QT_DEP_TFB_DOM
	, QT_DEP_TFB_INT
	, QT_DEP_TFC_DOM
	, QT_DEP_TFC_INT
	, QT_DEP_ISE_COL
	, QT_DEP_ISE_TRA
	, QT_DEP_ISE_CON_DOM
	, QT_DEP_ISE_CON_INT
	, QT_DEP_ISE_OUT
	, QT_DEP_EMB_BAG_DOM
	, QT_DEP_EMB_BAG_INT
	, QT_DEP_EMB_CAR_DOM
	, QT_DEP_EMB_CAR_INT
	, QT_DEP_EMB_COR_DOM
	, QT_DEP_EMB_COR_INT
From	T_DEP DEP, T_MIR_LOG_PAR_001 PAR
Where	DEP.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_ECP001, associados ao vôo de Partida selecionado, para a tabela T_ECP001 espelho */
Insert Into T_ECP001_MIR (
	CD_PAR
	, CD_ECP
	, CD_AER)
Select	ECP.CD_PAR
	, CD_ECP
	, CD_AER
From	T_ECP001 ECP, T_MIR_LOG_PAR_001 PAR
Where	ECP.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_TFB001, associados ao vôo de Partida selecionado, para a tabela T_TFB001 espelho */
Insert Into T_TFB001_MIR (
	CD_TFB
	, CD_COM
	, CD_HTE
	, QT_TFB
	, CD_PAR)
Select	 CD_TFB
	, CD_COM
	, CD_HTE
	, QT_TFB
	, TFB.CD_PAR
From	T_TFB001 TFB, T_MIR_LOG_PAR_001 PAR
Where	TFB.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_HSP, associados ao vôo de Partida selecionado, para a tabela T_HSP espelho */
Insert Into T_HSP_MIR (
	DH_HSP
	, CD_PAR
	, CD_IFT
	, CD_SIT
	, DH_HSP_PAR
	, CD_USR
	, NM_HSP_USR)
Select	DH_HSP
	, HSP.CD_PAR
	, CD_IFT
	, CD_SIT
	, DH_HSP_PAR
	, CD_USR
	, NM_HSP_USR
From	T_HSP HSP, T_MIR_LOG_PAR_001 PAR
Where	HSP.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_PRALOG, associados ao vôo de Partida selecionado, para a tabela T_PRALOG espelho */
Insert Into T_PRALOG_MIR (
	CD_PRA
	, CD_CHG
	, CD_PAR
	, QT_LOG_POR)
Select	CD_PRA
	, CD_CHG
	, LOG.CD_PAR
	, QT_LOG_POR
From	T_PRALOG LOG, T_MIR_LOG_PAR_001 PAR
Where	LOG.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_MPA, associados ao vôo de Partida selecionado, para a tabela T_MPA espelho */
Insert Into T_MPA_MIR (
	CD_MPA
	, CD_PAR
	, CD_USR
	, DH_MPA
	, DH_MPA_EFE
	, CD_SIT
	, NM_MPA_COM_SIT
	, CD_TPA
	, CD_IFT
	, CD_POR
	, DS_MPA_CHK
	, DS_MPA_CHK_001
	, TT_MPA_OBS
	, TP_MPA
	, FL_MPA_TEL)
Select	CD_MPA
	, MPA.CD_PAR
	, CD_USR
	, DH_MPA
	, DH_MPA_EFE
	, CD_SIT
	, NM_MPA_COM_SIT
	, CD_TPA

	, CD_IFT
	, CD_POR
	, DS_MPA_CHK
	, DS_MPA_CHK_001
	, TT_MPA_OBS
	, TP_MPA
	, FL_MPA_TEL
From	T_MPA MPA, T_MIR_LOG_PAR_001 PAR
Where	MPA.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o13"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o341">
<a:ObjectID>6958BD11-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_MONITOR</a:Name>
<a:Code>SP_MONITOR</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>CREATE PROCEDURE SP_MONITOR AS
/*	CHEGADAS
	Atualizar os vôos de chegada cuja situaçao atual tem uma situaçao sucessora e
	o tempo para atualizaçao é o TEMPO ANTES e que a diferença entre a hora
	prevista e a hora atual é menor ou igual que o TEMPO ANTES
*/

UPDATE	T_CHG
SET	CD_SIT = CD_SIT_SUC,
	CD_USR = NULL
FROM  	T_CHG CHG, T_SSU SSU   
WHERE 	SSU.CD_SIT = CHG.CD_SIT AND
	SSU.TP_SSU = 1 AND
	CHG.TP_CHG_STA = 1 AND
	DATEDIFF(MI, GETDATE(), DH_CHG_EFE) &lt;= SSU.QT_SSU AND
	CHG.TP_CHG_CTG NOT IN (3, 4) AND
	NOT EXISTS (	SELECT 	CD_CHG = CHG001.CD_CHG 
			FROM 	T_CHG CHG001,
				T_SSU SSU001,
				T_SIT SIT001
			WHERE 	CHG001.CD_CHG = CHG.CD_CHG AND
				SSU001.CD_SIT = CHG001.CD_SIT AND
				SIT001.CD_SIT = SSU001.CD_SIT_SUC AND
				SIT001.FL_SIT_CON_VOO = 1 AND
				CHG001.CD_AEN_CHG IS NULL)


/*	Atualizar os vôos de chegada cuja situaçao atual tem uma situaçao sucessora e
	o tempo para atualizaçao é o TEMPO APOS e que a diferença entre a hora da
	atualizaçao da situaçao e a hora atual é maior ou igual que o TEMPO APOS
*/
UPDATE	T_CHG
SET	CD_SIT = CD_SIT_SUC,
	CD_USR = NULL
FROM  	T_CHG CHG, T_SSU SSU   
WHERE 	SSU.CD_SIT = CHG.CD_SIT AND
	SSU.TP_SSU = 2 AND
	CHG.TP_CHG_STA = 1 AND
	DATEDIFF(MI, DH_CHG_SIT, GETDATE()) &gt;= SSU.QT_SSU AND
	CHG.TP_CHG_CTG NOT IN (3, 4) AND
	NOT EXISTS (	SELECT 	CD_CHG = CHG001.CD_CHG 
			FROM 	T_CHG CHG001,
				T_SSU SSU001,
				T_SIT SIT001
			WHERE 	CHG001.CD_CHG = CHG.CD_CHG AND
				SSU001.CD_SIT = CHG001.CD_SIT AND
				SIT001.CD_SIT = SSU001.CD_SIT_SUC AND
				SIT001.FL_SIT_CON_VOO = 1 AND
				CHG001.CD_AEN_CHG IS NULL)

/*	Atualizar os vôos de chegada cuja situaçao atual tem uma situaçao sucessora e
	o tempo para atualizaçao é o TEMPO MINIMO DE PERMANENCIA e que a diferença entre
	a hora prevista e a hora atual é menor ou igual que o TEMPO MINIMO DE PERMANENCIA
*/

UPDATE	T_CHG
SET	CD_SIT = CD_SIT_SUC,
	CD_USR = NULL
FROM  	T_CHG CHG, T_SSU SSU   
WHERE 	SSU.CD_SIT = CHG.CD_SIT AND
	SSU.TP_SSU = 3 AND
	CHG.TP_CHG_STA = 1 AND
	DATEDIFF(MI, GETDATE(), DH_CHG_EFE) &lt;= CHG.QT_CHG_PER_MIN AND
	CHG.TP_CHG_CTG NOT IN (3, 4) AND
	NOT EXISTS (	SELECT 	CD_CHG = CHG001.CD_CHG 
			FROM 	T_CHG CHG001,
				T_SSU SSU001,
				T_SIT SIT001
			WHERE 	CHG001.CD_CHG = CHG.CD_CHG AND
				SSU001.CD_SIT = CHG001.CD_SIT AND
				SIT001.CD_SIT = SSU001.CD_SIT_SUC AND
				SIT001.FL_SIT_CON_VOO = 1 AND
				CHG001.CD_AEN_CHG IS NULL)

/*	Atualizar os vôos de partida cuja situaçao atual tem uma situaçao sucessora e
	o tempo para atualizaçao é o TEMPO ANTES e que a diferença entre a hora
	prevista e a hora atual é menor ou igual que o TEMPO ANTES e que os vôos antecessores
	estao nas situaçoes condicionantes, caso existam
*/

UPDATE	T_PAR
SET	CD_SIT = CD_SIT_SUC,
	CD_USR = NULL
FROM  	T_PAR PAR, T_CHG CHGAENANT, T_SSU SSU, T_SIT SIT   
WHERE 	SSU.CD_SIT = PAR.CD_SIT AND
	SIT.CD_SIT = PAR.CD_SIT AND
	CHGAENANT.CD_CHG = PAR.CD_CHG_AEN_ANT AND
	PAR.TP_PAR_STA = 1 AND
	SSU.TP_SSU = 1 AND /* TEMPO ANTES */
	DATEDIFF(MI, GETDATE(), PAR.DH_PAR_EFE) &lt;= SSU.QT_SSU AND
   	(	/* não existe situação condicionante ou a situação do vôo de chegada é uma das situações condicionantes */
		NOT EXISTS (SELECT *  FROM T_SCA SCA WHERE SCA.CD_SIT = SSU.CD_SIT_SUC)  OR
		CHGAENANT.CD_SIT IN (SELECT CD_SIT_ANT FROM T_SCA SCA WHERE SCA.CD_SIT = SSU.CD_SIT_SUC)
	)

/*	Atualizar os vôos de partida cuja situaçao atual tem uma situaçao sucessora e
	o tempo para atualizaçao é o TEMPO APOS e que a diferença entre a hora
	prevista e a hora atual é maior ou igual que o TEMPO APOS e que os vôos antecessores
	estao nas situaçoes condicionantes, caso existam
*/

UPDATE 	T_PAR
SET	CD_SIT = CD_SIT_SUC,
	CD_USR = NULL
FROM  	T_PAR PAR, T_CHG CHGAENANT, T_SSU SSU, T_SIT SIT   
WHERE 	SSU.CD_SIT = PAR.CD_SIT AND
	SIT.CD_SIT = PAR.CD_SIT AND
	CHGAENANT.CD_CHG = PAR.CD_CHG_AEN_ANT AND
	PAR.TP_PAR_STA = 1 AND
	SSU.TP_SSU = 2 AND /* TEMPO APÓS */
	DATEDIFF(MI, PAR.DH_PAR_SIT, GETDATE()) &gt;= SSU.QT_SSU AND
   	(	/* não existe situação condicionante ou a situação do vôo de chegada é uma das situações condicionantes */
		NOT EXISTS (SELECT *  FROM T_SCA SCA WHERE SCA.CD_SIT = SSU.CD_SIT_SUC)  OR
		CHGAENANT.CD_SIT IN (SELECT CD_SIT_ANT FROM T_SCA SCA WHERE SCA.CD_SIT = SSU.CD_SIT_SUC)
	)

/*	Atualizar os vôos de partida cuja situaçao atual tem uma situaçao sucessora e
	o tempo para atualizaçao é o TEMPO MINIMO DE PERMANENCIA e que a diferença entre a hora
	prevista e a hora atual é menor ou igual que o TEMPO MINIMO DE PERMANENCIA e que os vôos antecessores
	estao nas situaçoes condicionantes, caso existam
*/

UPDATE 	T_PAR
SET	CD_SIT = CD_SIT_SUC,
	CD_USR = NULL
FROM  	T_PAR PAR, T_CHG CHGAENANT, T_SSU SSU, T_SIT SIT   
WHERE 	SSU.CD_SIT = PAR.CD_SIT AND
	SIT.CD_SIT = PAR.CD_SIT AND
	CHGAENANT.CD_CHG = PAR.CD_CHG_AEN_ANT AND
	PAR.TP_PAR_STA = 1 AND
	SSU.TP_SSU = 3 AND /* TEMPO MÍNIMO DE PERMANÊNCIA */
	DATEDIFF(MI, GETDATE(), PAR.DH_PAR_EFE) &lt;= CHGAENANT.QT_CHG_PER_MIN AND
   	(	/* não existe situação condicionante ou a situação do vôo de chegada é uma das situações condicionantes */
		NOT EXISTS (SELECT *  FROM T_SCA SCA WHERE SCA.CD_SIT = SSU.CD_SIT_SUC)  OR
		CHGAENANT.CD_SIT IN (SELECT CD_SIT_ANT FROM T_SCA SCA WHERE SCA.CD_SIT = SSU.CD_SIT_SUC)
	)
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o13"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o342">
<a:ObjectID>6958BD12-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_SOMA_DIA</a:Name>
<a:Code>SP_SOMA_DIA</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_SOMA_DIA    Script Date: 7/8/2000 12:15:32 ******/
Create Procedure SP_SOMA_DIA
(@DS_DIA VARCHAR(04), @NR_DIA INTEGER, @DS_SOMA_DIA VARCHAR(04) OUTPUT) As
DECLARE @DIA INTEGER
DECLARE @NR_POS INTEGER

SELECT @NR_POS = CHARINDEX(&#39;,&#39;, @DS_DIA)
SELECT @DIA = @NR_DIA + CONVERT(INTEGER, SUBSTRING(@DS_DIA, 1, @NR_POS - 1))
SELECT @DS_SOMA_DIA = CONVERT(VARCHAR, @DIA) + &#39;,&#39;
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o13"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o343">
<a:ObjectID>6958BD14-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_TransfereEspelho</a:Name>
<a:Code>SP_TransfereEspelho</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_TransfereEspelho    Script Date: 7/8/2000 12:15:34 ******/
Create Procedure SP_TransfereEspelho
(@pQtDt INT) As
IF @pQtDt &lt; (SELECT QT_PSI_MIR_TEM FROM T_PSI)
BEGIN
	RollBack Transaction
	RaisError 20003 &#39;Operação não executada: Data Limite para Espelhamento é menor que a data requerida&#39;
	Return
END

/* Monta recordset com vôos de Chegada cancelados que ocorreram até a data especificada */
DELETE T_MIR_LOG_CHG_001

Insert into T_MIR_LOG_CHG_001 (CD_CHG)
Select	CD_CHG 
From	T_CHG CHG
Where	TP_CHG_STA = 2
And 	FL_CHG_CAN = 1
And 	DATEDIFF(DD, DH_CHG_EFE, GETDATE()) &gt; @pQtDt

IF (SELECT COUNT(*) FROM T_MIR_LOG_CHG_001) &gt; 0
BEGIN

	Begin Transaction

	/* Inclui registros associados ao vôo de Chegada selecionado nas tabelas espelhos relacionadas */

	EXEC SP_IncTabEspRelCHG001

	IF @@ERROR &gt; 0

	BEGIN
		RollBack Transaction
		RaisError 20003 &#39;Operação não executada: SP_TransfereEspelho&#39;
		Return
	END

      
	/* Excluir registros das Tabelas Principais */
	EXEC SP_ExcTabPrincipal 2

	IF @@ERROR &gt; 0
	BEGIN

		RollBack Transaction
		RaisError 20003 &#39;Operação não executada: SP_TransfereEspelho&#39;
		Return
	END

	Commit Transaction
END


/* Monta recordset com vôos de Partida cancelados que ocorreram até a data especificada */
DELETE T_MIR_LOG_PAR_001

Insert into T_MIR_LOG_PAR_001 (CD_PAR)
Select	CD_PAR 
From	T_PAR PAR
Where	TP_PAR_STA = 2
And 	FL_PAR_CAN =1
And	DATEDIFF(DD, DH_PAR_EFE, GETDATE()) &gt; @pQtDt

IF (SELECT COUNT(*) FROM T_MIR_LOG_PAR_001) &gt; 0 
BEGIN
	Begin Transaction


	/* Inclui registros associados ao vôo de Chegada selecionado nas tabelas espelhos relacionadas */
	EXEC SP_IncTabEspRelPAR001
	IF @@ERROR &gt; 0
	BEGIN

		RollBack Transaction
		RaisError 20003 &#39;Operação não executada: SP_TransfereEspelho&#39;
		Return
	END


	/* Excluir registros das Tabelas Principais */
	EXEC SP_ExcTabPrincipal 3
	IF @@ERROR &gt; 0
	BEGIN
		RollBack Transaction

		RaisError 20003 &#39;Operação não executada: SP_TransfereEspelho&#39;
		Return
	END


	Commit Transaction
END

/* Monta recordset com vôos de Chegada associados aos vôos de Partida cujas decolagens aconteceram até a data especificada */

DELETE T_MIR_LOG_CHG

Insert into T_MIR_LOG_CHG (CD_CHG)
Select	CD_CHG 
From	T_CHG CHG
Where	CD_CHG In (	Select 	CD_CHG_AEN_ANT
			From  	T_PAR PAR
			Where 	PAR.TP_PAR_STA = 2

			And   	PAR.CD_AER = (SELECT CD_AER FROM T_PSI)
			And   	PAR.TP_PAR_CTG NOT IN (3,4)

			And   	DATEDIFF(DD, DH_PAR_EFE, GETDATE()) &gt; @pQtDt
			And   	PAR.FL_PAR_CAN = 0)

IF (SELECT COUNT(*) FROM T_MIR_LOG_CHG) &gt; 0
BEGIN


	Begin Transaction

	/* Inclui registros associados ao vôo de Chegada selecionado nas tabelas espelhos relacionadas */
	EXEC SP_IncTabEspRelCHG 

	IF @@ERROR &gt; 0
	BEGIN

		RollBack Transaction
		RaisError 20003 &#39;Operação não executada: SP_TransfereEspelho&#39;
		Return
	END

	/* Seleciona vôos de Chegada Codeshare ou Duplicate Leg vinculados ao vôo de Chegada selecionado */
	DELETE T_MIR_LOG_CHG_001

	Insert into T_MIR_LOG_CHG_001 (CD_CHG)
	Select	CHGVIN.CD_CHG 

	From	T_CHG CHGVIN, T_MIR_LOG_CHG CHG
	Where	CHGVIN.CD_CHG_VIN = CHG.CD_CHG
	Order By CHGVIN.CD_CHG

	/* Percorre vetor com vôos de Chegada vinculados a serem processados */
	EXEC SP_IncTabEspRelCHG001
	IF @@ERROR &gt; 0
	BEGIN
		RollBack Transaction
		RaisError 20003 &#39;Operação não executada: SP_TransfereEspelho&#39;
		Return
	END

	/* Seleciona vôos de Partida associados ao vôo de Chegada selecionado */

	DELETE T_MIR_LOG_PAR

	Insert into T_MIR_LOG_PAR (CD_PAR)
        	Select	PAR.CD_PAR
	From	T_PAR PAR, T_MIR_LOG_CHG CHG
	Where	PAR.CD_CHG_AEN_ANT = CHG.CD_CHG
	Order By PAR.CD_PAR


	/* Inclui registros associados ao vôo de Partida selecionado nas tabelas espelhos relacionadas */
	EXEC SP_IncTabEspRelPAR 
	IF @@ERROR &gt; 0

	BEGIN
		RollBack Transaction
		RaisError 20003 &#39;Operação não executada: SP_TransfereEspelho&#39;
		Return
	END

	/* Seleciona vôos de Partida Codeshare ou Duplicate Leg vinculados ao vôo de Partida selecionado */
	DELETE T_MIR_LOG_PAR_001
		Insert into T_MIR_LOG_PAR_001 (CD_PAR)
	Select	PARVIN.CD_PAR 
	From	T_PAR PARVIN, T_MIR_LOG_PAR PAR
	Where	PARVIN.CD_PAR_VIN = PAR.CD_PAR
	Order By PARVIN.CD_PAR

	/* Percorre vetor com vôos de Chegada vinculados a serem processados */
	EXEC SP_IncTabEspRelPAR001
	IF @@ERROR &gt; 0
	BEGIN
		RollBack Transaction
		RaisError 20003 &#39;Operação não executada: SP_TransfereEspelho&#39;
		Return
	END


       	/* Excluir Tabela Principal */
	EXEC SP_ExcTabPrincipal 1
	IF @@ERROR &gt; 0
	BEGIN
		RollBack Transaction
		RaisError 20003 &#39;Operação não executada: SP_TransfereEspelho&#39;
		Return
	END

	Commit Transaction
END
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o13"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o344">
<a:ObjectID>6958BD16-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_VerificaCodeShare</a:Name>
<a:Code>SP_VerificaCodeShare</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_VerificaCodeShare    Script Date: 7/8/2000 12:15:34 ******/
CREATE Procedure SP_VerificaCodeShare
(@CD_HOT_INS CHAR(7), @CD_HVE_INS CHAR(3), @CD_HFR_INS CHAR(1), @TP_HET_CTG_INS TINYINT) As
/* Declaração das variáveis que receberão o cursor */
DECLARE @CD_HOT			CHAR(7),
	 @CD_HVE			CHAR(3),
	 @CD_HFR			CHAR(1),
	 @CD_HET			CHAR(2),
	 @DS_HFR_CSH			CHAR(7),
	 @QT_HET_DIA_PAR_CSH		INT,
	 @QT_HET_DIA_CHG_CSH		INT,
	 @DS_HFR_NRM			CHAR(7),
	 @QT_HET_DIA_PAR_NRM		INT,
	 @QT_HET_DIA_CHG_NRM		INT,
	 @CD_HET_CORRENTE		CHAR(13),
	 @QT_NOK			TINYINT,
	 @FL_OK				BIT,
	 @FL_OK_TOTAL			BIT,
	 @NR_POS			TINYINT,
	 @DS_HFR_Descoberta 		CHAR(7),
	 @CD_HOT_NRM			CHAR(10),
	 @CD_HOT_NRM_CORRENTE	CHAR(10)

IF @TP_HET_CTG_INS IN (3, 4)
BEGIN
/* Verificar todas as etapas do tipo Code-Share ou Duplicate Leg pertencentes à mesma freqüencia das etapas alteradas, 
    se no Hotran Vinculado existe alguma etapa com a mesma origem e destino e 
    cujo período de validade abranja o período de validade do vôo code-share/duplicate leg */
IF (	SELECT	COUNT(*) FROM T_HVE HVEINS, T_HET HETINS
	WHERE	HETINS.CD_HOT + HETINS.CD_HVE + HETINS.CD_HFR = @CD_HOT_INS + @CD_HVE_INS + @CD_HFR_INS AND
		HVEINS.CD_HOT + HVEINS.CD_HVE = @CD_HOT_INS + @CD_HVE_INS AND
		HETINS.TP_HET_CTG IN (3, 4) AND
		NOT EXISTS (	SELECT * FROM T_HVE HVE, T_HET HET
				WHERE	HET.CD_HOT = HETINS.CD_HOT_VIN AND
					HVE.CD_HOT + HVE.CD_HVE = HET.CD_HOT + HET.CD_HVE AND
					HET.SG_AER_ORI = HETINS.SG_AER_ORI AND
					HET.SG_AER_DES = HETINS.SG_AER_DES AND
					HVE.DT_HVE_INI &lt;= HVEINS.DT_HVE_INI AND
					(HVE.DT_HVE_FIM &gt;= HVEINS.DT_HVE_FIM OR HVE.DT_HVE_FIM IS NULL))) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: Um vôo Code-Share ou Duplicate Leg tem de estar associado a um Hotran que possua pelo menos uma etapa com a mesma origem e destino e cujo período de validade abranja o período de validade.&#39;
	RETURN
END

/* Verificar entre as etapas do Hotran Vinculado válidas pela condição anterior, isto é, têm a mesma origem e destino desta etapa e com período de validade
    compreendido pelo período de validade da etapa vinculada, se há alguma etapa cuja freqüência abranja a freqüência do vôo code-share que está sendo alterado. */

/* Declaração do cursor */
DECLARE SP_CURSOR CURSOR FOR
	SELECT 	DISTINCT 
		HETCSH.CD_HOT,
		HETCSH.CD_HVE,
		HETCSH.CD_HFR,
		HETCSH.CD_HET,
		HET.CD_HOT + HET.CD_HVE,
		DS_HFR_CSH = HFRCSH.DS_HFR,
		QT_HET_DIA_PAR_CSH = CONVERT(INT, HETCSH.QT_HET_DIA_PAR),
		QT_HET_DIA_CHG_CSH = CONVERT(INT, HETCSH.QT_HET_DIA_CHG),
		DS_HFR_NRM = HFR.DS_HFR,

		QT_HET_DIA_PAR_NRM = CONVERT(INT, HET.QT_HET_DIA_PAR),
		QT_HET_DIA_CHG_NRM = CONVERT(INT, HET.QT_HET_DIA_CHG)
	FROM	T_HVE HVECSH, T_HFR HFRCSH, T_HET HETCSH, T_HVE HVE, T_HFR HFR, T_HET HET
	WHERE	HVECSH.CD_HOT + HVECSH.CD_HVE = HETCSH.CD_HOT + HETCSH.CD_HVE AND
		HFRCSH.CD_HOT + HFRCSH.CD_HVE + HFRCSH.CD_HFR = HETCSH.CD_HOT + HETCSH.CD_HVE + HETCSH.CD_HFR AND
		HETCSH.CD_HOT + HETCSH.CD_HVE + HETCSH.CD_HFR = @CD_HOT_INS + @CD_HVE_INS + @CD_HFR_INS AND
		HETCSH.TP_HET_CTG IN (3, 4) AND
		HVE.CD_HOT + HVE.CD_HVE = HET.CD_HOT + HET.CD_HVE AND
		HFR.CD_HOT + HFR.CD_HVE + HFR.CD_HFR = HET.CD_HOT + HET.CD_HVE + HET.CD_HFR AND
		HET.CD_HOT = HETCSH.CD_HOT_VIN AND
		HET.SG_AER_ORI = HETCSH.SG_AER_ORI AND
		HET.SG_AER_DES = HETCSH.SG_AER_DES AND


		HVE.DT_HVE_INI &lt;= HVECSH.DT_HVE_INI AND
		(HVE.DT_HVE_FIM &gt;= HVECSH.DT_HVE_FIM OR HVE.DT_HVE_FIM IS NULL)
	ORDER BY HETCSH.CD_HOT, HETCSH.CD_HVE, HETCSH.CD_HFR, HETCSH.CD_HET, HET.CD_HOT + HET.CD_HVE

SELECT @FL_OK_TOTAL = 1

/* Abertura do cursor */
OPEN SP_CURSOR

/* Ir para o primeiro registro */
FETCH	SP_CURSOR
INTO	@CD_HOT,
	@CD_HVE,
	@CD_HFR,
	@CD_HET,
	@CD_HOT_NRM,
	@DS_HFR_CSH,
	@QT_HET_DIA_PAR_CSH,
	@QT_HET_DIA_CHG_CSH,
	@DS_HFR_NRM,
	@QT_HET_DIA_PAR_NRM,
	@QT_HET_DIA_CHG_NRM

/* Processar todos os registros de SP_CURSOR */
WHILE @@FETCH_STATUS = 0
BEGIN

	SELECT	@CD_HET_CORRENTE = @CD_HOT + @CD_HVE + @CD_HFR + @CD_HET, 
		@FL_OK = 0

	/* Verificar todos os hotrans normais possivelmente válidos para esta etapa */


	WHILE @@FETCH_STATUS = 0 AND @CD_HOT + @CD_HVE + @CD_HFR + @CD_HET = @CD_HET_CORRENTE
	BEGIN


		SELECT 	@CD_HOT_NRM_CORRENTE = @CD_HOT_NRM,
			@DS_HFR_Descoberta = @DS_HFR_CSH

		/* Processar todas as frequüências deste hotran normal */
		WHILE @@FETCH_STATUS = 0 AND @CD_HOT + @CD_HVE + @CD_HFR + @CD_HET = @CD_HET_CORRENTE AND @CD_HOT_NRM = @CD_HOT_NRM_CORRENTE
		BEGIN

			SELECT	@DS_HFR_CSH = @DS_HFR_Descoberta,
				@DS_HFR_Descoberta = &#39;&#39;,
				@NR_POS = 1

			/* Varrer @DS_HFR_CSH para verificar se cada dia desta freqüência está contido na freqüência da etapa normal */
			WHILE SUBSTRING(RTRIM(@DS_HFR_CSH) + &#39;X&#39;, @NR_POS, 1) &lt;&gt; &#39;X&#39;
			BEGIN

				    /* Verificar se este dia da freqüência de partida do vôo codeshare/duplicate está na freqüência de partida do vôo vinculado */
				IF PATINDEX(&#39;%&#39; + CONVERT(CHAR(1), (((CONVERT(INT, SUBSTRING(@DS_HFR_CSH, @NR_POS, 1)) - ( ISNULL(@QT_HET_DIA_PAR_NRM,0) - ISNULL(@QT_HET_DIA_PAR_CSH,0) ) - 1) % 7) + 7) % 7 + 1) + &#39;%&#39;, @DS_HFR_NRM) = 0
				    OR
				   /* Verificar se este dia da freqüência de chegada do vôo codeshare/duplicate está na freqüência de chegada do vôo vinculado */
				    PATINDEX(&#39;%&#39; + CONVERT(CHAR(1), (((CONVERT(INT, SUBSTRING(@DS_HFR_CSH, @NR_POS, 1)) - ( ISNULL(@QT_HET_DIA_CHG_NRM,0) - ISNULL(@QT_HET_DIA_CHG_CSH,0) ) - 1) % 7) + 7) % 7 + 1) + &#39;%&#39;, @DS_HFR_NRM) = 0
					SELECT @DS_HFR_Descoberta = RTRIM(@DS_HFR_Descoberta) + SUBSTRING(@DS_HFR_CSH, @NR_POS, 1)

				SELECT @NR_POS = @NR_POS + 1

			END

			/* Ir para o próximo registro */
			FETCH	NEXT FROM SP_CURSOR
			INTO	@CD_HOT,
				@CD_HVE,
				@CD_HFR,
				@CD_HET,
				@CD_HOT_NRM,
				@DS_HFR_CSH,
				@QT_HET_DIA_PAR_CSH,
				@QT_HET_DIA_CHG_CSH,
				@DS_HFR_NRM,
				@QT_HET_DIA_PAR_NRM,
				@QT_HET_DIA_CHG_NRM

		END

		IF RTRIM(@DS_HFR_Descoberta) + &#39;X&#39; = &#39;X&#39; SELECT @FL_OK = 1

	END

	IF @FL_OK = 0 SELECT @FL_OK_TOTAL = 0

END
CLOSE SP_CURSOR
DEALLOCATE SP_CURSOR


IF @FL_OK_TOTAL = 0
BEGIN
	RAISERROR 20001 &#39;Operação não executada:Um vôo CodeShare ou DuplicateLeg tem de estar associado a um Hotran que possua pelo menos uma etapa com a mesma origem e destino e cuja freqüência e período de validade abranjam sua freqüência e período de validade, respectivamente.&#39;
	RETURN
END

END
ELSE
BEGIN

/* VERIFICAR SE ALTERAÇÕES NAS ETAPAS NORMAIS AFETAM AS ETAPAS CODE-SHARE/DUPLICATE LEG */

/* Verificar se, após a alteração, as etapas do tipo Code-Share ou Duplicate Leg que têm o hotran desta etapa como hotran vinculado,
    se no Hotran Vinculado continua existindo alguma etapa com a mesma origem e destino e cujo período de validade abranja o 
    período de validade da etapa CS/DL */
IF (	SELECT	COUNT(*) FROM T_HVE HVECSH, T_HET HETCSH
	WHERE	HVECSH.CD_HOT + HVECSH.CD_HVE = HETCSH.CD_HOT + HETCSH.CD_HVE AND
		HETCSH.CD_HOT_VIN = @CD_HOT_INS AND
		NOT EXISTS (	SELECT * FROM T_HVE HVE, T_HET HET
				WHERE	HVE.CD_HOT + HVE.CD_HVE = HET.CD_HOT + HET.CD_HVE AND
					HET.CD_HOT = HETCSH.CD_HOT_VIN AND
					HET.SG_AER_ORI = HETCSH.SG_AER_ORI AND
					HET.SG_AER_DES = HETCSH.SG_AER_DES AND
					HVE.DT_HVE_INI &lt;= HVECSH.DT_HVE_INI AND
					(HVE.DT_HVE_FIM &gt;= HVECSH.DT_HVE_FIM OR HVE.DT_HVE_FIM IS NULL))) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: Há vôos Code-Share ou Duplicate Leg associados a este Hotran que impedem esta alteração.&#39;
	RETURN
END



/* Verificar se após esta alteração, as etapas code-share ou duplicate leg vinculadas a este hotran continuaram válildas quanto à freqüência */

/* Declaração do cursor */
DECLARE SP_CURSOR CURSOR FOR
	SELECT 	DISTINCT 
		HETCSH.CD_HOT,
		HETCSH.CD_HVE,
		HETCSH.CD_HFR,
		HETCSH.CD_HET,
		HET.CD_HOT + HET.CD_HVE,
		DS_HFR_CSH = HFRCSH.DS_HFR,
		QT_HET_DIA_PAR_CSH = CONVERT(INT, HETCSH.QT_HET_DIA_PAR),
		QT_HET_DIA_CHG_CSH = CONVERT(INT, HETCSH.QT_HET_DIA_CHG),
		DS_HFR_NRM = HFR.DS_HFR,
		QT_HET_DIA_PAR_NRM = CONVERT(INT, HET.QT_HET_DIA_PAR),
		QT_HET_DIA_CHG_NRM = CONVERT(INT, HET.QT_HET_DIA_CHG)

	FROM	T_HVE HVECSH, T_HFR HFRCSH, T_HET HETCSH, T_HVE HVE, T_HFR HFR, T_HET HET
	WHERE	HVECSH.CD_HOT + HVECSH.CD_HVE = HETCSH.CD_HOT + HETCSH.CD_HVE AND
		HFRCSH.CD_HOT + HFRCSH.CD_HVE + HFRCSH.CD_HFR = HETCSH.CD_HOT + HETCSH.CD_HVE + HETCSH.CD_HFR AND
		HETCSH.CD_HOT_VIN = @CD_HOT_INS AND
		HVE.CD_HOT + HVE.CD_HVE = HET.CD_HOT + HET.CD_HVE AND
		HFR.CD_HOT + HFR.CD_HVE + HFR.CD_HFR = HET.CD_HOT + HET.CD_HVE + HET.CD_HFR AND
		HET.CD_HOT = HETCSH.CD_HOT_VIN AND
		HET.SG_AER_ORI = HETCSH.SG_AER_ORI AND
		HET.SG_AER_DES = HETCSH.SG_AER_DES AND
		HVE.DT_HVE_INI &lt;= HVECSH.DT_HVE_INI AND
		(HVE.DT_HVE_FIM &gt;= HVECSH.DT_HVE_FIM OR HVE.DT_HVE_FIM IS NULL)

	ORDER BY HETCSH.CD_HOT, HETCSH.CD_HVE, HETCSH.CD_HFR, HETCSH.CD_HET, HET.CD_HOT + HET.CD_HVE

SELECT @FL_OK_TOTAL = 1

/* Abertura do cursor */
OPEN SP_CURSOR

/* Ir para o primeiro registro */
FETCH	SP_CURSOR
INTO	@CD_HOT,
	@CD_HVE,
	@CD_HFR,
	@CD_HET,
	@CD_HOT_NRM,
	@DS_HFR_CSH,
	@QT_HET_DIA_PAR_CSH,
	@QT_HET_DIA_CHG_CSH,
	@DS_HFR_NRM,
	@QT_HET_DIA_PAR_NRM,
	@QT_HET_DIA_CHG_NRM


/* Processar todos os registros de SP_CURSOR */
WHILE @@FETCH_STATUS = 0
BEGIN

	SELECT	@CD_HET_CORRENTE = @CD_HOT + @CD_HVE + @CD_HFR + @CD_HET, 
		@FL_OK = 0

	/* Verificar todos os hotrans normais possivelmente válidos para esta etapa */
	WHILE @@FETCH_STATUS = 0 AND @CD_HOT + @CD_HVE + @CD_HFR + @CD_HET = @CD_HET_CORRENTE
	BEGIN

		SELECT 	@CD_HOT_NRM_CORRENTE = @CD_HOT_NRM,
			@DS_HFR_Descoberta = @DS_HFR_CSH

		/* Processar todas as frequüências deste hotran normal */
		WHILE @@FETCH_STATUS = 0 AND @CD_HOT + @CD_HVE + @CD_HFR + @CD_HET = @CD_HET_CORRENTE AND @CD_HOT_NRM = @CD_HOT_NRM_CORRENTE
		BEGIN

			SELECT	@DS_HFR_CSH = @DS_HFR_Descoberta,
				@DS_HFR_Descoberta = &#39;&#39;,
				@NR_POS = 1

			/* Varrer @DS_HFR_CSH para verificar se cada dia desta freqüência está contido na freqüência da etapa normal */
			WHILE SUBSTRING(RTRIM(@DS_HFR_CSH) + &#39;X&#39;, @NR_POS, 1) &lt;&gt; &#39;X&#39;
			BEGIN

				    /* Verificar se este dia da freqüência de partida do vôo codeshare/duplicate está na freqüência de partida do vôo vinculado */
				IF PATINDEX(&#39;%&#39; + CONVERT(CHAR(1), (((CONVERT(INT, SUBSTRING(@DS_HFR_CSH, @NR_POS, 1)) - ( ISNULL(@QT_HET_DIA_PAR_NRM,0) - ISNULL(@QT_HET_DIA_PAR_CSH,0) ) - 1) % 7) + 7) % 7 + 1) + &#39;%&#39;, @DS_HFR_NRM) = 0
				    OR

				   /* Verificar se este dia da freqüência de chegada do vôo codeshare/duplicate está na freqüência de chegada do vôo vinculado */
				    PATINDEX(&#39;%&#39; + CONVERT(CHAR(1), (((CONVERT(INT, SUBSTRING(@DS_HFR_CSH, @NR_POS, 1)) - ( ISNULL(@QT_HET_DIA_CHG_NRM,0) - ISNULL(@QT_HET_DIA_CHG_CSH,0) ) - 1) % 7) + 7) % 7 + 1) + &#39;%&#39;, @DS_HFR_NRM) = 0
					SELECT @DS_HFR_Descoberta = RTRIM(@DS_HFR_Descoberta) + SUBSTRING(@DS_HFR_CSH, @NR_POS, 1)

				SELECT @NR_POS = @NR_POS + 1

			END

			/* Ir para o próximo registro */
			FETCH	NEXT FROM SP_CURSOR
			INTO	@CD_HOT,
				@CD_HVE,
				@CD_HFR,
				@CD_HET,
				@CD_HOT_NRM,
				@DS_HFR_CSH,
				@QT_HET_DIA_PAR_CSH,
				@QT_HET_DIA_CHG_CSH,
				@DS_HFR_NRM,
				@QT_HET_DIA_PAR_NRM,
				@QT_HET_DIA_CHG_NRM

		END

		IF RTRIM(@DS_HFR_Descoberta) + &#39;X&#39; = &#39;X&#39; SELECT @FL_OK = 1

	END

	IF @FL_OK = 0 SELECT @FL_OK_TOTAL = 0

END
CLOSE SP_CURSOR
DEALLOCATE SP_CURSOR


IF @FL_OK_TOTAL = 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: Há vôos Code-Share ou Duplicate Leg associados a este Hotran que impedem esta alteração.&#39;
	RETURN
END

END
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o13"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o345">
<a:ObjectID>6958BD18-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_VerificaIP</a:Name>
<a:Code>SP_VerificaIP</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_VerificaIP    Script Date: 7/8/2000 12:15:32 ******/
Create Procedure SP_VerificaIP
(@pIP VARCHAR(15)) As
DECLARE @i INT
DECLARE @lIPPart VARCHAR(3)
DECLARE @lChar CHAR(1)
DECLARE @lPontos INT
DECLARE @lLenIP INT
DECLARE @lNumeros INT

select @lIPPart = &#39;&#39;
select @lPontos = 0
select @i = 1
IF PATINDEX(&#39;%@%&#39;, @pIP) &gt; 0 
BEGIN
	RAISERROR 20999 &#39;Operação não executada: IP Inválido.&#39;
	RETURN
END
SELECT @lLenIP = PATINDEX (&#39;%@%&#39;,@pIP + &#39;@&#39;) - 1

SELECT @lNumeros = 0

while @i &lt;= @lLenIP

BEGIN
	select @lChar = substring(@pIP, @i, 1)

	if @lChar = &#39;.&#39;
	BEGIN
		SELECT @lNumeros = 0
	END

        If @lChar &lt;&gt; &#39;.&#39; 
	BEGIN
		select @lNumeros = @lNumeros + 1
                
  	        IF @LCHAR &lt; &#39;0&#39; OR @LCHAR &gt; &#39;9&#39; OR @lNumeros &gt; 3
		BEGIN
			RAISERROR 20999 &#39;Operação não executada: IP Inválido.&#39;
			RETURN
		END
		select @lIPPart = LTRIM(@lIPPart) + @lChar
	END

	If (@lChar = &#39;.&#39; Or @i = @lLenIP) And @lIPPart &lt;&gt; &#39;&#39;
	BEGIN
		select @lPontos = @lPontos + 1
		If Not (CONVERT(INT, @lIPPart) &gt;= 0 and CONVERT(INT, @lippart) &lt;= 255)
		BEGIN
			RAISERROR 20999 &#39;Operação não executada: IP Inválido.&#39;
			RETURN
		END
		select @lIPPart = &#39;&#39;
	END
	select @i = @i + 1
END   

If @lPontos &lt;&gt; 4
BEGIN
	RAISERROR 20999 &#39;Operação não executada: IP Inválido.&#39;
	RETURN
END
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o13"/>
</c:Procedure.Owner>
</o:Procedure>
</c:Procedures>
<c:Tables>
<o:Table Ref="o305"/>
<o:Table Ref="o17"/>
<o:Table Ref="o120"/>
<o:Table Ref="o135"/>
<o:Table Ref="o254"/>
<o:Table Ref="o280"/>
<o:Table Ref="o150"/>
<o:Table Ref="o7"/>
<o:Table Ref="o53"/>
<o:Table Ref="o102"/>
<o:Table Ref="o175"/>
<o:Table Ref="o85"/>
<o:Table Ref="o204"/>
<o:Table Ref="o223"/>
<o:Table Ref="o237"/>
</c:Tables>
<c:References>
<o:Reference Ref="o49"/>
<o:Reference Ref="o81"/>
<o:Reference Ref="o98"/>
<o:Reference Ref="o131"/>
<o:Reference Ref="o146"/>
<o:Reference Ref="o162"/>
<o:Reference Ref="o165"/>
<o:Reference Ref="o169"/>
<o:Reference Ref="o198"/>
<o:Reference Ref="o219"/>
<o:Reference Ref="o233"/>
<o:Reference Ref="o250"/>
<o:Reference Ref="o276"/>
<o:Reference Ref="o298"/>
<o:Reference Ref="o301"/>
<o:Reference Ref="o321"/>
<o:Reference Ref="o324"/>
<o:Reference Ref="o327"/>
<o:Reference Ref="o330"/>
</c:References>
<c:TargetModels>
<o:TargetModel Id="o346">
<a:ObjectID>6958BCFC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Microsoft SQL Server 7.x</a:Name>
<a:Code>SQL SERVER 7</a:Code>
<a:CreationDate>1081540664</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540664</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:TargetModelURL>file:///%_DBMS%/sqlserv7.xdb</a:TargetModelURL>
<a:TargetModelID>986CB218-1936-4245-823C-883D7AF59B86</a:TargetModelID>
<a:TargetModelClassID>4BA9F647-DAB1-11D1-9944-006097355D9B</a:TargetModelClassID>
<c:SessionShortcuts>
<o:Shortcut Ref="o3"/>
<o:Shortcut Id="o347">
<a:ObjectID>6958BCFF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Microsoft SQL Server 7.x</a:Name>
<a:Code>SQL SERVER 7</a:Code>
<a:CreationDate>1081540666</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540666</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:TargetID>986CB218-1936-4245-823C-883D7AF59B86</a:TargetID>
<a:TargetClassID>4BA9F647-DAB1-11D1-9944-006097355D9B</a:TargetClassID>
<a:TargetPackagePath/>
</o:Shortcut>
</c:SessionShortcuts>
</o:TargetModel>
</c:TargetModels>
</o:Model>
</c:Children>
</o:RootObject>

</Model>