<?xml version="1.0" encoding="UTF-8"?>
<?PowerDesigner ID="{6958A53C-8FBB-11D8-B6CA-00024416849C}" Name="PhysicalDataModel_7" Objects="324" Symbols="34" Type="{CDE44E21-9669-11D1-9914-006097355D9B}" signature="PDM_DATA_MODEL_XML" version="9.0.0.438 Evaluation"?>
<!-- please do not edit this file -->

<Model xmlns:a="attribute" xmlns:c="collection" xmlns:o="object">

<o:RootObject Id="o1">
<c:Children>
<o:Model Id="o2">
<a:ObjectID>6958A53C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>PhysicalDataModel_7</a:Name>
<a:Code>PHYSICALDATAMODEL_7</a:Code>
<a:CreationDate>1081538410</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081692038</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PackageOptionsText>
[FolderOptions]

[FolderOptions\Physical Objects]
GenerationCheckModel=Yes
GenerationPath=
RevPkey=Yes
RevFkey=Yes
RevAkey=Yes
RevCheck=Yes
RevIndx=Yes
RevOpts=Yes
RevViewAsTabl=No
RevSystAsTabl=Yes
RevSynmAsTabl=Yes
GenScriptName=crebas
GenScriptName0=
GenScriptName1=
GenScriptName2=
GenScriptName3=
GenScriptName4=
GenScriptName5=
GenScriptName6=
GenScriptName7=
GenScriptName8=
GenScriptName9=
GenPathName=
GenSingleFile=Yes
GenTrgScriptName=cretrg
GenTrgScriptName0=
GenTrgScriptName1=
GenTrgScriptName2=
GenTrgScriptName3=
GenTrgScriptName4=
GenTrgScriptName5=
GenTrgScriptName6=
GenTrgScriptName7=
GenTrgScriptName8=
GenTrgScriptName9=
GenTrgPathName=
GenTrgSingleFile=Yes
GenODBC=No
GenCheckModel=Yes
GenScriptPrev=Yes
GenArchiveModel=No
GenDataPathName=
GenDataSinglefile=Yes
GenDataScriptName=testdata
GenDataScriptName0=
GenDataScriptName1=
GenDataScriptName2=
GenDataScriptName3=
GenDataScriptName4=
GenDataScriptName5=
GenDataScriptName6=
GenDataScriptName7=
GenDataScriptName8=
GenDataScriptName9=
GenDataOdbc=No
GenDataDelOld=No
GenDataTitle=No
GenDataDefNumRows=20
GenDataCommit=0
GenDataPacket=0
GenDataCSV=No
GenDataOwner=No
GenDataProfNumb=
GenDataProfChar=
GenDataProfDate=
GenTspcCrea=Yes
GenTspcDrop=Yes
GenStorCrea=Yes
GenStorDrop=Yes
GenUddtCrea=Yes
GenUddtDval=Yes
GenUddtChck=Yes
GenUddtCmmt=Yes
GenUddtDrop=Yes
GenClssCrea=Yes
GenClssHead=Yes
GenClssFoot=Yes
GenClssCmmt=Yes
GenClssDrop=Yes
GenClssInst=Yes
GenClssSupp=Yes
GenDtbsCrea=Yes
GenDtbsOpts=Yes
GenDtbsHead=Yes
GenDtbsFoot=Yes
GenDtbsOpen=Yes
GenDtbsClose=Yes
GenDtbsDrop=Yes
GenUserCrea=Yes
GenUserGrant=Yes
GenUserDrop=Yes
GenTablCrea=Yes
GenTablChck=Yes
GenTablOpts=Yes
GenTablHead=Yes
GenTablFoot=Yes
GenTablCmmt=Yes
GenTablDrop=Yes
GenColnUddt=Yes
GenColnDval=Yes
GenColnChck=Yes
GenColnOpts=Yes
GenColnCmmt=Yes
GenPkeyCrea=Yes
GenPkeyOpts=Yes
GenPkeyDrop=Yes
GenAkeyCrea=Yes
GenAkeyOpts=Yes
GenAkeyDrop=Yes
GenRefrCrea=Yes
GenRefrIdcl=Yes
GenRefrIDUR=Yes
GenRefrIDUC=Yes
GenRefrIDUN=Yes
GenRefrIDUD=Yes
GenRefrIDDR=Yes
GenRefrIDDC=Yes
GenRefrIDDN=Yes
GenRefrIDDD=Yes
GenRefrDrop=Yes
GenIndxCrea=Yes
GenIndxPkey=Yes
GenIndxFkey=Yes
GenIndxAkey=Yes
GenIndxClus=Yes
GenIndxOthr=Yes
GenIndxOpts=Yes
GenIndxCmmt=Yes
GenIndxDrop=Yes
GenViewCrea=Yes
GenViewHead=Yes
GenViewFoot=Yes
GenViewCmmt=Yes
GenViewDrop=Yes
GenJidxCrea=Yes
GenJidxHead=Yes
GenJidxFoot=Yes
GenJidxDrop=Yes
GenSqncCrea=Yes
GenSqncDrop=Yes
GenTrgrCrea=Yes
GenTrgrDrop=Yes
GenTrgrFIns=Yes
GenTrgrFUpd=Yes
GenTrgrFDel=Yes
GenProcCrea=Yes
GenProcDrop=Yes
GenScriptTitle=Yes
GenScriptNamLabl=No
GenScriptQDtbs=Yes
GenScriptQOwnr=Yes
GenScriptCase=0
GenScriptCharset=0
GenScriptNAcct=No
GenScriptODBC=No
GenUseSync=No
GenSyncChoice=0
GenSyncArch=
GenTmpTablCrea=Yes
GenTmpTablDrop=Yes
GenTrgrStdMsg=Yes
GenTrgrMsgTab=
GenTrgrMsgNo=
GenTrgrMsgTxt=
GenRuleCrea=Yes
GenRuleDrop=Yes

[FolderOptions\Pdm]
IndxIQName=%COLUMN%_%INDEXTYPE%
IndxPK=Yes
IndxFK=Yes
IndxAK=Yes
IndxPKName=%TABLE%_PK
IndxFKName=%REFR%_FK
IndxAKName=%AKEY%_AK
IndxPreserve=No
IndxThreshold=0
RefrPreserve=No
JidxPreserve=No
RbldMultiFact=Yes
RbldMultiDim=Yes
RbldMultiJidx=Yes
CubePreserve=No
CubeScriptPath=
CubeScriptCase=0
CubeScriptCharset=0
CubeScriptNacct=No
CubeScriptHeader=No
CubeScriptExt=csv
CubeScriptExt0=txt
CubeScriptExt1=
CubeScriptExt2=
CubeScriptSep=,
CubeScriptDeli=&quot;
TrgrPreserve=No
TrgrIns=Yes
TrgrUpd=Yes
TrgrDel=Yes
TrgrC2Ins=Yes
TrgrC2Upd=Yes
TrgrC3=Yes
TrgrC4=Yes
TrgrC5=Yes
TrgrC6=Yes
TrgrC7=Yes
TrgrC8=Yes
TrgrC9=Yes
TrgrC10=Yes
TrgrC11=Yes
TrgrC1=Yes
TrgrC12Ins=Yes
TrgrC12Upd=Yes
TrgrC13=Yes
</a:PackageOptionsText>
<a:ModelOptionsText>
[ModelOptions]

[ModelOptions\Physical Objects]
DisplayName=Yes
DefaultDttp=&lt;Undefined&gt;
IgnoreOwner=No
RefrUnique=No
RefrAutoMigrate=Yes
RefrMigrateReuse=Yes
RefrMigrateDomain=Yes
RefrMigrateCheck=Yes
RefrMigrateRule=Yes
RefrMigrateExtd=No
RefrMigrDefaultLink=No
DomnForbDivg=No
DomnCopyDttp=Yes
DomnCopyChck=No
DomnCopyRule=No
DomnCopyMand=No
DomnCopyExtd=No
DomnCopyProf=No

[ModelOptions\Connection]

[ModelOptions\Pdm]

[ModelOptions\Generate]

[ModelOptions\Generate\Cdm]
CheckModel=1
SaveLinks=1
NameToCode=0
Notation=2

[ModelOptions\Generate\Oom]
CheckModel=1
SaveLinks=1
ORMapping=0
NameToCode=0
ClassPrefix=

[ModelOptions\ClssNamingOptions]

[ModelOptions\ClssNamingOptions\PDMPCKG]

[ModelOptions\ClssNamingOptions\PDMPCKG\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\PDMPCKG\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\PDMDOMN]

[ModelOptions\ClssNamingOptions\PDMDOMN\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\PDMDOMN\Code]
Template=
MaxLen=128
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\TABL]

[ModelOptions\ClssNamingOptions\TABL\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\TABL\Code]
Template=
MaxLen=128
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\COLN]

[ModelOptions\ClssNamingOptions\COLN\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\COLN\Code]
Template=
MaxLen=128
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\REFR]

[ModelOptions\ClssNamingOptions\REFR\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\REFR\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\VREF]

[ModelOptions\ClssNamingOptions\VREF\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\VREF\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\VIEW]

[ModelOptions\ClssNamingOptions\VIEW\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\VIEW\Code]
Template=
MaxLen=128
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\FACT]

[ModelOptions\ClssNamingOptions\FACT\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\FACT\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\DIMN]

[ModelOptions\ClssNamingOptions\DIMN\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\DIMN\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\CUBE]

[ModelOptions\ClssNamingOptions\CUBE\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\CUBE\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\MEAS]

[ModelOptions\ClssNamingOptions\MEAS\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\MEAS\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\DATTR]

[ModelOptions\ClssNamingOptions\DATTR\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\DATTR\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\FILO]

[ModelOptions\ClssNamingOptions\FILO\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;\/:*?&lt;&gt;|&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\FILO\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_.&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\DefaultClass]

[ModelOptions\ClssNamingOptions\DefaultClass\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\DefaultClass\Code]
Template=
MaxLen=254
Case=M
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\NamingOptionsTemplates]

[ModelOptions\Default Opts]

[ModelOptions\Default Opts\TABL]
PhysOpts=

[ModelOptions\Default Opts\COLN]
PhysOpts=

[ModelOptions\Default Opts\INDX]
PhysOpts=

[ModelOptions\Default Opts\AKEY]
PhysOpts=

[ModelOptions\Default Opts\PKEY]
PhysOpts=

[ModelOptions\Default Opts\STOR]
PhysOpts=

[ModelOptions\Default Opts\TSPC]
PhysOpts=

[ModelOptions\Default Opts\SQNC]
PhysOpts=

[ModelOptions\Default Opts\DTBS]
PhysOpts=
</a:ModelOptionsText>
<c:DBMS>
<o:Shortcut Id="o3">
<a:ObjectID>6958A542-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Microsoft SQL Server 7.x</a:Name>
<a:Code>SQL SERVER 7</a:Code>
<a:CreationDate>1081538410</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538410</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:TargetID>986CB218-1936-4245-823C-883D7AF59B86</a:TargetID>
<a:TargetClassID>4BA9F647-DAB1-11D1-9944-006097355D9B</a:TargetClassID>
<a:TargetPackagePath/>
</o:Shortcut>
</c:DBMS>
<c:PhysicalDiagrams>
<o:PhysicalDiagram Id="o4">
<a:ObjectID>6958A53E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>PhysicalDiagram_1</a:Name>
<a:Code>PHYSICALDIAGRAM_1</a:Code>
<a:CreationDate>1081538408</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1082142011</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DisplayPreferences>
[DisplayPreferences]

[DisplayPreferences\PDM]

[DisplayPreferences\General]
Adjust to text=Yes
Snap Grid=No
Display Grid=No
Show Page Delimiter=Yes
Grid size=800
Graphic unit=0
Window color=255 255 255

[DisplayPreferences\Object]
Mode=0
Trunc Length=80
Word Length=80
Word Text=!&quot;&quot;#$%&amp;&#39;()*+,-./:;&lt;=&gt;?@[\]^_`{|}~
Shortcut IntIcon=Yes
Shortcut IntLoct=No
Shortcut ExtIcon=Yes
Shortcut ExtLoct=No
File Location=No
TablColn=No
ColnMode=0
ColnMax=5
TablIndx=No
TablKey=No
TablTrgr=Yes
TablOwnr=No
ColnDttp=Yes
ColnDomn=No
ColnShowDomn=Yes
ColnKey=Yes
ColnIndx=Yes
ColnMand=Yes
ViewTabl=Yes
ViewColn=Yes
ViewOwnr=No
VColName=Yes
VColExpr=No
VColDttp=No
VColCMod=1
VColCMax=5
RefrName=No
RefrJoin=Yes
RefrCnam=No
RefrIntg=No
RefrImpl=No
RefrCard=No
RefrMode=2
VRefName=No
VRefJoin=No
VRefMode=0

[DisplayPreferences\Symbol]

[DisplayPreferences\Symbol\PDMPCKG]
DISPNAMEFont=arial,8,N
DISPNAMEFont color=0, 0, 0
AutoAdjustToText=Yes
Width=4800
Height=3600
Brush color=255 255 255
Fill Color=Yes
Pen=1 0 0, 0, 255
Shadow color=192 192 192
Shadow=No

[DisplayPreferences\Symbol\TABL]
DISPNAMEFont=arial,8,N
DISPNAMEFont color=0, 0, 0
TableColumnsFont=arial,8,N
TableColumnsFont color=0, 0, 0
TablePkColumnsFont=arial,8,N
TablePkColumnsFont color=0, 0, 0
TableIndexsFont=arial,8,N
TableIndexsFont color=0, 0, 0
TableKeysFont=arial,8,N
TableKeysFont color=0, 0, 0
TableTriggersFont=arial,8,N
TableTriggersFont color=0, 0, 0
AutoAdjustToText=Yes
Width=4800
Height=3600
Brush color=255 255 255
Fill Color=Yes
Pen=1 0 0, 0, 255
Shadow color=192 192 192
Shadow=No

[DisplayPreferences\Symbol\REFR]
DISPNAMEFont=arial,8,N
DISPNAMEFont color=0, 0, 0
CARDFont=arial,8,N
CARDFont color=0, 0, 0
Line style=0
Brush color=255 255 255
Fill Color=Yes
Pen=1 0 0, 0, 255
Shadow color=192 192 192
Shadow=No

[DisplayPreferences\Symbol\VREF]
DISPNAMEFont=arial,8,N
DISPNAMEFont color=0, 0, 0
Line style=0
Brush color=255 255 255
Fill Color=Yes
Pen=1 0 0, 0, 255
Shadow color=192 192 192
Shadow=No

[DisplayPreferences\Symbol\VIEW]
DISPNAMEFont=arial,8,N
DISPNAMEFont color=0, 0, 0
ViewColumnnFont=arial,8,N
ViewColumnnFont color=0, 0, 0
ViewTablesFont=arial,8,N
ViewTablesFont color=0, 0, 0
AutoAdjustToText=Yes
Width=4800
Height=3600
Brush color=255 255 255
Fill Color=Yes
Pen=1 0 0, 0, 255
Shadow color=192 192 192
Shadow=No

[DisplayPreferences\Symbol\FILO]
NAMEFont=arial,8,N
NAMEFont color=0, 0, 0
AutoAdjustToText=Yes
Width=2400
Height=2400
Brush color=255 255 255
Fill Color=No
Pen=1 0 0, 0, 255
Shadow color=192 192 192
Shadow=No

[DisplayPreferences\Symbol\USRDEPD]
OBJXSTRFont=arial,8,N
OBJXSTRFont color=0, 0, 0
Line style=0
Brush color=255 255 255
Fill Color=Yes
Pen=2 0 0 0 0
Shadow color=192 192 192
Shadow=No

[DisplayPreferences\Symbol\Free Symbol]
Free TextFont=arial,8,N
Free TextFont color=0, 0, 0
Line style=0
Brush color=255 255 255
Fill Color=Yes
Pen=1 0 0, 0, 255
Shadow color=192 192 192
Shadow=No
</a:DisplayPreferences>
<a:PaperSize>(8268, 11689)</a:PaperSize>
<a:PageMargins>((315,354), (433,354))</a:PageMargins>
<a:PageSize>9</a:PageSize>
<a:PaperSource>7</a:PaperSource>
<c:Symbols>
<o:ReferenceSymbol Id="o5">
<a:CenterTextOffset>(4, 0)</a:CenterTextOffset>
<a:Rect>((-737831,673842), (-719949,684550))</a:Rect>
<a:ListOfPoints>((-719949,684550),(-737831,673842))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>12615680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Id="o6">
<a:Rect>((-721126,683903), (-714422,688449))</a:Rect>
<a:LineColor>12615680</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o7">
<a:ObjectID>6958A5A8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_CHG</a:Name>
<a:Code>T_CHG</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081691754</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o8">
<a:ObjectID>6958A5C8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_CHG</a:Name>
<a:Code>CD_CHG</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o9">
<a:ObjectID>6958A5C9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DT_CHG</a:Name>
<a:Code>DT_CHG</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_DAT    Script Date: 7/8/2000 12:14:35 ******/
Create Rule        RU_DAT As
DATEPART(hh,@data) = 0 AND
DATEPART(mi,@data) = 0 AND
DATEPART(ss,@data) = 0 AND
DATEPART(ms,@data) = 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>smalldatetime</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o10">
<a:ObjectID>6958A5CA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_AER</a:Name>
<a:Code>CD_AER</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o11">
<a:ObjectID>6958A5CB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_CHG_VOO</a:Name>
<a:Code>NR_CHG_VOO</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(10)</a:DataType>
<a:Length>10</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o12">
<a:ObjectID>6958A5CC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_CHG_HOT</a:Name>
<a:Code>NR_CHG_HOT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(9)</a:DataType>
<a:Length>9</a:Length>
</o:Column>
<o:Column Id="o13">
<a:ObjectID>6958A5CD-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_CHG_GRU</a:Name>
<a:Code>TP_CHG_GRU</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o14">
<a:ObjectID>6958A5CE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_CHG</a:Name>
<a:Code>TP_CHG</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o15">
<a:ObjectID>6958A5CF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_CHG_NAT</a:Name>
<a:Code>TP_CHG_NAT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o16">
<a:ObjectID>6958A5D0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_CHG_CTG</a:Name>
<a:Code>TP_CHG_CTG</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o17">
<a:ObjectID>6958A5D1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_COM</a:Name>
<a:Code>CD_COM</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o18">
<a:ObjectID>6958A5D2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_CHG_VIN</a:Name>
<a:Code>CD_CHG_VIN</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o19">
<a:ObjectID>6958A5D3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_CHG_ANU</a:Name>
<a:Code>FL_CHG_ANU</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o20">
<a:ObjectID>6958A5D4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_CHG_TEL</a:Name>
<a:Code>FL_CHG_TEL</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o21">
<a:ObjectID>6958A5D5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_EQP_CHG</a:Name>
<a:Code>CD_EQP_CHG</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o22">
<a:ObjectID>6958A5D6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_AEN_CHG</a:Name>
<a:Code>CD_AEN_CHG</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o23">
<a:ObjectID>6958A5D7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_BOX</a:Name>
<a:Code>CD_BOX</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o24">
<a:ObjectID>6958A5D8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_CHG_PER_MIN</a:Name>
<a:Code>QT_CHG_PER_MIN</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o25">
<a:ObjectID>6958A5D9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DH_CHG_NRM</a:Name>
<a:Code>DH_CHG_NRM</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>smalldatetime</a:DataType>
</o:Column>
<o:Column Id="o26">
<a:ObjectID>6958A5DA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DH_CHG_EFE</a:Name>
<a:Code>DH_CHG_EFE</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>smalldatetime</a:DataType>
</o:Column>
<o:Column Id="o27">
<a:ObjectID>6958A5DB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DH_CHG_EST</a:Name>
<a:Code>DH_CHG_EST</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>smalldatetime</a:DataType>
</o:Column>
<o:Column Id="o28">
<a:ObjectID>6958A5DC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_SIT</a:Name>
<a:Code>CD_SIT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o29">
<a:ObjectID>6958A5DD-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_CHG_COM_SIT</a:Name>
<a:Code>NM_CHG_COM_SIT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>varchar(30)</a:DataType>
<a:Length>30</a:Length>
</o:Column>
<o:Column Id="o30">
<a:ObjectID>6958A5DE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DH_CHG_SIT</a:Name>
<a:Code>DH_CHG_SIT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>smalldatetime</a:DataType>
</o:Column>
<o:Column Id="o31">
<a:ObjectID>6958A5DF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_CHG_CAN</a:Name>
<a:Code>FL_CHG_CAN</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_ZRO    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_ZRO As
0</a:DefaultValue>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o32">
<a:ObjectID>6958A5E0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_CHG_STA</a:Name>
<a:Code>TP_CHG_STA</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
</o:Column>
<o:Column Id="o33">
<a:ObjectID>6958A5E1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_IFT</a:Name>
<a:Code>CD_IFT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o34">
<a:ObjectID>6958A5E2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_USR</a:Name>
<a:Code>CD_USR</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o35">
<a:ObjectID>6958A611-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_AEN</a:Name>
<a:Code>CD_AEN</a:Code>
<a:CreationDate>1081691654</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081691654</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o36">
<a:ObjectID>6958A4D6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_EQP</a:Name>
<a:Code>CD_EQP</a:Code>
<a:CreationDate>1081691754</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081691754</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o37">
<a:ObjectID>6958A5E3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_CHG_PAR_ORI</a:Name>
<a:Code>FL_CHG_PAR_ORI</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_ZRO    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_ZRO As
0</a:DefaultValue>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o38">
<a:ObjectID>6958A5E4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o39">
<a:ObjectID>6958A600-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_CHG</a:Name>
<a:Code>Pk_T_CHG</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_CHG</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o8"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o40">
<a:ObjectID>6958A5E8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_CHG_EFE</a:Name>
<a:Code>I_CHG_EFE</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o41">
<a:ObjectID>6958A5E9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o32"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o42">
<a:ObjectID>6958A5EA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_1&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o26"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o43">
<a:ObjectID>6958A5EB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_2&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o8"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o44">
<a:ObjectID>6958A5EC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_CHG_GRU</a:Name>
<a:Code>I_CHG_GRU</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o45">
<a:ObjectID>6958A5ED-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o32"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o46">
<a:ObjectID>6958A5EF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_1&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o13"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o47">
<a:ObjectID>6958A5F0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_2&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o8"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o48">
<a:ObjectID>6958A5F1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_CHG_STA</a:Name>
<a:Code>I_CHG_STA</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o49">
<a:ObjectID>6958A5F2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o32"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o50">
<a:ObjectID>6958A5F3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_1&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o8"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o51">
<a:ObjectID>6958A5F4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_CHG_STA_DAT</a:Name>
<a:Code>I_CHG_STA_DAT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o52">
<a:ObjectID>6958A5F5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o32"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o53">
<a:ObjectID>6958A5F7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_1&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o9"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o54">
<a:ObjectID>6958A5F8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_2&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o8"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o55">
<a:ObjectID>6958A5F9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_CHG_TP</a:Name>
<a:Code>I_CHG_TP</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o56">
<a:ObjectID>6958A5FB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o14"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o57">
<a:ObjectID>6958A5FD-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_CHG_VIN</a:Name>
<a:Code>I_CHG_VIN</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o58">
<a:ObjectID>6958A5FF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o18"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Id="o59">
<a:ObjectID>6958A54A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>dbo</a:Name>
<a:Code>dbo</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
</o:User>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o60">
<a:ObjectID>6958A514-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_CHG_TRD</a:Name>
<a:Code>T_CHG_TRD</a:Code>
<a:Text>Create Trigger T_CHG_TRD On T_CHG
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Chegadas»Chegadas: Chegada Vinculada (Restrict) */
If (Select Count(*) From T_CHG dep, Deleted pri
 Where dep.CD_CHG_VIN = pri.CD_CHG) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Chegadas&gt; está sendo referenciada na tabela &lt;Chegadas&gt;&#39;
  Return
End
/* Chegadas»Chamadas de Anuncio: Chamada da Chegada (Cascade) */
Delete T_CHA From T_CHA dep, Deleted pri
 Where dep.CD_CHG = pri.CD_CHG
/* Chegadas»Mensagem de Chegada: Chegada da Mensagem (Cascade) */
Delete T_MCH From T_MCH dep, Deleted pri
 Where dep.CD_CHG = pri.CD_CHG
/* Chegadas»Histórico de Situação de Vôo de Chegada: Chegada do HSC (Cascade) */
Delete T_HSC From T_HSC dep, Deleted pri
 Where dep.CD_CHG = pri.CD_CHG
/* Chegadas»Log da Programação de Anúncios: Chegadas do Log de Programação (Cascade) */
Delete T_PRALOG From T_PRALOG dep, Deleted pri
 Where dep.CD_CHG = pri.CD_CHG
/* Chegadas»Dados Estatísticos de Chegada: Dados Estatísticos da Chegada (Cascade) */
Delete T_DEC From T_DEC dep, Deleted pri
 Where dep.CD_CHG = pri.CD_CHG
/* Chegadas»Escala da Chegada de Vôo: Escalas de Chegada (Cascade) */
Delete T_ECC001 From T_ECC001 dep, Deleted pri
 Where dep.CD_CHG = pri.CD_CHG
/* Chegadas»Esteira da Chegada de Vôo: Esteiras de Chegada (Cascade) */
Delete T_ESV001 From T_ESV001 dep, Deleted pri
 Where dep.CD_CHG = pri.CD_CHG
/* Chegadas»Histórico de Permanência de Aeronaves: Histórico de Permanência dos Vôos de Chegada (Cascade) */
Delete T_HPA001 From T_HPA001 dep, Deleted pri
 Where dep.CD_CHG = pri.CD_CHG
/* Chegadas»Chegadas Candidatas a Vôo Antecessor: Vôo de Chegada candidato a antecessor (Cascade) */
Delete T_CHGANT From T_CHGANT dep, Deleted pri
 Where dep.CD_CHG = pri.CD_CHG
/* Chegadas»Partidas: Chegada Antecessora (Set Null) */
Update T_PAR Set CD_CHG_ANT = Null
 From T_PAR dep, Deleted pri
 Where dep.CD_CHG_ANT = pri.CD_CHG
/* Chegadas»Partidas: Chegada da Aeronave Sucessora (Set Null) */
Update T_PAR Set CD_CHG_AEN_ANT = Null
 From T_PAR dep, Deleted pri
 Where dep.CD_CHG_AEN_ANT = pri.CD_CHG
/* Regra de negócio */
/* INCLUIR REGISTROS EM T_ACH */
INSERT	T_ACH (DH_ACH, CD_CHG)
SELECT GETDATE(), CD_CHG FROM DELETED

End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o61">
<a:ObjectID>6958A515-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_CHG_TRI</a:Name>
<a:Code>T_CHG_TRI</a:Code>
<a:Text>Create Trigger T_CHG_TRI On T_CHG
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Aeroporto»Chegadas: Aeroporto da Chegada */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
/* Aeronave»Chegadas: Aeronave da Chegada */
If (Select Count(*) From T_AEN, Inserted
Where T_AEN.CD_AEN = Inserted.CD_AEN_CHG)
 &lt;&gt;(Select Count(CD_AEN_CHG) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeronave&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
/* Companhia Aérea»Chegadas: Comapanhia Aérea da Chegada */
If (Select Count(*) From T_COM, Inserted
Where T_COM.CD_COM = Inserted.CD_COM)
 &lt;&gt;(Select Count(CD_COM) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Companhia Aérea&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
/* Equipamento»Chegadas: Equipamento da Chegada */
If (Select Count(*) From T_EQP, Inserted
Where T_EQP.CD_EQP = Inserted.CD_EQP_CHG)
 &lt;&gt;(Select Count(CD_EQP_CHG) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Equipamento&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
/* Box»Chegadas: Box da Chegada */
If (Select Count(*) From T_BOX, Inserted
Where T_BOX.CD_BOX = Inserted.CD_BOX)
 &lt;&gt;(Select Count(CD_BOX) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Box&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
/* Situação»Chegadas: Situação da Chegada */
If (Select Count(*) From T_SIT, Inserted
Where T_SIT.CD_SIT = Inserted.CD_SIT)
 &lt;&gt;(Select Count(CD_SIT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Situação&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
/* Informante da Situação de Vôo»Chegadas: Informante da Situação de Chegada */
If (Select Count(*) From T_IFT, Inserted
Where T_IFT.CD_IFT = Inserted.CD_IFT)
 &lt;&gt;(Select Count(CD_IFT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Informante da Situação de Vôo&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
/* Chegadas»Chegadas: Chegada Vinculada */
If (Select Count(*) From T_CHG, Inserted
Where T_CHG.CD_CHG = Inserted.CD_CHG_VIN)
 &lt;&gt;(Select Count(CD_CHG_VIN) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Chegadas&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
/* Usuários»Chegadas: Usuário logado */
If (Select Count(*) From T_USR, Inserted
Where T_USR.CD_USR = Inserted.CD_USR)
 &lt;&gt;(Select Count(CD_USR) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Usuários&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
/* Domínio de: Grupo do Vôo */
/* 1 - Grupo 1 */
/* 2 - Grupo 2 */
If (Select Count(*) From Inserted
    Where TP_CHG_GRU In (1,2))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Grupo do Vôo&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não é uma opção válida&#39;
  Return
End
/* Domínio de: Tipo do Vôo de Chegada */
/* 1 - DOM-Doméstico */
/* 2 - INT-Internacional */
/* 3 - REG-Regional */
If (Select Count(*) From Inserted
    Where TP_CHG In (1,2,3))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Tipo do Vôo de Chegada&gt; quese deseja incluir na tabela &lt;Chegadas&gt; não é uma opção válida&#39;
  Return
End
/* Domínio de: Natureza do Vôo de Chegada */
/* 1 - PAX-Passageiro */
/* 2 - CRG-Carga */
/* 3 - MIS-Misto */
/* 4 - TSL-Translado */
If (Select Count(*) From Inserted
    Where TP_CHG_NAT In (1,2,3,4))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Natureza do Vôo de Chegada&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não é uma opção válida&#39;
  Return
End
/* Domínio de: Categoria do Vôo de Chegada */
/* 1 - RGL-Regular */
/* 2 - CHT-Charter */
/* 3 - CSH-Codeshare */
/* 4 - DPL-Duplicate Leg */
/* 5 - TEC-Pouso Técnico */
/* 6 - TSL-Translado */
/* 7 - AVG-Aviação Geral */
/* 8 - MLT-Militar */
/* 9 - NRG-Não Regular */
/* 10 - TXA-Táxi Aéreo */
If (Select Count(*) From Inserted
    Where TP_CHG_CTG In (1,2,3,4,5,6,7,8,9,10))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Categoria do Vôo de Chegada&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não é uma opção válida&#39;
  Return
End
/* Domínio de: Status de Chegada do Vôo */
/* 1 - Em Aberto */
/* 2 - Concluído */
If (Select Count(*) From Inserted
    Where TP_CHG_STA In (1,2))
 &lt;&gt;(Select Count(*) From Inserted
    Where TP_CHG_STA Is Not Null)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Status de Chegada do Vôo&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não é uma opção válida&#39;
  Return
End
/* Regra de negócio */
/* RESTRIÇÕES */
/*********************************** RETIRADO PELO RONALDO EM 11/3/98 ***********************************************************
/* A data do vôo sendo incluído não pode ser maior do que a data posterior à da última geração nem anterior a data de hoje */
IF (	SELECT 	COUNT(*) 
	FROM 	INSERTED INS
	WHERE	(DATEDIFF(MI, Dateadd(HH, -Datepart(HH, GETDATE()), Dateadd(mi, -datepart(mi, GETDATE()), GETDATE())), INS.DT_CHG) &lt; 0 OR   /* (DATEDIFF(MI, CONVERT(DATETIME, (CONVERT(VARCHAR, DATEPART(MM, GETDATE())) + &#39;/&#39; + CONVERT(VARCHAR, DATEPART(DD, GETDATE()))  + &#39;/&#39; + CONVERT(VARCHAR, DATEPART(YY, GETDATE())) +  &#39; 00:00&#39;)), INS.DT_CHG) &lt; 0 OR */
		DATEADD(DD, -1, INS.DT_CHG) &gt; (SELECT MAX(DT_CHG) FROM T_CHG WHERE CD_CHG &lt;&gt; INS.CD_CHG) ) AND INS.NR_CHG_HOT IS NOT NULL) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: Não é permitida a geração de vôos de datas anteriores à data de hoje ou posteriores à data da última geração mais um dia.&#39;
	ROLLBACK TRANSACTION
	RETURN
END
**********************************************************************************************************************************************/

/* Um vôo não pode ser incluído CANCELADO */
IF (	SELECT 	COUNT(*)
	FROM	INSERTED INS, 
		T_SIT SIT
	WHERE	SIT.CD_SIT = INS.CD_SIT AND
		FL_SIT_CAN_VOO &lt;&gt; 0) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: Não é permitida a inclusão de vôos com situação de chegada cancelada&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Incluir HPA dos registros de Chegada a incluir */
/* Declaração do cursor */
DECLARE INSCHG CURSOR FOR
	SELECT 	CHG.CD_AER,
		CHG.CD_EQP_CHG,
		CHG.CD_AEN_CHG,
		CHG.CD_BOX,
		CHG.CD_CHG,
		CHG.DH_CHG_NRM
	FROM	T_CHG CHG,
		INSERTED INS
	WHERE	CHG.CD_CHG = INS.CD_CHG AND
		CHG.TP_CHG_CTG NOT IN (3, 4)
	ORDER BY CHG.CD_CHG

/* Declaração das variáveis que receberão o cursor */
DECLARE @CD_AER	INT,
	 @CD_EQP_CHG 	INT,
	 @CD_AEN_CHG	INT,
	 @CD_BOX	INT,
	 @CD_CHG	INT,
	 @DH_CHG_NRM	SMALLDATETIME

/* Abertura do cursor */
OPEN INSCHG

/* Ir para o primeiro registro */
FETCH	INSCHG
INTO	@CD_AER,
	 @CD_EQP_CHG,
	 @CD_AEN_CHG,
	 @CD_BOX,
	 @CD_CHG,
	 @DH_CHG_NRM

/* Processar todos os registros de INSCHG*/
WHILE @@FETCH_STATUS = 0
BEGIN

	/* Lançar Histórico de Permanência de Aeronaves */
	INSERT T_HPA001 (
		CD_HPA,
		NR_HPA_SEQ,
		CD_AER,
		CD_EQP,
		CD_AEN,
		CD_BOX,
		CD_CHG,
		DH_HPA_ENT)
	SELECT	ISNULL(MAX(CD_HPA), 0) +1,
		1, 
		@CD_AER,
		@CD_EQP_CHG,
		@CD_AEN_CHG,
		@CD_BOX,
		@CD_CHG,
		@DH_CHG_NRM
	FROM	T_HPA001 HPA

	/* Ir para o próximo registro */
	FETCH NEXT FROM INSCHG
	INTO	@CD_AER,
		@CD_EQP_CHG,
		@CD_AEN_CHG,
		@CD_BOX,
		@CD_CHG,
		@DH_CHG_NRM

END
CLOSE INSCHG
DEALLOCATE INSCHG


/* Milena 14/01/98 - Inserir vôo que está sendo incluído na tabela de Vôos candidatos a vôo Antecessor se 
o vôo não for Codeshare ou Duplicate Leg */
INSERT T_CHGANT (
	CD_CHG)
SELECT	CD_CHG
FROM	INSERTED INS
WHERE	INS.TP_CHG_CTG NOT IN (3,4)

/* PROVOCAR A EXECUÇÃO DA TRIGGER DE UPDATE PARA A COMPLEMENTAÇÃO DAS VERIFICAÇÕES
    E PROCESSAR OUTRAS ATUALIZAÇÕES */
UPDATE	T_CHG
SET	CD_SIT = CHG.CD_SIT,
	DH_CHG_SIT = CHG.DH_CHG_NRM
FROM	T_CHG CHG,
	INSERTED INS

WHERE	CHG.CD_CHG = INS.CD_CHG
End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o62">
<a:ObjectID>6958A516-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_CHG_TRU</a:Name>
<a:Code>T_CHG_TRU</a:Code>
<a:Text>CREATE Trigger T_CHG_TRU On T_CHG
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_CHG)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Vôo de Chegada&gt; da tabela &lt;Chegadas&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_AER)
/* Aeroporto Chegadas: Aeroporto da Chegada */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
If Update (CD_AEN_CHG)
/* Aeronave»Chegadas: Aeronave da Chegada */
If (Select Count(*) From T_AEN, Inserted
Where T_AEN.CD_AEN = Inserted.CD_AEN_CHG)
 &lt;&gt;(Select Count(CD_AEN_CHG) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeronave&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
If Update (CD_COM)
/* Companhia Aérea»Chegadas: Comapanhia Aérea da Chegada */
If (Select Count(*) From T_COM, Inserted
Where T_COM.CD_COM = Inserted.CD_COM)
 &lt;&gt;(Select Count(CD_COM) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Companhia Aérea&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
If Update (CD_EQP_CHG)
/* Equipamento»Chegadas: Equipamento da Chegada */
If (Select Count(*) From T_EQP, Inserted
Where T_EQP.CD_EQP = Inserted.CD_EQP_CHG)
 &lt;&gt;(Select Count(CD_EQP_CHG) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Equipamento&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
If Update (CD_BOX)
/* Box»Chegadas: Box da Chegada */
If (Select Count(*) From T_BOX, Inserted
Where T_BOX.CD_BOX = Inserted.CD_BOX)
 &lt;&gt;(Select Count(CD_BOX) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Box&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
If Update (CD_SIT)
/* Situação»Chegadas: Situação da Chegada */
If (Select Count(*) From T_SIT, Inserted
Where T_SIT.CD_SIT = Inserted.CD_SIT)
 &lt;&gt;(Select Count(CD_SIT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Situação&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
If Update (CD_IFT)
/* Informante da Situação de Vôo»Chegadas: Informante da Situação de Chegada */
If (Select Count(*) From T_IFT, Inserted
Where T_IFT.CD_IFT = Inserted.CD_IFT)
 &lt;&gt;(Select Count(CD_IFT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Informante da Situação de Vôo&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
If Update (CD_CHG_VIN)
/* Chegadas»Chegadas: Chegada Vinculada */
If (Select Count(*) From T_CHG, Inserted
Where T_CHG.CD_CHG = Inserted.CD_CHG_VIN)
 &lt;&gt;(Select Count(CD_CHG_VIN) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Chegadas&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
If Update (CD_USR)
/* Usuários»Chegadas: Usuário logado */
If (Select Count(*) From T_USR, Inserted
Where T_USR.CD_USR = Inserted.CD_USR)
 &lt;&gt;(Select Count(CD_USR) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Usuários&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não está cadastrada&#39;
  Return
End
If Update (TP_CHG_GRU)
Or Update (TP_CHG)
Or Update (TP_CHG_NAT)
Or Update (TP_CHG_CTG)
Or Update (TP_CHG_STA)
/* Domínio de: Grupo do Vôo */
/* 1 - Grupo 1 */
/* 2 - Grupo 2 */
If (Select Count(*) From Inserted
    Where TP_CHG_GRU In (1,2))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBackTransaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Grupo do Vôo&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não é uma opção válida&#39;
  Return
End
/* Domínio de: Tipo do Vôo de Chegada */
/* 1 - DOM-Doméstico */
/* 2 - INT-Internacional */
/* 3 - REG-Regional */
If (Select Count(*) From Inserted
    Where TP_CHG In (1,2,3))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Tipo do Vôo de Chegada&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não é uma opção válida&#39;
  Return
End
/* Domínio de: Natureza do Vôo de Chegada */
/* 1 - PAX-Passageiro */
/* 2 - CRG-Carga */
/* 3 - MIS-Misto */
/* 4 - TSL-Translado */
If (Select Count(*) From Inserted
    Where TP_CHG_NAT In (1,2,3,4))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Natureza do Vôo de Chegada&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não é uma opção válida&#39;
  Return
End
/* Domínio de: Categoria do Vôo de Chegada */
/* 1 - RGL-Regular */
/* 2 - CHT-Charter */
/* 3 - CSH-Codeshare */
/* 4 - DPL-Duplicate Leg */
/* 5 - TEC-Pouso Técnico */
/* 6 - TSL-Translado */
/* 7 - AVG-Aviação Geral */
/* 8 - MLT-Militar */
/* 9 - NRG-Não Regular */
/* 10 - TXA-Táxi Aéreo */
If (Select Count(*) From Inserted
    Where TP_CHG_CTG In (1,2,3,4,5,6,7,8,9,10))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Categoria do Vôo de Chegada&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não é uma opção válida&#39;
  Return
End
/* Domínio de: Status de Chegada do Vôo */
/* 1 - Em Aberto */
/* 2 - Concluído */
If (Select Count(*) From Inserted
    Where TP_CHG_STA In (1,2))
 &lt;&gt;(Select Count(*) From Inserted
    Where TP_CHG_STA Is Not Null)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Status de Chegada do Vôo&gt; que se deseja incluir na tabela &lt;Chegadas&gt; não é uma opção válida&#39;
  Return
End
/* Regra de negócio */
--CSH OU DPL
IF UPDATE(TP_CHG_CTG) OR UPDATE(CD_CHG_VIN)
	--Um vôo do tipo normal ou charter não pode ter vôo vinculado e um vôo do tipo CSH ou DPL tem de ter vôo vinculado
	IF (	SELECT 	COUNT(*) FROM INSERTED
		WHERE	(TP_CHG_CTG NOT IN (3,4) AND CD_CHG_VIN IS NOT NULL) OR (TP_CHG_CTG IN (3,4) AND CD_CHG_VIN IS NULL)) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: Um vôo do tipo Normal ou Charter não pode ter vôo vinculado, e um vôo do tipo Codeshare ou Duplicate Leg tem de ter vôo vinculado.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
IF UPDATE(TP_CHG_CTG)
	--Um vôo do tipo CSH ou DPL não pode ter vôo de PAR associado
	IF (	SELECT 	COUNT(*) FROM	INSERTED INS
		WHERE	TP_CHG_CTG IN (3,4) AND 
			EXISTS (SELECT * FROM T_PAR PAR WHERE PAR.CD_CHG_AEN_ANT = INS.CD_CHG)) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: Um vôo do tipo Codeshare ou Duplicate Leg não pode ter vôo de partida associado.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
--Não permitir que um vôo de CHG que tenha sido alterado para concluído, sem estar Cancelado e sem ser CSH ou DPL, possua o campo de aeronave nulo
IF (	SELECT 	COUNT(*) FROM 	INSERTED INS, T_SIT SIT
	WHERE	SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CON_VOO = 1 AND INS.FL_CHG_CAN = 0 AND INS.TP_CHG_CTG NOT IN (3, 4) AND INS.CD_AEN_CHG IS NULL) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: &lt;Hora de Entrada de Estacionamento&gt; ou &lt;Aeronave&gt; não informados.&#39;
	ROLLBACK TRANSACTION
	RETURN
END
IF UPDATE(CD_SIT)
BEGIN
	--Verificar se a situação informada é uma situação de CHG
	IF (SELECT COUNT(*) FROM	INSERTED INS, T_SIT SIT WHERE SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CHG &lt;&gt; 1) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: A situação informada não é uma situação de chegada.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
END
--Atualizar o complemento de chegada
IF UPDATE(CD_SIT) OR UPDATE(DH_CHG_EFE)
BEGIN
	--Hora
	UPDATE	T_CHG SET NM_CHG_COM_SIT = CONVERT(CHAR(5), CHG.DH_CHG_EFE, 8)
	FROM	T_CHG CHG, INSERTED INS, T_SIT SIT
	WHERE	CHG.CD_CHG = INS.CD_CHG AND SIT.CD_SIT = CHG.CD_SIT AND SIT.TP_SIT_COM = 1
	--Nenhum
	UPDATE	T_CHG SET NM_CHG_COM_SIT = NULL
	FROM	T_CHG CHG, INSERTED INS, T_SIT SIT
	WHERE	CHG.CD_CHG = INS.CD_CHG AND SIT.CD_SIT = CHG.CD_SIT AND SIT.TP_SIT_COM = 3
	--Caso a Data e Hora da Situação não já tenha sido alerada
	IF NOT UPDATE(DH_CHG_SIT)
	BEGIN
		--Atualizar hora da alteração da situação do vôo de CHG
		UPDATE	T_CHG SET DH_CHG_SIT = GETDATE()
		FROM	T_CHG CHG, INSERTED INS
		WHERE	CHG.CD_CHG = INS.CD_CHG
	END
END
IF UPDATE(CD_SIT)
BEGIN
	--Um vôo de PAR não pode ser cancelado se existir algum registro em T_DEC para este vôo ou para um dos seus vôos vinculados
	IF (	SELECT	COUNT(*) FROM INSERTED INS, T_SIT SIT
		WHERE	SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CAN_VOO = 1 AND
			(EXISTS (SELECT CD_CHG FROM T_DEC WHERE CD_CHG = INS.CD_CHG) OR
			EXISTS (SELECT DEC.CD_CHG FROM T_DEC DEC, T_CHG CHG WHERE CHG.CD_CHG_VIN = INS.CD_CHG AND DEC.CD_CHG = CHG.CD_CHG))) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: O vôo de Chegada não pode ser cancelado pois existe registro de &lt;Dados Estatísticos de Chegada&gt; para este vôo ou para algum de seus vôos vinculados.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
	--A alteração da situação de vôo de CHG de Etapa Concluída para outra qualquer não pode ser efetuada se o HPA do vôo estiver associado a mais de um Status
	IF (	SELECT 	COUNT(*)
		FROM 	T_STA STA, T_HPA001 HPA, INSERTED INS, DELETED DEL, T_SIT SITDEL, T_SIT SITINS
		WHERE 	STA.CD_STA = HPA.CD_STA AND HPA.CD_CHG = INS.CD_CHG AND
			DEL.CD_CHG = INS.CD_CHG AND SITDEL.CD_SIT = DEL.CD_SIT AND
			SITDEL.FL_SIT_CON_VOO = 1 AND SITINS.CD_SIT = INS.CD_SIT AND
			SITINS.FL_SIT_CON_VOO = 0) &gt; 1
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: A situação do vôo não pode ser alterada de Etapa Concluída para outra qualquer se este vôo estiver associado a mais de um Status de Aeronave.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
	--Atualizar Flag de CHG Cancelada em vôo
	UPDATE 	T_CHG SET FL_CHG_CAN = SIT.FL_SIT_CAN_VOO
	FROM 	T_CHG CHG, INSERTED INS, T_SIT SIT
	WHERE 	CHG.CD_CHG = INS.CD_CHG AND SIT.CD_SIT = INS.CD_SIT AND (SIT.FL_SIT_CAN_VOO = 1 OR SIT.FL_SIT_CON_VOO = 0)
	--Setar CD_CHG_ANT do vôo sucessor para nulo caso a CHG seja cancelada
	IF (	SELECT 	COUNT(*) FROM T_PAR PAR, INSERTED INS, T_SIT SIT
		WHERE 	PAR.CD_CHG_ANT = INS.CD_CHG AND SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CAN_VOO = 1) &gt; 0
	BEGIN
		UPDATE 	T_PAR SET CD_CHG_ANT = NULL
		FROM 	T_PAR PAR, INSERTED INS, T_SIT SIT
		WHERE 	PAR.CD_CHG_ANT = INS.CD_CHG AND SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CAN_VOO = 1
	END
	--Setar CD_CHG_AEN_ANT do vôo da aeronave sucessora para nulo caso a CHG seja cancelada
	IF (	SELECT 	COUNT(*) FROM T_PAR PAR, INSERTED INS, T_SIT SIT
		WHERE 	PAR.CD_CHG_AEN_ANT = INS.CD_CHG AND SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CAN_VOO = 1) &gt;0
	BEGIN
		UPDATE 	T_PAR SET CD_CHG_AEN_ANT = NULL
		FROM 	T_PAR PAR, INSERTED INS, T_SIT SIT
		WHERE 	PAR.CD_CHG_AEN_ANT = INS.CD_CHG AND SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CAN_VOO = 1
	END
	--Atualizar o Código da Aeronave para Null caso a CHG tenha sido cancelado
	IF (	SELECT COUNT(*) 	FROM T_CHG CHG, INSERTED INS, T_SIT SIT
		WHERE  	CHG.CD_CHG = INS.CD_CHG AND SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CAN_VOO = 1) &gt; 0
	BEGIN
		UPDATE 	T_CHG SET CD_AEN_CHG = NULL
		FROM 	T_CHG CHG, INSERTED INS, T_SIT SIT
		WHERE  	CHG.CD_CHG = INS.CD_CHG AND SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CAN_VOO = 1
	END
	--Apagar os HPA&#39;s de CHG caso a CHG tenha sido cancelada
	IF (	SELECT	COUNT(*) FROM T_HPA001 HPA, T_SIT SIT, INSERTED INS
		WHERE  	HPA.CD_CHG = INS.CD_CHG AND SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CAN_VOO = 1) &gt; 0
	BEGIN
		DELETE 	T_HPA001
		FROM 	T_HPA001 HPA, T_SIT SIT, INSERTED INS
		WHERE  	HPA.CD_CHG = INS.CD_CHG AND SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CAN_VOO = 1
	END
	--Excluir vôo da tabela de vôos candidatos a vôos Antecessores se a CHG tiver sido cancelada
	IF (	SELECT 	COUNT(*) FROM T_CHGANT CHGANT, T_SIT SIT, INSERTED INS
		WHERE	CHGANT.CD_CHG = INS.CD_CHG AND SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CAN_VOO = 1) &gt; 0
	BEGIN
		DELETE	T_CHGANT
		FROM	T_CHGANT CHGANT, T_SIT SIT, INSERTED INS
		WHERE	CHGANT.CD_CHG = INS.CD_CHG AND SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CAN_VOO = 1
	END
	--Incluir vôo na tabela de vôos candidatos a vôos Antecessores se a CHG estiver cancelada e for alterada para uma situação diferente de Etapa Concluída  e Cancelado
	IF (	SELECT 	COUNT(*) FROM T_CHG CHG, T_SIT SIT, INSERTED INS, DELETED DEL
		WHERE	CHG.CD_CHG = INS.CD_CHG AND INS.CD_CHG = DEL.CD_CHG AND
			DEL.FL_CHG_CAN = 1 AND SIT.CD_SIT = INS.CD_SIT AND
			SIT.FL_SIT_CON_VOO = 0 AND SIT.FL_SIT_CAN_VOO = 0) &gt; 0
	BEGIN
		INSERT	T_CHGANT (CD_CHG)
		SELECT	CHG.CD_CHG FROM T_CHG CHG, T_SIT SIT, INSERTED INS, DELETED DEL
		WHERE	CHG.CD_CHG = INS.CD_CHG AND INS.CD_CHG = DEL.CD_CHG AND
			DEL.FL_CHG_CAN = 1 AND SIT.CD_SIT = INS.CD_SIT AND
			SIT.FL_SIT_CON_VOO = 0 AND SIT.FL_SIT_CAN_VOO = 0
	END
	--Deletar da tabela T_REP todos os registros que tiverem os campos companhia e número do vôo iguais aos do registro atualizado e o aeroporto destino igual ao aeroporto usuário, caso a situação	do vôo tenha sido alterada para &quot;Etapa Concluída&quot;
	DELETE	T_REP001 FROM INSERTED INS, T_REP001 REP, T_COM COM, T_SIT SIT
	WHERE	SIT.CD_SIT = INS.CD_SIT AND
		SIT.FL_SIT_CON_VOO = 1 AND	--Etapa Concluída
		COM.CD_COM = INS.CD_COM AND
		RTRIM(REP.SG_COM_IAT_003) = RTRIM(COM.SG_COM_IAT_003) AND
		RTRIM(REP.NR_VOO) = RTRIM(INS.NR_CHG_VOO) AND
		REP.SG_AER_ICA_DES = (SELECT SG_AER_ICA FROM T_AER WHERE CD_AER = (SELECT CD_AER FROM T_PSI))
	--Setar flag de vôo não concluído ou concluído
	UPDATE 	T_CHG SET TP_CHG_STA = SIT.FL_SIT_CON_VOO + 1   --2=Concluída
	FROM 	T_CHG CHG, T_SIT SIT, INSERTED INS
	WHERE 	CHG.CD_CHG = INS.CD_CHG AND SIT.CD_SIT = INS.CD_SIT
	--Atualizar Flag de entrada concluída em T_HPA
	UPDATE 	T_HPA001 SET FL_HPA_ENT = SIT.FL_SIT_CON_VOO 
	FROM 	T_HPA001 HPA, T_SIT SIT, INSERTED INS
	WHERE  	HPA.CD_CHG = INS.CD_CHG AND SIT.CD_SIT = INS.CD_SIT 
	--INCLUSÃO DE STATUS DA AERONAVE
	DECLARE INSSTA CURSOR FOR
		SELECT 	INS.CD_CHG, INS.CD_SIT, INS.DH_CHG_EFE, AEN.FL_AEN_ISE, 
			COM.FL_COM_TAR_RED, PSI.QT_PSI_ISE, PSI.QT_PSI_TAR_RED
		FROM	INSERTED INS,  T_AEN AEN, T_COM COM, T_PSI PSI
		WHERE	TP_CHG_CTG NOT IN (3, 4) 	AND AEN.CD_AEN = INS.CD_AEN_CHG AND COM.CD_COM = INS.CD_COM
		ORDER BY CD_CHG
	--Declaração das variáveis
	DECLARE	@CD_CHG INT, @CD_SIT INT, @DH_CHG_EFE SMALLDATETIME, @CD_STA INT,
			@FL_AEN_ISE TINYINT, @FL_COM_TAR_RED TINYINT, 	@QT_PSI_ISE INT, @QT_PSI_TAR_RED INT
	--Abre o curso e posiciona no primeiro registro
	OPEN INSSTA
	FETCH	INSSTA INTO @CD_CHG, @CD_SIT, @DH_CHG_EFE, @FL_AEN_ISE, @FL_COM_TAR_RED, @QT_PSI_ISE, @QT_PSI_TAR_RED
	--Processar todos os registros de INSSTA
	WHILE @@FETCH_STATUS = 0
	BEGIN
		SELECT @CD_STA = (SELECT ISNULL(MAX(CD_STA), 0) +1 FROM T_STA)
		--Inserir o Status caso a situação seja Etapa Concluída e o vôo não esteja Cancelado
		INSERT 	INTO T_STA (
			CD_STA, DH_STA_ABE, MA_STA_ABE, NR_STA,
			DH_STA_FEC, MA_STA_FEC, CD_STA_ANT,
			TP_STA, 	FL_STA_AEN_ISE, FL_STA_COM_TAR_RED, 
			QT_STA_PSI_ISE, 	QT_STA_PSI_TAR_RED)
		SELECT	@CD_STA,
			@DH_CHG_EFE, 
			DATEADD(DD, 1- DATEPART(DD, Dateadd(HH, -Datepart(HH, @DH_CHG_EFE), Dateadd(mi, -datepart(mi, @DH_CHG_EFE), @DH_CHG_EFE))), Dateadd(HH, -Datepart(HH, @DH_CHG_EFE), Dateadd(mi, -datepart(mi, @DH_CHG_EFE), @DH_CHG_EFE))), --Primeiro dia do mês da Data da CHG
			(SELECT ISNULL(MAX(NR_STA), 0) + 1 FROM T_STA STA WHERE STA.MA_STA_ABE = DATEADD(DD, 1- DATEPART(DD, Dateadd(HH, -Datepart(HH, @DH_CHG_EFE), Dateadd(mi, -datepart(mi, @DH_CHG_EFE), @DH_CHG_EFE))), Dateadd(HH, -Datepart(HH, @DH_CHG_EFE), Dateadd(mi, -datepart(mi, @DH_CHG_EFE), @DH_CHG_EFE)))),
			NULL, NULL, NULL, 1, --Em Aberto
			@FL_AEN_ISE, @FL_COM_TAR_RED, @QT_PSI_ISE, @QT_PSI_TAR_RED
		FROM	T_CHG CHG, T_SIT SIT
		WHERE	SIT.CD_SIT = CHG.CD_SIT AND CHG.CD_CHG = @CD_CHG AND

			CHG.FL_CHG_CAN = 0 AND 		--CHG não Cancelada
			SIT.FL_SIT_CON_VOO = 1		--Situação Etapa Concluída
		IF @@ROWCOUNT &lt;&gt; 0 
		BEGIN
			--Atualizar CD_STA em T_HPA caso a situação seja Etapa Concluída e o vôo não esteja Cancelado
			UPDATE 	HPA SET CD_STA = @CD_STA
			FROM	T_CHG CHG, T_SIT SIT, T_HPA001 HPA
			WHERE	HPA.CD_CHG = CHG.CD_CHG AND
				SIT.CD_SIT = CHG.CD_SIT AND CHG.CD_CHG = @CD_CHG AND
				CHG.FL_CHG_CAN = 0 AND 		--CHG não Cancelada
				SIT.FL_SIT_CON_VOO = 1		--Situação Etapa Concluída
		END
		--Próximo registro
		FETCH NEXT FROM INSSTA
		INTO	@CD_CHG, @CD_SIT, @DH_CHG_EFE, @FL_AEN_ISE, @FL_COM_TAR_RED, @QT_PSI_ISE, @QT_PSI_TAR_RED
	END
	CLOSE INSSTA
	DEALLOCATE INSSTA
	--Cancelar o Status caso a CHG esteja concluída e a situação seja alterada para outra qualquer
	IF (	SELECT COUNT(*) 	FROM T_STA STA, INSERTED INS, DELETED DEL, T_SIT SITDEL, T_SIT SITINS, T_HPA001 HPA
		WHERE 	STA.CD_STA = HPA.CD_STA AND HPA.CD_CHG = INS.CD_CHG AND
			DEL.CD_CHG = INS.CD_CHG AND SITDEL.CD_SIT = DEL.CD_SIT AND
			SITDEL.FL_SIT_CON_VOO = 1 AND SITINS.CD_SIT = INS.CD_SIT AND
			SITINS.FL_SIT_CON_VOO = 0) &gt; 0
	BEGIN
		UPDATE 	STA
		SET 	TP_STA = 3,  --Cancelado
			DH_STA_FEC = NULL, MA_STA_FEC = NULL,
			CD_STA_ANT = NULL, FL_STA_AEN_ISE = NULL,
			FL_STA_COM_TAR_RED = NULL, QT_STA_PSI_ISE = NULL,
			QT_STA_PSI_TAR_RED = NULL
		FROM 	T_STA STA, INSERTED INS, DELETED DEL, T_SIT SITDEL, T_SIT SITINS, T_HPA001 HPA
		WHERE 	STA.CD_STA = HPA.CD_STA AND HPA.CD_CHG = INS.CD_CHG AND
			DEL.CD_CHG = INS.CD_CHG AND SITDEL.CD_SIT = DEL.CD_SIT AND
			SITDEL.FL_SIT_CON_VOO = 1 AND SITINS.CD_SIT = INS.CD_SIT AND
			SITINS.FL_SIT_CON_VOO = 0
	END
	--Alterar CD_STA de HPA para NULL caso a CHG esteja concluída e a situação seja alterada para outra qualquer
	IF (	SELECT COUNT(*) 	FROM T_HPA001 HPA, INSERTED INS, DELETED DEL, T_SIT SITDEL, T_SIT SITINS
		WHERE 	HPA.CD_CHG = INS.CD_CHG AND DEL.CD_CHG = INS.CD_CHG AND
			SITDEL.CD_SIT = DEL.CD_SIT AND SITDEL.FL_SIT_CON_VOO = 1 AND
			SITINS.CD_SIT = INS.CD_SIT AND SITINS.FL_SIT_CON_VOO = 0) &gt; 0
	BEGIN
		UPDATE 	HPA SET CD_STA = NULL
		FROM 	T_HPA001 HPA, INSERTED INS, DELETED DEL, T_SIT SITDEL, T_SIT SITINS
		WHERE 	HPA.CD_CHG = INS.CD_CHG AND DEL.CD_CHG = INS.CD_CHG AND
			SITDEL.CD_SIT = DEL.CD_SIT AND SITDEL.FL_SIT_CON_VOO = 1 AND
			SITINS.CD_SIT = INS.CD_SIT AND SITINS.FL_SIT_CON_VOO = 0
	END
END
IF UPDATE(NR_CHG_VOO)
BEGIN
	--Atualizar o prefixo da aeronave dos vôos do grupo 2 caso o número do vôo tenha sido alterado
	UPDATE	CHG
	SET	CD_AEN_CHG = (	SELECT 	CD_AEN 
					FROM 	T_AEN AEN WHERE RTRIM(AEN.NR_AEN) = RTRIM(INS.NR_CHG_VOO))
	FROM	T_CHG CHG, INSERTED INS
	WHERE	CHG.CD_CHG = INS.CD_CHG AND INS.TP_CHG_GRU = 2
	--Atualizar o número do vôo de PAR associado caso este voo seja do Grupo 2
	IF (	SELECT COUNT(*) 	FROM T_PAR PAR, INSERTED INS
		WHERE	PAR.CD_CHG_AEN_ANT = INS.CD_CHG AND
			INS.TP_CHG_GRU = 2 AND PAR.TP_PAR_GRU = 2) &gt; 0
	BEGIN
		UPDATE	PAR SET NR_PAR_VOO = INS.NR_CHG_VOO
		FROM	T_PAR PAR, INSERTED INS
		WHERE	PAR.CD_CHG_AEN_ANT = INS.CD_CHG AND
			INS.TP_CHG_GRU = 2 AND PAR.TP_PAR_GRU = 2
	END
	--Atualizar em HPA o prefixo da aeronave dos vôos do grupo 2 caso o número do vôo tenha sido alterado
	IF (	SELECT 	COUNT(*) FROM T_HPA001 HPA, INSERTED INS
		WHERE	HPA.CD_CHG = INS.CD_CHG AND INS.TP_CHG_GRU = 2) &gt; 0
	BEGIN
		UPDATE	T_HPA001
		SET	CD_AEN = (	SELECT 	CD_AEN 
					FROM 	T_AEN AEN WHERE RTRIM(AEN.NR_AEN) = RTRIM(INS.NR_CHG_VOO))
		FROM	T_HPA001 HPA, INSERTED INS
		WHERE	HPA.CD_CHG = INS.CD_CHG AND INS.TP_CHG_GRU = 2 
	END
END
IF UPDATE(TP_CHG_CTG)
BEGIN
	--Apagar os hpa dos vôos de CHG que passaram a ser CSH ou DPL
	DELETE	T_HPA001 FROM T_HPA001 HPA, INSERTED INS
	WHERE	HPA.CD_CHG = INS.CD_CHG AND INS.TP_CHG_CTG IN (3,4)
	--Anular o tipo de equipamento, o box e a aeronave dos vôos que passaram a ser CSH ou DPL
	UPDATE	T_CHG
	SET	CD_EQP_CHG = NULL, CD_AEN_CHG = NULL, CD_BOX = NULL
	FROM	T_CHG CHG, INSERTED INS
	WHERE	CHG.CD_CHG = INS.CD_CHG AND INS.TP_CHG_CTG IN (3,4)
	--Incluir vôo na tabela de vôos candidatos a vôos Antecessores se TP_CHG_CTG mudar de 3 ou 4 para uma categoria que seja diferente de 3 ou 4
	INSERT	T_CHGANT(CD_CHG)
	SELECT	INS.CD_CHG FROM INSERTED INS, DELETED DEL
	WHERE	INS.CD_CHG = DEL.CD_CHG AND DEL.TP_CHG_CTG IN (3,4) AND INS.TP_CHG_CTG NOT IN (3,4)
	--Excluir vôo da tabela de vôos candidatos a vôos Antecessores se TP_CHG_CTG mudar para 3 ou 4
	DELETE	T_CHGANT FROM T_CHGANT CHGANT, INSERTED INS
	WHERE	CHGANT.CD_CHG = INS.CD_CHG AND INS.TP_CHG_CTG IN (3,4)
END
IF UPDATE(DH_CHG_EFE)
BEGIN
	--Atualizar a hora do vôo de PAR caso a diferença entre a hora da PAR e a hora da CHG seja menor que o tempo mínimo de permanência do vôo.
	IF (	SELECT COUNT(*) 	FROM T_PAR PAR, INSERTED INS
		WHERE	PAR.CD_CHG_AEN_ANT = INS.CD_CHG AND 
			(DATEDIFF(MI, INS.DH_CHG_EFE, PAR.DH_PAR_EFE) &lt; INS.QT_CHG_PER_MIN OR PAR.DH_PAR_EFE &gt; PAR.DH_PAR_NRM)) &gt;0
	BEGIN
		UPDATE 	T_PAR
		SET 	DH_PAR_SIT = GETDATE(),
			DH_PAR_EFE  =  DATEADD( MI, INS.QT_CHG_PER_MIN, INS.DH_CHG_EFE),
			DH_PAR_EST  =  DATEADD( MI, INS.QT_CHG_PER_MIN, INS.DH_CHG_EFE)
		FROM 	T_PAR PAR, INSERTED INS
		WHERE	PAR.CD_CHG_AEN_ANT = INS.CD_CHG AND (DATEDIFF(MI, INS.DH_CHG_EFE, PAR.DH_PAR_EFE) &lt; INS.QT_CHG_PER_MIN OR PAR.DH_PAR_EFE &gt; PAR.DH_PAR_NRM)
	END
	--Atualizar a hora prevista e de estacionamento dos vôos que ficaram com estas horas menores que a hora normal
	IF (	SELECT	COUNT(*) FROM T_PAR PAR, INSERTED INS
		WHERE	PAR.CD_CHG_AEN_ANT = INS.CD_CHG AND PAR.DH_PAR_EFE &lt; PAR.DH_PAR_NRM) &gt; 0
	BEGIN
		UPDATE 	T_PAR
		SET	DH_PAR_EFE = PAR.DH_PAR_NRM, DH_PAR_EST = PAR.DH_PAR_NRM
		FROM 	T_PAR PAR, INSERTED INS
		WHERE	PAR.CD_CHG_AEN_ANT = INS.CD_CHG AND PAR.DH_PAR_EFE &lt; PAR.DH_PAR_NRM
	END
	--Atualizar os campos DH_STA_ABE e MA_STA_ABE do Status de Aeronave associado ao primeiro HPA do vôo alterado, se houver alteração na Data/Hora Efetiva do Vôo de CHG, e o Status associado ao primeiro HPA desse vôo, estiver aberto
	UPDATE	STA
	SET	DH_STA_ABE = INS.DH_CHG_EFE,
		MA_STA_ABE = DATEADD(DD, 1- DATEPART(DD, Dateadd(HH, -Datepart(HH, INS.DH_CHG_EFE), Dateadd(mi, -datepart(mi, INS.DH_CHG_EFE), INS.DH_CHG_EFE))), Dateadd(HH, -Datepart(HH, INS.DH_CHG_EFE), Dateadd(mi, -datepart(mi, INS.DH_CHG_EFE), INS.DH_CHG_EFE))) --Primeiro dia do mês da Data da CHG
	FROM	T_STA STA, T_CHG CHG, INSERTED INS, T_HPA001 HPA
	WHERE	CHG.CD_CHG = INS.CD_CHG AND HPA.CD_CHG = INS.CD_CHG AND
		HPA.NR_HPA_SEQ = 1 AND 	STA.CD_STA = HPA.CD_STA AND STA.TP_STA = 1
END
--Se o vôo possuir CHG e atualizarmos a aeronave de CHG do vôo, temos que atualizá-la também em HPA
IF UPDATE(CD_AEN_CHG)
BEGIN
	IF (	SELECT 	COUNT(*) FROM INSERTED INS, T_CHG CHG
		WHERE	CHG.CD_CHG = INS.CD_CHG AND CHG.FL_CHG_CAN = 1 AND INS.CD_AEN_CHG IS NOT NULL) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: Não é permitido definir aeronave para vôos cancelados.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
	--Não permitir que o prefixo da aeronave seja nulo para vôos do grupo 2
	IF (	SELECT 	COUNT(*) FROM INSERTED INS
		WHERE	INS.TP_CHG_GRU = 2 AND INS.CD_AEN_CHG IS NULL) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: O &lt;Prefixo da Aeronave&gt; para vôos da Aviação Geral não deve ser nulo, e sim igual ao &lt;Número do Vôo&gt;.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
	--Atualizar o número do vôo de CHG para vôos do grupo 2 caso o prefixo da aeronave tenha sido alterado
	UPDATE	CHG
	SET	NR_CHG_VOO = (SELECT NR_AEN FROM T_AEN AEN WHERE AEN.CD_AEN = INS.CD_AEN_CHG)
	FROM	T_CHG CHG, INSERTED INS
	WHERE	CHG.CD_CHG = INS.CD_CHG AND INS.TP_CHG_GRU = 2

	--Atualizar o número do vôo de PAR para vôos do grupo 2 caso o prefixo da aeronave tenha sido alterado
	IF (	SELECT	COUNT(*) FROM T_PAR PAR, INSERTED INS
		WHERE	PAR.CD_CHG_AEN_ANT = INS.CD_CHG AND
			INS.TP_CHG_GRU = 2 AND PAR.TP_PAR_GRU = 2) &gt;0
	BEGIN
		UPDATE	PAR
		SET	NR_PAR_VOO = (SELECT NR_AEN FROM T_AEN AEN WHERE AEN.CD_AEN = INS.CD_AEN_CHG)
		FROM	T_PAR PAR, INSERTED INS
		WHERE	PAR.CD_CHG_AEN_ANT = INS.CD_CHG AND
			INS.TP_CHG_GRU = 2 AND 	PAR.TP_PAR_GRU = 2
	END
	--Atualizar aeronave em HPA
	UPDATE 	T_HPA001 SET CD_AEN = INS.CD_AEN_CHG
	FROM 	T_HPA001 HPA, T_CHG CHG, INSERTED INS
	WHERE  	HPA.CD_CHG = INS.CD_CHG AND CHG.CD_CHG = INS.CD_CHG
END
--Se atualizarmos a aeronave de CHG do vôo para outra que não seja Null e a situação do vôo for etapa concluída, temos que atualizar as informações referentes à aeronave em STA
IF UPDATE(CD_AEN_CHG) 
BEGIN
	UPDATE 	T_STA SET FL_STA_AEN_ISE = AEN.FL_AEN_ISE
	FROM 	T_STA STA, T_CHG CHG, T_HPA001 HPA, T_AEN AEN, T_SIT SIT, INSERTED INS
	WHERE  STA.CD_STA = HPA.CD_STA AND HPA.CD_CHG = INS.CD_CHG AND
		CHG.CD_CHG = INS.CD_CHG AND AEN.CD_AEN = INS.CD_AEN_CHG AND
		INS.CD_AEN_CHG is not Null AND SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CON_VOO = 1
END
--Se atualizarmos a companhia aérea do vôo de CHG e a situação do vôo for etapa concluída, temos que atualizar as informações referentes à companhia aérea em STA
IF UPDATE(CD_COM) 
BEGIN
	UPDATE 	T_STA SET FL_STA_COM_TAR_RED = COM.FL_COM_TAR_RED
	FROM 	T_STA STA, T_CHG CHG, T_HPA001 HPA, T_COM COM, T_SIT SIT, INSERTED INS
	WHERE  STA.CD_STA = HPA.CD_STA AND HPA.CD_CHG = INS.CD_CHG AND
		CHG.CD_CHG = INS.CD_CHG AND COM.CD_COM = INS.CD_COM AND
		SIT.CD_SIT = INS.CD_SIT AND SIT.FL_SIT_CON_VOO = 1 
END
IF UPDATE(DH_CHG_EST)
BEGIN
	--Não permitir alteração na Data ou Hora de Estacionamento de um Vôo de CHG, se o Status de Aeronave associado ao primeiro HPA desse vôo, estiver Fechado
	IF (	SELECT	COUNT(*)
		FROM 	T_CHG CHG, INSERTED INS, T_HPA001 HPA, T_STA STA
		WHERE	CHG.CD_CHG = INS.CD_CHG AND HPA.CD_CHG = INS.CD_CHG AND
			HPA.NR_HPA_SEQ = 1 AND STA.CD_STA = HPA.CD_STA AND STA.TP_STA = 2) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: A &lt;Data ou Hora de Estacionamento&gt; do vôo de Chegada não pode ser alterada, se o Status de Aeronave associado ao primeiro HPA desse vôo, estiver Fechado.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
	--Atualizamos Hora de Entrada em HPA como Hora de Estacionamento de CHG, no registro que possue o Vôo sendo atualizado como Vôo de CHG
	UPDATE 	T_HPA001 SET DH_HPA_ENT = CHG.DH_CHG_EST
	FROM	T_HPA001 HPA, T_CHG CHG, INSERTED INS
	WHERE 	CHG.CD_CHG = INS.CD_CHG AND HPA.CD_CHG = INS.CD_CHG AND HPA.NR_HPA_SEQ = 1
END
--CONSISTÊNCIAS A SEREM FEITAS APÓS AS ATUALIZAÇÕES
--Verificar se há horas de CHG maiores que as horas de PAR
IF   (	SELECT COUNT(*) FROM T_CHG CHG, T_PAR PAR, INSERTED INS
	WHERE 	CHG.CD_CHG = INS.CD_CHG AND PAR.CD_CHG_AEN_ANT = CHG.CD_CHG AND
		( (CHG.DH_CHG_EFE &gt;= PAR.DH_PAR_EFE) OR (CHG.DH_CHG_EST &gt;= PAR.DH_PAR_EST))) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: A hora de chegada não pode ser maior nem igual à hora de partida.&#39;
	ROLLBACK TRANSACTION
	RETURN
END
--Alexei 18/06/01
IF UPDATE(FL_CHG_TEL)
BEGIN
	--Se desmarcar da tela desmarcar do anunciador automático
	Update	T_CHG
	set	FL_CHG_ANU = 0
	FROM	T_CHG CHG
	JOIN	INSERTED INS ON INS.CD_CHG = CHG.CD_CHG
	WHERE	INS.FL_CHG_TEL = 0
END

--Verificar se são satisfeitas as condições para a nova situação de CHG
--Alexei 18/06/01
IF UPDATE(CD_SIT) OR UPDATE(DH_CHG_EFE)
BEGIN
	--Lançar Histórico de Situação de Vôo
	INSERT T_HSC (DH_HSC, CD_CHG, CD_IFT, CD_SIT, DH_HSC_CHG, CD_USR) SELECT GETDATE(), INS.CD_CHG, INS.CD_IFT, INS.CD_SIT, INS.DH_CHG_EFE, INS.CD_USR FROM INSERTED INS

	--Deleta todos os registros da programação não anunciados e que estejam vinculados a este vôo
	DELETE T_PRALOG FROM T_PRALOG JOIN INSERTED INS ON INS.CD_CHG = T_PRALOG.CD_CHG WHERE T_PRALOG.FL_LOG = 0

	--Inserir programação de Log
	--Antes da Hora Prevista
	INSERT INTO T_PRALOG (CD_PRA, CD_CHG, CD_PAR, DH_LOG, FL_LOG)
	SELECT 	CD_PRA, INS.CD_CHG, NULL, DATEADD(MI, -PRA.QT_PRA_TMP, INS.DH_CHG_EFE), 0
	FROM	T_PRA PRA JOIN INSERTED INS ON INS.CD_SIT = PRA.CD_SIT AND INS.FL_CHG_TEL = 1 AND INS.FL_CHG_ANU = 1
	JOIN	T_TPA TPA ON TPA.CD_TPA = PRA.CD_TPA AND TPA.TP_TPA = 1 JOIN T_SIT SIT ON SIT.CD_SIT = INS.CD_SIT AND FL_SIT_CON_VOO = 0
	WHERE	PRA.TP_PRA = 1 AND NOT EXISTS (SELECT * FROM T_PRALOG WHERE CD_PRA = PRA.CD_PRA AND CD_CHG = INS.CD_CHG) 

	 --Após a Alteração da Situação
	INSERT INTO T_PRALOG (CD_PRA, CD_CHG, CD_PAR, DH_LOG, FL_LOG)
	SELECT 	CD_PRA, INS.CD_CHG, NULL, DATEADD(MI, PRA.QT_PRA_TMP, GETDATE()), 0
	FROM	T_PRA PRA JOIN INSERTED INS ON INS.CD_SIT = PRA.CD_SIT AND INS.FL_CHG_TEL = 1 AND INS.FL_CHG_ANU = 1
	JOIN	T_TPA TPA ON TPA.CD_TPA = PRA.CD_TPA AND TPA.TP_TPA = 1 JOIN T_SIT SIT ON SIT.CD_SIT = INS.CD_SIT AND FL_SIT_CON_VOO = 0
	WHERE	PRA.TP_PRA = 2 AND NOT EXISTS (SELECT * FROM T_PRALOG WHERE CD_PRA = PRA.CD_PRA AND CD_CHG = INS.CD_CHG)
END
IF UPDATE(CD_SIT)
BEGIN
	IF (	SELECT	COUNT(*) FROM INSERTED INS, T_PAR AEN, T_SIT SITAEN
		WHERE	AEN.CD_CHG_AEN_ANT = INS.CD_CHG AND 
			SITAEN.CD_SIT = AEN.CD_SIT AND SITAEN.FL_SIT_TOD = 1 AND 
			EXISTS (SELECT * FROM T_SCA SCA WHERE SCA.CD_SIT = AEN.CD_SIT) AND 
			INS.CD_SIT NOT IN (SELECT CD_SIT_ANT FROM T_SCA SCA WHERE SCA.CD_SIT = AEN.CD_SIT)) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: A nova situação do vôo de chegada é incompatível com as situações dos vôos sucessores.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END

	--Antes da Hora Prevista
	INSERT INTO T_PRALOG (CD_PRA, CD_CHG, CD_PAR, DH_LOG, FL_LOG)
	SELECT 	CD_PRA, NULL, NULL, DATEADD(MI, -PRA.QT_PRA_TMP, INS.DH_CHG_EFE), 0
	FROM	T_PRA PRA JOIN INSERTED INS ON INS.CD_SIT = PRA.CD_SIT AND INS.FL_CHG_TEL = 1 AND INS.FL_CHG_ANU = 1
	JOIN	T_TPA TPA ON TPA.CD_TPA = PRA.CD_TPA AND TPA.TP_TPA = 3 JOIN T_SIT SIT ON SIT.CD_SIT = INS.CD_SIT AND FL_SIT_CON_VOO = 0
	WHERE	PRA.TP_PRA = 1 AND NOT EXISTS (SELECT * FROM T_PRALOG WHERE CD_PRA = PRA.CD_PRA AND CD_CHG = INS.CD_CHG) AND TP_PRA_TPA = 1

	--Após a Alteração da Situação
	INSERT INTO T_PRALOG (CD_PRA, CD_CHG, CD_PAR, DH_LOG, FL_LOG)
	SELECT 	CD_PRA, NULL, NULL, DATEADD(MI, PRA.QT_PRA_TMP, GETDATE()), 0
	FROM	T_PRA PRA JOIN INSERTED INS ON INS.CD_SIT = PRA.CD_SIT AND INS.FL_CHG_TEL = 1 AND INS.FL_CHG_ANU = 1
	JOIN	T_TPA TPA ON TPA.CD_TPA = PRA.CD_TPA AND TPA.TP_TPA = 3 JOIN T_SIT SIT ON SIT.CD_SIT = INS.CD_SIT AND FL_SIT_CON_VOO = 0
	WHERE	PRA.TP_PRA = 2 AND NOT EXISTS (SELECT * FROM T_PRALOG WHERE CD_PRA = PRA.CD_PRA AND CD_CHG = INS.CD_CHG) AND TP_PRA_TPA = 1
END
--JOGAR os dados dos vôos do tipo Normal, nos vôos do tipo Codeshare
IF (	SELECT 	COUNT(*)  FROM T_CHG CHG, T_CHG CHGVIN, INSERTED INS
	WHERE	CHG.CD_CHG_VIN = INS.CD_CHG AND CHGVIN.CD_CHG = INS.CD_CHG) &gt;0
BEGIN
	UPDATE	CHG
	SET	CD_EQP_CHG = CHGVIN.CD_EQP_CHG, CD_BOX = CHGVIN.CD_BOX,
		QT_CHG_PER_MIN = CHGVIN.QT_CHG_PER_MIN, DH_CHG_NRM = CHGVIN.DH_CHG_NRM,
		DH_CHG_EFE = CHGVIN.DH_CHG_EFE, DH_CHG_EST = CHGVIN.DH_CHG_EST,
		NM_CHG_COM_SIT = CHGVIN.NM_CHG_COM_SIT, DH_CHG_SIT  = CHGVIN.DH_CHG_SIT,
		FL_CHG_CAN = CHGVIN.FL_CHG_CAN, CD_SIT = CHGVIN.CD_SIT,
		TP_CHG_STA = CHGVIN.TP_CHG_STA, CD_USR = CHGVIN.CD_USR
	FROM	T_CHG CHG, T_CHG CHGVIN, INSERTED INS
	WHERE	CHG.CD_CHG_VIN = INS.CD_CHG AND CHGVIN.CD_CHG = INS.CD_CHG
END
--PUXAR os dados dos vôos do tipo Normal, nos vôos do tipo Codeshare
IF (	SELECT 	COUNT(*) FROM T_CHG CHG, T_CHG CHGVIN, INSERTED INS
	WHERE	CHG.CD_CHG = INS.CD_CHG AND CHGVIN.CD_CHG = INS.CD_CHG_VIN) &gt; 0
BEGIN
	UPDATE	CHG
	SET	CD_EQP_CHG = CHGVIN.CD_EQP_CHG, CD_BOX = CHGVIN.CD_BOX,
		QT_CHG_PER_MIN = CHGVIN.QT_CHG_PER_MIN, DH_CHG_NRM = CHGVIN.DH_CHG_NRM,
		DH_CHG_EFE = CHGVIN.DH_CHG_EFE, DH_CHG_EST = CHGVIN.DH_CHG_EST,
		NM_CHG_COM_SIT = CHGVIN.NM_CHG_COM_SIT, DH_CHG_SIT  = CHGVIN.DH_CHG_SIT,
		FL_CHG_CAN = CHGVIN.FL_CHG_CAN, CD_SIT = CHGVIN.CD_SIT,
		TP_CHG_STA = CHGVIN.TP_CHG_STA, CD_USR = CHGVIN.CD_USR
	FROM	T_CHG CHG, T_CHG CHGVIN, INSERTED INS
	WHERE	CHG.CD_CHG = INS.CD_CHG AND CHGVIN.CD_CHG = INS.CD_CHG_VIN
END
--Lançar registro para Replicação na tabela T_REP001
IF UPDATE(CD_SIT) OR UPDATE(CD_AEN_CHG)
BEGIN
	DECLARE @HR_REP_ZUL INT
	DECLARE @HR_HOR_NRM INT
	DECLARE @HR_HOR_VER INT

	--Verifica Defazagem em relação ao horário Zulu
	SELECT 	@HR_HOR_NRM = HR_HOR_NRM, @HR_HOR_VER = HR_HOR_VER
	FROM 	T_HOR HOR, T_AER AER, T_CID CID, T_PSI PSI
	WHERE 	CID.CD_CID = AER.CD_CID And HOR.CD_HOR = CID.CD_HOR And AER.CD_AER = PSI.CD_AER
   
	--Verifica se o Aeroporto está no Horário de Verão
	IF (SELECT COUNT(*) FROM T_HRV WHERE GETDATE() BETWEEN DT_HRV_INI AND DT_HRV_FIM) &gt; 0
		SELECT @HR_REP_ZUL = @HR_HOR_VER
	ELSE
		SELECT @HR_REP_ZUL = @HR_HOR_NRM
END
IF UPDATE(CD_SIT)
BEGIN
	--Vôos de CHG cujas situações estão sendo atualizadas para &quot;Etapa Concluída&quot; e cuja primeira escala posterior do vôo de PAR associado é um dos aeroportos ativos existentes na tabela T_RED
	DECLARE REP1 CURSOR FOR
	SELECT 	PAR.CD_PAR, SG_COM_IAT_003, NR_VOO = PAR.NR_PAR_VOO, 
		DH_VOO_EFE = INS.DH_CHG_EFE, QT_VOO_DIF = DATEDIFF(MI, INS.DH_CHG_NRM, INS.DH_CHG_EFE)
	FROM 	INSERTED INS, T_CHG CHG, T_SIT SIT, T_PAR PAR, T_COM COM
	WHERE	INS.CD_CHG = CHG.CD_CHG AND SIT.CD_SIT = INS.CD_SIT AND
		SIT.FL_SIT_CON_VOO = 1 AND CHG.FL_CHG_CAN = 0 AND
		PAR.CD_CHG_AEN_ANT = INS.CD_CHG AND
		PAR.CD_PAR IN (	SELECT	CD_PAR FROM T_ECP001 ECP
				WHERE	ECP.CD_PAR = PAR.CD_PAR AND
					ECP.CD_ECP = (SELECT MIN(CD_ECP) FROM T_ECP001 ECP1 WHERE ECP1.CD_PAR = ECP.CD_PAR) AND
					ECP.CD_AER IN (SELECT CD_AER FROM T_AER WHERE SG_AER_ICA IN (SELECT SG_AER_ICA FROM T_RED WHERE FL_RED_ATI = 1))) AND
		COM.CD_COM = PAR.CD_COM
	--Declaração das variáveis
	DECLARE @CD_PAR INT, @SG_COM_IAT_003 CHAR(3), 	@NR_VOO CHAR(10), @DH_VOO_EFE SMALLDATETIME, @QT_VOO_DIF INT
	--Abre cursor e posiciona no primeiro registro
	OPEN REP1
	FETCH REP1 INTO	@CD_PAR, @SG_COM_IAT_003, @NR_VOO, @DH_VOO_EFE, @QT_VOO_DIF
	--Processar todos os registros de REP1
	WHILE @@FETCH_STATUS = 0
	BEGIN
		--Inserir registro na tabela T_REP001
		INSERT INTO T_REP001 (
			SG_AER_ICA_ORI, SG_AER_ICA_DES, SG_COM_IAT_003, NR_VOO, 
			DH_VOO_EFE, QT_VOO_DIF, NM_SIT, NR_AEN,
			FL_CHG_CON, FL_PAR_CON, FL_AEN, DH_REP, DH_REP_ORI, HR_REP_ZUL)
		SELECT 	(SELECT SG_AER_ICA FROM T_AER WHERE CD_AER = (SELECT CD_AER FROM T_PSI)),
			(SELECT SG_AER_ICA FROM T_ECP001 ECP, T_AER AER WHERE ECP.CD_PAR = @CD_PAR AND ECP.CD_ECP = (SELECT MIN(CD_ECP) FROM T_ECP001 WHERE CD_PAR = @CD_PAR) AND ECP.CD_AER = AER.CD_AER),
			@SG_COM_IAT_003, @NR_VOO,
			@DH_VOO_EFE, @QT_VOO_DIF,
			NULL, NULL, 1, 0, 0, GETDATE(), GETDATE(), @HR_REP_ZUL
		--Ir para o próximo registro
		FETCH NEXT FROM REP1
		INTO	@CD_PAR, @SG_COM_IAT_003, @NR_VOO, @DH_VOO_EFE, @QT_VOO_DIF
	END
	CLOSE REP1
	DEALLOCATE REP1
END
IF UPDATE(CD_AEN_CHG)
BEGIN
	--Vôos de CHG cujas prefixos das aeronaves estão sendo atualizadas e cuja primeira escala posterior do vôo de PAR associado é um dos aeroportos ativos existentes na tabela T_RED
	DECLARE REP2 CURSOR FOR
	SELECT 	PAR.CD_PAR, SG_COM_IAT_003, NR_VOO = PAR.NR_PAR_VOO, NR_AEN
	FROM 	INSERTED INS, T_PAR PAR, T_COM COM, T_AEN AEN
	WHERE	PAR.CD_CHG_AEN_ANT = INS.CD_CHG AND
		PAR.CD_PAR IN (	SELECT	CD_PAR 	FROM T_ECP001 ECP
				WHERE	ECP.CD_PAR = PAR.CD_PAR AND
					ECP.CD_ECP = (SELECT MIN(CD_ECP) FROM T_ECP001 ECP1 WHERE ECP1.CD_PAR = ECP.CD_PAR) AND
					ECP.CD_AER IN (SELECT CD_AER FROM T_AER WHERE SG_AER_ICA IN (SELECT SG_AER_ICA FROM T_RED WHERE FL_RED_ATI = 1))) AND
		COM.CD_COM = PAR.CD_COM AND AEN.CD_AEN =* INS.CD_AEN_CHG
	--Declaração das variáveis
	DECLARE @NR_AEN CHAR(10)
	--Abre curso e posiciona no primeiro registro
	OPEN REP2
	FETCH REP2 INTO @CD_PAR, @SG_COM_IAT_003, @NR_VOO, @NR_AEN
	--Processar todos os registros de REP2
	WHILE @@FETCH_STATUS = 0
	BEGIN
		--Inserir registro na tabela T_REP001
		INSERT INTO T_REP001 (
			SG_AER_ICA_ORI, SG_AER_ICA_DES, SG_COM_IAT_003, NR_VOO, 
			DH_VOO_EFE, QT_VOO_DIF, NM_SIT, NR_AEN,
			FL_CHG_CON, FL_PAR_CON, FL_AEN, DH_REP, DH_REP_ORI, HR_REP_ZUL)
		SELECT 	(SELECT SG_AER_ICA FROM T_AER WHERE CD_AER = (SELECT CD_AER FROM T_PSI)),
			(SELECT SG_AER_ICA FROM T_ECP001 ECP, T_AER AER WHERE ECP.CD_PAR = @CD_PAR AND ECP.CD_ECP = (SELECT MIN(CD_ECP) FROM T_ECP001 WHERE CD_PAR = @CD_PAR) AND ECP.CD_AER = AER.CD_AER),
			@SG_COM_IAT_003, @NR_VOO,
			NULL, NULL, NULL, @NR_AEN, 0, 0, 1, GETDATE(), GETDATE(), @HR_REP_ZUL

		--Ir para o próximo registro
		FETCH NEXT FROM REP2 INTO @CD_PAR, @SG_COM_IAT_003, @NR_VOO, @NR_AEN
	END
	CLOSE REP2
	DEALLOCATE REP2
END
--INCLUIR REGISTROS EM T_ACH
INSERT	T_ACH (DH_ACH, CD_CHG)
SELECT GETDATE(), CD_CHG FROM INSERTED

IF 	UPDATE(NR_CHG_VOO) OR UPDATE(TP_CHG_GRU) OR UPDATE(TP_CHG) OR 
	UPDATE(TP_CHG_NAT) OR UPDATE(TP_CHG_CTG) OR UPDATE(CD_COM)
BEGIN
	--Incluir registros em T_AHP
	INSERT	T_AHP (CD_HPA, DH_AHP)
	Select 	DISTINCT CD_HPA, GETDATE()
	From 	T_HPA001 HPA, T_CHG CHG, T_SIT SIT, INSERTED INS
	Where	HPA.CD_CHG = CHG.CD_CHG AND SIT.CD_SIT = CHG.CD_SIT AND
		HPA.CD_AER = (Select CD_AER From T_PSI) AND
		(HPA.FL_HPA_ENT = 1 OR SIT.FL_SIT_AEN_PAT = 1) AND HPA.FL_HPA_SAI = 0 AND
		HPA.CD_AEN IS NOT NULL AND CHG.CD_CHG = INS.CD_CHG
END
IF 	UPDATE(CD_AEN_CHG)
BEGIN
	--Incluir registros em T_APA
	INSERT	T_APA (CD_PAR, DH_APA)
	Select 	DISTINCT CD_PAR, GETDATE()
	From 	T_PAR PAR, INSERTED INS
	Where	PAR.CD_CHG_AEN_ANT = INS.CD_CHG AND
		PAR.TP_PAR_STA = 1 AND
		PAR.CD_AER = (Select CD_AER From T_PSI)

END
End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o39"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o63">
<a:Rect>((-741437,671978), (-734811,677194))</a:Rect>
<a:LineColor>12615680</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o64">
<a:ObjectID>6958A592-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_AER</a:Name>
<a:Code>T_AER</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o65">
<a:ObjectID>6958A583-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_AER</a:Name>
<a:Code>CD_AER</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o66">
<a:ObjectID>6958A585-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_AER</a:Name>
<a:Code>NM_AER</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(40)</a:DataType>
<a:Length>40</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o67">
<a:ObjectID>6958A587-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SG_AER_ICA</a:Name>
<a:Code>SG_AER_ICA</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(4)</a:DataType>
<a:Length>4</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o68">
<a:ObjectID>6958A589-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SG_AER_IAT</a:Name>
<a:Code>SG_AER_IAT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(3)</a:DataType>
<a:Length>3</a:Length>
</o:Column>
<o:Column Id="o69">
<a:ObjectID>6958A58B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_AER_TEL_CHG</a:Name>
<a:Code>NR_AER_TEL_CHG</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o70">
<a:ObjectID>6958A58D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_AER_TEL_PAR</a:Name>
<a:Code>NR_AER_TEL_PAR</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o71">
<a:ObjectID>6958A590-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_AER_CTG</a:Name>
<a:Code>TP_AER_CTG</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o72">
<a:ObjectID>6958A593-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_CID</a:Name>
<a:Code>CD_CID</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o73">
<a:ObjectID>6958A595-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o74">
<a:ObjectID>6958A59C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_AER</a:Name>
<a:Code>Pk_T_AER</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_AER</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o65"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o75">
<a:ObjectID>6958A599-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_AER_ICA</a:Name>
<a:Code>I_AER_ICA</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o76">
<a:ObjectID>6958A59B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o67"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Ref="o59"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o77">
<a:ObjectID>6958A4F3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_AER_TRD</a:Name>
<a:Code>T_AER_TRD</a:Code>
<a:Text>Create Trigger T_AER_TRD On T_AER
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Aeroporto»Chegadas - Mirror: Aeroporto da Chegada (Restrict) */
If (Select Count(*) From T_CHG_MIR dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Chegadas - Mirror&gt;&#39;
  Return
End
/* Aeroporto»Chegadas: Aeroporto da Chegada (Restrict) */
If (Select Count(*) From T_CHG dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Chegadas&gt;&#39;
  Return
End
/* Aeroporto»Escala da Chegada de Vôo - Mirror: Aeroporto da Escala de Partida (Restrict) */
If (Select Count(*) From T_ECC001_MIR dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Escala da Chegada de Vôo - Mirror&gt;&#39;
  Return
End
/* Aeroporto»Escala da Partida de Vôo - Mirror: Aeroporto da Escala de Partida (Restrict) */
If (Select Count(*) From T_ECP001_MIR dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Escala da Partida de Vôo - Mirror&gt;&#39;
  Return
End
/* Aeroporto»Partidas - Mirror: Aeroporto da Partida (Restrict) */
If (Select Count(*) From T_PAR_MIR dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Partidas - Mirror&gt;&#39;
  Return
End
/* Aeroporto»Partidas: Aeroporto da Partida (Restrict) */
If (Select Count(*) From T_PAR dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Partidas&gt;&#39;
  Return
End
/* Aeroporto»Tela: Aeroporto das Telas (Restrict) */
If (Select Count(*) From T_TEL dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Tela&gt;&#39;
  Return
End
/* Aeroporto»Hotran - Etapa: Aeroporto Destino (Restrict) */
If (Select Count(*) From T_HET dep, Deleted pri
 Where dep.SG_AER_DES = pri.SG_AER_ICA) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Hotran - Etapa&gt;&#39;
  Return
End
/* Aeroporto»Histórico de Permanência de Aeronaves - Mirror: Aeroporto do HPA (Restrict) */
If (Select Count(*) From T_HPA001_MIR dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Histórico de Permanência de Aeronaves - Mirror&gt;&#39;
  Return
End
/* Aeroporto»Histórico de Permanência de Aeronaves: Aeroporto do HPA (Restrict) */
If (Select Count(*) From T_HPA001 dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Histórico de Permanência de Aeronaves&gt;&#39;
  Return
End
/* Aeroporto»Dados Estatísticos de Partida - Mirror: Aeroporto está em (Restrict) */
If (Select Count(*) From T_DEP_MIR dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Dados Estatísticos de Partida - Mirror&gt;&#39;
  Return
End
/* Aeroporto»Escala da Chegada de Vôo: Aeroporto integra ECC (Restrict) */
If (Select Count(*) From T_ECC001 dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Escala da Chegada de Vôo&gt;&#39;
  Return
End
/* Aeroporto»Escala da Partida de Vôo: Aeroporto integra ECP (Restrict) */
If (Select Count(*) From T_ECP001 dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Escala da Partida de Vôo&gt;&#39;
  Return
End
/* Aeroporto»Parâmetros do Sistema: Aeroporto Integra Par. Sistema (Restrict) */
If (Select Count(*) From T_PSI dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Parâmetros do Sistema&gt;&#39;
  Return
End
/* Aeroporto»Hotran - Etapa: Aeroporto Origem (Restrict) */
If (Select Count(*) From T_HET dep, Deleted pri
 Where dep.SG_AER_ORI = pri.SG_AER_ICA) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Hotran - Etapa&gt;&#39;
  Return
End
/* Aeroporto»Propaganda: Aeroporto Possui Propagandas (Restrict) */
If (Select Count(*) From T_PRG dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Propaganda&gt;&#39;
  Return
End
/* Aeroporto»Dados Estatísticos de Partida: Está em (Restrict) */
If (Select Count(*) From T_DEP dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Dados Estatísticos de Partida&gt;&#39;
  Return
End
/* Aeroporto»Horário Comercial: Aer. possui Horário Comercial (Cascade) */
Delete T_HRC From T_HRC dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER
/* Aeroporto»Box: Aeroporto possui Boxes (Cascade) */
Delete T_BOX From T_BOX dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER
/* Aeroporto»Checkin: Aeroporto possui Checkins (Cascade) */
Delete T_CHK From T_CHK dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER
/* Aeroporto»Esteira: Aeroporto possui Esteiras (Cascade) */
Delete T_EST From T_EST dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER
/* Aeroporto»Pistas de Decolagem: Aeroporto possui Pista (Cascade) */
Delete T_PIS From T_PIS dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER
/* Aeroporto»Ponte de Embarque: Aeroporto possui Pista de Embarque (Cascade) */
Delete T_PON From T_PON dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER
/* Aeroporto»Portão: Aeroporto possui Portões (Cascade) */
Delete T_POR From T_POR dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER
/* Aeroporto»Sala de Desembarque: Aeroporto possui Sal.Desemb. (Cascade) */
Delete T_SAL From T_SAL dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER
/* Aeroporto»Sala de Embarque: Aeroporto possui SalasEmbarque (Cascade) */
Delete T_EMB From T_EMB dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER
End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o78">
<a:ObjectID>6958A4F5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_AER_TRI</a:Name>
<a:Code>T_AER_TRI</a:Code>
<a:Text>Create Trigger T_AER_TRI On T_AER
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Cidade»Aeroporto: Cidade possui Aeroportos */
If (Select Count(*) From T_CID, Inserted
Where T_CID.CD_CID = Inserted.CD_CID)
 &lt;&gt;(Select Count(CD_CID) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Cidade&gt; que se deseja incluir na tabela &lt;Aeroporto&gt; não está cadastrada&#39;
  Return
End
/* Domínio de: Categoria do Aeroporto */
/* 1 - Não se aplica */
/* 2 - 1ª Categoria */
/* 3 - 2ª Categoria */
/* 4 - 3ª Categoria */
/* 5 - 4ª Categoria */
If (Select Count(*) From Inserted
    Where TP_AER_CTG In (1,2,3,4,5))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Categoria do Aeroporto&gt; que se deseja incluir na tabela &lt;Aeroporto&gt; não é uma opção válida&#39;
  Return
End
/* Regra de negócio */
/* Verificar se já existe algum Aeroporto com a sigla IATA do Aeroporto que se está incluindo */
IF (	SELECT	COUNT(*)
	FROM	T_AER AER, 
		INSERTED INS
	WHERE	AER.CD_AER &lt;&gt; INS.CD_AER AND
		AER.SG_AER_IAT = INS.SG_AER_IAT AND
		INS.SG_AER_IAT IS NOT NULL) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Já existe um Aeroporto cadastrado com esta sigla IATA.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o79">
<a:ObjectID>6958A4F7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_AER_TRU</a:Name>
<a:Code>T_AER_TRU</a:Code>
<a:Text>Create Trigger T_AER_TRU On T_AER
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_AER)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Aeroporto&gt; da tabela &lt;Aeroporto&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_CID)
/* Cidade»Aeroporto: Cidade possui Aeroportos */
If (Select Count(*) From T_CID, Inserted
Where T_CID.CD_CID = Inserted.CD_CID)
 &lt;&gt;(Select Count(CD_CID) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Cidade&gt; que se deseja incluir na tabela &lt;Aeroporto&gt; não está cadastrada&#39;
  Return
End
If Update (TP_AER_CTG)
/* Domínio de: Categoria do Aeroporto */
/* 1 - Não se aplica */
/* 2 - 1ª Categoria */
/* 3 - 2ª Categoria */
/* 4 - 3ª Categoria */
/* 5 - 4ª Categoria */
If (Select Count(*) From Inserted
    Where TP_AER_CTG In (1,2,3,4,5))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Categoria do Aeroporto&gt; que se deseja incluir na tabela &lt;Aeroporto&gt; não é uma opção válida&#39;
  Return
End
/* Regra de negócio */
/* Verificar se já existe algum Aeroporto cadastrado com a sigla IATA do Aeroporto que se está alterando */
IF (	SELECT	COUNT(*)
	FROM	T_AER AER, 
		INSERTED INS
	WHERE	AER.CD_AER &lt;&gt; INS.CD_AER AND
		AER.SG_AER_IAT = INS.SG_AER_IAT AND
		INS.SG_AER_IAT IS NOT NULL) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Já existe um Aeroporto cadastrado com esta sigla IATA.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Caso a sigla ICAO do aeroporto seja alterada, alterar os campos SG_AER_DES E SG_AER_ORI da tabela T_HET */
IF UPDATE(SG_AER_ICA)
BEGIN
	UPDATE	HET
	SET	SG_AER_DES = INS.SG_AER_ICA
	FROM	T_HET HET, INSERTED INS, DELETED DEL
	WHERE	INS.CD_AER = DEL.CD_AER AND
		HET.SG_AER_DES = DEL.SG_AER_ICA

	UPDATE	HET
	SET	SG_AER_ORI = INS.SG_AER_ICA
	FROM	T_HET HET, INSERTED INS, DELETED DEL
	WHERE	INS.CD_AER = DEL.CD_AER AND
		HET.SG_AER_ORI = DEL.SG_AER_ICA
END

IF UPDATE(SG_AER_ICA) OR UPDATE(SG_AER_IAT)
BEGIN
	/* Incluir registros em T_ACH */
	INSERT	T_ACH (DH_ACH, CD_CHG)
	Select	GETDATE(), ECC.CD_CHG
	From	T_ECC001 ECC, T_AER AER, INSERTED INS
	Where	ECC.CD_CHG IN (	Select 	CD_CHG
				From 	T_CHG CHG
				Where	CHG.TP_CHG_STA = 1 And
					CHG.CD_AER = (Select CD_AER From T_PSI)) AND
		AER.CD_AER = ECC.CD_AER AND
		AER.CD_AER = INS.CD_AER

	/* Incluir registros em T_APA */
	INSERT	T_APA (DH_APA, CD_PAR)
	Select	GETDATE(), ECP.CD_PAR
	From	T_ECP001 ECP, T_AER AER, INSERTED INS
	Where	ECP.CD_PAR IN (	Select 	CD_PAR
				From 	T_PAR PAR
				Where	PAR.TP_PAR_STA = 1 And
					PAR.CD_AER = (Select CD_AER From T_PSI)) AND
		AER.CD_AER = ECP.CD_AER AND
		AER.CD_AER = INS.CD_AER
END

IF UPDATE(SG_AER_IAT)
BEGIN
	/* Incluir registros em T_AHO */
	INSERT	T_AHO (CD_HOT, DH_AHO)
	Select	DISTINCT CD_HOT, GETDATE()
	From	T_HET HET, INSERTED INS
	Where	HET.SG_AER_ORI = INS.SG_AER_ICA OR
		HET.SG_AER_DES = INS.SG_AER_ICA

	-- Alexei alterou em 05/01/00
	-- Não permitir a alteração da sigla IATA para NULO se o aeroporto estiver em alguma etapa de hotran
	IF (	Select	Count(*)
		from	T_Het Het
		,	Inserted Ins
		where	(Het.SG_AER_ORI = Ins.SG_AER_ICA
		or	Het.SG_AER_DES = Ins.SG_AER_ICA)
		and	Ins.SG_AER_IAT is NULL) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: O aeroporto não pode ter sigla IATA nula pois está sendo utilizado em etapa de hotran.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
	-- Fim Alteração Alexei em 05/01/00

END
End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o74"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o80">
<a:ObjectID>6958A561-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_2</a:Name>
<a:Code>REFERENCE_2</a:Code>
<a:CreationDate>1081538799</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538799</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o64"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o7"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o74"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o81">
<a:ObjectID>6958A564-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538799</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538799</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o65"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o10"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o82">
<a:CenterTextOffset>(4, 0)</a:CenterTextOffset>
<a:Rect>((-741214,674927), (-733490,685116))</a:Rect>
<a:ListOfPoints>((-737350,685116),(-737366,674927))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>12615680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Id="o83">
<a:Rect>((-741836,682961), (-733820,687507))</a:Rect>
<a:LineColor>12615680</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o84">
<a:ObjectID>6958A5BD-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_ECC001</a:Name>
<a:Code>T_ECC001</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o85">
<a:ObjectID>6958A4EA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_CHG</a:Name>
<a:Code>CD_CHG</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o86">
<a:ObjectID>6958A4EB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_ECC</a:Name>
<a:Code>CD_ECC</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o87">
<a:ObjectID>6958A4EC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_AER</a:Name>
<a:Code>CD_AER</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o88">
<a:ObjectID>6958A4ED-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o89">
<a:ObjectID>6958A4F0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_ECC001</a:Name>
<a:Code>Pk_T_ECC001</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_ECC001</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o85"/>
<o:Column Ref="o86"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Owner>
<o:User Ref="o59"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o90">
<a:ObjectID>6958A543-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_ECC001_TRD</a:Name>
<a:Code>T_ECC001_TRD</a:Code>
<a:Text>Create Trigger T_ECC001_TRD On T_ECC001
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Regra de negócio */
-- INCLUIR REGISTROS EM T_ACH
-- Alexei 12/12/00
INSERT	T_ACH (DH_ACH, CD_CHG)
SELECT GETDATE(), CD_CHG FROM DELETED group by CD_CHG

End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o91">
<a:ObjectID>6958A545-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_ECC001_TRI</a:Name>
<a:Code>T_ECC001_TRI</a:Code>
<a:Text>Create Trigger T_ECC001_TRI On T_ECC001
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Aeroporto»Escala da Chegada de Vôo: Aeroporto integra ECC */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Escala da Chegada de Vôo&gt; não está cadastrada&#39;
  Return
End
/* Chegadas»Escala da Chegada de Vôo: Escalas de Chegada */
If (Select Count(*) From T_CHG, Inserted
Where T_CHG.CD_CHG = Inserted.CD_CHG)
 &lt;&gt;(Select Count(CD_CHG) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Chegadas&gt; que se deseja incluir na tabela &lt;Escala da Chegada de Vôo&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
-- INCLUIR REGISTROS EM T_ACH
-- Alexei 12/12/00
INSERT	T_ACH (DH_ACH, CD_CHG)
SELECT GETDATE(), CD_CHG FROM INSERTED group by CD_CHG

End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o92">
<a:ObjectID>6958A548-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_ECC001_TRU</a:Name>
<a:Code>T_ECC001_TRU</a:Code>
<a:Text>Create Trigger T_ECC001_TRU On T_ECC001
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_CHG)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do  Vôo de Chegada&gt; da tabela &lt;Escala da Chegada de Vôo&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_AER)
/* Aeroporto»Escala da Chegada de Vôo: Aeroporto integra ECC */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Escala da Chegada de Vôo&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
-- INCLUIR REGISTROS EM T_ACH
-- Alexei 12/12/00
INSERT	T_ACH (DH_ACH, CD_CHG)
SELECT GETDATE(), CD_CHG FROM INSERTED group by CD_CHG

End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o89"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o63"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o93">
<a:ObjectID>6958A567-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_3</a:Name>
<a:Code>REFERENCE_3</a:Code>
<a:CreationDate>1081538799</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538799</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o64"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o84"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o74"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o94">
<a:ObjectID>6958A569-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538799</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538799</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o65"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o87"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o95">
<a:Rect>((-738121,685550), (-719424,695648))</a:Rect>
<a:ListOfPoints>((-719424,685550),(-738121,695648))</a:ListOfPoints>
<a:ArrowStyle>4881</a:ArrowStyle>
<a:LineColor>12615680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o6"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o96">
<a:Rect>((-741682,693185), (-734978,697731))</a:Rect>
<a:LineColor>12615680</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o97">
<a:ObjectID>6958A5A4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_BOX</a:Name>
<a:Code>T_BOX</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081691297</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o98">
<a:ObjectID>6958A59E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_BOX</a:Name>
<a:Code>CD_BOX</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o99">
<a:ObjectID>6958A5A0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_BOX</a:Name>
<a:Code>NR_BOX</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(4)</a:DataType>
<a:Length>4</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o100">
<a:ObjectID>6958A5A1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_BOX</a:Name>
<a:Code>TP_BOX</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o101">
<a:ObjectID>6958A5A2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_BOX_PES</a:Name>
<a:Code>QT_BOX_PES</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_ZRO    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_ZRO As
0</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o102">
<a:ObjectID>6958A5A3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_BOX_CON</a:Name>
<a:Code>FL_BOX_CON</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_ZRO    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_ZRO As
0</a:DefaultValue>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o103">
<a:ObjectID>6958A5A5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_BOX_PAX</a:Name>
<a:Code>FL_BOX_PAX</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o104">
<a:ObjectID>6958A5A6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_BOX_CRG</a:Name>
<a:Code>FL_BOX_CRG</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o105">
<a:ObjectID>6958A5A7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_DOM</a:Name>
<a:Code>FT_BOX_DOM</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o106">
<a:ObjectID>6958A5A9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_INT</a:Name>
<a:Code>FT_BOX_INT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o107">
<a:ObjectID>6958A5AA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_REG</a:Name>
<a:Code>FT_BOX_REG</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o108">
<a:ObjectID>6958A5AC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_PAX</a:Name>
<a:Code>FT_BOX_PAX</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o109">
<a:ObjectID>6958A5AD-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_CRG</a:Name>
<a:Code>FT_BOX_CRG</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o110">
<a:ObjectID>6958A5AF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_MIS</a:Name>
<a:Code>FT_BOX_MIS</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o111">
<a:ObjectID>6958A5B1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_TSL</a:Name>
<a:Code>FT_BOX_TSL</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o112">
<a:ObjectID>6958A5B2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_RGL</a:Name>
<a:Code>FT_BOX_RGL</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o113">
<a:ObjectID>6958A5B4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_CHT</a:Name>
<a:Code>FT_BOX_CHT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o114">
<a:ObjectID>6958A5B6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_TEC</a:Name>
<a:Code>FT_BOX_TEC</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o115">
<a:ObjectID>6958A5B8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_AVG</a:Name>
<a:Code>FT_BOX_AVG</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o116">
<a:ObjectID>6958A5BA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_MLT</a:Name>
<a:Code>FT_BOX_MLT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o117">
<a:ObjectID>6958A5BB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_NRG</a:Name>
<a:Code>FT_BOX_NRG</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o118">
<a:ObjectID>6958A5BC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_TXA</a:Name>
<a:Code>FT_BOX_TXA</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o119">
<a:ObjectID>6958A5BE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o120">
<a:ObjectID>6958A5C7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_BOX</a:Name>
<a:Code>Pk_T_BOX</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_BOX</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o98"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o121">
<a:ObjectID>6958A5BF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_BOX_AER</a:Name>
<a:Code>I_BOX_AER</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081691297</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o122">
<a:ObjectID>6958A5C0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o99"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o123">
<a:ObjectID>6958A5C2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_AER</a:Name>
<a:Code>I_AER</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081691297</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
</o:Index>
<o:Index Id="o124">
<a:ObjectID>6958A5C5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_BOX_TP</a:Name>
<a:Code>I_BOX_TP</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o125">
<a:ObjectID>6958A5C6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o100"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Ref="o59"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o126">
<a:ObjectID>6958A50A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_BOX_TRD</a:Name>
<a:Code>T_BOX_TRD</a:Code>
<a:Text>Create Trigger T_BOX_TRD On T_BOX
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Box»Chegadas - Mirror: Box da Chegada (Restrict) */
If (Select Count(*) From T_CHG_MIR dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Box&gt; está sendo referenciada na tabela &lt;Chegadas - Mirror&gt;&#39;
  Return
End
/* Box»Chegadas: Box da Chegada (Restrict) */
If (Select Count(*) From T_CHG dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Box&gt; está sendo referenciada na tabela &lt;Chegadas&gt;&#39;
  Return
End
/* Box»Hotran - Boxes: Box do Hotran (Restrict) */
If (Select Count(*) From T_HBX001 dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Box&gt; está sendo referenciada na tabela &lt;Hotran - Boxes&gt;&#39;
  Return
End
/* Box»Histórico de Permanência de Aeronaves - Mirror: Box do HPA (Restrict) */
If (Select Count(*) From T_HPA001_MIR dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Box&gt; está sendo referenciada na tabela &lt;Histórico de Permanência de Aeronaves - Mirror&gt;&#39;
  Return
End
/* Box»Histórico de Permanência de Aeronaves: Box do HPA (Restrict) */
If (Select Count(*) From T_HPA001 dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Box&gt; está sendo referenciada na tabela &lt;Histórico de Permanência de Aeronaves&gt;&#39;
  Return
End
/* Box»Boxes da Companhia Aérea: Boxes da Companhia Aérea (Restrict) */
If (Select Count(*) From T_BCO dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Box&gt; está sendo referenciada na tabela &lt;Boxes da Companhia Aérea&gt;&#39;
  Return
End
/* Box»Boxes do Equipamento: Boxes do Equipamento (Restrict) */
If (Select Count(*) From T_BEQ dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Box&gt; está sendo referenciada na tabela &lt;Boxes do Equipamento&gt;&#39;
  Return
End
/* Box»Hotran - Frequência: É Box da Frequencia (Restrict) */
If (Select Count(*) From T_HFR dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Box&gt; está sendo referenciada na tabela &lt;Hotran - Frequência&gt;&#39;
  Return
End
/* Box»Capacidades do Box: Box da Capacidade do Box (Cascade) */
Delete T_BCP From T_BCP dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX
/* Box»Hotran - Box x Vôo: Boxes do BOX x VÔO (Cascade) */
Delete T_HBV From T_HBV dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX
/* Box»Boxes Indisponíveis: Indisponibilidade de Box (Cascade) */
Delete T_BIN From T_BIN dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX
End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o127">
<a:ObjectID>6958A50D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_BOX_TRI</a:Name>
<a:Code>T_BOX_TRI</a:Code>
<a:Text>Create Trigger T_BOX_TRI On T_BOX
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Aeroporto»Box: Aeroporto possui Boxes */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Box&gt; não está cadastrada&#39;
  Return
End
/* Domínio de: Tipo de Box */
/* 1 - Estadia */
/* 2 - Isento */
/* 3 - Pátio */
/* 9 - Controle */
If (Select Count(*) From Inserted
    Where TP_BOX In (1,2,3,9))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Tipo de Box&gt; que se deseja incluir na tabela &lt;Box&gt; não é uma opção válida&#39;
  Return
End
/* Regra de negócio */
/* Não pode existir mais de um box do tipo Controle (9) */
IF (	SELECT 	COUNT(*) 
	FROM 	T_BOX BOX,
		INSERTED INS
	WHERE 	BOX.CD_AER = INS.CD_AER AND
		INS.TP_BOX = 9 AND 
		BOX.TP_BOX = 9) &gt; 1
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Só pode existir um único box do tipo &lt;Controle&gt;.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o128">
<a:ObjectID>6958A50F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_BOX_TRU</a:Name>
<a:Code>T_BOX_TRU</a:Code>
<a:Text>Create Trigger T_BOX_TRU On T_BOX
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_BOX)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Box&gt; da tabela &lt;Box&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_AER)
/* Aeroporto»Box: Aeroporto possui Boxes */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Box&gt; não está cadastrada&#39;
  Return
End
If Update (TP_BOX)
/* Domínio de: Tipo de Box */
/* 1 - Estadia */
/* 2 - Isento */
/* 3 - Pátio */
/* 9 - Controle */
If (Select Count(*) From Inserted
    Where TP_BOX In (1,2,3,9))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Tipo de Box&gt; que se deseja incluir na tabela &lt;Box&gt; não é uma opção válida&#39;
  Return
End
/* Regra de negócio */
/* Não pode existir mais de um box do tipo Controle (9) */
IF (	SELECT 	COUNT(*) 
	FROM 	T_BOX BOX,
		INSERTED INS
	WHERE 	BOX.CD_AER = INS.CD_AER AND
		INS.TP_BOX = 9 AND 
		BOX.TP_BOX = 9) &gt; 1
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Só pode existir um único box do tipo &lt;Controle&gt;.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

IF UPDATE(NR_BOX)
BEGIN
	/* Incluir Registros em T_ACH */
	INSERT	T_ACH (DH_ACH, CD_CHG)
	Select 	GETDATE(), CHG.CD_CHG
	From 	T_CHG CHG, T_HPA001 HPA, INSERTED INS
	Where 	CHG.TP_CHG_STA = 1 AND
		CHG.CD_AER = (Select CD_AER From T_PSI) AND
		CHG.CD_CHG = HPA.CD_CHG AND
		HPA.NR_HPA_SEQ = 1 AND
		HPA.CD_BOX = INS.CD_BOX

	/* Incluir Registros em T_APA */
	INSERT	T_APA (DH_APA, CD_PAR)
	Select 	GETDATE(), PAR.CD_PAR
	From 	T_PAR PAR, T_HPA001 HPA, INSERTED INS
	Where 	PAR.TP_PAR_STA = 1 AND
		PAR.CD_AER = (Select CD_AER From T_PSI) AND
		PAR.CD_PAR = HPA.CD_PAR AND
		HPA.NR_HPA_SEQ = (SELECT MAX(NR_HPA_SEQ) FROM T_HPA001 WHERE CD_HPA = HPA.CD_HPA) AND
		HPA.CD_BOX = INS.CD_BOX

	/* Incluir Registros em T_AHO */
	INSERT	T_AHO (CD_HOT, DH_AHO)
	Select	DISTINCT CD_HOT, GETDATE()
	From	T_HFR HFR, INSERTED INS
	Where	HFR.CD_BOX = INS.CD_BOX
END

IF UPDATE(NR_BOX) OR UPDATE(TP_BOX)
BEGIN
	/* Incluir Registros em T_AHP */
	INSERT	T_AHP (CD_HPA, DH_AHP)
	Select	DISTINCT CD_HPA, GETDATE()
	From	T_HPA001 HPA, T_CHG CHG, T_SIT SIT, INSERTED INS
	Where	HPA.CD_CHG = CHG.CD_CHG AND
		SIT.CD_SIT = CHG.CD_SIT AND
		HPA.CD_AER = (Select CD_AER From T_PSI) AND
		(HPA.FL_HPA_ENT = 1 OR SIT.FL_SIT_AEN_PAT = 1) AND
		HPA.FL_HPA_SAI = 0 AND 
		HPA.CD_AEN IS NOT NULL AND
		HPA.CD_BOX = INS.CD_BOX
END

End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o120"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o129">
<a:ObjectID>6958A56C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_5</a:Name>
<a:Code>REFERENCE_5</a:Code>
<a:CreationDate>1081538799</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538799</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o97"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o7"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o120"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o130">
<a:ObjectID>6958A56D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538799</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538799</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o98"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o23"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o131">
<a:CenterTextOffset>(4, 0)</a:CenterTextOffset>
<a:Rect>((-737578,684191), (-717924,685450))</a:Rect>
<a:ListOfPoints>((-737578,685424),(-717924,685450))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>12615680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o83"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o6"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o132">
<a:ObjectID>6958A56F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_6</a:Name>
<a:Code>REFERENCE_6</a:Code>
<a:CreationDate>1081538799</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538799</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o7"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o84"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o39"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o133">
<a:ObjectID>6958A571-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538799</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538799</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o8"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o85"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o134">
<a:CenterTextOffset>(300, 1500)</a:CenterTextOffset>
<a:Rect>((-734427,652107), (-718224,686125))</a:Rect>
<a:ListOfPoints>((-734427,652107),(-718224,686125))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>12615680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Id="o135">
<a:Rect>((-741121,649335), (-733105,653881))</a:Rect>
<a:LineColor>12615680</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o136">
<a:ObjectID>6958A5C4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_ESV001</a:Name>
<a:Code>T_ESV001</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o137">
<a:ObjectID>6958A512-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_CHG</a:Name>
<a:Code>CD_CHG</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o138">
<a:ObjectID>6958A513-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_EST</a:Name>
<a:Code>CD_EST</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o139">
<a:ObjectID>6958A517-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_ESV001</a:Name>
<a:Code>Pk_T_ESV001</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_ESV001</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o137"/>
<o:Column Ref="o138"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Owner>
<o:User Ref="o59"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o140">
<a:ObjectID>6958A568-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_ESV001_TRD</a:Name>
<a:Code>T_ESV001_TRD</a:Code>
<a:Text>Create Trigger T_ESV001_TRD On T_ESV001
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Regra de negócio */
/* Se nada tiver sido excluído, retornar */

/* Deletar esteiras dos vôos vinculados */
DELETE	T_ESV001
FROM	T_ESV001 ESV,
	T_CHG CHGVIN,
	DELETED DEL
WHERE	CHGVIN.CD_CHG_VIN = DEL.CD_CHG AND
	ESV.CD_CHG = CHGVIN.CD_CHG AND
	ESV.CD_EST = DEL.CD_EST

/* INCLUIR REGISTROS EM T_ACH */
INSERT	T_ACH (DH_ACH, CD_CHG)
SELECT GETDATE(), CD_CHG FROM DELETED

/* Incluir Registros em T_AHP */
INSERT	T_AHP (CD_HPA, DH_AHP)
Select	DISTINCT CD_HPA, GETDATE()
From	T_HPA001 HPA, T_CHG CHG, T_SIT SIT, DELETED DEL
Where	HPA.CD_CHG = CHG.CD_CHG AND
	SIT.CD_SIT = CHG.CD_SIT AND
	HPA.CD_AER = (Select CD_AER From T_PSI) AND
	(HPA.FL_HPA_ENT = 1 OR SIT.FL_SIT_AEN_PAT = 1) AND
	HPA.FL_HPA_SAI = 0 AND
	HPA.CD_AEN IS NOT NULL AND
	HPA.CD_CHG = DEL.CD_CHG

End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o141">
<a:ObjectID>6958A56A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_ESV001_TRI</a:Name>
<a:Code>T_ESV001_TRI</a:Code>
<a:Text>Create Trigger T_ESV001_TRI On T_ESV001
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Esteira»Esteira da Chegada de Vôo: Esteira integra ESV */
If (Select Count(*) From T_EST, Inserted
Where T_EST.CD_EST = Inserted.CD_EST)
 &lt;&gt;(Select Count(CD_EST) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Esteira&gt; que se deseja incluir na tabela &lt;Esteira da Chegada de Vôo&gt; não está cadastrada&#39;
  Return
End
/* Chegadas»Esteira da Chegada de Vôo: Esteiras de Chegada */
If (Select Count(*) From T_CHG, Inserted
Where T_CHG.CD_CHG = Inserted.CD_CHG)
 &lt;&gt;(Select Count(CD_CHG) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Chegadas&gt; que se deseja incluir na tabela &lt;Esteira da Chegada de Vôo&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
/* RESTRIÇÕES */

/* Verificar se há vôos com Esteiras de mais de uma Sala de Desembarque */
IF (	SELECT 	COUNT(*) 
	FROM 	INSERTED INS 
	WHERE 	EXISTS (	SELECT 	*
			FROM 	T_ESV001 ESV, T_EST EST
			WHERE	ESV.CD_CHG = INS.CD_CHG AND
				EST.CD_EST = ESV.CD_EST
			GROUP BY ESV.CD_CHG
			HAVING	COUNT(DISTINCT EST.CD_SAL) &gt; 1)) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: Um vôo não pode estar associado a esteiras de salas de desembarque diferentes.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Inserir, nos vôos vinculados, todas  esteiras inseridas */
INSERT	T_ESV001 (CD_CHG, CD_EST)
SELECT	CHGVIN.CD_CHG, INS.CD_EST
FROM	T_CHG CHG,
	T_CHG CHGVIN,
	INSERTED INS
WHERE	CHG.CD_CHG = INS.CD_CHG AND
	CHGVIN.CD_CHG_VIN = INS.CD_CHG

/* INCLUIR REGISTROS EM T_ACH */
INSERT	T_ACH (DH_ACH, CD_CHG)
SELECT GETDATE(), CD_CHG FROM INSERTED

/* Incluir Registros em T_AHP */
INSERT	T_AHP (CD_HPA, DH_AHP)
Select	DISTINCT CD_HPA, GETDATE()
From	T_HPA001 HPA, T_CHG CHG, T_SIT SIT, INSERTED INS
Where	HPA.CD_CHG = CHG.CD_CHG AND
	SIT.CD_SIT = CHG.CD_SIT AND
	HPA.CD_AER = (Select CD_AER From T_PSI) AND
	(HPA.FL_HPA_ENT = 1 OR SIT.FL_SIT_AEN_PAT = 1) AND
	HPA.FL_HPA_SAI = 0 AND
	HPA.CD_AEN IS NOT NULL AND
	HPA.CD_CHG = INS.CD_CHG

End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o142">
<a:ObjectID>6958A56B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_ESV001_TRU</a:Name>
<a:Code>T_ESV001_TRU</a:Code>
<a:Text>Create Trigger T_ESV001_TRU On T_ESV001
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_CHG)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do  Vôo de Chegada&gt; da tabela &lt;Esteira da Chegada de Vôo&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_EST)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código da Esteira&gt; da tabela &lt;Esteira da Chegada de Vôo&gt; não pode ser alterada.&#39;
  Return
End
/* Regra de negócio */
/* INCLUIR REGISTROS EM T_ACH */
INSERT	T_ACH (DH_ACH, CD_CHG)
SELECT GETDATE(), CD_CHG FROM INSERTED

/* Incluir Registros em T_AHP */
INSERT	T_AHP (CD_HPA, DH_AHP)
Select	DISTINCT CD_HPA, GETDATE()
From	T_HPA001 HPA, T_CHG CHG, T_SIT SIT, INSERTED INS
Where	HPA.CD_CHG = CHG.CD_CHG AND
	SIT.CD_SIT = CHG.CD_SIT AND
	HPA.CD_AER = (Select CD_AER From T_PSI) AND
	(HPA.FL_HPA_ENT = 1 OR SIT.FL_SIT_AEN_PAT = 1) AND
	HPA.FL_HPA_SAI = 0 AND
	HPA.CD_AEN IS NOT NULL AND
	HPA.CD_CHG = INS.CD_CHG

End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o139"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o6"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o143">
<a:ObjectID>6958A573-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_7</a:Name>
<a:Code>REFERENCE_7</a:Code>
<a:CreationDate>1081538799</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538799</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o7"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o136"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o39"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o144">
<a:ObjectID>6958A575-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538799</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538799</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o8"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o137"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o145">
<a:CenterTextOffset>(4, 0)</a:CenterTextOffset>
<a:Rect>((-715708,652300), (-697936,686425))</a:Rect>
<a:ListOfPoints>((-697936,652300),(-715708,686425))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>12615680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Id="o146">
<a:Rect>((-702209,649339), (-695583,653885))</a:Rect>
<a:LineColor>12615680</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o147">
<a:ObjectID>6958A5EE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HSC</a:Name>
<a:Code>T_HSC</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o148">
<a:ObjectID>6958A518-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DH_HSC</a:Name>
<a:Code>DH_HSC</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>datetime</a:DataType>
</o:Column>
<o:Column Id="o149">
<a:ObjectID>6958A519-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_CHG</a:Name>
<a:Code>CD_CHG</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o150">
<a:ObjectID>6958A51B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_IFT</a:Name>
<a:Code>CD_IFT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o151">
<a:ObjectID>6958A51D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_SIT</a:Name>
<a:Code>CD_SIT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o152">
<a:ObjectID>6958A51E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DH_HSC_CHG</a:Name>
<a:Code>DH_HSC_CHG</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>smalldatetime</a:DataType>
</o:Column>
<o:Column Id="o153">
<a:ObjectID>6958A51F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_USR</a:Name>
<a:Code>CD_USR</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o154">
<a:ObjectID>6958A520-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_HSC_USR</a:Name>
<a:Code>NM_HSC_USR</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>varchar(30)</a:DataType>
<a:Length>30</a:Length>
</o:Column>
</c:Columns>
<c:Indexes>
<o:Index Id="o155">
<a:ObjectID>6958A521-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_HSC</a:Name>
<a:Code>I_HSC</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>with fillfactor= 90</a:PhysicalOptions>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o156">
<a:ObjectID>6958A522-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o148"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o157">
<a:ObjectID>6958A523-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_1&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o149"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o158">
<a:ObjectID>6958A524-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_HSC_CHG</a:Name>
<a:Code>I_HSC_CHG</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o159">
<a:ObjectID>6958A525-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o149"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Ref="o59"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o160">
<a:ObjectID>6958A5E5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HSC_TRD</a:Name>
<a:Code>T_HSC_TRD</a:Code>
<a:Text>Create Trigger T_HSC_TRD On T_HSC
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Regra de negócio */
/* Não permitir a deleção de vôos que tenham mais de um histórico de situação
    (Fazer a checagem somente se esse vôo não existir mais na tabela T_CHG) */
IF (	SELECT 	COUNT(*)
	FROM	DELETED DEL
	WHERE	EXISTS (SELECT CD_CHG FROM T_CHG WHERE CD_CHG = DEL.CD_CHG)) = 0
BEGIN
	IF (	SELECT	COUNT(*) 
		FROM 	DELETED DEL
		WHERE	EXISTS	(SELECT	COUNT(*)
				FROM	DELETED
				GROUP BY CD_CHG
				HAVING 	CD_CHG = DEL.CD_CHG AND
					COUNT(*) &gt; 1)) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: Este vôo já possui movimentação de situação e não pode ser excluído.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END

END
End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o161">
<a:ObjectID>6958A5E6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HSC_TRI</a:Name>
<a:Code>T_HSC_TRI</a:Code>
<a:Text>Create Trigger T_HSC_TRI On T_HSC
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Situação»Histórico de Situação de Vôo de Chegada: Situação do HSC */
If (Select Count(*) From T_SIT, Inserted
Where T_SIT.CD_SIT = Inserted.CD_SIT)
 &lt;&gt;(Select Count(CD_SIT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Situação&gt; que se deseja incluir na tabela &lt;Histórico de Situação de Vôo de Chegada&gt; não está cadastrada&#39;
  Return
End
/* Informante da Situação de Vôo»Histórico de Situação de Vôo de Chegada: Informante do HSC */
If (Select Count(*) From T_IFT, Inserted
Where T_IFT.CD_IFT = Inserted.CD_IFT)
 &lt;&gt;(Select Count(CD_IFT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Informante da Situação de Vôo&gt; que se deseja incluir na tabela &lt;Histórico de Situação de Vôo de Chegada&gt; não está cadastrada&#39;
  Return
End
/* Chegadas»Histórico de Situação de Vôo de Chegada: Chegada do HSC */
If (Select Count(*) From T_CHG, Inserted
Where T_CHG.CD_CHG = Inserted.CD_CHG)
 &lt;&gt;(Select Count(CD_CHG) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Chegadas&gt; que se deseja incluir na tabela &lt;Histórico de Situação de Vôo de Chegada&gt; não está cadastrada&#39;
  Return
End
/* Usuários»Histórico de Situação de Vôo de Chegada: Usuário logado */
If (Select Count(*) From T_USR, Inserted
Where T_USR.CD_USR = Inserted.CD_USR)
 &lt;&gt;(Select Count(CD_USR) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Usuários&gt; que se deseja incluir na tabela &lt;Histórico de Situação de Vôo de Chegada&gt; não está cadastrada&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o162">
<a:ObjectID>6958A5E7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HSC_TRU</a:Name>
<a:Code>T_HSC_TRU</a:Code>
<a:Text>Create Trigger T_HSC_TRU On T_HSC
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_SIT)
/* Situação»Histórico de Situação de Vôo de Chegada: Situação do HSC */
If (Select Count(*) From T_SIT, Inserted
Where T_SIT.CD_SIT = Inserted.CD_SIT)
 &lt;&gt;(Select Count(CD_SIT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Situação&gt; que se deseja incluir na tabela &lt;Histórico de Situação de Vôo de Chegada&gt; não está cadastrada&#39;
  Return
End
If Update (CD_IFT)
/* Informante da Situação de Vôo»Histórico de Situação de Vôo de Chegada: Informante do HSC */
If (Select Count(*) From T_IFT, Inserted
Where T_IFT.CD_IFT = Inserted.CD_IFT)
 &lt;&gt;(Select Count(CD_IFT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Informante da Situação de Vôo&gt; que se deseja incluir na tabela &lt;Histórico de Situação de Vôo de Chegada&gt; não está cadastrada&#39;
  Return
End
If Update (CD_CHG)
/* Chegadas»Histórico de Situação de Vôo de Chegada: Chegada do HSC */
If (Select Count(*) From T_CHG, Inserted
Where T_CHG.CD_CHG = Inserted.CD_CHG)
 &lt;&gt;(Select Count(CD_CHG) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Chegadas&gt; que se deseja incluir na tabela &lt;Histórico de Situação de Vôo de Chegada&gt; não está cadastrada&#39;
  Return
End
If Update (CD_USR)
/* Usuários»Histórico de Situação de Vôo de Chegada: Usuário logado */
If (Select Count(*) From T_USR, Inserted
Where T_USR.CD_USR = Inserted.CD_USR)
 &lt;&gt;(Select Count(CD_USR) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Usuários&gt; que se deseja incluir na tabela &lt;Histórico de Situação de Vôo de Chegada&gt; não está cadastrada&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:ClusterObject>
<o:Index Ref="o155"/>
</c:ClusterObject>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o6"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o163">
<a:ObjectID>6958A576-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_8</a:Name>
<a:Code>REFERENCE_8</a:Code>
<a:CreationDate>1081538799</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538799</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o7"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o147"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o39"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o164">
<a:ObjectID>6958A577-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538799</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538799</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o8"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o149"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o165">
<a:CenterTextOffset>(5, 0)</a:CenterTextOffset>
<a:Rect>((-717233,687166), (-709059,720703))</a:Rect>
<a:ListOfPoints>((-716624,687166),(-709426,720703))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>12615680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o6"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o166">
<a:Rect>((-713069,718240), (-706211,722786))</a:Rect>
<a:LineColor>12615680</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o167">
<a:ObjectID>6958A5B7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_COM</a:Name>
<a:Code>T_COM</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o168">
<a:ObjectID>6958A603-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_COM</a:Name>
<a:Code>CD_COM</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o169">
<a:ObjectID>6958A604-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_COM</a:Name>
<a:Code>NM_COM</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(30)</a:DataType>
<a:Length>30</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o170">
<a:ObjectID>6958A605-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SG_COM_IAT_003</a:Name>
<a:Code>SG_COM_IAT_003</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(3)</a:DataType>
<a:Length>3</a:Length>
</o:Column>
<o:Column Id="o171">
<a:ObjectID>6958A606-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SG_COM_IAT_002</a:Name>
<a:Code>SG_COM_IAT_002</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(2)</a:DataType>
<a:Length>2</a:Length>
</o:Column>
<o:Column Id="o172">
<a:ObjectID>6958A607-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_COM_GR1</a:Name>
<a:Code>FL_COM_GR1</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o173">
<a:ObjectID>6958A608-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_COM_GR2</a:Name>
<a:Code>FL_COM_GR2</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o174">
<a:ObjectID>6958A609-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_COM_TAR_RED</a:Name>
<a:Code>FL_COM_TAR_RED</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o175">
<a:ObjectID>6958A60A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_COM_MAT</a:Name>
<a:Code>CD_COM_MAT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o176">
<a:ObjectID>6958A60B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o177">
<a:ObjectID>6958A4D5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_COM</a:Name>
<a:Code>Pk_T_COM</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_COM</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o168"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o178">
<a:ObjectID>6958A60C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_COM_GR1</a:Name>
<a:Code>I_COM_GR1</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o179">
<a:ObjectID>6958A60E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o172"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o180">
<a:ObjectID>6958A610-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_COM_GR2</a:Name>
<a:Code>I_COM_GR2</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o181">
<a:ObjectID>6958A612-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o173"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o182">
<a:ObjectID>6958A4CF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_COM_IAT_002</a:Name>
<a:Code>I_COM_IAT_002</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o183">
<a:ObjectID>6958A4D0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o171"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o184">
<a:ObjectID>6958A4D1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_COM_IAT_003</a:Name>
<a:Code>I_COM_IAT_003</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o185">
<a:ObjectID>6958A4D3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o170"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Ref="o59"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o186">
<a:ObjectID>6958A52D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_COM_TRD</a:Name>
<a:Code>T_COM_TRD</a:Code>
<a:Text>Create Trigger T_COM_TRD On T_COM
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Companhia Aérea»Chegadas: Comapanhia Aérea da Chegada (Restrict) */
If (Select Count(*) From T_CHG dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;Chegadas&gt;&#39;
  Return
End
/* Companhia Aérea»Chegadas - Mirror: Companhia Aérea da Chegada (Restrict) */
If (Select Count(*) From T_CHG_MIR dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;Chegadas - Mirror&gt;&#39;
  Return
End
/* Companhia Aérea»Partidas - Mirror: Companhia Aérea da Partida (Restrict) */
If (Select Count(*) From T_PAR_MIR dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;Partidas - Mirror&gt;&#39;
  Return
End
/* Companhia Aérea»Partidas: Companhia Aérea da Partida (Restrict) */
If (Select Count(*) From T_PAR dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;Partidas&gt;&#39;
  Return
End
/* Companhia Aérea»FIDS - IST Companhia: Companhia do ISC (Restrict) */
If (Select Count(*) From T_FIDS_ISC dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;FIDS - IST Companhia&gt;&#39;
  Return
End
/* Companhia Aérea»FIDS - Usuário do Grupo de Displays: DGT-COM:R (Restrict) */
If (Select Count(*) From T_FIDS_DGU dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;FIDS - Usuário do Grupo de Displays&gt;&#39;
  Return
End
/* Companhia Aérea»Hotran: É Companhia do Hotran (Restrict) */
If (Select Count(*) From T_HOT001 dep, Deleted pri
 Where dep.SG_COM = pri.SG_COM_IAT_003) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;Hotran&gt;&#39;
  Return
End
/* Companhia Aérea»Companhia Aérea: É Matriz de (Restrict) */
If (Select Count(*) From T_COM dep, Deleted pri
 Where dep.CD_COM_MAT = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;Companhia Aérea&gt;&#39;
  Return
End
/* Companhia Aérea»Informante da Situação de Vôo: possui (Restrict) */
If (Select Count(*) From T_IFT dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;Informante da Situação de Vôo&gt;&#39;
  Return
End
/* Companhia Aérea»Tarifas Pagas no Bilhete: Se Relaciona (Restrict) */
If (Select Count(*) From T_TFB001 dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;Tarifas Pagas no Bilhete&gt;&#39;
  Return
End
/* Companhia Aérea»Tarifas Pagas no Bilhete - Mirror: Se relaciona (Restrict) */
If (Select Count(*) From T_TFB001_MIR dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;Tarifas Pagas no Bilhete - Mirror&gt;&#39;
  Return
End
/* Companhia Aérea»Boxes da Companhia Aérea: Boxes da Companhia Aérea (Cascade) */
Delete T_BCO From T_BCO dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM
/* Companhia Aérea»Aeronave: Companh Aérea possui Aeronaves (Cascade) */
Delete T_AEN From T_AEN dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM
/* Companhia Aérea»Checkin: Companhia Aér. possui Checkins (Cascade) */
Delete T_CHK From T_CHK dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM
End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o187">
<a:ObjectID>6958A52F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_COM_TRI</a:Name>
<a:Code>T_COM_TRI</a:Code>
<a:Text>Create Trigger T_COM_TRI On T_COM
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Companhia Aérea»Companhia Aérea: É Matriz de */
If (Select Count(*) From T_COM, Inserted
Where T_COM.CD_COM = Inserted.CD_COM_MAT)
 &lt;&gt;(Select Count(CD_COM_MAT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Companhia Aérea&gt; que se deseja incluir na tabela &lt;Companhia Aérea&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
/* Verificar se há alguma situação que não seja do Grupo 1 nem do Grupo 2 */
IF (	SELECT	COUNT(*)
	FROM	INSERTED INS,
		T_COM COM
	WHERE	COM.CD_COM = INS.CD_COM AND
		INS.FL_COM_GR1 = 0 AND 
		INS.FL_COM_GR2 = 0) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Uma Companhia Aérea deve pertencer a pelo menos um Grupo .&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Verificar se quando a companhia for do Grupo 1, existe sigla IATA-3 */
IF (	SELECT	COUNT(*)
	FROM	INSERTED INS,
		T_COM COM
	WHERE	COM.CD_COM = INS.CD_COM AND
		INS.FL_COM_GR1 = 1 AND 
		INS.SG_COM_IAT_003 = &#39;&#39;) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Uma Companhia Aérea do Grupo 1 deve possuir sigla IATA-3.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Verificar se quando a companhia for do Grupo 1, existe sigla IATA-2 */
IF (	SELECT	COUNT(*)
	FROM	INSERTED INS,
		T_COM COM
	WHERE	COM.CD_COM = INS.CD_COM AND
		INS.FL_COM_GR1 = 1 AND 
		INS.SG_COM_IAT_002 = &#39;&#39;) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Uma Companhia Aérea do Grupo 1 deve possuir sigla IATA-2.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Verificar se já existe alguma companhia cadastrada com a sigla IATA-3 da companhia que se está incluindo */
IF (	SELECT	COUNT(*)
	FROM	T_COM COM, 
		INSERTED INS
	WHERE	COM.CD_COM &lt;&gt; INS.CD_COM AND
		COM.SG_COM_IAT_003 = INS.SG_COM_IAT_003 AND
		INS.SG_COM_IAT_003 &lt;&gt; &#39;&#39;) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Já existe uma Companhia Áerea cadastrada com esta sigla IATA-3.&#39;
	ROLLBACK TRANSACTION
	RETURN
END


/* Verificar se já existe alguma companhia cadastrada com a sigla IATA-2 da companhia que se está incluindo */
IF (	SELECT	COUNT(*)
	FROM	T_COM COM, 
		INSERTED INS
	WHERE	COM.CD_COM &lt;&gt; INS.CD_COM AND
		COM.SG_COM_IAT_002 = INS.SG_COM_IAT_002 AND
		INS.SG_COM_IAT_002 &lt;&gt; &#39;&#39;) &gt; 0
BEGIN 
	RAISERROR 20310 &#39;Operação não executada: Já existe uma Companhia Áerea cadastrada com esta sigla IATA-2.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o188">
<a:ObjectID>6958A531-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_COM_TRU</a:Name>
<a:Code>T_COM_TRU</a:Code>
<a:Text>Create Trigger T_COM_TRU On T_COM
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_COM)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código da Companhia Aérea&gt; da tabela &lt;Companhia Aérea&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_COM_MAT)
/* Companhia Aérea»Companhia Aérea: É Matriz de */
If (Select Count(*) From T_COM, Inserted
Where T_COM.CD_COM = Inserted.CD_COM_MAT)
 &lt;&gt;(Select Count(CD_COM_MAT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Companhia Aérea&gt; que se deseja incluir na tabela &lt;Companhia Aérea&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
/* Verificar se há alguma Companhia que não seja do Grupo 1 nem do Grupo 2 */
IF (	SELECT	COUNT(*)
	FROM	INSERTED
	WHERE	FL_COM_GR1 = 0 AND FL_COM_GR2 = 0) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Uma Companhia Aérea deve pertencer a pelo menos um Grupo.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Verificar se quando a companhia for do Grupo 1, existe sigla IATA-3 */
IF (	SELECT	COUNT(*)
	FROM	INSERTED INS,
		T_COM COM
	WHERE	COM.CD_COM = INS.CD_COM AND
		INS.FL_COM_GR1 = 1 AND 
		INS.SG_COM_IAT_003 = &#39;&#39;) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Uma Companhia Aérea do Grupo 1 deve possuir sigla IATA-3.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Verificar se quando a companhia for do Grupo 1, existe sigla IATA-2 */
IF (	SELECT	COUNT(*)
	FROM	INSERTED INS,
		T_COM COM
	WHERE	COM.CD_COM = INS.CD_COM AND
		INS.FL_COM_GR1 = 1 AND 
		INS.SG_COM_IAT_002 = &#39;&#39;) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Uma Companhia Aérea do Grupo 1 deve possuir sigla IATA-2.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Não permitir que o campo SG_COM_IAT_003 seja alterado se existir alguma referência a esta sigla na tabela T_HOT001 */
IF UPDATE(SG_COM_IAT_003)
BEGIN
	IF (	SELECT	COUNT(*)
		FROM	DELETED DEL, T_HOT001 HOT
		WHERE	HOT.SG_COM = DEL.SG_COM_IAT_003) &gt; 0
	BEGIN 
		RAISERROR 20310 &#39;Operação não executada: A sigla IATA-3 dessa Companhia Aérea não pode ser alterada pois está sendo referenciada em pelo menos um Hotran.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
END

/* Verificar se já existe alguma companhia cadastrada com a sigla IATA-3 da companhia que se está alterando */
IF (	SELECT	COUNT(*)
	FROM	T_COM COM, 
		INSERTED INS
	WHERE	COM.CD_COM &lt;&gt; INS.CD_COM AND
		COM.SG_COM_IAT_003 = INS.SG_COM_IAT_003 AND
		INS.SG_COM_IAT_003 &lt;&gt; &#39;&#39;) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Já existe uma Companhia Áerea cadastrada com esta sigla IATA-3.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Verificar se já existe alguma companhia cadastrada com a sigla IATA-2 da companhia que se está alterando */
IF (	SELECT	COUNT(*)
	FROM	T_COM COM, 
		INSERTED INS
	WHERE	COM.CD_COM &lt;&gt; INS.CD_COM AND
		COM.SG_COM_IAT_002 = INS.SG_COM_IAT_002 AND
		INS.SG_COM_IAT_002 &lt;&gt; &#39;&#39;) &gt; 0
BEGIN 
	RAISERROR 20310 &#39;Operação não executada: Já existe uma Companhia Áerea cadastrada com esta sigla IATA-2.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

IF UPDATE(SG_COM_IAT_003)
BEGIN
	/* Incluir Registros em T_ACH */
	INSERT	T_ACH (DH_ACH, CD_CHG)
	Select 	GETDATE(), CD_CHG
	From 	T_CHG CHG, INSERTED INS
	Where	CHG.TP_CHG_STA = 1 AND
		CHG.CD_AER = (Select CD_AER From T_PSI) AND
		CHG.CD_COM = INS.CD_COM

	/* Incluir Registros em T_APA */
	INSERT	T_APA (DH_APA, CD_PAR)
	Select 	GETDATE(), CD_PAR
	From 	T_PAR PAR, INSERTED INS
	Where	PAR.TP_PAR_STA = 1 AND
		PAR.CD_AER = (Select CD_AER From T_PSI) AND
		PAR.CD_COM = INS.CD_COM

	/* Incluir Registros em T_AHP - Chegadas */
	INSERT	T_AHP (CD_HPA, DH_AHP)
	Select 	DISTINCT CD_HPA, GETDATE()
	From 	T_HPA001 HPA, T_CHG CHG, T_SIT SIT, INSERTED INS
	Where	HPA.CD_CHG = CHG.CD_CHG AND
		SIT.CD_SIT = CHG.CD_SIT AND
		HPA.CD_AER = (Select CD_AER From T_PSI) AND
		(HPA.FL_HPA_ENT = 1 OR SIT.FL_SIT_AEN_PAT = 1) AND
		HPA.FL_HPA_SAI = 0 AND
		HPA.CD_AEN IS NOT NULL AND
		CHG.CD_COM = INS.CD_COM

	/* Incluir Registros em T_AHP - Partidas */
	INSERT	T_AHP (CD_HPA, DH_AHP)
	Select 	DISTINCT CD_HPA, GETDATE()
	From 	T_HPA001 HPA, T_CHG CHG, T_SIT SIT, T_PAR PAR, INSERTED INS
	Where	HPA.CD_CHG = CHG.CD_CHG AND
		SIT.CD_SIT = CHG.CD_SIT AND
		HPA.CD_AER = (Select CD_AER From T_PSI) AND
		(HPA.FL_HPA_ENT = 1 OR SIT.FL_SIT_AEN_PAT = 1) AND
		HPA.FL_HPA_SAI = 0 AND
		HPA.CD_AEN IS NOT NULL AND
		PAR.CD_CHG_AEN_ANT = HPA.CD_CHG AND
		PAR.CD_COM = INS.CD_COM

END
End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o177"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o189">
<a:ObjectID>6958A57B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_10</a:Name>
<a:Code>REFERENCE_10</a:Code>
<a:CreationDate>1081538799</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538799</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o167"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o7"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o177"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o190">
<a:ObjectID>6958A57C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538799</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538799</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o168"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o17"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o191">
<a:CenterTextOffset>(2, 0)</a:CenterTextOffset>
<a:Rect>((-742143,652661), (-734419,663774))</a:Rect>
<a:ListOfPoints>((-738248,652661),(-738335,663774))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>12615680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o135"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o192">
<a:Rect>((-740988,660652), (-734362,665198))</a:Rect>
<a:LineColor>12615680</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o193">
<a:ObjectID>6958A5C3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_EST</a:Name>
<a:Code>T_EST</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081691234</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o194">
<a:ObjectID>6958A504-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_EST</a:Name>
<a:Code>CD_EST</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o195">
<a:ObjectID>6958A505-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_EST</a:Name>
<a:Code>NR_EST</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(4)</a:DataType>
<a:Length>4</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o196">
<a:ObjectID>6958A506-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_SAL</a:Name>
<a:Code>CD_SAL</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o197">
<a:ObjectID>6958A507-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o198">
<a:ObjectID>6958A511-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_EST</a:Name>
<a:Code>Pk_T_EST</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_EST</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o194"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o199">
<a:ObjectID>6958A50C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_EST_AER</a:Name>
<a:Code>I_EST_AER</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081691234</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o200">
<a:ObjectID>6958A50E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o195"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o201">
<a:ObjectID>6958A510-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_1&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o196"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Ref="o59"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o202">
<a:ObjectID>6958A55F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_EST_TRD</a:Name>
<a:Code>T_EST_TRD</a:Code>
<a:Text>Create Trigger T_EST_TRD On T_EST
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Esteira»Hotran - Frequência: É Esteira da Frequência (Restrict) */
If (Select Count(*) From T_HFR dep, Deleted pri
 Where dep.CD_EST = pri.CD_EST) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Esteira&gt; está sendo referenciada na tabela &lt;Hotran - Frequência&gt;&#39;
  Return
End
/* Esteira»FIDS - IST Servidor de Informação: Esteira Associada ao IST (Restrict) */
If (Select Count(*) From T_FIDS_IST dep, Deleted pri
 Where dep.CD_EST = pri.CD_EST) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Esteira&gt; está sendo referenciada na tabela &lt;FIDS - IST Servidor de Informação&gt;&#39;
  Return
End
/* Esteira»Esteira da Chegada de Vôo - Mirror: Esteira da Chegada (Restrict) */
If (Select Count(*) From T_ESV001_MIR dep, Deleted pri
 Where dep.CD_EST = pri.CD_EST) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Esteira&gt; está sendo referenciada na tabela &lt;Esteira da Chegada de Vôo - Mirror&gt;&#39;
  Return
End
/* Esteira»Esteira da Chegada de Vôo: Esteira integra ESV (Restrict) */
If (Select Count(*) From T_ESV001 dep, Deleted pri
 Where dep.CD_EST = pri.CD_EST) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Esteira&gt; está sendo referenciada na tabela &lt;Esteira da Chegada de Vôo&gt;&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o203">
<a:ObjectID>6958A562-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_EST_TRI</a:Name>
<a:Code>T_EST_TRI</a:Code>
<a:Text>Create Trigger T_EST_TRI On T_EST
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Aeroporto»Esteira: Aeroporto possui Esteiras */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Esteira&gt; não está cadastrada&#39;
  Return
End
/* Sala de Desembarque»Esteira: Sala Desemb. possui Esteiras */
If (Select Count(*) From T_SAL, Inserted
Where T_SAL.CD_SAL = Inserted.CD_SAL)
 &lt;&gt;(Select Count(CD_SAL) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Sala de Desembarque&gt; que se deseja incluir na tabela &lt;Esteira&gt; não está cadastrada&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o204">
<a:ObjectID>6958A565-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_EST_TRU</a:Name>
<a:Code>T_EST_TRU</a:Code>
<a:Text>Create Trigger T_EST_TRU On T_EST
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_EST)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código da Esteira&gt; da tabela &lt;Esteira&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_AER)
/* Aeroporto»Esteira: Aeroporto possui Esteiras */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Esteira&gt; não está cadastrada&#39;
  Return
End
If Update (CD_SAL)
/* Sala de Desembarque»Esteira: Sala Desemb. possui Esteiras */
If (Select Count(*) From T_SAL, Inserted
Where T_SAL.CD_SAL = Inserted.CD_SAL)
 &lt;&gt;(Select Count(CD_SAL) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Sala de Desembarque&gt; que se deseja incluir na tabela &lt;Esteira&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
IF UPDATE(NR_EST) OR UPDATE(CD_SAL)
BEGIN
	/* Incluir registros em T_ACH */
	INSERT	T_ACH (DH_ACH, CD_CHG)
	Select	GETDATE(), ESV.CD_CHG
	From	T_ESV001 ESV, T_EST EST, INSERTED INS
	Where	ESV.CD_CHG IN (	Select 	CD_CHG
				From 	T_CHG CHG
				Where	CHG.TP_CHG_STA = 1 And
					CHG.CD_AER = (Select CD_AER From T_PSI)) And
		EST.CD_EST = ESV.CD_EST And
		EST.CD_EST = INS.CD_EST

	/* Incluir Registros em T_AHO */
	INSERT	T_AHO (CD_HOT, DH_AHO)
	Select	DISTINCT CD_HOT, GETDATE()
	From	T_HFR HFR, INSERTED INS
	Where	HFR.CD_EST = INS.CD_EST

	/* Incluir Registros em T_AHP */
	INSERT	T_AHP (CD_HPA, DH_AHP)
	Select	DISTINCT CD_HPA, GETDATE()
	From	T_HPA001 HPA, T_CHG CHG, T_SIT SIT, T_ESV001 ESV, T_EST EST, INSERTED INS
	Where	HPA.CD_CHG = CHG.CD_CHG AND
		SIT.CD_SIT = CHG.CD_SIT AND
		HPA.CD_AER = (Select CD_AER From T_PSI) AND
		(HPA.FL_HPA_ENT = 1 OR SIT.FL_SIT_AEN_PAT = 1) AND
		HPA.FL_HPA_SAI = 0 AND
		HPA.CD_AEN IS NOT NULL AND
		ESV.CD_CHG = HPA.CD_CHG AND 
		EST.CD_EST = ESV.CD_EST And
		EST.CD_EST = INS.CD_EST
END

End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o198"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o205">
<a:ObjectID>6958A580-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_13</a:Name>
<a:Code>REFERENCE_13</a:Code>
<a:CreationDate>1081538799</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538799</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o193"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o136"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o198"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o206">
<a:ObjectID>6958A582-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538799</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538799</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o194"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o138"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o207">
<a:CenterTextOffset>(-1196, -2100)</a:CenterTextOffset>
<a:Rect>((-715599,687725), (-698298,719208))</a:Rect>
<a:ListOfPoints>((-715599,687725),(-698298,719208))</a:ListOfPoints>
<a:ArrowStyle>4881</a:ArrowStyle>
<a:LineColor>12615680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o6"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o208">
<a:Rect>((-701862,717995), (-695622,722541))</a:Rect>
<a:LineColor>12615680</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o209">
<a:ObjectID>6958A5F6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_IFT</a:Name>
<a:Code>T_IFT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081692038</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o210">
<a:ObjectID>6958A526-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_IFT</a:Name>
<a:Code>CD_IFT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o211">
<a:ObjectID>6958A527-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TT_IFT</a:Name>
<a:Code>TT_IFT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>varchar(255)</a:DataType>
<a:Length>255</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o212">
<a:ObjectID>6958A528-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o213">
<a:ObjectID>6958A52C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_IFT</a:Name>
<a:Code>Pk_T_IFT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_IFT</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o210"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Owner>
<o:User Ref="o59"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o214">
<a:ObjectID>6958A5FA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_IFT_TRD</a:Name>
<a:Code>T_IFT_TRD</a:Code>
<a:Text>Create Trigger T_IFT_TRD On T_IFT
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Informante da Situação de Vôo»Chamadas de Anuncio: Informante da Chamada (Restrict) */
If (Select Count(*) From T_CHA dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Chamadas de Anuncio&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Chamadas de Anuncio - Mirror: Informante da Chamada (Restrict) */
If (Select Count(*) From T_CHA_MIR dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Chamadas de Anuncio - Mirror&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Mensagem de Chegada - Mirror: Informante da Mensagem de Chegada (Restrict) */
If (Select Count(*) From T_MCH_MIR dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Mensagem de Chegada - Mirror&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Mensagem de Chegada: Informante da Mensagem de Chegada (Restrict) */
If (Select Count(*) From T_MCH dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Mensagem de Chegada&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Mensagem de Partida - Mirror: Informante da Mensagem de Partida (Restrict) */
If (Select Count(*) From T_MPA_MIR dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Mensagem de Partida - Mirror&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Mensagem de Partida: Informante da Mensagem de Partida (Restrict) */
If (Select Count(*) From T_MPA dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Mensagem de Partida&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Chegadas - Mirror: Informante da Situação de Chegada (Restrict) */
If (Select Count(*) From T_CHG_MIR dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Chegadas - Mirror&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Chegadas: Informante da Situação de Chegada (Restrict) */
If (Select Count(*) From T_CHG dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Chegadas&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Partidas - Mirror: Informante da Situação de Partida (Restrict) */
If (Select Count(*) From T_PAR_MIR dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Partidas - Mirror&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Partidas: Informante da Situação de Partida (Restrict) */
If (Select Count(*) From T_PAR dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Partidas&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Histórico de Situação de Vôo de Chegada - Mirror: Informante do HSC (Restrict) */
If (Select Count(*) From T_HSC_MIR dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Histórico de Situação de Vôo de Chegada - Mirror&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Histórico de Situação de Vôo de Chegada: Informante do HSC (Restrict) */
If (Select Count(*) From T_HSC dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Histórico de Situação de Vôo de Chegada&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Histórico de Situação de Vôo de Partida - Mirror: Informante do HSP (Restrict) */
If (Select Count(*) From T_HSP_MIR dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Histórico de Situação de Vôo de Partida - Mirror&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Histórico de Situação de Vôo de Partida: Informante do HSP (Restrict) */
If (Select Count(*) From T_HSP dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Histórico de Situação de Vôo de Partida&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Log da Programação de Anúncios: C:IFT-PRALOG (Cascade) */
Delete T_PRALOG From T_PRALOG dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT
End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o215">
<a:ObjectID>6958A5FC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_IFT_TRI</a:Name>
<a:Code>T_IFT_TRI</a:Code>
<a:Text>Create Trigger T_IFT_TRI On T_IFT
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Companhia Aérea»Informante da Situação de Vôo: possui */
If (Select Count(*) From T_COM, Inserted
Where T_COM.CD_COM = Inserted.CD_COM)
 &lt;&gt;(Select Count(CD_COM) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Companhia Aérea&gt; que se deseja incluir na tabela &lt;Informante da Situação de Vôo&gt; não está cadastrada&#39;
  Return
End
/* Pessoas»Informante da Situação de Vôo: Pessoa do Informante */
If (Select Count(*) From T_PES, Inserted
Where T_PES.CD_PES = Inserted.CD_IFT)
 &lt;&gt;(Select Count(CD_IFT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Pessoas&gt; que se deseja incluir na tabela &lt;Informante da Situação de Vôo&gt; não está cadastrada&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o216">
<a:ObjectID>6958A5FE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_IFT_TRU</a:Name>
<a:Code>T_IFT_TRU</a:Code>
<a:Text>Create Trigger T_IFT_TRU On T_IFT
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_IFT)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Informante da Situação de Vôo&gt; da tabela &lt;Informante da Situação de Vôo&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_COM)
/* Companhia Aérea»Informante da Situação de Vôo: possui */
If (Select Count(*) From T_COM, Inserted
Where T_COM.CD_COM = Inserted.CD_COM)
 &lt;&gt;(Select Count(CD_COM) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Companhia Aérea&gt; que se deseja incluir na tabela &lt;Informante da Situação de Vôo&gt; não está cadastrada&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o213"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o217">
<a:ObjectID>6958A584-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_14</a:Name>
<a:Code>REFERENCE_14</a:Code>
<a:CreationDate>1081538799</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538799</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o209"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o7"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o213"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o218">
<a:ObjectID>6958A586-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538799</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538799</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o210"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o33"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o219">
<a:CenterTextOffset>(3, 0)</a:CenterTextOffset>
<a:Rect>((-699817,651994), (-692843,719933))</a:Rect>
<a:ListOfPoints>((-696429,651994),(-696240,719933))</a:ListOfPoints>
<a:ArrowStyle>4881</a:ArrowStyle>
<a:LineColor>12615680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o146"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o208"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o220">
<a:ObjectID>6958A588-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_15</a:Name>
<a:Code>REFERENCE_15</a:Code>
<a:CreationDate>1081538799</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538799</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o209"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o147"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o213"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o221">
<a:ObjectID>6958A58A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538799</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538799</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o210"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o150"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o222">
<a:CenterTextOffset>(4, 0)</a:CenterTextOffset>
<a:Rect>((-724029,652494), (-716905,686200))</a:Rect>
<a:ListOfPoints>((-717549,686200),(-723311,652494))</a:ListOfPoints>
<a:ArrowStyle>4881</a:ArrowStyle>
<a:LineColor>12615680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o6"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o223">
<a:Rect>((-724698,649754), (-718382,654300))</a:Rect>
<a:LineColor>12615680</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o224">
<a:ObjectID>6958A4DB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_SIT</a:Name>
<a:Code>T_SIT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o225">
<a:ObjectID>6958A52E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_SIT</a:Name>
<a:Code>CD_SIT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o226">
<a:ObjectID>6958A530-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_SIT_LOC</a:Name>
<a:Code>NM_SIT_LOC</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>varchar(30)</a:DataType>
<a:Length>30</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o227">
<a:ObjectID>6958A532-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_SIT_EST</a:Name>
<a:Code>NM_SIT_EST</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>varchar(30)</a:DataType>
<a:Length>30</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o228">
<a:ObjectID>6958A534-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_SIT_ORD</a:Name>
<a:Code>NR_SIT_ORD</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_ZRO    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_ZRO As
0</a:DefaultValue>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o229">
<a:ObjectID>6958A536-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SG_SIT</a:Name>
<a:Code>SG_SIT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>varchar(3)</a:DataType>
<a:Length>3</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o230">
<a:ObjectID>6958A537-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_SIT_PAR</a:Name>
<a:Code>FL_SIT_PAR</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o231">
<a:ObjectID>6958A538-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_SIT_CHG</a:Name>
<a:Code>FL_SIT_CHG</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o232">
<a:ObjectID>6958A539-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_SIT_REA</a:Name>
<a:Code>FL_SIT_REA</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o233">
<a:ObjectID>6958A53A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_SIT_HR1</a:Name>
<a:Code>FL_SIT_HR1</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o234">
<a:ObjectID>6958A53B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_SIT_CON_VOO</a:Name>
<a:Code>FL_SIT_CON_VOO</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o235">
<a:ObjectID>6958A53D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_SIT_CAN_VOO</a:Name>
<a:Code>FL_SIT_CAN_VOO</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o236">
<a:ObjectID>6958A53F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_SIT_AEN_PAT</a:Name>
<a:Code>FL_SIT_AEN_PAT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o237">
<a:ObjectID>6958A541-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_SIT_TOD</a:Name>
<a:Code>FL_SIT_TOD</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o238">
<a:ObjectID>6958A544-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_SIT_COM</a:Name>
<a:Code>TP_SIT_COM</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o239">
<a:ObjectID>6958A546-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>HR_SIT_ANT</a:Name>
<a:Code>HR_SIT_ANT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o240">
<a:ObjectID>6958A549-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>HR_SIT_APS</a:Name>
<a:Code>HR_SIT_APS</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o241">
<a:ObjectID>6958A54B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_SIT_STF</a:Name>
<a:Code>FL_SIT_STF</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o242">
<a:ObjectID>6958A54C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o243">
<a:ObjectID>6958A550-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_SIT</a:Name>
<a:Code>Pk_T_SIT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_SIT</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o225"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Owner>
<o:User Ref="o59"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o244">
<a:ObjectID>6958A508-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_SIT_TRD</a:Name>
<a:Code>T_SIT_TRD</a:Code>
<a:Text>Create Trigger T_SIT_TRD On T_SIT
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Situação»Situação Sucessora: É Sucessora (Restrict) */
Declare @DBBDsc varchar(255)
Select @DBBDsc = &#39;(&#39;
Select @DBBDsc = @DBBDsc+RTrim(Convert(varchar(255),PRI.NM_SIT_LOC))+&#39;, &#39; From T_SSU dep, Deleted pri
 Where dep.CD_SIT_SUC = pri.CD_SIT
If DataLength(@DBBDsc) &gt; 1
Begin
  RollBack Transaction
  If DataLength(@DBBDsc) &gt; 252
    Select @DBBDsc = Substring(@DBBDsc,1,252)+&#39;...&#39;
  Else
    Select @DBBDsc = Substring(@DBBDsc,1,DataLength(@DBBDsc)-2)
  Select @DBBDsc = &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Situação Sucessora&gt; &#39;+@DBBDsc+&#39;)&#39;
  RaisError 20003 @DBBDsc
  Return
End
/* Situação»Situação Condicionante do Vôo Antecessor: Situação Antecessora (Restrict) */
If (Select Count(*) From T_SCA dep, Deleted pri
 Where dep.CD_SIT_ANT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Situação Condicionante do Vôo Antecessor&gt;&#39;
  Return
End
/* Situação»Chegadas - Mirror: Situação da Chegada (Restrict) */
If (Select Count(*) From T_CHG_MIR dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Chegadas - Mirror&gt;&#39;
  Return
End
/* Situação»Chegadas: Situação da Chegada (Restrict) */
If (Select Count(*) From T_CHG dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Chegadas&gt;&#39;
  Return
End
/* Situação»Mensagem de Chegada: Situação da Mensagem de Chegada (Restrict) */
If (Select Count(*) From T_MCH dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Mensagem de Chegada&gt;&#39;
  Return
End
/* Situação»Mensagem de Partida - Mirror: Situação da Mensagem de Partida (Restrict) */
If (Select Count(*) From T_MPA_MIR dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Mensagem de Partida - Mirror&gt;&#39;
  Return
End
/* Situação»Mensagem de Partida: Situação da Mensagem de Partida (Restrict) */
If (Select Count(*) From T_MPA dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Mensagem de Partida&gt;&#39;
  Return
End
/* Situação»Partidas - Mirror: Situação da Partida (Restrict) */
If (Select Count(*) From T_PAR_MIR dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Partidas - Mirror&gt;&#39;
  Return
End
/* Situação»Partidas: Situação da Partida (Restrict) */
If (Select Count(*) From T_PAR dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Partidas&gt;&#39;
  Return
End
/* Situação»Programação de Anúncios: Situação da Programação (Restrict) */
If (Select Count(*) From T_PRA dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Programação de Anúncios&gt;&#39;
  Return
End
/* Situação»Mensagens: Situação das Mensagens (Restrict) */
If (Select Count(*) From T_MSG dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Mensagens&gt;&#39;
  Return
End
/* Situação»Parâmetros do Sistema: Situação de Confirmação de Chegada (Restrict) */
If (Select Count(*) From T_PSI dep, Deleted pri
 Where dep.CD_SIT_CHG_CON = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Parâmetros do Sistema&gt;&#39;
  Return
End
/* Situação»Parâmetros do Sistema: Situação de Confirmação de Partida (Restrict) */
If (Select Count(*) From T_PSI dep, Deleted pri
 Where dep.CD_SIT_PAR_CON = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Parâmetros do Sistema&gt;&#39;
  Return
End
/* Situação»Mensagem de Chegada - Mirror: Situação de Mensagem de Chegada (Restrict) */
If (Select Count(*) From T_MCH_MIR dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Mensagem de Chegada - Mirror&gt;&#39;
  Return
End
/* Situação»Histórico de Situação de Vôo de Chegada - Mirror: Situação do HSC (Restrict) */
If (Select Count(*) From T_HSC_MIR dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Histórico de Situação de Vôo de Chegada - Mirror&gt;&#39;
  Return
End
/* Situação»Histórico de Situação de Vôo de Chegada: Situação do HSC (Restrict) */
If (Select Count(*) From T_HSC dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Histórico de Situação de Vôo de Chegada&gt;&#39;
  Return
End
/* Situação»Histórico de Situação de Vôo de Partida - Mirror: Situação do HSP (Restrict) */
If (Select Count(*) From T_HSP_MIR dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Histórico de Situação de Vôo de Partida - Mirror&gt;&#39;
  Return
End
/* Situação»Histórico de Situação de Vôo de Partida: Situação do HSP (Restrict) */
If (Select Count(*) From T_HSP dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Histórico de Situação de Vôo de Partida&gt;&#39;
  Return
End
/* Situação»Parâmetros do Sistema: Situação Inicial de Chegada do Grupo 1 (Restrict) */
If (Select Count(*) From T_PSI dep, Deleted pri
 Where dep.CD_SIT_CHG_001 = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Parâmetros do Sistema&gt;&#39;
  Return
End
/* Situação»Parâmetros do Sistema: Situação Inicial de Chegada do Grupo 2 (Restrict) */
If (Select Count(*) From T_PSI dep, Deleted pri
 Where dep.CD_SIT_CHG_002 = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Parâmetros do Sistema&gt;&#39;
  Return
End
/* Situação»Parâmetros do Sistema: Situação Inicial de Partida do Grupo 1 (Restrict) */
If (Select Count(*) From T_PSI dep, Deleted pri
 Where dep.CD_SIT_PAR_001 = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Parâmetros do Sistema&gt;&#39;
  Return
End
/* Situação»Parâmetros do Sistema: Situação Inicial de Partida do Grupo 2 (Restrict) */
If (Select Count(*) From T_PSI dep, Deleted pri
 Where dep.CD_SIT_PAR_002 = pri.CD_SIT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Situação&gt; está sendo referenciada na tabela &lt;Parâmetros do Sistema&gt;&#39;
  Return
End
/* Situação»Situação Sucessora: Possui Sucessora (Cascade) */
Delete T_SSU From T_SSU dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT
/* Situação»Situação Condicionante do Vôo Antecessor: Situação (Cascade) */
Delete T_SCA From T_SCA dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT
/* Situação»Telas da Situação: Telas da Situação (Cascade) */
Delete T_TSI From T_TSI dep, Deleted pri
 Where dep.CD_SIT = pri.CD_SIT
End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o245">
<a:ObjectID>6958A509-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_SIT_TRI</a:Name>
<a:Code>T_SIT_TRI</a:Code>
<a:Text>Create Trigger T_SIT_TRI On T_SIT
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Domínio de: Tipo de Complemento da Sitação */
/* 1 - Hora */
/* 2 - Texto */
/* 3 - Nenhum */
If (Select Count(*) From Inserted
    Where TP_SIT_COM In (1,2,3))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Tipo de Complemento da Sitação&gt; que se deseja incluir na tabela &lt;Situação&gt; não é uma opção válida&#39;
  Return
End
/* Regra de negócio */
/* Verificar se há alguma situação que não seja nem de Chegada nem de Partida */
IF (	SELECT	COUNT(*)
	FROM	T_SIT SIT,
		INSERTED INS
	WHERE	SIT.CD_SIT = INS.CD_SIT AND
		INS.FL_SIT_CHG = 0 AND 
		INS.FL_SIT_PAR = 0) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Uma situação deve ser de chegada ou de partida ou de ambas.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Se existir mais de uma situação de ETAPA CONCLUÍDA não atualiza*/
IF (	SELECT 	COUNT(*) 
	FROM 	T_SIT SIT,
		INSERTED INS
	WHERE 	SIT.CD_SIT &lt;&gt; INS.CD_SIT AND
		SIT.FL_SIT_CON_VOO = 1 AND
		(SIT.FL_SIT_CHG = INS.FL_SIT_CHG OR SIT.FL_SIT_PAR = INS.FL_SIT_PAR) AND
		INS.FL_SIT_CON_VOO = 1) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Só pode existir uma única situação de vôo do tipo ETAPA CONCLUÍDA.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Se existir mais de uma situação do tipo CANCELADO não atualiza*/
IF (	SELECT 	COUNT(*) 
	FROM 	T_SIT SIT,
		INSERTED INS
	WHERE 	SIT.CD_SIT &lt;&gt; INS.CD_SIT AND
		SIT.FL_SIT_CAN_VOO = 1 AND
		(SIT.FL_SIT_CHG = INS.FL_SIT_CHG OR SIT.FL_SIT_PAR = INS.FL_SIT_PAR) AND
		INS.FL_SIT_CAN_VOO = 1 ) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Só pode existir uma única  situação de vôo do tipo ETAPA CANCELADA.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Se existir mais de uma situação do tipo AERONAVE NO PÁTIO não atualiza*/
IF (	SELECT 	COUNT(*) 
	FROM 	T_SIT SIT
	WHERE 	SIT.FL_SIT_AEN_PAT = 1) &gt; 1
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Só pode existir uma única  situação de vôo do tipo AERONAVE NO PÁTIO.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o246">
<a:ObjectID>6958A50B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_SIT_TRU</a:Name>
<a:Code>T_SIT_TRU</a:Code>
<a:Text>Create Trigger T_SIT_TRU On T_SIT
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_SIT)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código da Situação do Vôo&gt; da tabela &lt;Situação&gt; não pode ser alterada.&#39;
  Return
End
If Update (TP_SIT_COM)
/* Domínio de: Tipo de Complemento da Sitação */
/* 1 - Hora */
/* 2 - Texto */
/* 3 - Nenhum */
If (Select Count(*) From Inserted
    Where TP_SIT_COM In (1,2,3))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Tipo de Complemento da Sitação&gt; que se deseja incluir na tabela &lt;Situação&gt; não é uma opção válida&#39;
  Return
End
/* Regra de negócio */
/* Verificar se há alguma situação que não seja nem de Chegada nem de Partida */
IF (	SELECT	COUNT(*)
	FROM	T_SIT SIT,
		INSERTED INS
	WHERE	SIT.CD_SIT = INS.CD_SIT AND
		INS.FL_SIT_CHG = 0 AND 
		INS.FL_SIT_PAR = 0) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Uma situação deve ser de chegada ou de partida ou de ambas.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Se existir mais de uma situação de ETAPA CONCLUÍDA não atualiza*/
IF (	SELECT 	COUNT(*) 
	FROM 	T_SIT SIT,
		INSERTED INS
	WHERE 	SIT.CD_SIT &lt;&gt; INS.CD_SIT AND
		SIT.FL_SIT_CON_VOO = 1 AND
		(SIT.FL_SIT_CHG = INS.FL_SIT_CHG OR SIT.FL_SIT_PAR = INS.FL_SIT_PAR) AND
		INS.FL_SIT_CON_VOO = 1) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Só pode existir uma única situação de vôo do tipo ETAPA CONCLUÍDA.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Se existir mais de uma situação do tipo CANCELADO não atualiza*/
IF (	SELECT 	COUNT(*) 
	FROM 	T_SIT SIT,
		INSERTED INS
	WHERE 	SIT.CD_SIT &lt;&gt; INS.CD_SIT AND
		SIT.FL_SIT_CAN_VOO = 1 AND
		(SIT.FL_SIT_CHG = INS.FL_SIT_CHG OR SIT.FL_SIT_PAR = INS.FL_SIT_PAR) AND
		INS.FL_SIT_CAN_VOO = 1 ) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Só pode existir uma única  situação de vôo do tipo ETAPA CANCELADA.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Se existir mais de uma situação do tipo AERONAVE NO PÁTIO não atualiza*/
IF (	SELECT 	COUNT(*) 
	FROM 	T_SIT SIT
	WHERE 	SIT.FL_SIT_AEN_PAT = 1) &gt; 1
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Só pode existir uma única  situação de vôo do tipo AERONAVE NO PÁTIO.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

IF UPDATE (FL_SIT_CHG)
BEGIN
	/* Se uma situação de chegada deixar de ser de chegada */
	/* Verificar se há algum vôo de chegada com esta situação */
	IF (	SELECT	COUNT(*)
		FROM	INSERTED INS,
			DELETED DEL,
			T_CHG CHG
		WHERE	INS.CD_SIT = DEL.CD_SIT AND
			DEL.FL_SIT_CHG &lt;&gt; 0 AND
			INS.FL_SIT_CHG = 0 AND
			CHG.CD_SIT = INS.CD_SIT) &gt; 0
	BEGIN
		RAISERROR 20311 &#39;Operação não executada: Existe um vôo de chegada utilizando esta situação.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END

	/* Se uma situação de chegada deixar de ser de chegada */
	/* Verificar se esta situação é situação condicionante de alguma situação de partida */
	IF (	SELECT	COUNT(*)
		FROM	INSERTED INS,
			DELETED DEL,
			T_SCA SCA
		WHERE	INS.CD_SIT = DEL.CD_SIT AND
			DEL.FL_SIT_CHG &lt;&gt; 0 AND
			INS.FL_SIT_CHG = 0 AND
			SCA.CD_SIT_ANT = INS.CD_SIT) &gt; 0
	BEGIN
		RAISERROR 20311 &#39;Operação não executada: Esta situação é uma situação condicionante de alguma situação de partida.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END

	/* Se uma situação de chegada deixar de ser de chegada */
	/* Verificar se esta situação é situação sucessora de alguma situação de chegada */
	IF (	SELECT	COUNT(*)
		FROM	INSERTED INS,
			T_SSU SSU,
			T_SIT SIT
		WHERE	SSU.CD_SIT_SUC = INS.CD_SIT AND
			SIT.CD_SIT = SSU.CD_SIT AND
			INS.FL_SIT_CHG = 0 AND
			SIT.FL_SIT_CHG = 1) &gt; 0
	BEGIN
		RAISERROR 20311 &#39;Operação não executada: Esta situação é situação sucessora de uma situação de chegada. Por esta razão ela também tem de ser de chegada.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
END

IF UPDATE (FL_SIT_PAR)
BEGIN
	/* Se uma situação de partida deixar de ser de partida */
	/* Verificar se há algum vôo de partida com esta situação */
	IF (	SELECT	COUNT(*)
		FROM	INSERTED INS,
			DELETED DEL,
			T_PAR PAR
		WHERE	INS.CD_SIT = DEL.CD_SIT AND
			DEL.FL_SIT_PAR &lt;&gt; 0 AND
			INS.FL_SIT_PAR = 0 AND
			PAR.CD_SIT = INS.CD_SIT) &gt; 0
	BEGIN
		RAISERROR 20311 &#39;Operação não executada: Existe um vôo de partida utilizando esta situação.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END

	/* Se uma situação de partida deixar de ser de partida */
	/* Verificar se esta situação possui alguma situação de chegada condicionante */
	IF (	SELECT	COUNT(*)
		FROM	INSERTED INS,
			DELETED DEL,
			T_SCA SCA
		WHERE	INS.CD_SIT = DEL.CD_SIT AND
			DEL.FL_SIT_PAR &lt;&gt; 0 AND
			INS.FL_SIT_PAR = 0 AND
			SCA.CD_SIT = INS.CD_SIT) &gt; 0
	BEGIN
		RAISERROR 20311 &#39;Operação não executada: Esta situação possui alguma situação de chegada condicionante.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END

	/* Se uma situação de partida deixar de ser de partida */
	/* Verificar se esta situação é situação sucessora de alguma situação de partida */
	IF (	SELECT	COUNT(*)
		FROM	INSERTED INS,
			T_SSU SSU,
			T_SIT SIT
		WHERE	SSU.CD_SIT_SUC = INS.CD_SIT AND
			SIT.CD_SIT = SSU.CD_SIT AND
			INS.FL_SIT_PAR = 0 AND
			SIT.FL_SIT_PAR = 1) &gt; 0
	BEGIN
		RAISERROR 20311 &#39;Operação não executada: Esta situação é situação sucessora de uma situação de partida. Por esta razão ela também tem de ser de partida.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
END

/* Incluir Registros em T_ACH */
INSERT	T_ACH (DH_ACH, CD_CHG)
Select 	GETDATE(), CD_CHG
From 	T_CHG CHG, INSERTED INS
Where	CHG.TP_CHG_STA = 1 AND
	CHG.CD_AER = (Select CD_AER From T_PSI) AND
	CHG.CD_SIT = INS.CD_SIT

/* Incluir Registros em T_APA */
INSERT	T_APA (DH_APA, CD_PAR)
Select 	GETDATE(), CD_PAR
From 	T_PAR PAR, INSERTED INS
Where	PAR.TP_PAR_STA = 1 AND
	PAR.CD_AER = (Select CD_AER From T_PSI) AND
	PAR.CD_SIT = INS.CD_SIT

End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o243"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o247">
<a:ObjectID>6958A58C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_16</a:Name>
<a:Code>REFERENCE_16</a:Code>
<a:CreationDate>1081538799</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538799</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o224"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o7"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o243"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o248">
<a:ObjectID>6958A58E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538799</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538799</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o225"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o28"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o249">
<a:CenterTextOffset>(3, 0)</a:CenterTextOffset>
<a:Rect>((-721344,651006), (-699832,652367))</a:Rect>
<a:ListOfPoints>((-699832,652144),(-721344,652367))</a:ListOfPoints>
<a:ArrowStyle>4881</a:ArrowStyle>
<a:LineColor>12615680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o146"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o223"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o250">
<a:ObjectID>6958A591-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_17</a:Name>
<a:Code>REFERENCE_17</a:Code>
<a:CreationDate>1081538799</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538799</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o224"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o147"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o243"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o251">
<a:ObjectID>6958A594-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538799</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538799</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o225"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o151"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o252">
<a:CenterTextOffset>(5, 0)</a:CenterTextOffset>
<a:Rect>((-719178,661747), (-711454,687250))</a:Rect>
<a:ListOfPoints>((-716574,687250),(-714123,661747))</a:ListOfPoints>
<a:ArrowStyle>4881</a:ArrowStyle>
<a:LineColor>12615680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o6"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o253">
<a:Rect>((-716293,660010), (-709667,664556))</a:Rect>
<a:LineColor>12615680</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o254">
<a:ObjectID>6958A4E7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_USR</a:Name>
<a:Code>T_USR</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o255">
<a:ObjectID>6958A552-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_USR</a:Name>
<a:Code>CD_USR</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o256">
<a:ObjectID>6958A554-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_USR_PAS</a:Name>
<a:Code>NM_USR_PAS</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(30)</a:DataType>
<a:Length>30</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o257">
<a:ObjectID>6958A556-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o258">
<a:ObjectID>6958A55B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_USR</a:Name>
<a:Code>Pk_T_USR</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_USR</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o255"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Owner>
<o:User Ref="o59"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o259">
<a:ObjectID>6958A529-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_USR_TRD</a:Name>
<a:Code>T_USR_TRD</a:Code>
<a:Text>Create Trigger T_USR_TRD On T_USR
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Usuários»Chamadas de Anuncio - Mirror: Usuário da Chamada (Restrict) */
If (Select Count(*) From T_CHA_MIR dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Chamadas de Anuncio - Mirror&gt;&#39;
  Return
End
/* Usuários»Chamadas de Anuncio: Usuário da Chamada (Restrict) */
If (Select Count(*) From T_CHA dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Chamadas de Anuncio&gt;&#39;
  Return
End
/* Usuários»Mensagem de Chegada - Mirror: Usuário da Mensagem de Chegada (Restrict) */
If (Select Count(*) From T_MCH_MIR dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Mensagem de Chegada - Mirror&gt;&#39;
  Return
End
/* Usuários»Mensagem de Chegada: Usuário da Mensagem de Chegada (Restrict) */
If (Select Count(*) From T_MCH dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Mensagem de Chegada&gt;&#39;
  Return
End
/* Usuários»Mensagem de Partida: Usuário da Mensagem de Partida (Restrict) */
If (Select Count(*) From T_MPA dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Mensagem de Partida&gt;&#39;
  Return
End
/* Usuários»Mensagem de Partida - Mirror: Usuário da Mensagem de Partida (Restrict) */
If (Select Count(*) From T_MPA_MIR dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Mensagem de Partida - Mirror&gt;&#39;
  Return
End
/* Usuários»Chegadas - Mirror: Usuário Logado (Restrict) */
If (Select Count(*) From T_CHG_MIR dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Chegadas - Mirror&gt;&#39;
  Return
End
/* Usuários»Partidas - Mirror: Usuário Logado (Restrict) */
If (Select Count(*) From T_PAR_MIR dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Partidas - Mirror&gt;&#39;
  Return
End
/* Usuários»Histórico de Situação de Vôo de Chegada - Mirror: Usuário Logado (Restrict) */
If (Select Count(*) From T_HSC_MIR dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Histórico de Situação de Vôo de Chegada - Mirror&gt;&#39;
  Return
End
/* Usuários»Histórico de Situação de Vôo de Partida - Mirror: Usuário Logado (Restrict) */
If (Select Count(*) From T_HSP_MIR dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Histórico de Situação de Vôo de Partida - Mirror&gt;&#39;
  Return
End
/* Usuários»Histórico de Situação de Vôo de Chegada: Usuário logado (Restrict) */
If (Select Count(*) From T_HSC dep,Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Histórico de Situação de Vôo de Chegada&gt;&#39;
  Return
End
/* Usuários»Histórico de Situação de Vôo de Partida: Usuário logado (Restrict) */
If (Select Count(*) From T_HSP dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Histórico de Situação de Vôo de Partida&gt;&#39;
  Return
End
/* Usuários»Chegadas: Usuário logado (Restrict) */
If (Select Count(*) From T_CHG dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Chegadas&gt;&#39;
  Return
End
/* Usuários»Partidas: Usuário logado (Restrict) */
If (Select Count(*) From T_PAR dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Partidas&gt;&#39;
  Return
End
/* Usuários»Usuários do Grupo: Usuários do Grupo (Restrict) */
If (Select Count(*) From T_USG dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;Usuários do Grupo&gt;&#39;
  Return
End
/* Usuários»FIDS - Usuário do Grupo de Displays: Usuários do Grupo de Displays (Restrict) */
If (Select Count(*) From T_FIDS_DGU dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Usuários&gt; está sendo referenciada na tabela &lt;FIDS - Usuário do Grupo de Displays&gt;&#39;
  Return
End
/* Usuários»Log da Programação de Anúncios: C:USR-PRALOG (Cascade) */
Delete T_PRALOG From T_PRALOG dep, Deleted pri
 Where dep.CD_USR = pri.CD_USR
/* Regra de negócio */
/* INCLUIR REGISTROS EM T_AUS */
INSERT	T_AUS (DH_AUS, CD_USR)
SELECT GETDATE(), CD_USR FROM DELETED

End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o260">
<a:ObjectID>6958A52A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_USR_TRI</a:Name>
<a:Code>T_USR_TRI</a:Code>
<a:Text>Create Trigger T_USR_TRI On T_USR
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Pessoas»Usuários: Pessoa do Usuário */
If (Select Count(*) From T_PES, Inserted
Where T_PES.CD_PES = Inserted.CD_USR)
 &lt;&gt;(Select Count(CD_USR) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Pessoas&gt; que se deseja incluir na tabela &lt;Usuários&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
/* INCLUIR REGISTROS EM T_AUS */
INSERT	T_AUS (DH_AUS, CD_USR)
SELECT GETDATE(), CD_USR FROM INSERTED

End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o261">
<a:ObjectID>6958A52B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_USR_TRU</a:Name>
<a:Code>T_USR_TRU</a:Code>
<a:Text>Create Trigger T_USR_TRU On T_USR
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_USR)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Usuário&gt; da tabela &lt;Usuários&gt; não pode ser alterada.&#39;
  Return
End
/* Regra de negócio */
/* INCLUIR REGISTROS EM T_AUS */
INSERT	T_AUS (DH_AUS, CD_USR)
SELECT GETDATE(), CD_USR FROM INSERTED

End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o258"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o262">
<a:ObjectID>6958A596-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_18</a:Name>
<a:Code>REFERENCE_18</a:Code>
<a:CreationDate>1081538799</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538799</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o254"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o7"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o258"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o263">
<a:ObjectID>6958A597-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538799</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538799</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o255"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o34"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o264">
<a:CenterTextOffset>(3, 0)</a:CenterTextOffset>
<a:Rect>((-712774,652550), (-699690,662473))</a:Rect>
<a:ListOfPoints>((-699690,652550),(-712774,662473))</a:ListOfPoints>
<a:ArrowStyle>4881</a:ArrowStyle>
<a:LineColor>12615680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o146"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o253"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o265">
<a:ObjectID>6958A598-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_19</a:Name>
<a:Code>REFERENCE_19</a:Code>
<a:CreationDate>1081538799</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538799</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o254"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o147"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o258"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o266">
<a:ObjectID>6958A59A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538799</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538799</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o255"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o153"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o267">
<a:Rect>((-717999,685150), (-704349,687400))</a:Rect>
<a:ListOfPoints>((-715524,687400),(-709224,687400),(-709149,686125),(-709149,685150),(-717999,685225))</a:ListOfPoints>
<a:ArrowStyle>4881</a:ArrowStyle>
<a:LineColor>12615680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o6"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o6"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o268">
<a:ObjectID>6958A59D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_20</a:Name>
<a:Code>REFERENCE_20</a:Code>
<a:CreationDate>1081539599</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081539599</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o7"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o7"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o39"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o269">
<a:ObjectID>6958A59F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081539599</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081540498</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o8"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o18"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o270">
<a:CenterTextOffset>(3, 0)</a:CenterTextOffset>
<a:Rect>((-730044,686900), (-718674,721604))</a:Rect>
<a:ListOfPoints>((-730044,721604),(-718674,686900))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>12615680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Id="o271">
<a:Rect>((-733438,719073), (-726812,722673))</a:Rect>
<a:LineColor>12615680</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o272">
<a:ObjectID>6958A5B9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_DEC</a:Name>
<a:Code>T_DEC</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o273">
<a:ObjectID>6958A4D7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_CHG</a:Name>
<a:Code>CD_CHG</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o274">
<a:ObjectID>6958A4D8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_DEC_DES_DOM</a:Name>
<a:Code>QT_DEC_DES_DOM</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o275">
<a:ObjectID>6958A4D9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_DEC_DES_INT</a:Name>
<a:Code>QT_DEC_DES_INT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o276">
<a:ObjectID>6958A4DA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_DEC_DES_BAG_DOM</a:Name>
<a:Code>QT_DEC_DES_BAG_DOM</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o277">
<a:ObjectID>6958A4DC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_DEC_DES_BAG_INT</a:Name>
<a:Code>QT_DEC_DES_BAG_INT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o278">
<a:ObjectID>6958A4DD-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_DEC_DES_CAR_DOM</a:Name>
<a:Code>QT_DEC_DES_CAR_DOM</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o279">
<a:ObjectID>6958A4DE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_DEC_DES_CAR_INT</a:Name>
<a:Code>QT_DEC_DES_CAR_INT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o280">
<a:ObjectID>6958A4DF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_DEC_DES_COR_DOM</a:Name>
<a:Code>QT_DEC_DES_COR_DOM</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o281">
<a:ObjectID>6958A4E0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_DEC_DES_COR_INT</a:Name>
<a:Code>QT_DEC_DES_COR_INT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o282">
<a:ObjectID>6958A4E1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_DEC_TRA_BAG_DOM</a:Name>
<a:Code>QT_DEC_TRA_BAG_DOM</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o283">
<a:ObjectID>6958A4E2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_DEC_TRA_BAG_INT</a:Name>
<a:Code>QT_DEC_TRA_BAG_INT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o284">
<a:ObjectID>6958A4E3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_DEC_TRA_CAR_DOM</a:Name>
<a:Code>QT_DEC_TRA_CAR_DOM</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o285">
<a:ObjectID>6958A4E4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_DEC_TRA_CAR_INT</a:Name>
<a:Code>QT_DEC_TRA_CAR_INT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o286">
<a:ObjectID>6958A4E5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_DEC_TRA_COR_DOM</a:Name>
<a:Code>QT_DEC_TRA_COR_DOM</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o287">
<a:ObjectID>6958A4E6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_DEC_TRA_COR_INT</a:Name>
<a:Code>QT_DEC_TRA_COR_INT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o288">
<a:ObjectID>6958A4E8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o289">
<a:ObjectID>6958A4E9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_DEC</a:Name>
<a:Code>Pk_T_DEC</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_DEC</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o273"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Owner>
<o:User Ref="o59"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o290">
<a:ObjectID>6958A533-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_DEC_TRI</a:Name>
<a:Code>T_DEC_TRI</a:Code>
<a:Text>Create Trigger T_DEC_TRI On T_DEC
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Chegadas»Dados Estatísticos de Chegada: Dados Estatísticos da Chegada */
If (Select Count(*) From T_CHG, Inserted
Where T_CHG.CD_CHG = Inserted.CD_CHG)
 &lt;&gt;(Select Count(CD_CHG) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Chegadas&gt; que se deseja incluir na tabela &lt;Dados Estatísticos de Chegada&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
/* Se todos os campos do registro que está sendo incluído forem nulos, deletar o registro */
DELETE	T_DEC
FROM	T_DEC DEC, INSERTED INS
WHERE	DEC.CD_CHG = INS.CD_CHG AND
	INS.QT_DEC_DES_DOM IS NULL AND
	INS.QT_DEC_DES_INT IS NULL AND
	INS.QT_DEC_DES_BAG_DOM IS NULL AND
	INS.QT_DEC_DES_BAG_INT IS NULL AND
	INS.QT_DEC_DES_CAR_DOM IS NULL AND
	INS.QT_DEC_DES_CAR_INT IS NULL AND
	INS.QT_DEC_DES_COR_DOM IS NULL AND
	INS.QT_DEC_DES_COR_INT IS NULL AND
	INS.QT_DEC_TRA_BAG_DOM IS NULL AND
	INS.QT_DEC_TRA_BAG_INT IS NULL AND
	INS.QT_DEC_TRA_CAR_DOM IS NULL AND
	INS.QT_DEC_TRA_CAR_INT IS NULL AND
	INS.QT_DEC_TRA_COR_DOM IS NULL AND
	INS.QT_DEC_TRA_COR_INT IS NULL

/* Não permitir Informações Internacionais para Vôos Regionais */
If (	SELECT 	COUNT(*) 
	FROM	INSERTED INS, T_CHG CHG
	WHERE	CHG.CD_CHG = INS.CD_CHG AND
		CHG.TP_CHG = 3 AND
		(INS.QT_DEC_DES_INT IS NOT NULL OR
		INS.QT_DEC_DES_BAG_INT IS NOT NULL OR
		INS.QT_DEC_DES_CAR_INT IS NOT NULL OR
		INS.QT_DEC_DES_COR_INT IS NOT NULL OR 
		INS.QT_DEC_TRA_BAG_INT IS NOT NULL OR 
		INS.QT_DEC_TRA_CAR_INT IS NOT NULL OR
		INS.QT_DEC_TRA_COR_INT IS NOT NULL) ) &gt; 0
BEGIN
	RollBack Transaction
	RaisError 20001 &#39;Operação não executada: Não é permitido Informações Internacionais para Vôos Regionais.&#39;
	Return

END
End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o291">
<a:ObjectID>6958A535-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_DEC_TRU</a:Name>
<a:Code>T_DEC_TRU</a:Code>
<a:Text>Create Trigger T_DEC_TRU On T_DEC
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_CHG)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do  Vôo de Chegada&gt; da tabela &lt;Dados Estatísticos de Chegada&gt; não pode ser alterada.&#39;
  Return
End
/* Regra de negócio */
/* Se todos os campos do registro que está sendo alterado forem nulos, deletar o registro */
DELETE	T_DEC
FROM	T_DEC DEC, INSERTED INS
WHERE	DEC.CD_CHG = INS.CD_CHG AND
	INS.QT_DEC_DES_DOM IS NULL AND
	INS.QT_DEC_DES_INT IS NULL AND
	INS.QT_DEC_DES_BAG_DOM IS NULL AND
	INS.QT_DEC_DES_BAG_INT IS NULL AND
	INS.QT_DEC_DES_CAR_DOM IS NULL AND
	INS.QT_DEC_DES_CAR_INT IS NULL AND
	INS.QT_DEC_DES_COR_DOM IS NULL AND
	INS.QT_DEC_DES_COR_INT IS NULL AND
	INS.QT_DEC_TRA_BAG_DOM IS NULL AND
	INS.QT_DEC_TRA_BAG_INT IS NULL AND
	INS.QT_DEC_TRA_CAR_DOM IS NULL AND
	INS.QT_DEC_TRA_CAR_INT IS NULL AND
	INS.QT_DEC_TRA_COR_DOM IS NULL AND
	INS.QT_DEC_TRA_COR_INT IS NULL

/* Não permitir Informações Internacionais para Vôos Regionais */
If (	SELECT 	COUNT(*) 
	FROM	INSERTED INS, T_CHG CHG
	WHERE	CHG.CD_CHG = INS.CD_CHG AND
		CHG.TP_CHG = 3 AND
		(INS.QT_DEC_DES_INT IS NOT NULL OR
		INS.QT_DEC_DES_BAG_INT IS NOT NULL OR
		INS.QT_DEC_DES_CAR_INT IS NOT NULL OR
		INS.QT_DEC_DES_COR_INT IS NOT NULL OR 
		INS.QT_DEC_TRA_BAG_INT IS NOT NULL OR 
		INS.QT_DEC_TRA_CAR_INT IS NOT NULL OR
		INS.QT_DEC_TRA_COR_INT IS NOT NULL) ) &gt; 0
BEGIN
	RollBack Transaction
	RaisError 20001 &#39;Operação não executada: Não é permitido Informações Internacionais para Vôos Regionais.&#39;
	Return

END
End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o289"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o6"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o292">
<a:ObjectID>6958A5AE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_21</a:Name>
<a:Code>REFERENCE_21</a:Code>
<a:CreationDate>1081688849</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081688849</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o7"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o272"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o39"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o293">
<a:ObjectID>6958A5B0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081688849</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081688849</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o8"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o273"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o294">
<a:CenterTextOffset>(3, 0)</a:CenterTextOffset>
<a:Rect>((-738022,686450), (-719424,704715))</a:Rect>
<a:ListOfPoints>((-738022,704715),(-719424,686450))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>12615680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Id="o295">
<a:Rect>((-742295,703476), (-733969,707076))</a:Rect>
<a:LineColor>12615680</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o296">
<a:ObjectID>6958A5AB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_CHGANT</a:Name>
<a:Code>T_CHGANT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o297">
<a:ObjectID>6958A601-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_CHG</a:Name>
<a:Code>CD_CHG</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o298">
<a:ObjectID>6958A602-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_CHGANT</a:Name>
<a:Code>Pk_T_CHGANT</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_CHGANT</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o297"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Owner>
<o:User Ref="o59"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o299">
<a:ObjectID>6958A51A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_CHGANT_TRI</a:Name>
<a:Code>T_CHGANT_TRI</a:Code>
<a:Text>Create Trigger T_CHGANT_TRI On T_CHGANT
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Chegadas»Chegadas Candidatas a Vôo Antecessor: Vôo de Chegada candidato a antecessor */
If (Select Count(*) From T_CHG, Inserted
Where T_CHG.CD_CHG = Inserted.CD_CHG)
 &lt;&gt;(Select Count(CD_CHG) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Chegadas&gt; que se deseja incluir na tabela &lt;Chegadas Candidatas a Vôo Antecessor&gt; não está cadastrada&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o300">
<a:ObjectID>6958A51C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_CHGANT_TRU</a:Name>
<a:Code>T_CHGANT_TRU</a:Code>
<a:Text>Create Trigger T_CHGANT_TRU On T_CHGANT
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_CHG)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do  Vôo de Chegada candidato a Antecessor&gt; da tabela &lt;Chegadas Candidatas a Vôo Antecessor&gt; não pode ser alterada.&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o298"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o6"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o301">
<a:ObjectID>6958A5B3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_22</a:Name>
<a:Code>REFERENCE_22</a:Code>
<a:CreationDate>1081689056</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081689056</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o7"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o296"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o39"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o302">
<a:ObjectID>6958A5B5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081689056</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081689056</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o8"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o297"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o303">
<a:CenterTextOffset>(903, -2100)</a:CenterTextOffset>
<a:Rect>((-739440,687050), (-719424,720924))</a:Rect>
<a:ListOfPoints>((-719424,687050),(-739440,720924))</a:ListOfPoints>
<a:ArrowStyle>4881</a:ArrowStyle>
<a:LineColor>12615680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o6"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o304">
<a:Rect>((-742753,718651), (-736127,723197))</a:Rect>
<a:LineColor>12615680</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o305">
<a:ObjectID>6958A58F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_AEN</a:Name>
<a:Code>T_AEN</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081691471</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o306">
<a:ObjectID>6958A56E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_AEN</a:Name>
<a:Code>CD_AEN</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o307">
<a:ObjectID>6958A570-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_AEN</a:Name>
<a:Code>NR_AEN</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(10)</a:DataType>
<a:Length>10</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o308">
<a:ObjectID>6958A572-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_AEN_ASS_DIS</a:Name>
<a:Code>NR_AEN_ASS_DIS</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o309">
<a:ObjectID>6958A574-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_AEN_CRG</a:Name>
<a:Code>QT_AEN_CRG</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>float(15)</a:DataType>
<a:Length>15</a:Length>
</o:Column>
<o:Column Id="o310">
<a:ObjectID>6958A578-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_AEN_USR</a:Name>
<a:Code>NM_AEN_USR</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(30)</a:DataType>
<a:Length>30</a:Length>
</o:Column>
<o:Column Id="o311">
<a:ObjectID>6958A579-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_AEN_ISE</a:Name>
<a:Code>FL_AEN_ISE</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o312">
<a:ObjectID>6958A57A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o313">
<a:ObjectID>6958A581-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_AEN</a:Name>
<a:Code>Pk_T_AEN</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_AEN</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o306"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o314">
<a:ObjectID>6958A57D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_AENAEN</a:Name>
<a:Code>I_AENAEN</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o315">
<a:ObjectID>6958A57E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o307"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o316">
<a:ObjectID>6958A57F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_AENCOM</a:Name>
<a:Code>I_AENCOM</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081691471</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Ref="o59"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o317">
<a:ObjectID>6958A4EE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_AEN_TRD</a:Name>
<a:Code>T_AEN_TRD</a:Code>
<a:Text>Create Trigger T_AEN_TRD On T_AEN
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Aeronave»Chegadas - Mirror: Aeronave da Chegada (Restrict) */
If (Select Count(*) From T_CHG_MIR dep, Deleted pri
 Where dep.CD_AEN_CHG = pri.CD_AEN) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeronave&gt; está sendo referenciada na tabela &lt;Chegadas - Mirror&gt;&#39;
  Return
End
/* Aeronave»Chegadas: Aeronave da Chegada (Restrict) */
If (Select Count(*) From T_CHG dep, Deleted pri
 Where dep.CD_AEN_CHG = pri.CD_AEN) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeronave&gt; está sendo referenciada na tabela &lt;Chegadas&gt;&#39;
  Return
End
/* Aeronave»Histórico de Permanência de Aeronaves: Aeronave do HPA (Restrict) */
Declare @DBBDsc varchar(255)
Select @DBBDsc = &#39;(&#39;
Select @DBBDsc = @DBBDsc+RTrim(Convert(varchar(255),(Select NR_CHG_VOO from T_CHG where CD_CHG = dep.CD_CHG)))+&#39;, &#39; From T_HPA001 dep, Deleted pri
 Where dep.CD_AEN = pri.CD_AEN
If DataLength(@DBBDsc) &gt; 1
Begin
  RollBack Transaction
  If DataLength(@DBBDsc) &gt; 252
    Select @DBBDsc = Substring(@DBBDsc,1,252)+&#39;...&#39;
  Else
    Select @DBBDsc = Substring(@DBBDsc,1,DataLength(@DBBDsc)-2)
  Select @DBBDsc = &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeronave&gt; está sendo referenciada na tabela &lt;Histórico de Permanência de Aeronaves&gt; &#39;+@DBBDsc+&#39;)&#39;
  RaisError 20003 @DBBDsc
  Return
End
/* Aeronave»Histórico de Permanência de Aeronaves - Mirror: Aeronave do HPA (Restrict) */
Select @DBBDsc = &#39;(&#39;
Select @DBBDsc = @DBBDsc+RTrim(Convert(varchar(255),(Select NR_CHG_VOO From T_CHG Where CD_CHG = dep.CD_CHG)))+&#39;, &#39; From T_HPA001_MIR dep, Deleted pri
 Where dep.CD_AEN = pri.CD_AEN
If DataLength(@DBBDsc) &gt; 1
Begin
  RollBack Transaction
  If DataLength(@DBBDsc) &gt; 252
    Select @DBBDsc = Substring(@DBBDsc,1,252)+&#39;...&#39;
  Else
    Select @DBBDsc = Substring(@DBBDsc,1,DataLength(@DBBDsc)-2)
  Select @DBBDsc = &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeronave&gt; está sendo referenciada na tabela &lt;Histórico de Permanência de Aeronaves - Mirror&gt; &#39;+@DBBDsc+&#39;)&#39;
  RaisError 20003 @DBBDsc
  Return
End
End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o318">
<a:ObjectID>6958A4EF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_AEN_TRI</a:Name>
<a:Code>T_AEN_TRI</a:Code>
<a:Text>Create Trigger T_AEN_TRI On T_AEN
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Companhia Aérea»Aeronave: Companh Aérea possui Aeronaves */
If (Select Count(*) From T_COM, Inserted
Where T_COM.CD_COM = Inserted.CD_COM)
 &lt;&gt;(Select Count(CD_COM) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Companhia Aérea&gt; que se deseja incluir na tabela &lt;Aeronave&gt; não está cadastrada&#39;
  Return
End
/* Equipamento»Aeronave: Equipamento */
If (Select Count(*) From T_EQP, Inserted
Where T_EQP.CD_EQP = Inserted.CD_EQP)
 &lt;&gt;(Select Count(CD_EQP) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Equipamento&gt; que se deseja incluir na tabela &lt;Aeronave&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
/* Nome do usuário que incluiu a aeronave */
Update	T_AEN
Set	NM_AEN_USR = (	select name from master..syslogins where suid in (
			select suid from master..sysprocesses where spid = @@spid))
From	Inserted INS, T_AEN AEN
Where	AEN.CD_AEN = INS.CD_AEN

End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o319">
<a:ObjectID>6958A4F1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_AEN_TRU</a:Name>
<a:Code>T_AEN_TRU</a:Code>
<a:Text>Create Trigger T_AEN_TRU On T_AEN
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_AEN)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código da Aeronave&gt; da tabela &lt;Aeronave&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_COM)
/* Companhia Aérea»Aeronave: Companh Aérea possui Aeronaves */
If (Select Count(*) From T_COM, Inserted
Where T_COM.CD_COM = Inserted.CD_COM)
 &lt;&gt;(Select Count(CD_COM) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Companhia Aérea&gt; que se deseja incluir na tabela &lt;Aeronave&gt; não está cadastrada&#39;
  Return
End
If Update (CD_EQP)
/* Equipamento»Aeronave: Equipamento */
If (Select Count(*) From T_EQP, Inserted
Where T_EQP.CD_EQP = Inserted.CD_EQP)
 &lt;&gt;(Select Count(CD_EQP) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Equipamento&gt; que se deseja incluir na tabela &lt;Aeronave&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
/* Nome do usuário que Alterou a aeronave */
Update	T_AEN
Set	NM_AEN_USR = (	select name from master..syslogins where suid in (
			select suid from master..sysprocesses where spid = @@spid))
From	Inserted INS, T_AEN AEN
Where	AEN.CD_AEN = INS.CD_AEN

IF UPDATE(NR_AEN) OR UPDATE(CD_EQP)
BEGIN
	/* Incluir Registros em T_ACH */
	INSERT	T_ACH (DH_ACH, CD_CHG)
	Select 	GETDATE(), CD_CHG
	From 	T_CHG CHG, INSERTED INS
	Where	CHG.TP_CHG_STA = 1 AND
		CHG.CD_AER = (Select CD_AER From T_PSI) AND
		CHG.CD_AEN_CHG = INS.CD_AEN

	/* Incluir Registros em T_APA */
	INSERT	T_APA (DH_APA, CD_PAR)
	Select 	GETDATE(), CD_PAR
	From 	T_PAR PAR, T_CHG CHG, INSERTED INS
	Where	PAR.TP_PAR_STA = 1 AND
		PAR.CD_AER = (Select CD_AER From T_PSI) AND
		CHG.CD_CHG = PAR.CD_CHG_AEN_ANT AND
		CHG.CD_AEN_CHG = INS.CD_AEN

	/* Incluir Registros em T_AHP */
	INSERT	T_AHP (CD_HPA, DH_AHP)
	Select	DISTINCT CD_HPA, GETDATE()
	From	T_HPA001 HPA, T_CHG CHG, T_SIT SIT, INSERTED INS
	Where	HPA.CD_CHG = CHG.CD_CHG AND
		SIT.CD_SIT = CHG.CD_SIT AND
		HPA.CD_AER = (Select CD_AER From T_PSI) AND
		(HPA.FL_HPA_ENT = 1 OR SIT.FL_SIT_AEN_PAT = 1) AND
		HPA.FL_HPA_SAI = 0 AND
		HPA.CD_AEN = INS.CD_AEN
END

End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o313"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o320">
<a:ObjectID>6958A60D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_19</a:Name>
<a:Code>REFERENCE_19</a:Code>
<a:CreationDate>1081691654</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081691654</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o305"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o7"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o313"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o321">
<a:ObjectID>6958A60F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081691654</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081691654</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o306"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o35"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o322">
<a:CenterTextOffset>(150, 2400)</a:CenterTextOffset>
<a:Rect>((-723373,687800), (-715499,722547))</a:Rect>
<a:ListOfPoints>((-718149,687800),(-721264,722547))</a:ListOfPoints>
<a:ArrowStyle>4881</a:ArrowStyle>
<a:LineColor>12615680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o6"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o323">
<a:Rect>((-723416,719247), (-716712,722847))</a:Rect>
<a:LineColor>12615680</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o324">
<a:ObjectID>6958A5C1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_EQP</a:Name>
<a:Code>T_EQP</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o325">
<a:ObjectID>6958A4F2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_EQP</a:Name>
<a:Code>CD_EQP</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o326">
<a:ObjectID>6958A4F4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_EQP</a:Name>
<a:Code>NM_EQP</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(20)</a:DataType>
<a:Length>20</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o327">
<a:ObjectID>6958A4F6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SG_EQP</a:Name>
<a:Code>SG_EQP</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(10)</a:DataType>
<a:Length>10</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o328">
<a:ObjectID>6958A4F8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_EQP_ASS_MIN</a:Name>
<a:Code>NR_EQP_ASS_MIN</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o329">
<a:ObjectID>6958A4F9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_EQP_ASS_MAX</a:Name>
<a:Code>NR_EQP_ASS_MAX</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o330">
<a:ObjectID>6958A4FA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_EQP_CRG_MIN</a:Name>
<a:Code>QT_EQP_CRG_MIN</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>float(15)</a:DataType>
<a:Length>15</a:Length>
</o:Column>
<o:Column Id="o331">
<a:ObjectID>6958A4FB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_EQP_CRG_MAX</a:Name>
<a:Code>QT_EQP_CRG_MAX</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>float(15)</a:DataType>
<a:Length>15</a:Length>
</o:Column>
<o:Column Id="o332">
<a:ObjectID>6958A4FC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_EQP_PMD</a:Name>
<a:Code>QT_EQP_PMD</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>float(15)</a:DataType>
<a:Length>15</a:Length>
</o:Column>
<o:Column Id="o333">
<a:ObjectID>6958A4FD-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_EQP_ENV</a:Name>
<a:Code>QT_EQP_ENV</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>float(15)</a:DataType>
<a:Length>15</a:Length>
</o:Column>
<o:Column Id="o334">
<a:ObjectID>6958A4FE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_EQP_COM</a:Name>
<a:Code>QT_EQP_COM</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>float(15)</a:DataType>
<a:Length>15</a:Length>
</o:Column>
<o:Column Id="o335">
<a:ObjectID>6958A4FF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_EQP_HLC</a:Name>
<a:Code>FL_EQP_HLC</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o336">
<a:ObjectID>6958A500-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o337">
<a:ObjectID>6958A503-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_EQP</a:Name>
<a:Code>Pk_T_EQP</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_EQP</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o325"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o338">
<a:ObjectID>6958A501-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_EQP_SGL</a:Name>
<a:Code>I_EQP_SGL</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o339">
<a:ObjectID>6958A502-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o327"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Ref="o59"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o340">
<a:ObjectID>6958A559-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_EQP_TRD</a:Name>
<a:Code>T_EQP_TRD</a:Code>
<a:Text>Create Trigger T_EQP_TRD On T_EQP
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Equipamento»Hotran - Etapa: É Equipamento da Etapa (Restrict) */
If (Select Count(*) From T_HET dep, Deleted pri
 Where dep.SG_EQP = pri.SG_EQP) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Equipamento&gt; está sendo referenciada na tabela &lt;Hotran - Etapa&gt;&#39;
  Return
End
/* Equipamento»Aeronave: Equipamento (Restrict) */
If (Select Count(*) From T_AEN dep, Deleted pri
 Where dep.CD_EQP = pri.CD_EQP) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Equipamento&gt; está sendo referenciada na tabela &lt;Aeronave&gt;&#39;
  Return
End
/* Equipamento»Chegadas - Mirror: Equipamento da Chegada (Restrict) */
If (Select Count(*) From T_CHG_MIR dep, Deleted pri
 Where dep.CD_EQP_CHG = pri.CD_EQP) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Equipamento&gt; está sendo referenciada na tabela &lt;Chegadas - Mirror&gt;&#39;
  Return
End
/* Equipamento»Chegadas: Equipamento da Chegada (Restrict) */
If (Select Count(*) From T_CHG dep, Deleted pri
 Where dep.CD_EQP_CHG = pri.CD_EQP) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Equipamento&gt; está sendo referenciada na tabela &lt;Chegadas&gt;&#39;
  Return
End
/* Equipamento»Hotran - Boxes: Equipamento do HBX (Restrict) */
If (Select Count(*) From T_HBX001 dep, Deleted pri
 Where dep.SG_EQP = pri.SG_EQP) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Equipamento&gt; está sendo referenciada na tabela &lt;Hotran - Boxes&gt;&#39;
  Return
End
/* Equipamento»Histórico de Permanência de Aeronaves - Mirror: Equipamento do HPA (Restrict) */
If (Select Count(*) From T_HPA001_MIR dep, Deleted pri
 Where dep.CD_EQP = pri.CD_EQP) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Equipamento&gt; está sendo referenciada na tabela &lt;Histórico de Permanência de Aeronaves - Mirror&gt;&#39;
  Return
End
/* Equipamento»Histórico de Permanência de Aeronaves: Equipamento do HPA (Restrict) */
If (Select Count(*) From T_HPA001 dep, Deleted pri
 Where dep.CD_EQP = pri.CD_EQP) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Equipamento&gt; está sendo referenciada na tabela &lt;Histórico de Permanência de Aeronaves&gt;&#39;
  Return
End
/* Equipamento»Boxes do Equipamento: Boxes do Equipamento (Cascade) */
Delete T_BEQ From T_BEQ dep, Deleted pri
 Where dep.CD_EQP = pri.CD_EQP
End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o341">
<a:ObjectID>6958A55C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_EQP_TRU</a:Name>
<a:Code>T_EQP_TRU</a:Code>
<a:Text>Create Trigger T_EQP_TRU On T_EQP
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_EQP)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Equipamento&gt; da tabela &lt;Equipamento&gt; não pode ser alterada.&#39;
  Return
End
/* Regra de negócio */
/* Caso a sigla do equipamento seja alterada, alterar os campos correspondente nas tabelas T_HBX001 e T_HET */
IF UPDATE(SG_EQP)
BEGIN
	UPDATE	HBX
	SET	SG_EQP = INS.SG_EQP
	FROM	T_HBX001 HBX, INSERTED INS, DELETED DEL
	WHERE	INS.CD_EQP = DEL.CD_EQP AND
		HBX.SG_EQP = DEL.SG_EQP

	UPDATE	HET
	SET	SG_EQP = INS.SG_EQP
	FROM	T_HET HET, INSERTED INS, DELETED DEL
	WHERE	INS.CD_EQP = DEL.CD_EQP AND
		HET.SG_EQP = DEL.SG_EQP
END

IF UPDATE(SG_EQP)
BEGIN
	/* Incluir Registros em T_ACH */
	INSERT	T_ACH (DH_ACH, CD_CHG)
	Select 	GETDATE(), CD_CHG
	From 	T_CHG CHG, T_EQP EQP, T_AEN AEN, INSERTED INS
	Where	CHG.TP_CHG_STA = 1 AND
		CHG.CD_AER = (Select CD_AER From T_PSI) AND
		AEN.CD_AEN = CHG.CD_AEN_CHG AND
		EQP.CD_EQP = AEN.CD_EQP AND
		EQP.CD_EQP = INS.CD_EQP

	/* Incluir Registros em T_APA */
	INSERT	T_APA (DH_APA, CD_PAR)
	Select 	GETDATE(), CD_PAR
	From 	T_PAR PAR, T_CHG CHG, T_EQP EQP, T_AEN AEN, INSERTED INS
	Where	PAR.TP_PAR_STA = 1 AND
		PAR.CD_AER = (Select CD_AER From T_PSI) AND
		CHG.CD_CHG = PAR.CD_CHG_AEN_ANT AND
		AEN.CD_AEN = CHG.CD_AEN_CHG AND
		EQP.CD_EQP = AEN.CD_EQP AND
		EQP.CD_EQP = INS.CD_EQP

	/* Incluir Registros em T_AHP */
	INSERT	T_AHP (CD_HPA, DH_AHP)
	Select	DISTINCT CD_HPA, GETDATE()
	From	T_HPA001 HPA, T_CHG CHG, T_SIT SIT, T_AEN AEN, T_EQP EQP, INSERTED INS
	Where	HPA.CD_CHG = CHG.CD_CHG AND
		SIT.CD_SIT = CHG.CD_SIT AND
		HPA.CD_AER = (Select CD_AER From T_PSI) AND
		(HPA.FL_HPA_ENT = 1 OR SIT.FL_SIT_AEN_PAT = 1) AND
		HPA.FL_HPA_SAI = 0 AND
		AEN.CD_AEN = HPA.CD_AEN AND
		EQP.CD_EQP = AEN.CD_EQP AND
		EQP.CD_EQP = INS.CD_EQP
END

End
go</a:Text>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o337"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o342">
<a:ObjectID>6958A4D2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_20</a:Name>
<a:Code>REFERENCE_20</a:Code>
<a:CreationDate>1081691754</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081691754</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o324"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o7"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o337"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o343">
<a:ObjectID>6958A4D4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081691754</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081691754</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o325"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o36"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:TableSymbol Ref="o208"/>
<o:TableSymbol Ref="o146"/>
<o:TableSymbol Ref="o135"/>
<o:TableSymbol Ref="o192"/>
<o:TableSymbol Ref="o323"/>
<o:TableSymbol Ref="o83"/>
<o:TableSymbol Ref="o271"/>
<o:TableSymbol Ref="o166"/>
<o:TableSymbol Ref="o295"/>
<o:TableSymbol Ref="o6"/>
<o:TableSymbol Ref="o96"/>
<o:TableSymbol Ref="o63"/>
<o:TableSymbol Ref="o304"/>
<o:TableSymbol Ref="o223"/>
<o:TableSymbol Ref="o253"/>
</c:Symbols>
</o:PhysicalDiagram>
</c:PhysicalDiagrams>
<c:DefaultDiagram>
<o:PhysicalDiagram Ref="o4"/>
</c:DefaultDiagram>
<c:Users>
<o:User Ref="o59"/>
</c:Users>
<c:Procedures>
<o:Procedure Id="o344">
<a:ObjectID>6958A54D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_BCL_DEL</a:Name>
<a:Code>SP_BCL_DEL</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_BCL_DEL    Script Date: 7/8/2000 12:15:32 ******/
Create Procedure SP_BCL_DEL
(@CD_BCP	INT, @CD_BCP_LIM	INT) As
/* Deletar todos os BCL  que sejam limitantes de CD_BCP de mesmo BOX e tipo e com valor menor que o deletado */
DELETE BCL
FROM	T_BCL BCL,
	T_BCP BCP,
	T_BCP BCPLIM
WHERE	BCL.CD_BCP = @CD_BCP AND
	BCL.CD_BCP_LIM = BCPLIM.CD_BCP AND
	BCP.CD_BCP = @CD_BCP_LIM AND
	BCPLIM.CD_BOX = BCP.CD_BOX AND
	BCPLIM.TP_BCP = BCP.TP_BCP AND
	BCPLIM.VL_BCP &lt; BCP.VL_BCP

/* Deletar todos os BCL  que sejam limitantes de CD_BCP_LIM de mesmo BOX e tipo e com valor menor que o deletado */
DELETE BCL
FROM	T_BCL BCL,
	T_BCP BCP,
	T_BCP BCPLIM
WHERE	BCL.CD_BCP = @CD_BCP_LIM AND
	BCL.CD_BCP_LIM = BCPLIM.CD_BCP AND
	BCP.CD_BCP = @CD_BCP AND
	BCPLIM.CD_BOX = BCP.CD_BOX AND
	BCPLIM.TP_BCP = BCP.TP_BCP AND
	BCPLIM.VL_BCP &lt; BCP.VL_BCP
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o59"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o345">
<a:ObjectID>6958A54E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_BCL_INS</a:Name>
<a:Code>SP_BCL_INS</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_BCL_INS    Script Date: 7/8/2000 12:15:32 ******/
Create Procedure SP_BCL_INS
(@CD_BCP	INT, @CD_BCP_LIM	INT) As
/* Verificar se há BCLs cujos boxes de BCP e BCP_LIM sejam iguais */
IF	(SELECT COUNT(*) FROM T_BCP BCP, T_BCP BCPLIM
	WHERE	BCP.CD_BCP = @CD_BCP AND
		BCPLIM.CD_BCP = @CD_BCP_LIM AND
		BCP.CD_BOX = BCPLIM.CD_BOX) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: Um box não pode ser referenciado como limitante do próprio box&#39;
	RETURN
END

/* Inserir como limitante de CD_BCP todos os CD_BCP do mesmo tipo e de valor maior ao inserido */
INSERT INTO T_BCL(CD_BCP, CD_BCP_LIM)
SELECT 	@CD_BCP, BCPLIM.CD_BCP
FROM	T_BCP BCP,
	T_BCP BCPLIM
WHERE	BCP.CD_BCP = @CD_BCP_LIM AND
	BCPLIM.CD_BOX = BCP.CD_BOX AND
	BCPLIM.TP_BCP = BCP.TP_BCP AND
	BCPLIM.VL_BCP &gt; BCP.VL_BCP


/* Inserir como limitante de CD_BCP_LIM todos os CD_BCP do mesmo tipo e de valor maior ao inserido */
INSERT INTO T_BCL(CD_BCP, CD_BCP_LIM)
SELECT 	@CD_BCP_LIM, BCPLIM.CD_BCP
FROM	T_BCP BCP,
	T_BCP BCPLIM
WHERE	BCP.CD_BCP = @CD_BCP AND
	BCPLIM.CD_BOX = BCP.CD_BOX AND
	BCPLIM.TP_BCP = BCP.TP_BCP AND
	BCPLIM.VL_BCP &gt; BCP.VL_BCP
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o59"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o346">
<a:ObjectID>6958A54F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_CriaStatus</a:Name>
<a:Code>SP_CriaStatus</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_CriaStatus    Script Date: 7/8/2000 12:15:31 ******/
Create Procedure SP_CriaStatus As
/* Verificar se existe algum registro em T_STA */
IF EXISTS (SELECT * FROM T_STA)
BEGIN
	RAISERROR 30000 &#39;OPERAÇÃO NÃO EXECUTADA: HÁ REGISTROS NA TABELA DE STATUS&#39;
	RETURN
END

/* CRIAR CURSOR COM OS DADOS PARA GERAÇÃO DOS STATUS */
/* Declaração do cursor */
/* Criar um cursor com dados do primeiro e do último registro de cada HPA cuja entrada 
   esteja concluída */
DECLARE CRIAR_STATUS CURSOR FOR
	SELECT	HPA1.CD_HPA,
		HPA1.DH_HPA_ENT,
		MA_STA_ABE = DATEADD(SS, -DATEPART(SS, HPA1.DH_HPA_ENT) - 60*DATEPART(MI, HPA1.DH_HPA_ENT) - 60*60*DATEPART(HH, HPA1.DH_HPA_ENT) - 24*60*60*DATEPART(DD, HPA1.DH_HPA_ENT) + 24*60*60, HPA1.DH_HPA_ENT),
		HPA2.DH_HPA_SAI,
		MA_STA_FEC = DATEADD(SS, -DATEPART(SS, HPA2.DH_HPA_SAI) - 60*DATEPART(MI, HPA2.DH_HPA_SAI) - 60*60*DATEPART(HH, HPA2.DH_HPA_SAI) - 24*60*60*DATEPART(DD, HPA2.DH_HPA_SAI) + 24*60*60, HPA2.DH_HPA_SAI),
		TP_STA = CONVERT(INT, HPA2.FL_HPA_SAI) + 1
	FROM	T_HPA001 HPA1,
		T_HPA001 HPA2
	WHERE	HPA2.CD_HPA = HPA1.CD_HPA AND
		HPA2.NR_HPA_SEQ = (SELECT MAX(NR_HPA_SEQ) FROM T_HPA001 HPA3 WHERE HPA3.CD_HPA = HPA1.CD_HPA) AND
		HPA1.NR_HPA_SEQ = 1 AND
		HPA1.FL_HPA_ENT = 1
	ORDER BY HPA1.DH_HPA_ENT


/* Declaração de variáveis */
DECLARE	@CD_HPA 	INT,
	@DH_STA_ABE	SMALLDATETIME,
	@MA_STA_ABE	SMALLDATETIME,
	@DH_STA_FEC	SMALLDATETIME,
	@MA_STA_FEC	SMALLDATETIME,
	@TP_STA		INT,
	@CD_STA		INT,
	@NR_STA		INT

/* Abrir cursor */
OPEN CRIAR_STATUS

/* Ir para o primeiro registro */
FETCH	CRIAR_STATUS
INTO	@CD_HPA,
	@DH_STA_ABE,
	@MA_STA_ABE,
	@DH_STA_FEC,
	@MA_STA_FEC,
	@TP_STA

/* Processar todos os registros de CRIAR_STATUS */
WHILE @@FETCH_STATUS = 0
BEGIN

	/* Anular @DH_STA_FEC e @MA_STA_FEC caso @TP_STA = 1 */
	IF @TP_STA = 1 	SELECT  @DH_STA_FEC = NULL, @MA_STA_FEC = NULL

	/* Identificar o próximo número de STATUS disponível */
	SELECT @CD_STA = (SELECT ISNULL(MAX(CD_STA),0) + 1 FROM T_STA)

	/* Incluir um novo status */
	INSERT	INTO T_STA (
		CD_STA,
		DH_STA_ABE,

		MA_STA_ABE,
		NR_STA,
		DH_STA_FEC,
		MA_STA_FEC,
		TP_STA)
	SELECT	@CD_STA,
		@DH_STA_ABE,
		@MA_STA_ABE,
		(SELECT ISNULL(MAX(NR_STA), 0) + 1 FROM T_STA WHERE MA_STA_ABE = @MA_STA_ABE),
		@DH_STA_FEC,
		@MA_STA_FEC,
		@TP_STA

	/* Atualizar HPA */
	UPDATE	T_HPA001
	SET	CD_STA = @CD_STA
	WHERE	CD_HPA = @CD_HPA

	/* Ir para o próximo registro */
	FETCH	NEXT FROM CRIAR_STATUS
	INTO	@CD_HPA,
		@DH_STA_ABE,
		@MA_STA_ABE,
		@DH_STA_FEC,
		@MA_STA_FEC,
		@TP_STA

END
CLOSE CRIAR_STATUS
DEALLOCATE CRIAR_STATUS
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o59"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o347">
<a:ObjectID>6958A551-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_DIA</a:Name>
<a:Code>SP_DIA</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_DIA    Script Date: 7/8/2000 12:15:32 ******/
Create Procedure SP_DIA
(@DS_FRQ_IN CHAR(30), @DS_FRQ_OUT CHAR(30) OUTPUT, @DS_DIA CHAR(03) OUTPUT) As
DECLARE @NR_POS INTEGER

SELECT @DS_DIA = &#39;&#39;
SELECT @DS_FRQ_OUT = &#39;&#39;
SELECT @NR_POS = CHARINDEX(&#39;,&#39;, @DS_FRQ_IN)
IF (@NR_POS &gt; 0)
BEGIN
	SELECT @DS_DIA = SUBSTRING(@DS_FRQ_IN, 1, @NR_POS)
	SELECT @DS_FRQ_OUT = SUBSTRING(@DS_FRQ_IN, @NR_POS + 1, 30 - (@NR_POS + 1))
END
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o59"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o348">
<a:ObjectID>6958A553-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_ExcTabPrincipal</a:Name>
<a:Code>SP_ExcTabPrincipal</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_ExcTabPrincipal    Script Date: 7/8/2000 12:15:32 ******/
Create Procedure SP_ExcTabPrincipal
(@pTipo INT) As
/* Objetivo:  Excluir das tabelas principais registros associados ao vôo de Chegada selecionado : 
T_CHG, T_CHA, T_HSC, T_DEC, T_ECC001, T_ESV001, T_CHGANT, T_STA, T_HPA001 */
   
/* Chegada com partida associada */
If @pTipo = 1
BEGIN
	/* &#39;Exclui vôos Codeshare ou Duplicate Leg vinculados ao vôo de Partida associado ao vôo de Chegada selecionado */
	Delete T_HSP Where CD_PAR IN (SELECT CD_PAR FROM T_MIR_LOG_PAR_001)
	IF @@ERROR &gt; 0 RETURN
       
         	/* Exclui vôos Codeshare ou Duplicate Leg vinculados ao vôo de Partida associado ao vôo de Chegada selecionado */
	Delete T_PAR Where CD_PAR IN (SELECT CD_PAR FROM T_MIR_LOG_PAR_001)
	IF @@ERROR &gt; 0 RETURN

	/* Exclui movimentação de situação dos vôos de Partida associadoS ao vôo de Chegada selecionado */
	Delete T_HSP Where CD_PAR IN (SELECT CD_PAR FROM T_MIR_LOG_PAR)
	IF @@ERROR &gt; 0 RETURN

	/* Exclui vôos de Partida associadoS ao vôo de Chegada selecionado */
	Delete T_PAR Where CD_PAR IN (SELECT CD_PAR FROM T_MIR_LOG_PAR)
	IF @@ERROR &gt; 0 RETURN
     
	/* Exclui histórico de situação dos vôos Codeshare ou Duplicate Leg vinculados ao vôo de Chegada selecionado */
	Delete T_HSC Where CD_CHG IN (SELECT CD_CHG FROM T_MIR_LOG_CHG_001)
	IF @@ERROR &gt; 0 RETURN

	/* Exclui vôos Codeshare ou Duplicate Leg vinculados ao vôo de Chegada selecionado */
	Delete T_CHG Where CD_CHG IN (SELECT CD_CHG FROM T_MIR_LOG_CHG_001)
	IF @@ERROR &gt; 0 RETURN

	/* Exclui movimentação de situação do vôo de Chegada selecionado */
	Delete T_HSC Where CD_CHG IN (SELECT CD_CHG FROM T_MIR_LOG_CHG)
	IF @@ERROR &gt; 0 RETURN

	/* Exclui vôo de Chegada selecionado */
	Delete T_CHG Where CD_CHG IN (SELECT CD_CHG FROM T_MIR_LOG_CHG)
	IF @@ERROR &gt; 0 RETURN
END
ELSE
BEGIN
	/* &#39;Vôos de Chegada Cancelados 2*/
	IF @pTipo = 2

	BEGIN
		/* Exclui movimentação de situação do vôo de Chegada selecionado */
		Delete T_HSC Where CD_CHG IN (SELECT CD_CHG FROM T_MIR_LOG_CHG_001)
		IF @@ERROR &gt; 0 RETURN

		/* Exclui vôo de Chegada selecionado */
		Delete T_CHG Where CD_CHG IN (SELECT CD_CHG FROM T_MIR_LOG_CHG_001)
		IF @@ERROR &gt; 0 RETURN
	END
	/* Vôos de Partida Cancelados 3*/
	ELSE
	BEGIN
		/* Exclui movimentação de situação do vôo de Partida selecionado */
		Delete T_HSP Where CD_PAR IN (SELECT CD_PAR FROM T_MIR_LOG_PAR_001)
		IF @@ERROR &gt; 0 RETURN

		/* Exclui vôo de Partida selecionado */
		Delete T_PAR Where CD_PAR IN (SELECT CD_PAR FROM T_MIR_LOG_PAR_001)
		IF @@ERROR &gt; 0 RETURN
	END
END
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o59"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o349">
<a:ObjectID>6958A555-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_IncTabEspRelCHG</a:Name>
<a:Code>SP_IncTabEspRelCHG</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_IncTabEspRelCHG    Script Date: 7/8/2000 12:15:32 ******/
Create Procedure SP_IncTabEspRelCHG As
Insert Into T_CHG_MIR (
	CD_CHG
	, DT_CHG
	, CD_AER
	, NR_CHG_VOO
	, NR_CHG_HOT
	, TP_CHG_GRU
	, TP_CHG
	, TP_CHG_NAT
	, TP_CHG_CTG
	, CD_COM
	, CD_CHG_VIN
	, FL_CHG_TEL
	, CD_EQP_CHG
	, CD_AEN_CHG
	, CD_BOX
	, QT_CHG_PER_MIN
	, DH_CHG_NRM
	, DH_CHG_EFE
	, DH_CHG_EST
	, CD_SIT
	, NM_CHG_COM_SIT
	, DH_CHG_SIT

	, FL_CHG_CAN
	, TP_CHG_STA
	, CD_IFT
	, CD_USR
	, FL_CHG_PAR_ORI)
Select	CHG.CD_CHG
	, DT_CHG
	, CD_AER
	, NR_CHG_VOO
	, NR_CHG_HOT
	, TP_CHG_GRU
	, TP_CHG
	, TP_CHG_NAT
	, TP_CHG_CTG
	, CD_COM
	, CD_CHG_VIN
	, FL_CHG_TEL
	, CD_EQP_CHG
	, CD_AEN_CHG
	, CD_BOX
	, QT_CHG_PER_MIN
	, DH_CHG_NRM
	, DH_CHG_EFE
	, DH_CHG_EST
	, CD_SIT
	, NM_CHG_COM_SIT
	, DH_CHG_SIT
	, FL_CHG_CAN
	, TP_CHG_STA
	, CD_IFT
	, CD_USR
	, FL_CHG_PAR_ORI
From	T_CHG CHG, T_MIR_LOG_CHG CHGTMP
Where	CHG.CD_CHG = CHGTMP.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_CHA, associados ao vôo de Chegada selecionado, para a tabela T_CHA espelho */
Insert Into T_CHA_MIR (
	CD_CHA
	, CD_CHG
	, CD_PAR

	, CD_IFT
	, DH_CHA
	, CD_MSG
	, CD_USR)
Select	CD_CHA
	, CHA.CD_CHG
	, CD_PAR
	, CD_IFT
	, DH_CHA
	, CD_MSG
	, CD_USR
From	T_CHA CHA, T_MIR_LOG_CHG CHG
Where	CHA.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_HSC, associados ao vôo de Chegada selecionado, para a tabela T_HSC espelho */
Insert Into T_HSC_MIR (
	DH_HSC
	, CD_CHG
	, CD_IFT

	, CD_SIT
	, DH_HSC_CHG
	, CD_USR
	, NM_HSC_USR)
Select	DH_HSC
	, HSC.CD_CHG
	, CD_IFT
	, CD_SIT
	, DH_HSC_CHG

	, CD_USR
	, NM_HSC_USR
From	T_HSC HSC, T_MIR_LOG_CHG CHG
Where	HSC.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_DEC, associados ao vôo de Chegada selecionado, para a tabela T_DEC espelho */
Insert Into T_DEC_MIR (
	CD_CHG
	, QT_DEC_DES_DOM
	, QT_DEC_DES_INT
	, QT_DEC_DES_BAG_DOM
	, QT_DEC_DES_BAG_INT
	, QT_DEC_DES_CAR_DOM
	, QT_DEC_DES_CAR_INT
	, QT_DEC_DES_COR_DOM
	, QT_DEC_DES_COR_INT
	, QT_DEC_TRA_BAG_DOM
	, QT_DEC_TRA_BAG_INT
	, QT_DEC_TRA_CAR_DOM
	, QT_DEC_TRA_CAR_INT
	, QT_DEC_TRA_COR_DOM
	, QT_DEC_TRA_COR_INT)
Select	DEC.CD_CHG
	, QT_DEC_DES_DOM
	, QT_DEC_DES_INT
	, QT_DEC_DES_BAG_DOM
	, QT_DEC_DES_BAG_INT

	, QT_DEC_DES_CAR_DOM
	, QT_DEC_DES_CAR_INT
	, QT_DEC_DES_COR_DOM
	, QT_DEC_DES_COR_INT
	, QT_DEC_TRA_BAG_DOM
	, QT_DEC_TRA_BAG_INT
	, QT_DEC_TRA_CAR_DOM
	, QT_DEC_TRA_CAR_INT
	, QT_DEC_TRA_COR_DOM
	, QT_DEC_TRA_COR_INT
From	T_DEC DEC, T_MIR_LOG_CHG CHG
Where	DEC.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
  
/* Transfere dados da tabela T_ECC001, associados ao vôo de Chegada selecionado, para a tabela T_ECC001 espelho */
Insert Into T_ECC001_MIR (
	CD_CHG
	, CD_ECC
	, CD_AER)
Select	ECC.CD_CHG
	, CD_ECC
	, CD_AER
From	T_ECC001 ECC, T_MIR_LOG_CHG CHG
Where	ECC.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_ESV001, associados ao vôo de Chegada selecionado, para a tabela T_ESV001 espelho */
Insert Into T_ESV001_MIR (
	CD_CHG
	, CD_EST)
Select	ESV.CD_CHG
	, CD_EST
From	T_ESV001 ESV, T_MIR_LOG_CHG CHG
Where	ESV.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_CHGANT, associados ao vôo de Chegada selecionado, para a tabela T_CHGANT espelho */
Insert Into T_CHGANT_MIR (CD_CHG)
Select	CHGANT.CD_CHG
From	T_CHGANT CHGANT, T_MIR_LOG_CHG CHG
Where	CHGANT.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_STA, associados ao vôo de Chegada selecionado, para a tabela T_STA espelho */
Insert Into T_STA_MIR (
	CD_STA
	, DH_STA_ABE
	, MA_STA_ABE
	, NR_STA
	, DH_STA_FEC
	, MA_STA_FEC
	, CD_STA_ANT
	, TP_STA
	, FL_STA_AEN_ISE
	, FL_STA_COM_TAR_RED
	, QT_STA_PSI_ISE
	, QT_STA_PSI_TAR_RED)
Select	CD_STA
	, DH_STA_ABE
	, MA_STA_ABE
	, NR_STA
	, DH_STA_FEC
	, MA_STA_FEC
	, CD_STA_ANT
	, TP_STA
	, FL_STA_AEN_ISE
	, FL_STA_COM_TAR_RED
	, QT_STA_PSI_ISE
	, QT_STA_PSI_TAR_RED
From	T_STA
Where	CD_STA In (  Select CD_STA
	             From  T_HPA001 HPA, T_MIR_LOG_CHG CHG
	             Where HPA.CD_CHG = CHG.CD_CHG)
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_HPA001 associados ao vôo de Chegada selecionado, para a tabela T_HPA001 espelho */
Insert Into T_HPA001_MIR (
	CD_HPA

	, NR_HPA_SEQ
	, CD_AER
	, CD_EQP
	, CD_AEN
	, CD_BOX
	, CD_CHG
	, DH_HPA_ENT
	, CD_PAR
	, DH_HPA_SAI
	, FL_HPA_ENT
	, FL_HPA_SAI
	, FL_HPA_TOK
	, CD_STA)
Select	CD_HPA
	, NR_HPA_SEQ
	, CD_AER
	, CD_EQP

	, CD_AEN
	, CD_BOX
	, HPA.CD_CHG
	, DH_HPA_ENT
	, CD_PAR
	, DH_HPA_SAI
	, FL_HPA_ENT
	, FL_HPA_SAI
	, FL_HPA_TOK
	, CD_STA
From	T_HPA001 HPA, T_MIR_LOG_CHG CHG
Where	HPA.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_PRALOG, associados ao vôo de Chegada selecionado, para a tabela T_PRALOG espelho */
Insert Into T_PRALOG_MIR (
	CD_PRA
	, CD_CHG
	, CD_PAR
	, QT_LOG_POR)
Select  	CD_PRA
	, LOG.CD_CHG
	, CD_PAR
	, QT_LOG_POR
From	T_PRALOG LOG, T_MIR_LOG_CHG CHG
Where	LOG.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_MCH, associados ao vôo de Chegada selecionado, para a tabela T_MCH espelho */
Insert Into T_MCH_MIR (
	CD_MCH
	, CD_CHG
	, CD_USR
	, DH_MCH
	, DH_MCH_EFE
	, CD_SIT
	, NM_MCH_COM_SIT
	, CD_TPA
	, CD_IFT
	, DS_MCH_EST
	, DS_MCH_EST_001
	, NR_MCH_AEN
	, TT_MCH_OBS
	, TP_MCH
	, FL_MCH_TEL)
Select	CD_MCH
	, MCH.CD_CHG
	, CD_USR
	, DH_MCH
	, DH_MCH_EFE
	, CD_SIT
	, NM_MCH_COM_SIT
	, CD_TPA
	, CD_IFT
	, DS_MCH_EST
	, DS_MCH_EST_001
	, NR_MCH_AEN
	, TT_MCH_OBS
	, TP_MCH
	, FL_MCH_TEL
From	T_MCH MCH, T_MIR_LOG_CHG CHG
Where	MCH.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o59"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o350">
<a:ObjectID>6958A557-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_IncTabEspRelCHG001</a:Name>
<a:Code>SP_IncTabEspRelCHG001</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_IncTabEspRelCHG001    Script Date: 7/8/2000 12:15:33 ******/
Create Procedure SP_IncTabEspRelCHG001 As
Insert Into T_CHG_MIR (
	CD_CHG
	, DT_CHG
	, CD_AER
	, NR_CHG_VOO
	, NR_CHG_HOT
	, TP_CHG_GRU
	, TP_CHG
	, TP_CHG_NAT
	, TP_CHG_CTG
	, CD_COM
	, CD_CHG_VIN
	, FL_CHG_TEL
	, CD_EQP_CHG
	, CD_AEN_CHG

	, CD_BOX
	, QT_CHG_PER_MIN
	, DH_CHG_NRM
	, DH_CHG_EFE
	, DH_CHG_EST
	, CD_SIT
	, NM_CHG_COM_SIT
	, DH_CHG_SIT

	, FL_CHG_CAN
	, TP_CHG_STA
	, CD_IFT
	, CD_USR
	, FL_CHG_PAR_ORI)
Select	CHG.CD_CHG
	, DT_CHG
	, CD_AER
	, NR_CHG_VOO
	, NR_CHG_HOT
	, TP_CHG_GRU
	, TP_CHG
	, TP_CHG_NAT
	, TP_CHG_CTG
	, CD_COM
	, CD_CHG_VIN
	, FL_CHG_TEL
	, CD_EQP_CHG
	, CD_AEN_CHG
	, CD_BOX
	, QT_CHG_PER_MIN
	, DH_CHG_NRM
	, DH_CHG_EFE
	, DH_CHG_EST
	, CD_SIT
	, NM_CHG_COM_SIT
	, DH_CHG_SIT
	, FL_CHG_CAN
	, TP_CHG_STA
	, CD_IFT
	, CD_USR
	, FL_CHG_PAR_ORI
From	T_CHG CHG, T_MIR_LOG_CHG_001 CHGTMP
Where	CHG.CD_CHG = CHGTMP.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_CHA, associados ao vôo de Chegada selecionado, para a tabela T_CHA espelho */
Insert Into T_CHA_MIR (
	CD_CHA
	, CD_CHG
	, CD_PAR

	, CD_IFT
	, DH_CHA
	, CD_MSG
	, CD_USR)
Select	CD_CHA
	, CHA.CD_CHG
	, CD_PAR
	, CD_IFT
	, DH_CHA
	, CD_MSG
	, CD_USR
From	T_CHA CHA, T_MIR_LOG_CHG_001 CHG
Where	CHA.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_HSC, associados ao vôo de Chegada selecionado, para a tabela T_HSC espelho */
Insert Into T_HSC_MIR (
	DH_HSC
	, CD_CHG
	, CD_IFT

	, CD_SIT
	, DH_HSC_CHG
	, CD_USR
	, NM_HSC_USR)
Select	DH_HSC
	, HSC.CD_CHG
	, CD_IFT
	, CD_SIT
	, DH_HSC_CHG

	, CD_USR
	, NM_HSC_USR
From	T_HSC HSC, T_MIR_LOG_CHG_001 CHG
Where	HSC.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_DEC, associados ao vôo de Chegada selecionado, para a tabela T_DEC espelho */
Insert Into T_DEC_MIR (
	CD_CHG
	, QT_DEC_DES_DOM
	, QT_DEC_DES_INT
	, QT_DEC_DES_BAG_DOM
	, QT_DEC_DES_BAG_INT
	, QT_DEC_DES_CAR_DOM
	, QT_DEC_DES_CAR_INT
	, QT_DEC_DES_COR_DOM
	, QT_DEC_DES_COR_INT
	, QT_DEC_TRA_BAG_DOM
	, QT_DEC_TRA_BAG_INT
	, QT_DEC_TRA_CAR_DOM
	, QT_DEC_TRA_CAR_INT
	, QT_DEC_TRA_COR_DOM
	, QT_DEC_TRA_COR_INT)
Select	DEC.CD_CHG
	, QT_DEC_DES_DOM
	, QT_DEC_DES_INT
	, QT_DEC_DES_BAG_DOM
	, QT_DEC_DES_BAG_INT
	, QT_DEC_DES_CAR_DOM
	, QT_DEC_DES_CAR_INT
	, QT_DEC_DES_COR_DOM
	, QT_DEC_DES_COR_INT
	, QT_DEC_TRA_BAG_DOM
	, QT_DEC_TRA_BAG_INT
	, QT_DEC_TRA_CAR_DOM
	, QT_DEC_TRA_CAR_INT
	, QT_DEC_TRA_COR_DOM
	, QT_DEC_TRA_COR_INT
From	T_DEC DEC, T_MIR_LOG_CHG_001 CHG
Where	DEC.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_ECC001, associados ao vôo de Chegada selecionado, para a tabela T_ECC001 espelho 	*/
Insert Into T_ECC001_MIR (
	CD_CHG
	, CD_ECC
	, CD_AER)
Select	ECC.CD_CHG
	, CD_ECC
	, CD_AER
From	T_ECC001 ECC, T_MIR_LOG_CHG_001 CHG
Where	ECC.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_ESV001, associados ao vôo de Chegada selecionado, para a tabela T_ESV001 espelho */
Insert Into T_ESV001_MIR (
	CD_CHG
	, CD_EST)
Select	ESV.CD_CHG
	, CD_EST
From	T_ESV001 ESV, T_MIR_LOG_CHG_001 CHG
Where	ESV.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_CHGANT, associados ao vôo de Chegada selecionado, para a tabela T_CHGANT espelho */
Insert Into T_CHGANT_MIR (CD_CHG)
Select	CHGANT.CD_CHG
From	T_CHGANT CHGANT, T_MIR_LOG_CHG_001 CHG
Where	CHGANT.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_STA, associados ao vôo de Chegada selecionado, para a tabela T_STA espelho */
Insert Into T_STA_MIR (
	CD_STA
	, DH_STA_ABE
	, MA_STA_ABE
	, NR_STA
	, DH_STA_FEC
	, MA_STA_FEC
	, CD_STA_ANT
	, TP_STA
	, FL_STA_AEN_ISE
	, FL_STA_COM_TAR_RED
	, QT_STA_PSI_ISE
	, QT_STA_PSI_TAR_RED)
Select	CD_STA
	, DH_STA_ABE
	,MA_STA_ABE
	, NR_STA
	, DH_STA_FEC
	, MA_STA_FEC
	, CD_STA_ANT
	, TP_STA
	, FL_STA_AEN_ISE
	, FL_STA_COM_TAR_RED
	, QT_STA_PSI_ISE
	, QT_STA_PSI_TAR_RED
From	T_STA
Where	CD_STA In (  Select CD_STA
	             From  T_HPA001 HPA, T_MIR_LOG_CHG_001 CHG
	             Where HPA.CD_CHG = CHG.CD_CHG)
IF @@ERROR &gt; 0 RETURN
  
/* Transfere dados da tabela T_HPA001 associados ao vôo de Chegada selecionado, para a tabela T_HPA001 espelho */
Insert Into T_HPA001_MIR (
	CD_HPA

	, NR_HPA_SEQ
	, CD_AER
	, CD_EQP
	, CD_AEN
	, CD_BOX
	, CD_CHG
	, DH_HPA_ENT
	, CD_PAR
	, DH_HPA_SAI
	, FL_HPA_ENT
	, FL_HPA_SAI
	, FL_HPA_TOK
	, CD_STA)
Select	CD_HPA
	, NR_HPA_SEQ
	, CD_AER
	, CD_EQP

	, CD_AEN
	, CD_BOX
	, HPA.CD_CHG
	, DH_HPA_ENT
	, CD_PAR
	, DH_HPA_SAI
	, FL_HPA_ENT
	, FL_HPA_SAI
	, FL_HPA_TOK
	, CD_STA
From	T_HPA001 HPA, T_MIR_LOG_CHG_001 CHG
Where	HPA.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_PRALOG, associados ao vôo de Chegada selecionado, para a tabela T_PRALOG espelho */
Insert Into T_PRALOG_MIR (
	CD_PRA
	, CD_CHG
	, CD_PAR
	, QT_LOG_POR)
Select  CD_PRA
	, LOG.CD_CHG

	, CD_PAR
	, QT_LOG_POR
From	T_PRALOG LOG, T_MIR_LOG_CHG_001 CHG
Where	LOG.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_MCH, associados ao vôo de Chegada selecionado, para a tabela T_MCH espelho */

Insert Into T_MCH_MIR (
	CD_MCH
	, CD_CHG
	, CD_USR
	, DH_MCH
	, DH_MCH_EFE
	, CD_SIT
	, NM_MCH_COM_SIT
	, CD_TPA
	, CD_IFT
	, DS_MCH_EST
	, DS_MCH_EST_001
	, NR_MCH_AEN
	, TT_MCH_OBS
	, TP_MCH
	, FL_MCH_TEL)
Select	CD_MCH
	, MCH.CD_CHG
	, CD_USR
	, DH_MCH
	, DH_MCH_EFE
	, CD_SIT
	, NM_MCH_COM_SIT
	, CD_TPA
	, CD_IFT
	, DS_MCH_EST
	, DS_MCH_EST_001
	, NR_MCH_AEN
	, TT_MCH_OBS
	, TP_MCH
	, FL_MCH_TEL
From	T_MCH MCH, T_MIR_LOG_CHG_001 CHG
Where	MCH.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o59"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o351">
<a:ObjectID>6958A558-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_IncTabEspRelPAR</a:Name>
<a:Code>SP_IncTabEspRelPAR</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_IncTabEspRelPAR    Script Date: 7/8/2000 12:15:33 ******/
Create Procedure SP_IncTabEspRelPAR As
/* Objetivo: Incluir registros associados ao vôo de Partida selecionado nas tabelas espelho relacionadas: 
T_PAR, T_CHA, T_CKV001, T_DEP, T_ECP001, T_HSP, T_TFB001, T_PRALOG, T_MPA */   
   
/* Transfere dados da tabela T_PAR, associados ao vôo de Partida selecionado, para a tabela T_PAR espelho */
Insert Into T_PAR_MIR (
	CD_PAR
	, DT_PAR
	, CD_AER
	, NR_PAR_VOO
	, NR_PAR_HOT
	, TP_PAR_GRU
	, TP_PAR
	, TP_PAR_NAT
	, TP_PAR_CTG
	, CD_COM
	, CD_CHG_ANT
	, CD_CHG_AEN_ANT
	, CD_PAR_VIN
	, FL_PAR_TEL
	, DH_PAR_NRM
	, DH_PAR_EFE
	, DH_PAR_EST
	, CD_SIT
	, NM_PAR_COM_SIT
	, DH_PAR_SIT
	, CD_POR
	, FL_PAR_CAN
	, TP_PAR_STA
	, CD_IFT
	, CD_USR)
 Select 	PAR.CD_PAR
	, DT_PAR
	, CD_AER
	, NR_PAR_VOO
	, NR_PAR_HOT
	, TP_PAR_GRU
	, TP_PAR
	, TP_PAR_NAT
	, TP_PAR_CTG
	, CD_COM
	, CD_CHG_ANT
	, CD_CHG_AEN_ANT
	, CD_PAR_VIN
	, FL_PAR_TEL
	, DH_PAR_NRM
	, DH_PAR_EFE
	, DH_PAR_EST
	, CD_SIT
	, NM_PAR_COM_SIT
	, DH_PAR_SIT
	, CD_POR
	, FL_PAR_CAN
	, TP_PAR_STA
	, CD_IFT
	, CD_USR
From	T_PAR PAR, T_MIR_LOG_PAR PARLOG
Where	PAR.CD_PAR = PARLOG.CD_PAR
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_CHA, associados ao vôo de Partida selecionado, para a tabela T_CHA espelho */
Insert Into T_CHA_MIR (
	CD_CHA
	, CD_CHG
	, CD_PAR
	, CD_IFT
	, DH_CHA
	, CD_MSG
	, CD_USR)
Select	CD_CHA
	, CD_CHG
	, CHA.CD_PAR
	, CD_IFT
	, DH_CHA
	, CD_MSG
	, CD_USR
From	T_CHA CHA, T_MIR_LOG_PAR PAR
Where	CHA.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_CKV001, associados ao vôo de Partida selecionado, para a tabela T_CKV001 espelho */
Insert Into T_CKV001_MIR (
	CD_PAR
	, CD_CHK
	, CD_CLS)
Select	CKV.CD_PAR
	, CD_CHK
	, CD_CLS
From	T_CKV001 CKV, T_MIR_LOG_PAR PAR
Where	CKV.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_DEP, associados ao vôo de Partida selecionado, para a tabela T_DEP espelho */
Insert Into T_DEP_MIR (
	CD_PAR

	, CD_AER
	, QT_DEP_TFB_DOM
	, QT_DEP_TFB_INT
	, QT_DEP_TFC_DOM
	, QT_DEP_TFC_INT
	, QT_DEP_ISE_COL
	, QT_DEP_ISE_TRA
	, QT_DEP_ISE_CON_DOM
	, QT_DEP_ISE_CON_INT
	, QT_DEP_ISE_OUT
	, QT_DEP_EMB_BAG_DOM
	, QT_DEP_EMB_BAG_INT

	, QT_DEP_EMB_CAR_DOM
	, QT_DEP_EMB_CAR_INT

	, QT_DEP_EMB_COR_DOM
	, QT_DEP_EMB_COR_INT)
Select	DEP.CD_PAR
	, CD_AER
	, QT_DEP_TFB_DOM
	, QT_DEP_TFB_INT
	, QT_DEP_TFC_DOM
	, QT_DEP_TFC_INT
	, QT_DEP_ISE_COL
	, QT_DEP_ISE_TRA
	, QT_DEP_ISE_CON_DOM
	, QT_DEP_ISE_CON_INT
	, QT_DEP_ISE_OUT
	, QT_DEP_EMB_BAG_DOM
	, QT_DEP_EMB_BAG_INT
	, QT_DEP_EMB_CAR_DOM
	, QT_DEP_EMB_CAR_INT
	, QT_DEP_EMB_COR_DOM
	, QT_DEP_EMB_COR_INT
From	T_DEP DEP, T_MIR_LOG_PAR PAR
Where	DEP.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_ECP001, associados ao vôo de Partida selecionado, para a tabela T_ECP001 espelho */
Insert Into T_ECP001_MIR (
	CD_PAR
	, CD_ECP
	, CD_AER)
Select	ECP.CD_PAR
	, CD_ECP
	, CD_AER
From	T_ECP001 ECP, T_MIR_LOG_PAR PAR
Where	ECP.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_TFB001, associados ao vôo de Partida selecionado, para a tabela T_TFB001 espelho */
Insert Into T_TFB001_MIR (
	CD_TFB
	, CD_COM
	, CD_HTE
	, QT_TFB
	, CD_PAR)
Select	 CD_TFB
	, CD_COM
	, CD_HTE
	, QT_TFB
	, TFB.CD_PAR
From	T_TFB001 TFB, T_MIR_LOG_PAR PAR
Where	TFB.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_HSP, associados ao vôo de Partida selecionado, para a tabela T_HSP espelho */
Insert Into T_HSP_MIR (
	DH_HSP
	, CD_PAR
	, CD_IFT
	, CD_SIT
	, DH_HSP_PAR
	, CD_USR
	, NM_HSP_USR)
Select	DH_HSP
	, HSP.CD_PAR
	, CD_IFT
	, CD_SIT
	, DH_HSP_PAR
	, CD_USR
	, NM_HSP_USR
From	T_HSP HSP, T_MIR_LOG_PAR PAR
Where	HSP.CD_PAR = PAR.CD_PAR

IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_PRALOG, associados ao vôo de Partida selecionado, para a tabela T_PRALOG espelho */
Insert Into T_PRALOG_MIR (CD_PRA
	, CD_CHG
	, CD_PAR
	, QT_LOG_POR)
Select	CD_PRA
	, CD_CHG
	, LOG.CD_PAR
	, QT_LOG_POR
From	T_PRALOG LOG, T_MIR_LOG_PAR PAR
Where	LOG.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_MPA, associados ao vôo de Partida selecionado, para a tabela T_MPA espelho */
Insert Into T_MPA_MIR (
	CD_MPA
	, CD_PAR
	, CD_USR
	, DH_MPA
	, DH_MPA_EFE
	, CD_SIT
	, NM_MPA_COM_SIT
	, CD_TPA
	, CD_IFT
	, CD_POR
	, DS_MPA_CHK
	, DS_MPA_CHK_001
	, TT_MPA_OBS
	, TP_MPA
	, FL_MPA_TEL)
Select	CD_MPA
	, MPA.CD_PAR
	, CD_USR
	, DH_MPA
	, DH_MPA_EFE
	, CD_SIT
	, NM_MPA_COM_SIT
	, CD_TPA

	, CD_IFT
	, CD_POR
	, DS_MPA_CHK
	, DS_MPA_CHK_001
	, TT_MPA_OBS
	, TP_MPA
	, FL_MPA_TEL
From	T_MPA MPA, T_MIR_LOG_PAR PAR
Where	MPA.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o59"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o352">
<a:ObjectID>6958A55A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_IncTabEspRelPAR001</a:Name>
<a:Code>SP_IncTabEspRelPAR001</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_IncTabEspRelPAR001    Script Date: 7/8/2000 12:15:33 ******/
Create Procedure SP_IncTabEspRelPAR001 As
/* Objetivo: Incluir registros associados ao vôo de Partida selecionado nas tabelas espelho relacionadas:
T_PAR. T_CHA, T_CKV001, T_DEP, T_ECP001, T_HSP, T_TFB001, T_PRALOG, T_MPA */   
   
/* Transfere dados da tabela T_PAR, associados ao vôo de Partida selecionado, para a tabela T_PAR espelho */
Insert Into T_PAR_MIR (
	CD_PAR
	, DT_PAR
	, CD_AER
	, NR_PAR_VOO
	, NR_PAR_HOT
	, TP_PAR_GRU
	, TP_PAR
	, TP_PAR_NAT
	, TP_PAR_CTG
	, CD_COM
	, CD_CHG_ANT
	, CD_CHG_AEN_ANT
	, CD_PAR_VIN
	, FL_PAR_TEL
	, DH_PAR_NRM
	, DH_PAR_EFE
	, DH_PAR_EST
	, CD_SIT
	, NM_PAR_COM_SIT
	, DH_PAR_SIT
	, CD_POR
	, FL_PAR_CAN
	, TP_PAR_STA
	, CD_IFT
	, CD_USR)
 Select 	PAR.CD_PAR
	, DT_PAR
	, CD_AER
	, NR_PAR_VOO
	, NR_PAR_HOT
	, TP_PAR_GRU
	, TP_PAR
	, TP_PAR_NAT
	, TP_PAR_CTG
	, CD_COM
	, CD_CHG_ANT
	, CD_CHG_AEN_ANT
	, CD_PAR_VIN
	, FL_PAR_TEL
	, DH_PAR_NRM
	, DH_PAR_EFE
	, DH_PAR_EST
	, CD_SIT
	, NM_PAR_COM_SIT
	, DH_PAR_SIT
	, CD_POR
	, FL_PAR_CAN
	, TP_PAR_STA
	, CD_IFT
	, CD_USR
From	T_PAR PAR, T_MIR_LOG_PAR_001 PARLOG
Where	PAR.CD_PAR = PARLOG.CD_PAR
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_CHA, associados ao vôo de Partida selecionado, para a tabela T_CHA espelho */
Insert Into T_CHA_MIR (
	CD_CHA
	, CD_CHG
	, CD_PAR
	, CD_IFT
	, DH_CHA
	, CD_MSG
	, CD_USR)
Select	CD_CHA
	, CD_CHG
	, CHA.CD_PAR
	, CD_IFT
	, DH_CHA
	, CD_MSG
	, CD_USR
From	T_CHA CHA, T_MIR_LOG_PAR_001 PAR

Where	CHA.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_CKV001, associados ao vôo de Partida selecionado, para a tabela T_CKV001 espelho */
Insert Into T_CKV001_MIR (
	CD_PAR
	, CD_CHK
	, CD_CLS)
Select	CKV.CD_PAR
	, CD_CHK
	, CD_CLS
From	T_CKV001 CKV, T_MIR_LOG_PAR_001 PAR
Where	CKV.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_DEP, associados ao vôo de Partida selecionado, para a tabela T_DEP espelho */
Insert Into T_DEP_MIR (
	CD_PAR

	, CD_AER
	, QT_DEP_TFB_DOM
	, QT_DEP_TFB_INT
	, QT_DEP_TFC_DOM
	, QT_DEP_TFC_INT
	, QT_DEP_ISE_COL
	, QT_DEP_ISE_TRA
	, QT_DEP_ISE_CON_DOM
	, QT_DEP_ISE_CON_INT
	, QT_DEP_ISE_OUT
	, QT_DEP_EMB_BAG_DOM
	, QT_DEP_EMB_BAG_INT
	, QT_DEP_EMB_CAR_DOM
	, QT_DEP_EMB_CAR_INT
	, QT_DEP_EMB_COR_DOM
	, QT_DEP_EMB_COR_INT)
Select	DEP.CD_PAR
	, CD_AER
	, QT_DEP_TFB_DOM
	, QT_DEP_TFB_INT
	, QT_DEP_TFC_DOM
	, QT_DEP_TFC_INT
	, QT_DEP_ISE_COL
	, QT_DEP_ISE_TRA
	, QT_DEP_ISE_CON_DOM
	, QT_DEP_ISE_CON_INT
	, QT_DEP_ISE_OUT
	, QT_DEP_EMB_BAG_DOM
	, QT_DEP_EMB_BAG_INT
	, QT_DEP_EMB_CAR_DOM
	, QT_DEP_EMB_CAR_INT
	, QT_DEP_EMB_COR_DOM
	, QT_DEP_EMB_COR_INT
From	T_DEP DEP, T_MIR_LOG_PAR_001 PAR
Where	DEP.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_ECP001, associados ao vôo de Partida selecionado, para a tabela T_ECP001 espelho */
Insert Into T_ECP001_MIR (
	CD_PAR
	, CD_ECP
	, CD_AER)
Select	ECP.CD_PAR
	, CD_ECP
	, CD_AER
From	T_ECP001 ECP, T_MIR_LOG_PAR_001 PAR
Where	ECP.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_TFB001, associados ao vôo de Partida selecionado, para a tabela T_TFB001 espelho */
Insert Into T_TFB001_MIR (
	CD_TFB
	, CD_COM
	, CD_HTE
	, QT_TFB
	, CD_PAR)
Select	 CD_TFB
	, CD_COM
	, CD_HTE
	, QT_TFB
	, TFB.CD_PAR
From	T_TFB001 TFB, T_MIR_LOG_PAR_001 PAR
Where	TFB.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_HSP, associados ao vôo de Partida selecionado, para a tabela T_HSP espelho */
Insert Into T_HSP_MIR (
	DH_HSP
	, CD_PAR
	, CD_IFT
	, CD_SIT
	, DH_HSP_PAR
	, CD_USR
	, NM_HSP_USR)
Select	DH_HSP
	, HSP.CD_PAR
	, CD_IFT
	, CD_SIT
	, DH_HSP_PAR
	, CD_USR
	, NM_HSP_USR
From	T_HSP HSP, T_MIR_LOG_PAR_001 PAR
Where	HSP.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_PRALOG, associados ao vôo de Partida selecionado, para a tabela T_PRALOG espelho */
Insert Into T_PRALOG_MIR (
	CD_PRA
	, CD_CHG
	, CD_PAR
	, QT_LOG_POR)
Select	CD_PRA
	, CD_CHG
	, LOG.CD_PAR
	, QT_LOG_POR
From	T_PRALOG LOG, T_MIR_LOG_PAR_001 PAR
Where	LOG.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_MPA, associados ao vôo de Partida selecionado, para a tabela T_MPA espelho */
Insert Into T_MPA_MIR (
	CD_MPA
	, CD_PAR
	, CD_USR
	, DH_MPA
	, DH_MPA_EFE
	, CD_SIT
	, NM_MPA_COM_SIT
	, CD_TPA
	, CD_IFT
	, CD_POR
	, DS_MPA_CHK
	, DS_MPA_CHK_001
	, TT_MPA_OBS
	, TP_MPA
	, FL_MPA_TEL)
Select	CD_MPA
	, MPA.CD_PAR
	, CD_USR
	, DH_MPA
	, DH_MPA_EFE
	, CD_SIT
	, NM_MPA_COM_SIT
	, CD_TPA

	, CD_IFT
	, CD_POR
	, DS_MPA_CHK
	, DS_MPA_CHK_001
	, TT_MPA_OBS
	, TP_MPA
	, FL_MPA_TEL
From	T_MPA MPA, T_MIR_LOG_PAR_001 PAR
Where	MPA.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o59"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o353">
<a:ObjectID>6958A55D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_MONITOR</a:Name>
<a:Code>SP_MONITOR</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>CREATE PROCEDURE SP_MONITOR AS
/*	CHEGADAS
	Atualizar os vôos de chegada cuja situaçao atual tem uma situaçao sucessora e
	o tempo para atualizaçao é o TEMPO ANTES e que a diferença entre a hora
	prevista e a hora atual é menor ou igual que o TEMPO ANTES
*/

UPDATE	T_CHG
SET	CD_SIT = CD_SIT_SUC,
	CD_USR = NULL
FROM  	T_CHG CHG, T_SSU SSU   
WHERE 	SSU.CD_SIT = CHG.CD_SIT AND
	SSU.TP_SSU = 1 AND
	CHG.TP_CHG_STA = 1 AND
	DATEDIFF(MI, GETDATE(), DH_CHG_EFE) &lt;= SSU.QT_SSU AND
	CHG.TP_CHG_CTG NOT IN (3, 4) AND
	NOT EXISTS (	SELECT 	CD_CHG = CHG001.CD_CHG 
			FROM 	T_CHG CHG001,
				T_SSU SSU001,
				T_SIT SIT001
			WHERE 	CHG001.CD_CHG = CHG.CD_CHG AND
				SSU001.CD_SIT = CHG001.CD_SIT AND
				SIT001.CD_SIT = SSU001.CD_SIT_SUC AND
				SIT001.FL_SIT_CON_VOO = 1 AND
				CHG001.CD_AEN_CHG IS NULL)


/*	Atualizar os vôos de chegada cuja situaçao atual tem uma situaçao sucessora e
	o tempo para atualizaçao é o TEMPO APOS e que a diferença entre a hora da
	atualizaçao da situaçao e a hora atual é maior ou igual que o TEMPO APOS
*/
UPDATE	T_CHG
SET	CD_SIT = CD_SIT_SUC,
	CD_USR = NULL
FROM  	T_CHG CHG, T_SSU SSU   
WHERE 	SSU.CD_SIT = CHG.CD_SIT AND
	SSU.TP_SSU = 2 AND
	CHG.TP_CHG_STA = 1 AND
	DATEDIFF(MI, DH_CHG_SIT, GETDATE()) &gt;= SSU.QT_SSU AND
	CHG.TP_CHG_CTG NOT IN (3, 4) AND
	NOT EXISTS (	SELECT 	CD_CHG = CHG001.CD_CHG 
			FROM 	T_CHG CHG001,
				T_SSU SSU001,
				T_SIT SIT001
			WHERE 	CHG001.CD_CHG = CHG.CD_CHG AND
				SSU001.CD_SIT = CHG001.CD_SIT AND
				SIT001.CD_SIT = SSU001.CD_SIT_SUC AND
				SIT001.FL_SIT_CON_VOO = 1 AND
				CHG001.CD_AEN_CHG IS NULL)

/*	Atualizar os vôos de chegada cuja situaçao atual tem uma situaçao sucessora e
	o tempo para atualizaçao é o TEMPO MINIMO DE PERMANENCIA e que a diferença entre
	a hora prevista e a hora atual é menor ou igual que o TEMPO MINIMO DE PERMANENCIA
*/

UPDATE	T_CHG
SET	CD_SIT = CD_SIT_SUC,
	CD_USR = NULL
FROM  	T_CHG CHG, T_SSU SSU   
WHERE 	SSU.CD_SIT = CHG.CD_SIT AND
	SSU.TP_SSU = 3 AND
	CHG.TP_CHG_STA = 1 AND
	DATEDIFF(MI, GETDATE(), DH_CHG_EFE) &lt;= CHG.QT_CHG_PER_MIN AND
	CHG.TP_CHG_CTG NOT IN (3, 4) AND
	NOT EXISTS (	SELECT 	CD_CHG = CHG001.CD_CHG 
			FROM 	T_CHG CHG001,
				T_SSU SSU001,
				T_SIT SIT001
			WHERE 	CHG001.CD_CHG = CHG.CD_CHG AND
				SSU001.CD_SIT = CHG001.CD_SIT AND
				SIT001.CD_SIT = SSU001.CD_SIT_SUC AND
				SIT001.FL_SIT_CON_VOO = 1 AND
				CHG001.CD_AEN_CHG IS NULL)

/*	Atualizar os vôos de partida cuja situaçao atual tem uma situaçao sucessora e
	o tempo para atualizaçao é o TEMPO ANTES e que a diferença entre a hora
	prevista e a hora atual é menor ou igual que o TEMPO ANTES e que os vôos antecessores
	estao nas situaçoes condicionantes, caso existam
*/

UPDATE	T_PAR
SET	CD_SIT = CD_SIT_SUC,
	CD_USR = NULL
FROM  	T_PAR PAR, T_CHG CHGAENANT, T_SSU SSU, T_SIT SIT   
WHERE 	SSU.CD_SIT = PAR.CD_SIT AND
	SIT.CD_SIT = PAR.CD_SIT AND
	CHGAENANT.CD_CHG = PAR.CD_CHG_AEN_ANT AND
	PAR.TP_PAR_STA = 1 AND
	SSU.TP_SSU = 1 AND /* TEMPO ANTES */
	DATEDIFF(MI, GETDATE(), PAR.DH_PAR_EFE) &lt;= SSU.QT_SSU AND
   	(	/* não existe situação condicionante ou a situação do vôo de chegada é uma das situações condicionantes */
		NOT EXISTS (SELECT *  FROM T_SCA SCA WHERE SCA.CD_SIT = SSU.CD_SIT_SUC)  OR
		CHGAENANT.CD_SIT IN (SELECT CD_SIT_ANT FROM T_SCA SCA WHERE SCA.CD_SIT = SSU.CD_SIT_SUC)
	)

/*	Atualizar os vôos de partida cuja situaçao atual tem uma situaçao sucessora e
	o tempo para atualizaçao é o TEMPO APOS e que a diferença entre a hora
	prevista e a hora atual é maior ou igual que o TEMPO APOS e que os vôos antecessores
	estao nas situaçoes condicionantes, caso existam
*/

UPDATE 	T_PAR
SET	CD_SIT = CD_SIT_SUC,
	CD_USR = NULL
FROM  	T_PAR PAR, T_CHG CHGAENANT, T_SSU SSU, T_SIT SIT   
WHERE 	SSU.CD_SIT = PAR.CD_SIT AND
	SIT.CD_SIT = PAR.CD_SIT AND
	CHGAENANT.CD_CHG = PAR.CD_CHG_AEN_ANT AND
	PAR.TP_PAR_STA = 1 AND
	SSU.TP_SSU = 2 AND /* TEMPO APÓS */
	DATEDIFF(MI, PAR.DH_PAR_SIT, GETDATE()) &gt;= SSU.QT_SSU AND
   	(	/* não existe situação condicionante ou a situação do vôo de chegada é uma das situações condicionantes */
		NOT EXISTS (SELECT *  FROM T_SCA SCA WHERE SCA.CD_SIT = SSU.CD_SIT_SUC)  OR
		CHGAENANT.CD_SIT IN (SELECT CD_SIT_ANT FROM T_SCA SCA WHERE SCA.CD_SIT = SSU.CD_SIT_SUC)
	)

/*	Atualizar os vôos de partida cuja situaçao atual tem uma situaçao sucessora e
	o tempo para atualizaçao é o TEMPO MINIMO DE PERMANENCIA e que a diferença entre a hora
	prevista e a hora atual é menor ou igual que o TEMPO MINIMO DE PERMANENCIA e que os vôos antecessores
	estao nas situaçoes condicionantes, caso existam
*/

UPDATE 	T_PAR
SET	CD_SIT = CD_SIT_SUC,
	CD_USR = NULL
FROM  	T_PAR PAR, T_CHG CHGAENANT, T_SSU SSU, T_SIT SIT   
WHERE 	SSU.CD_SIT = PAR.CD_SIT AND
	SIT.CD_SIT = PAR.CD_SIT AND
	CHGAENANT.CD_CHG = PAR.CD_CHG_AEN_ANT AND
	PAR.TP_PAR_STA = 1 AND
	SSU.TP_SSU = 3 AND /* TEMPO MÍNIMO DE PERMANÊNCIA */
	DATEDIFF(MI, GETDATE(), PAR.DH_PAR_EFE) &lt;= CHGAENANT.QT_CHG_PER_MIN AND
   	(	/* não existe situação condicionante ou a situação do vôo de chegada é uma das situações condicionantes */
		NOT EXISTS (SELECT *  FROM T_SCA SCA WHERE SCA.CD_SIT = SSU.CD_SIT_SUC)  OR
		CHGAENANT.CD_SIT IN (SELECT CD_SIT_ANT FROM T_SCA SCA WHERE SCA.CD_SIT = SSU.CD_SIT_SUC)
	)
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o59"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o354">
<a:ObjectID>6958A55E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_SOMA_DIA</a:Name>
<a:Code>SP_SOMA_DIA</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_SOMA_DIA    Script Date: 7/8/2000 12:15:32 ******/
Create Procedure SP_SOMA_DIA
(@DS_DIA VARCHAR(04), @NR_DIA INTEGER, @DS_SOMA_DIA VARCHAR(04) OUTPUT) As
DECLARE @DIA INTEGER
DECLARE @NR_POS INTEGER

SELECT @NR_POS = CHARINDEX(&#39;,&#39;, @DS_DIA)
SELECT @DIA = @NR_DIA + CONVERT(INTEGER, SUBSTRING(@DS_DIA, 1, @NR_POS - 1))
SELECT @DS_SOMA_DIA = CONVERT(VARCHAR, @DIA) + &#39;,&#39;
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o59"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o355">
<a:ObjectID>6958A560-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_TransfereEspelho</a:Name>
<a:Code>SP_TransfereEspelho</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_TransfereEspelho    Script Date: 7/8/2000 12:15:34 ******/
Create Procedure SP_TransfereEspelho
(@pQtDt INT) As
IF @pQtDt &lt; (SELECT QT_PSI_MIR_TEM FROM T_PSI)
BEGIN
	RollBack Transaction
	RaisError 20003 &#39;Operação não executada: Data Limite para Espelhamento é menor que a data requerida&#39;
	Return
END

/* Monta recordset com vôos de Chegada cancelados que ocorreram até a data especificada */
DELETE T_MIR_LOG_CHG_001

Insert into T_MIR_LOG_CHG_001 (CD_CHG)
Select	CD_CHG 
From	T_CHG CHG
Where	TP_CHG_STA = 2
And 	FL_CHG_CAN = 1
And 	DATEDIFF(DD, DH_CHG_EFE, GETDATE()) &gt; @pQtDt

IF (SELECT COUNT(*) FROM T_MIR_LOG_CHG_001) &gt; 0
BEGIN

	Begin Transaction

	/* Inclui registros associados ao vôo de Chegada selecionado nas tabelas espelhos relacionadas */

	EXEC SP_IncTabEspRelCHG001

	IF @@ERROR &gt; 0

	BEGIN
		RollBack Transaction
		RaisError 20003 &#39;Operação não executada: SP_TransfereEspelho&#39;
		Return
	END

      
	/* Excluir registros das Tabelas Principais */
	EXEC SP_ExcTabPrincipal 2

	IF @@ERROR &gt; 0
	BEGIN

		RollBack Transaction
		RaisError 20003 &#39;Operação não executada: SP_TransfereEspelho&#39;
		Return
	END

	Commit Transaction
END


/* Monta recordset com vôos de Partida cancelados que ocorreram até a data especificada */
DELETE T_MIR_LOG_PAR_001

Insert into T_MIR_LOG_PAR_001 (CD_PAR)
Select	CD_PAR 
From	T_PAR PAR
Where	TP_PAR_STA = 2
And 	FL_PAR_CAN =1
And	DATEDIFF(DD, DH_PAR_EFE, GETDATE()) &gt; @pQtDt

IF (SELECT COUNT(*) FROM T_MIR_LOG_PAR_001) &gt; 0 
BEGIN
	Begin Transaction


	/* Inclui registros associados ao vôo de Chegada selecionado nas tabelas espelhos relacionadas */
	EXEC SP_IncTabEspRelPAR001
	IF @@ERROR &gt; 0
	BEGIN

		RollBack Transaction
		RaisError 20003 &#39;Operação não executada: SP_TransfereEspelho&#39;
		Return
	END


	/* Excluir registros das Tabelas Principais */
	EXEC SP_ExcTabPrincipal 3
	IF @@ERROR &gt; 0
	BEGIN
		RollBack Transaction

		RaisError 20003 &#39;Operação não executada: SP_TransfereEspelho&#39;
		Return
	END


	Commit Transaction
END

/* Monta recordset com vôos de Chegada associados aos vôos de Partida cujas decolagens aconteceram até a data especificada */

DELETE T_MIR_LOG_CHG

Insert into T_MIR_LOG_CHG (CD_CHG)
Select	CD_CHG 
From	T_CHG CHG
Where	CD_CHG In (	Select 	CD_CHG_AEN_ANT
			From  	T_PAR PAR
			Where 	PAR.TP_PAR_STA = 2

			And   	PAR.CD_AER = (SELECT CD_AER FROM T_PSI)
			And   	PAR.TP_PAR_CTG NOT IN (3,4)

			And   	DATEDIFF(DD, DH_PAR_EFE, GETDATE()) &gt; @pQtDt
			And   	PAR.FL_PAR_CAN = 0)

IF (SELECT COUNT(*) FROM T_MIR_LOG_CHG) &gt; 0
BEGIN


	Begin Transaction

	/* Inclui registros associados ao vôo de Chegada selecionado nas tabelas espelhos relacionadas */
	EXEC SP_IncTabEspRelCHG 

	IF @@ERROR &gt; 0
	BEGIN

		RollBack Transaction
		RaisError 20003 &#39;Operação não executada: SP_TransfereEspelho&#39;
		Return
	END

	/* Seleciona vôos de Chegada Codeshare ou Duplicate Leg vinculados ao vôo de Chegada selecionado */
	DELETE T_MIR_LOG_CHG_001

	Insert into T_MIR_LOG_CHG_001 (CD_CHG)
	Select	CHGVIN.CD_CHG 

	From	T_CHG CHGVIN, T_MIR_LOG_CHG CHG
	Where	CHGVIN.CD_CHG_VIN = CHG.CD_CHG
	Order By CHGVIN.CD_CHG

	/* Percorre vetor com vôos de Chegada vinculados a serem processados */
	EXEC SP_IncTabEspRelCHG001
	IF @@ERROR &gt; 0
	BEGIN
		RollBack Transaction
		RaisError 20003 &#39;Operação não executada: SP_TransfereEspelho&#39;
		Return
	END

	/* Seleciona vôos de Partida associados ao vôo de Chegada selecionado */

	DELETE T_MIR_LOG_PAR

	Insert into T_MIR_LOG_PAR (CD_PAR)
        	Select	PAR.CD_PAR
	From	T_PAR PAR, T_MIR_LOG_CHG CHG
	Where	PAR.CD_CHG_AEN_ANT = CHG.CD_CHG
	Order By PAR.CD_PAR


	/* Inclui registros associados ao vôo de Partida selecionado nas tabelas espelhos relacionadas */
	EXEC SP_IncTabEspRelPAR 
	IF @@ERROR &gt; 0

	BEGIN
		RollBack Transaction
		RaisError 20003 &#39;Operação não executada: SP_TransfereEspelho&#39;
		Return
	END

	/* Seleciona vôos de Partida Codeshare ou Duplicate Leg vinculados ao vôo de Partida selecionado */
	DELETE T_MIR_LOG_PAR_001
		Insert into T_MIR_LOG_PAR_001 (CD_PAR)
	Select	PARVIN.CD_PAR 
	From	T_PAR PARVIN, T_MIR_LOG_PAR PAR
	Where	PARVIN.CD_PAR_VIN = PAR.CD_PAR
	Order By PARVIN.CD_PAR

	/* Percorre vetor com vôos de Chegada vinculados a serem processados */
	EXEC SP_IncTabEspRelPAR001
	IF @@ERROR &gt; 0
	BEGIN
		RollBack Transaction
		RaisError 20003 &#39;Operação não executada: SP_TransfereEspelho&#39;
		Return
	END


       	/* Excluir Tabela Principal */
	EXEC SP_ExcTabPrincipal 1
	IF @@ERROR &gt; 0
	BEGIN
		RollBack Transaction
		RaisError 20003 &#39;Operação não executada: SP_TransfereEspelho&#39;
		Return
	END

	Commit Transaction
END
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o59"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o356">
<a:ObjectID>6958A563-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_VerificaCodeShare</a:Name>
<a:Code>SP_VerificaCodeShare</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_VerificaCodeShare    Script Date: 7/8/2000 12:15:34 ******/
CREATE Procedure SP_VerificaCodeShare
(@CD_HOT_INS CHAR(7), @CD_HVE_INS CHAR(3), @CD_HFR_INS CHAR(1), @TP_HET_CTG_INS TINYINT) As
/* Declaração das variáveis que receberão o cursor */
DECLARE @CD_HOT			CHAR(7),
	 @CD_HVE			CHAR(3),
	 @CD_HFR			CHAR(1),
	 @CD_HET			CHAR(2),
	 @DS_HFR_CSH			CHAR(7),
	 @QT_HET_DIA_PAR_CSH		INT,
	 @QT_HET_DIA_CHG_CSH		INT,
	 @DS_HFR_NRM			CHAR(7),
	 @QT_HET_DIA_PAR_NRM		INT,
	 @QT_HET_DIA_CHG_NRM		INT,
	 @CD_HET_CORRENTE		CHAR(13),
	 @QT_NOK			TINYINT,
	 @FL_OK				BIT,
	 @FL_OK_TOTAL			BIT,
	 @NR_POS			TINYINT,
	 @DS_HFR_Descoberta 		CHAR(7),
	 @CD_HOT_NRM			CHAR(10),
	 @CD_HOT_NRM_CORRENTE	CHAR(10)

IF @TP_HET_CTG_INS IN (3, 4)
BEGIN
/* Verificar todas as etapas do tipo Code-Share ou Duplicate Leg pertencentes à mesma freqüencia das etapas alteradas, 
    se no Hotran Vinculado existe alguma etapa com a mesma origem e destino e 
    cujo período de validade abranja o período de validade do vôo code-share/duplicate leg */
IF (	SELECT	COUNT(*) FROM T_HVE HVEINS, T_HET HETINS
	WHERE	HETINS.CD_HOT + HETINS.CD_HVE + HETINS.CD_HFR = @CD_HOT_INS + @CD_HVE_INS + @CD_HFR_INS AND
		HVEINS.CD_HOT + HVEINS.CD_HVE = @CD_HOT_INS + @CD_HVE_INS AND
		HETINS.TP_HET_CTG IN (3, 4) AND
		NOT EXISTS (	SELECT * FROM T_HVE HVE, T_HET HET
				WHERE	HET.CD_HOT = HETINS.CD_HOT_VIN AND
					HVE.CD_HOT + HVE.CD_HVE = HET.CD_HOT + HET.CD_HVE AND
					HET.SG_AER_ORI = HETINS.SG_AER_ORI AND
					HET.SG_AER_DES = HETINS.SG_AER_DES AND
					HVE.DT_HVE_INI &lt;= HVEINS.DT_HVE_INI AND
					(HVE.DT_HVE_FIM &gt;= HVEINS.DT_HVE_FIM OR HVE.DT_HVE_FIM IS NULL))) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: Um vôo Code-Share ou Duplicate Leg tem de estar associado a um Hotran que possua pelo menos uma etapa com a mesma origem e destino e cujo período de validade abranja o período de validade.&#39;
	RETURN
END

/* Verificar entre as etapas do Hotran Vinculado válidas pela condição anterior, isto é, têm a mesma origem e destino desta etapa e com período de validade
    compreendido pelo período de validade da etapa vinculada, se há alguma etapa cuja freqüência abranja a freqüência do vôo code-share que está sendo alterado. */

/* Declaração do cursor */
DECLARE SP_CURSOR CURSOR FOR
	SELECT 	DISTINCT 
		HETCSH.CD_HOT,
		HETCSH.CD_HVE,
		HETCSH.CD_HFR,
		HETCSH.CD_HET,
		HET.CD_HOT + HET.CD_HVE,
		DS_HFR_CSH = HFRCSH.DS_HFR,
		QT_HET_DIA_PAR_CSH = CONVERT(INT, HETCSH.QT_HET_DIA_PAR),
		QT_HET_DIA_CHG_CSH = CONVERT(INT, HETCSH.QT_HET_DIA_CHG),
		DS_HFR_NRM = HFR.DS_HFR,

		QT_HET_DIA_PAR_NRM = CONVERT(INT, HET.QT_HET_DIA_PAR),
		QT_HET_DIA_CHG_NRM = CONVERT(INT, HET.QT_HET_DIA_CHG)
	FROM	T_HVE HVECSH, T_HFR HFRCSH, T_HET HETCSH, T_HVE HVE, T_HFR HFR, T_HET HET
	WHERE	HVECSH.CD_HOT + HVECSH.CD_HVE = HETCSH.CD_HOT + HETCSH.CD_HVE AND
		HFRCSH.CD_HOT + HFRCSH.CD_HVE + HFRCSH.CD_HFR = HETCSH.CD_HOT + HETCSH.CD_HVE + HETCSH.CD_HFR AND
		HETCSH.CD_HOT + HETCSH.CD_HVE + HETCSH.CD_HFR = @CD_HOT_INS + @CD_HVE_INS + @CD_HFR_INS AND
		HETCSH.TP_HET_CTG IN (3, 4) AND
		HVE.CD_HOT + HVE.CD_HVE = HET.CD_HOT + HET.CD_HVE AND
		HFR.CD_HOT + HFR.CD_HVE + HFR.CD_HFR = HET.CD_HOT + HET.CD_HVE + HET.CD_HFR AND
		HET.CD_HOT = HETCSH.CD_HOT_VIN AND
		HET.SG_AER_ORI = HETCSH.SG_AER_ORI AND
		HET.SG_AER_DES = HETCSH.SG_AER_DES AND


		HVE.DT_HVE_INI &lt;= HVECSH.DT_HVE_INI AND
		(HVE.DT_HVE_FIM &gt;= HVECSH.DT_HVE_FIM OR HVE.DT_HVE_FIM IS NULL)
	ORDER BY HETCSH.CD_HOT, HETCSH.CD_HVE, HETCSH.CD_HFR, HETCSH.CD_HET, HET.CD_HOT + HET.CD_HVE

SELECT @FL_OK_TOTAL = 1

/* Abertura do cursor */
OPEN SP_CURSOR

/* Ir para o primeiro registro */
FETCH	SP_CURSOR
INTO	@CD_HOT,
	@CD_HVE,
	@CD_HFR,
	@CD_HET,
	@CD_HOT_NRM,
	@DS_HFR_CSH,
	@QT_HET_DIA_PAR_CSH,
	@QT_HET_DIA_CHG_CSH,
	@DS_HFR_NRM,
	@QT_HET_DIA_PAR_NRM,
	@QT_HET_DIA_CHG_NRM

/* Processar todos os registros de SP_CURSOR */
WHILE @@FETCH_STATUS = 0
BEGIN

	SELECT	@CD_HET_CORRENTE = @CD_HOT + @CD_HVE + @CD_HFR + @CD_HET, 
		@FL_OK = 0

	/* Verificar todos os hotrans normais possivelmente válidos para esta etapa */


	WHILE @@FETCH_STATUS = 0 AND @CD_HOT + @CD_HVE + @CD_HFR + @CD_HET = @CD_HET_CORRENTE
	BEGIN


		SELECT 	@CD_HOT_NRM_CORRENTE = @CD_HOT_NRM,
			@DS_HFR_Descoberta = @DS_HFR_CSH

		/* Processar todas as frequüências deste hotran normal */
		WHILE @@FETCH_STATUS = 0 AND @CD_HOT + @CD_HVE + @CD_HFR + @CD_HET = @CD_HET_CORRENTE AND @CD_HOT_NRM = @CD_HOT_NRM_CORRENTE
		BEGIN

			SELECT	@DS_HFR_CSH = @DS_HFR_Descoberta,
				@DS_HFR_Descoberta = &#39;&#39;,
				@NR_POS = 1

			/* Varrer @DS_HFR_CSH para verificar se cada dia desta freqüência está contido na freqüência da etapa normal */
			WHILE SUBSTRING(RTRIM(@DS_HFR_CSH) + &#39;X&#39;, @NR_POS, 1) &lt;&gt; &#39;X&#39;
			BEGIN

				    /* Verificar se este dia da freqüência de partida do vôo codeshare/duplicate está na freqüência de partida do vôo vinculado */
				IF PATINDEX(&#39;%&#39; + CONVERT(CHAR(1), (((CONVERT(INT, SUBSTRING(@DS_HFR_CSH, @NR_POS, 1)) - ( ISNULL(@QT_HET_DIA_PAR_NRM,0) - ISNULL(@QT_HET_DIA_PAR_CSH,0) ) - 1) % 7) + 7) % 7 + 1) + &#39;%&#39;, @DS_HFR_NRM) = 0
				    OR
				   /* Verificar se este dia da freqüência de chegada do vôo codeshare/duplicate está na freqüência de chegada do vôo vinculado */
				    PATINDEX(&#39;%&#39; + CONVERT(CHAR(1), (((CONVERT(INT, SUBSTRING(@DS_HFR_CSH, @NR_POS, 1)) - ( ISNULL(@QT_HET_DIA_CHG_NRM,0) - ISNULL(@QT_HET_DIA_CHG_CSH,0) ) - 1) % 7) + 7) % 7 + 1) + &#39;%&#39;, @DS_HFR_NRM) = 0
					SELECT @DS_HFR_Descoberta = RTRIM(@DS_HFR_Descoberta) + SUBSTRING(@DS_HFR_CSH, @NR_POS, 1)

				SELECT @NR_POS = @NR_POS + 1

			END

			/* Ir para o próximo registro */
			FETCH	NEXT FROM SP_CURSOR
			INTO	@CD_HOT,
				@CD_HVE,
				@CD_HFR,
				@CD_HET,
				@CD_HOT_NRM,
				@DS_HFR_CSH,
				@QT_HET_DIA_PAR_CSH,
				@QT_HET_DIA_CHG_CSH,
				@DS_HFR_NRM,
				@QT_HET_DIA_PAR_NRM,
				@QT_HET_DIA_CHG_NRM

		END

		IF RTRIM(@DS_HFR_Descoberta) + &#39;X&#39; = &#39;X&#39; SELECT @FL_OK = 1

	END

	IF @FL_OK = 0 SELECT @FL_OK_TOTAL = 0

END
CLOSE SP_CURSOR
DEALLOCATE SP_CURSOR


IF @FL_OK_TOTAL = 0
BEGIN
	RAISERROR 20001 &#39;Operação não executada:Um vôo CodeShare ou DuplicateLeg tem de estar associado a um Hotran que possua pelo menos uma etapa com a mesma origem e destino e cuja freqüência e período de validade abranjam sua freqüência e período de validade, respectivamente.&#39;
	RETURN
END

END
ELSE
BEGIN

/* VERIFICAR SE ALTERAÇÕES NAS ETAPAS NORMAIS AFETAM AS ETAPAS CODE-SHARE/DUPLICATE LEG */

/* Verificar se, após a alteração, as etapas do tipo Code-Share ou Duplicate Leg que têm o hotran desta etapa como hotran vinculado,
    se no Hotran Vinculado continua existindo alguma etapa com a mesma origem e destino e cujo período de validade abranja o 
    período de validade da etapa CS/DL */
IF (	SELECT	COUNT(*) FROM T_HVE HVECSH, T_HET HETCSH
	WHERE	HVECSH.CD_HOT + HVECSH.CD_HVE = HETCSH.CD_HOT + HETCSH.CD_HVE AND
		HETCSH.CD_HOT_VIN = @CD_HOT_INS AND
		NOT EXISTS (	SELECT * FROM T_HVE HVE, T_HET HET
				WHERE	HVE.CD_HOT + HVE.CD_HVE = HET.CD_HOT + HET.CD_HVE AND
					HET.CD_HOT = HETCSH.CD_HOT_VIN AND
					HET.SG_AER_ORI = HETCSH.SG_AER_ORI AND
					HET.SG_AER_DES = HETCSH.SG_AER_DES AND
					HVE.DT_HVE_INI &lt;= HVECSH.DT_HVE_INI AND
					(HVE.DT_HVE_FIM &gt;= HVECSH.DT_HVE_FIM OR HVE.DT_HVE_FIM IS NULL))) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: Há vôos Code-Share ou Duplicate Leg associados a este Hotran que impedem esta alteração.&#39;
	RETURN
END



/* Verificar se após esta alteração, as etapas code-share ou duplicate leg vinculadas a este hotran continuaram válildas quanto à freqüência */

/* Declaração do cursor */
DECLARE SP_CURSOR CURSOR FOR
	SELECT 	DISTINCT 
		HETCSH.CD_HOT,
		HETCSH.CD_HVE,
		HETCSH.CD_HFR,
		HETCSH.CD_HET,
		HET.CD_HOT + HET.CD_HVE,
		DS_HFR_CSH = HFRCSH.DS_HFR,
		QT_HET_DIA_PAR_CSH = CONVERT(INT, HETCSH.QT_HET_DIA_PAR),
		QT_HET_DIA_CHG_CSH = CONVERT(INT, HETCSH.QT_HET_DIA_CHG),
		DS_HFR_NRM = HFR.DS_HFR,
		QT_HET_DIA_PAR_NRM = CONVERT(INT, HET.QT_HET_DIA_PAR),
		QT_HET_DIA_CHG_NRM = CONVERT(INT, HET.QT_HET_DIA_CHG)

	FROM	T_HVE HVECSH, T_HFR HFRCSH, T_HET HETCSH, T_HVE HVE, T_HFR HFR, T_HET HET
	WHERE	HVECSH.CD_HOT + HVECSH.CD_HVE = HETCSH.CD_HOT + HETCSH.CD_HVE AND
		HFRCSH.CD_HOT + HFRCSH.CD_HVE + HFRCSH.CD_HFR = HETCSH.CD_HOT + HETCSH.CD_HVE + HETCSH.CD_HFR AND
		HETCSH.CD_HOT_VIN = @CD_HOT_INS AND
		HVE.CD_HOT + HVE.CD_HVE = HET.CD_HOT + HET.CD_HVE AND
		HFR.CD_HOT + HFR.CD_HVE + HFR.CD_HFR = HET.CD_HOT + HET.CD_HVE + HET.CD_HFR AND
		HET.CD_HOT = HETCSH.CD_HOT_VIN AND
		HET.SG_AER_ORI = HETCSH.SG_AER_ORI AND
		HET.SG_AER_DES = HETCSH.SG_AER_DES AND
		HVE.DT_HVE_INI &lt;= HVECSH.DT_HVE_INI AND
		(HVE.DT_HVE_FIM &gt;= HVECSH.DT_HVE_FIM OR HVE.DT_HVE_FIM IS NULL)

	ORDER BY HETCSH.CD_HOT, HETCSH.CD_HVE, HETCSH.CD_HFR, HETCSH.CD_HET, HET.CD_HOT + HET.CD_HVE

SELECT @FL_OK_TOTAL = 1

/* Abertura do cursor */
OPEN SP_CURSOR

/* Ir para o primeiro registro */
FETCH	SP_CURSOR
INTO	@CD_HOT,
	@CD_HVE,
	@CD_HFR,
	@CD_HET,
	@CD_HOT_NRM,
	@DS_HFR_CSH,
	@QT_HET_DIA_PAR_CSH,
	@QT_HET_DIA_CHG_CSH,
	@DS_HFR_NRM,
	@QT_HET_DIA_PAR_NRM,
	@QT_HET_DIA_CHG_NRM


/* Processar todos os registros de SP_CURSOR */
WHILE @@FETCH_STATUS = 0
BEGIN

	SELECT	@CD_HET_CORRENTE = @CD_HOT + @CD_HVE + @CD_HFR + @CD_HET, 
		@FL_OK = 0

	/* Verificar todos os hotrans normais possivelmente válidos para esta etapa */
	WHILE @@FETCH_STATUS = 0 AND @CD_HOT + @CD_HVE + @CD_HFR + @CD_HET = @CD_HET_CORRENTE
	BEGIN

		SELECT 	@CD_HOT_NRM_CORRENTE = @CD_HOT_NRM,
			@DS_HFR_Descoberta = @DS_HFR_CSH

		/* Processar todas as frequüências deste hotran normal */
		WHILE @@FETCH_STATUS = 0 AND @CD_HOT + @CD_HVE + @CD_HFR + @CD_HET = @CD_HET_CORRENTE AND @CD_HOT_NRM = @CD_HOT_NRM_CORRENTE
		BEGIN

			SELECT	@DS_HFR_CSH = @DS_HFR_Descoberta,
				@DS_HFR_Descoberta = &#39;&#39;,
				@NR_POS = 1

			/* Varrer @DS_HFR_CSH para verificar se cada dia desta freqüência está contido na freqüência da etapa normal */
			WHILE SUBSTRING(RTRIM(@DS_HFR_CSH) + &#39;X&#39;, @NR_POS, 1) &lt;&gt; &#39;X&#39;
			BEGIN

				    /* Verificar se este dia da freqüência de partida do vôo codeshare/duplicate está na freqüência de partida do vôo vinculado */
				IF PATINDEX(&#39;%&#39; + CONVERT(CHAR(1), (((CONVERT(INT, SUBSTRING(@DS_HFR_CSH, @NR_POS, 1)) - ( ISNULL(@QT_HET_DIA_PAR_NRM,0) - ISNULL(@QT_HET_DIA_PAR_CSH,0) ) - 1) % 7) + 7) % 7 + 1) + &#39;%&#39;, @DS_HFR_NRM) = 0
				    OR

				   /* Verificar se este dia da freqüência de chegada do vôo codeshare/duplicate está na freqüência de chegada do vôo vinculado */
				    PATINDEX(&#39;%&#39; + CONVERT(CHAR(1), (((CONVERT(INT, SUBSTRING(@DS_HFR_CSH, @NR_POS, 1)) - ( ISNULL(@QT_HET_DIA_CHG_NRM,0) - ISNULL(@QT_HET_DIA_CHG_CSH,0) ) - 1) % 7) + 7) % 7 + 1) + &#39;%&#39;, @DS_HFR_NRM) = 0
					SELECT @DS_HFR_Descoberta = RTRIM(@DS_HFR_Descoberta) + SUBSTRING(@DS_HFR_CSH, @NR_POS, 1)

				SELECT @NR_POS = @NR_POS + 1

			END

			/* Ir para o próximo registro */
			FETCH	NEXT FROM SP_CURSOR
			INTO	@CD_HOT,
				@CD_HVE,
				@CD_HFR,
				@CD_HET,
				@CD_HOT_NRM,
				@DS_HFR_CSH,
				@QT_HET_DIA_PAR_CSH,
				@QT_HET_DIA_CHG_CSH,
				@DS_HFR_NRM,
				@QT_HET_DIA_PAR_NRM,
				@QT_HET_DIA_CHG_NRM

		END

		IF RTRIM(@DS_HFR_Descoberta) + &#39;X&#39; = &#39;X&#39; SELECT @FL_OK = 1

	END

	IF @FL_OK = 0 SELECT @FL_OK_TOTAL = 0

END
CLOSE SP_CURSOR
DEALLOCATE SP_CURSOR


IF @FL_OK_TOTAL = 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: Há vôos Code-Share ou Duplicate Leg associados a este Hotran que impedem esta alteração.&#39;
	RETURN
END

END
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o59"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o357">
<a:ObjectID>6958A566-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_VerificaIP</a:Name>
<a:Code>SP_VerificaIP</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_VerificaIP    Script Date: 7/8/2000 12:15:32 ******/
Create Procedure SP_VerificaIP
(@pIP VARCHAR(15)) As
DECLARE @i INT
DECLARE @lIPPart VARCHAR(3)
DECLARE @lChar CHAR(1)
DECLARE @lPontos INT
DECLARE @lLenIP INT
DECLARE @lNumeros INT

select @lIPPart = &#39;&#39;
select @lPontos = 0
select @i = 1
IF PATINDEX(&#39;%@%&#39;, @pIP) &gt; 0 
BEGIN
	RAISERROR 20999 &#39;Operação não executada: IP Inválido.&#39;
	RETURN
END
SELECT @lLenIP = PATINDEX (&#39;%@%&#39;,@pIP + &#39;@&#39;) - 1

SELECT @lNumeros = 0

while @i &lt;= @lLenIP

BEGIN
	select @lChar = substring(@pIP, @i, 1)

	if @lChar = &#39;.&#39;
	BEGIN
		SELECT @lNumeros = 0
	END

        If @lChar &lt;&gt; &#39;.&#39; 
	BEGIN
		select @lNumeros = @lNumeros + 1
                
  	        IF @LCHAR &lt; &#39;0&#39; OR @LCHAR &gt; &#39;9&#39; OR @lNumeros &gt; 3
		BEGIN
			RAISERROR 20999 &#39;Operação não executada: IP Inválido.&#39;
			RETURN
		END
		select @lIPPart = LTRIM(@lIPPart) + @lChar
	END

	If (@lChar = &#39;.&#39; Or @i = @lLenIP) And @lIPPart &lt;&gt; &#39;&#39;
	BEGIN
		select @lPontos = @lPontos + 1
		If Not (CONVERT(INT, @lIPPart) &gt;= 0 and CONVERT(INT, @lippart) &lt;= 255)
		BEGIN
			RAISERROR 20999 &#39;Operação não executada: IP Inválido.&#39;
			RETURN
		END
		select @lIPPart = &#39;&#39;
	END
	select @i = @i + 1
END   

If @lPontos &lt;&gt; 4
BEGIN
	RAISERROR 20999 &#39;Operação não executada: IP Inválido.&#39;
	RETURN
END
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o59"/>
</c:Procedure.Owner>
</o:Procedure>
</c:Procedures>
<c:Tables>
<o:Table Ref="o305"/>
<o:Table Ref="o64"/>
<o:Table Ref="o97"/>
<o:Table Ref="o7"/>
<o:Table Ref="o296"/>
<o:Table Ref="o167"/>
<o:Table Ref="o272"/>
<o:Table Ref="o84"/>
<o:Table Ref="o324"/>
<o:Table Ref="o193"/>
<o:Table Ref="o136"/>
<o:Table Ref="o147"/>
<o:Table Ref="o209"/>
<o:Table Ref="o224"/>
<o:Table Ref="o254"/>
</c:Tables>
<c:References>
<o:Reference Ref="o80"/>
<o:Reference Ref="o93"/>
<o:Reference Ref="o129"/>
<o:Reference Ref="o132"/>
<o:Reference Ref="o143"/>
<o:Reference Ref="o163"/>
<o:Reference Ref="o189"/>
<o:Reference Ref="o205"/>
<o:Reference Ref="o217"/>
<o:Reference Ref="o220"/>
<o:Reference Ref="o247"/>
<o:Reference Ref="o250"/>
<o:Reference Ref="o262"/>
<o:Reference Ref="o265"/>
<o:Reference Ref="o268"/>
<o:Reference Ref="o292"/>
<o:Reference Ref="o301"/>
<o:Reference Ref="o320"/>
<o:Reference Ref="o342"/>
</c:References>
<c:TargetModels>
<o:TargetModel Id="o358">
<a:ObjectID>6958A540-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Microsoft SQL Server 7.x</a:Name>
<a:Code>SQL SERVER 7</a:Code>
<a:CreationDate>1081538410</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538410</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:TargetModelURL>file:///%_DBMS%/sqlserv7.xdb</a:TargetModelURL>
<a:TargetModelID>986CB218-1936-4245-823C-883D7AF59B86</a:TargetModelID>
<a:TargetModelClassID>4BA9F647-DAB1-11D1-9944-006097355D9B</a:TargetModelClassID>
<c:SessionShortcuts>
<o:Shortcut Ref="o3"/>
<o:Shortcut Id="o359">
<a:ObjectID>6958A547-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Microsoft SQL Server 7.x</a:Name>
<a:Code>SQL SERVER 7</a:Code>
<a:CreationDate>1081538437</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081538437</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:TargetID>986CB218-1936-4245-823C-883D7AF59B86</a:TargetID>
<a:TargetClassID>4BA9F647-DAB1-11D1-9944-006097355D9B</a:TargetClassID>
<a:TargetPackagePath/>
</o:Shortcut>
</c:SessionShortcuts>
</o:TargetModel>
</c:TargetModels>
</o:Model>
</c:Children>
</o:RootObject>

</Model>