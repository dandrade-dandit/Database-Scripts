<?xml version="1.0" encoding="UTF-8"?>
<?PowerDesigner ID="{69589A96-8FBB-11D8-B6CA-00024416849C}" Name="PhysicalDataModel_3" Objects="230" Symbols="26" Type="{CDE44E21-9669-11D1-9914-006097355D9B}" signature="PDM_DATA_MODEL_XML" version="9.0.0.438 Evaluation"?>
<!-- please do not edit this file -->

<Model xmlns:a="attribute" xmlns:c="collection" xmlns:o="object">

<o:RootObject Id="o1">
<c:Children>
<o:Model Id="o2">
<a:ObjectID>69589A96-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>PhysicalDataModel_3</a:Name>
<a:Code>PHYSICALDATAMODEL_3</a:Code>
<a:CreationDate>1081528635</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1082127190</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PackageOptionsText>
[FolderOptions]

[FolderOptions\Physical Objects]
GenerationCheckModel=Yes
GenerationPath=
RevPkey=Yes
RevFkey=Yes
RevAkey=Yes
RevCheck=Yes
RevIndx=Yes
RevOpts=Yes
RevViewAsTabl=No
RevSystAsTabl=Yes
RevSynmAsTabl=Yes
GenScriptName=crebas
GenScriptName0=
GenScriptName1=
GenScriptName2=
GenScriptName3=
GenScriptName4=
GenScriptName5=
GenScriptName6=
GenScriptName7=
GenScriptName8=
GenScriptName9=
GenPathName=
GenSingleFile=Yes
GenTrgScriptName=cretrg
GenTrgScriptName0=
GenTrgScriptName1=
GenTrgScriptName2=
GenTrgScriptName3=
GenTrgScriptName4=
GenTrgScriptName5=
GenTrgScriptName6=
GenTrgScriptName7=
GenTrgScriptName8=
GenTrgScriptName9=
GenTrgPathName=
GenTrgSingleFile=Yes
GenODBC=No
GenCheckModel=Yes
GenScriptPrev=Yes
GenArchiveModel=No
GenDataPathName=
GenDataSinglefile=Yes
GenDataScriptName=testdata
GenDataScriptName0=
GenDataScriptName1=
GenDataScriptName2=
GenDataScriptName3=
GenDataScriptName4=
GenDataScriptName5=
GenDataScriptName6=
GenDataScriptName7=
GenDataScriptName8=
GenDataScriptName9=
GenDataOdbc=No
GenDataDelOld=No
GenDataTitle=No
GenDataDefNumRows=20
GenDataCommit=0
GenDataPacket=0
GenDataCSV=No
GenDataOwner=No
GenDataProfNumb=
GenDataProfChar=
GenDataProfDate=
GenTspcCrea=Yes
GenTspcDrop=Yes
GenStorCrea=Yes
GenStorDrop=Yes
GenUddtCrea=Yes
GenUddtDval=Yes
GenUddtChck=Yes
GenUddtCmmt=Yes
GenUddtDrop=Yes
GenClssCrea=Yes
GenClssHead=Yes
GenClssFoot=Yes
GenClssCmmt=Yes
GenClssDrop=Yes
GenClssInst=Yes
GenClssSupp=Yes
GenDtbsCrea=Yes
GenDtbsOpts=Yes
GenDtbsHead=Yes
GenDtbsFoot=Yes
GenDtbsOpen=Yes
GenDtbsClose=Yes
GenDtbsDrop=Yes
GenUserCrea=Yes
GenUserGrant=Yes
GenUserDrop=Yes
GenTablCrea=Yes
GenTablChck=Yes
GenTablOpts=Yes
GenTablHead=Yes
GenTablFoot=Yes
GenTablCmmt=Yes
GenTablDrop=Yes
GenColnUddt=Yes
GenColnDval=Yes
GenColnChck=Yes
GenColnOpts=Yes
GenColnCmmt=Yes
GenPkeyCrea=Yes
GenPkeyOpts=Yes
GenPkeyDrop=Yes
GenAkeyCrea=Yes
GenAkeyOpts=Yes
GenAkeyDrop=Yes
GenRefrCrea=Yes
GenRefrIdcl=Yes
GenRefrIDUR=Yes
GenRefrIDUC=Yes
GenRefrIDUN=Yes
GenRefrIDUD=Yes
GenRefrIDDR=Yes
GenRefrIDDC=Yes
GenRefrIDDN=Yes
GenRefrIDDD=Yes
GenRefrDrop=Yes
GenIndxCrea=Yes
GenIndxPkey=Yes
GenIndxFkey=Yes
GenIndxAkey=Yes
GenIndxClus=Yes
GenIndxOthr=Yes
GenIndxOpts=Yes
GenIndxCmmt=Yes
GenIndxDrop=Yes
GenViewCrea=Yes
GenViewHead=Yes
GenViewFoot=Yes
GenViewCmmt=Yes
GenViewDrop=Yes
GenJidxCrea=Yes
GenJidxHead=Yes
GenJidxFoot=Yes
GenJidxDrop=Yes
GenSqncCrea=Yes
GenSqncDrop=Yes
GenTrgrCrea=Yes
GenTrgrDrop=Yes
GenTrgrFIns=Yes
GenTrgrFUpd=Yes
GenTrgrFDel=Yes
GenProcCrea=Yes
GenProcDrop=Yes
GenScriptTitle=Yes
GenScriptNamLabl=No
GenScriptQDtbs=Yes
GenScriptQOwnr=Yes
GenScriptCase=0
GenScriptCharset=0
GenScriptNAcct=No
GenScriptODBC=No
GenUseSync=No
GenSyncChoice=0
GenSyncArch=
GenTmpTablCrea=Yes
GenTmpTablDrop=Yes
GenTrgrStdMsg=Yes
GenTrgrMsgTab=
GenTrgrMsgNo=
GenTrgrMsgTxt=
GenRuleCrea=Yes
GenRuleDrop=Yes

[FolderOptions\Pdm]
IndxIQName=%COLUMN%_%INDEXTYPE%
IndxPK=Yes
IndxFK=Yes
IndxAK=Yes
IndxPKName=%TABLE%_PK
IndxFKName=%REFR%_FK
IndxAKName=%AKEY%_AK
IndxPreserve=No
IndxThreshold=0
RefrPreserve=No
JidxPreserve=No
RbldMultiFact=Yes
RbldMultiDim=Yes
RbldMultiJidx=Yes
CubePreserve=No
CubeScriptPath=
CubeScriptCase=0
CubeScriptCharset=0
CubeScriptNacct=No
CubeScriptHeader=No
CubeScriptExt=csv
CubeScriptExt0=txt
CubeScriptExt1=
CubeScriptExt2=
CubeScriptSep=,
CubeScriptDeli=&quot;
TrgrPreserve=No
TrgrIns=Yes
TrgrUpd=Yes
TrgrDel=Yes
TrgrC2Ins=Yes
TrgrC2Upd=Yes
TrgrC3=Yes
TrgrC4=Yes
TrgrC5=Yes
TrgrC6=Yes
TrgrC7=Yes
TrgrC8=Yes
TrgrC9=Yes
TrgrC10=Yes
TrgrC11=Yes
TrgrC1=Yes
TrgrC12Ins=Yes
TrgrC12Upd=Yes
TrgrC13=Yes
</a:PackageOptionsText>
<a:ModelOptionsText>
[ModelOptions]

[ModelOptions\Physical Objects]
DisplayName=Yes
DefaultDttp=&lt;Undefined&gt;
IgnoreOwner=No
RefrUnique=No
RefrAutoMigrate=Yes
RefrMigrateReuse=Yes
RefrMigrateDomain=Yes
RefrMigrateCheck=Yes
RefrMigrateRule=Yes
RefrMigrateExtd=No
RefrMigrDefaultLink=No
DomnForbDivg=No
DomnCopyDttp=Yes
DomnCopyChck=No
DomnCopyRule=No
DomnCopyMand=No
DomnCopyExtd=No
DomnCopyProf=No

[ModelOptions\Connection]

[ModelOptions\Pdm]

[ModelOptions\Generate]

[ModelOptions\Generate\Cdm]
CheckModel=1
SaveLinks=1
NameToCode=0
Notation=2

[ModelOptions\Generate\Oom]
CheckModel=1
SaveLinks=1
ORMapping=0
NameToCode=0
ClassPrefix=

[ModelOptions\ClssNamingOptions]

[ModelOptions\ClssNamingOptions\PDMPCKG]

[ModelOptions\ClssNamingOptions\PDMPCKG\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\PDMPCKG\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\PDMDOMN]

[ModelOptions\ClssNamingOptions\PDMDOMN\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\PDMDOMN\Code]
Template=
MaxLen=128
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\TABL]

[ModelOptions\ClssNamingOptions\TABL\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\TABL\Code]
Template=
MaxLen=128
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\COLN]

[ModelOptions\ClssNamingOptions\COLN\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\COLN\Code]
Template=
MaxLen=128
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\REFR]

[ModelOptions\ClssNamingOptions\REFR\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\REFR\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\VREF]

[ModelOptions\ClssNamingOptions\VREF\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\VREF\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\VIEW]

[ModelOptions\ClssNamingOptions\VIEW\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\VIEW\Code]
Template=
MaxLen=128
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\FACT]

[ModelOptions\ClssNamingOptions\FACT\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\FACT\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\DIMN]

[ModelOptions\ClssNamingOptions\DIMN\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\DIMN\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\CUBE]

[ModelOptions\ClssNamingOptions\CUBE\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\CUBE\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\MEAS]

[ModelOptions\ClssNamingOptions\MEAS\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\MEAS\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\DATTR]

[ModelOptions\ClssNamingOptions\DATTR\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\DATTR\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\FILO]

[ModelOptions\ClssNamingOptions\FILO\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;\/:*?&lt;&gt;|&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\FILO\Code]
Template=
MaxLen=254
Case=U
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_.&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\DefaultClass]

[ModelOptions\ClssNamingOptions\DefaultClass\Name]
Template=
MaxLen=254
Case=M
ValidChar=
InvldChar=&quot;+-*/\.,!:;&#39;&quot;
AllValid=1
NoAccent=0
DefaultChar=_
Script=.foreach_part(%Name%)[CRLF].convert_name(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\ClssNamingOptions\DefaultClass\Code]
Template=
MaxLen=254
Case=M
ValidChar=&#39;a&#39;-&#39;z&#39;,&#39;A&#39;-&#39;Z&#39;,&#39;0&#39;-&#39;9&#39;,&quot;_&quot;
InvldChar=
AllValid=0
NoAccent=1
DefaultChar=_
Script=.foreach_part(%Code%)[CRLF].convert_code(%CurrentPart%)[CRLF].next(&quot;_&quot;)
ConvTable=

[ModelOptions\NamingOptionsTemplates]

[ModelOptions\Default Opts]

[ModelOptions\Default Opts\TABL]
PhysOpts=

[ModelOptions\Default Opts\COLN]
PhysOpts=

[ModelOptions\Default Opts\INDX]
PhysOpts=

[ModelOptions\Default Opts\AKEY]
PhysOpts=

[ModelOptions\Default Opts\PKEY]
PhysOpts=

[ModelOptions\Default Opts\STOR]
PhysOpts=

[ModelOptions\Default Opts\TSPC]
PhysOpts=

[ModelOptions\Default Opts\SQNC]
PhysOpts=

[ModelOptions\Default Opts\DTBS]
PhysOpts=
</a:ModelOptionsText>
<c:DBMS>
<o:Shortcut Id="o3">
<a:ObjectID>69589A99-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Microsoft SQL Server 7.x</a:Name>
<a:Code>SQL SERVER 7</a:Code>
<a:CreationDate>1081528635</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528635</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:TargetID>986CB218-1936-4245-823C-883D7AF59B86</a:TargetID>
<a:TargetClassID>4BA9F647-DAB1-11D1-9944-006097355D9B</a:TargetClassID>
<a:TargetPackagePath/>
</o:Shortcut>
</c:DBMS>
<c:PhysicalDiagrams>
<o:PhysicalDiagram Id="o4">
<a:ObjectID>69589A97-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>PhysicalDiagram_1</a:Name>
<a:Code>PHYSICALDIAGRAM_1</a:Code>
<a:CreationDate>1081528633</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1082140469</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DisplayPreferences>
[DisplayPreferences]

[DisplayPreferences\PDM]

[DisplayPreferences\General]
Adjust to text=Yes
Snap Grid=No
Display Grid=No
Show Page Delimiter=Yes
Grid size=800
Graphic unit=0
Window color=255 255 255

[DisplayPreferences\Object]
Mode=0
Trunc Length=80
Word Length=80
Word Text=!&quot;&quot;#$%&amp;&#39;()*+,-./:;&lt;=&gt;?@[\]^_`{|}~
Shortcut IntIcon=Yes
Shortcut IntLoct=No
Shortcut ExtIcon=Yes
Shortcut ExtLoct=No
File Location=No
TablColn=No
ColnMode=0
ColnMax=5
TablIndx=No
TablKey=No
TablTrgr=Yes
TablOwnr=No
ColnDttp=Yes
ColnDomn=No
ColnShowDomn=Yes
ColnKey=Yes
ColnIndx=Yes
ColnMand=Yes
ViewTabl=Yes
ViewColn=Yes
ViewOwnr=No
VColName=Yes
VColExpr=No
VColDttp=No
VColCMod=1
VColCMax=5
RefrName=No
RefrJoin=Yes
RefrCnam=No
RefrIntg=No
RefrImpl=No
RefrCard=No
RefrMode=2
VRefName=No
VRefJoin=No
VRefMode=0

[DisplayPreferences\Symbol]

[DisplayPreferences\Symbol\PDMPCKG]
DISPNAMEFont=arial,8,N
DISPNAMEFont color=0, 0, 0
AutoAdjustToText=Yes
Width=4800
Height=3600
Brush color=255 255 255
Fill Color=Yes
Pen=1 0 0, 0, 255
Shadow color=192 192 192
Shadow=No

[DisplayPreferences\Symbol\TABL]
DISPNAMEFont=arial,8,N
DISPNAMEFont color=0, 0, 0
TableColumnsFont=arial,8,N
TableColumnsFont color=0, 0, 0
TablePkColumnsFont=arial,8,N
TablePkColumnsFont color=0, 0, 0
TableIndexsFont=arial,8,N
TableIndexsFont color=0, 0, 0
TableKeysFont=arial,8,N
TableKeysFont color=0, 0, 0
TableTriggersFont=arial,8,N
TableTriggersFont color=0, 0, 0
AutoAdjustToText=Yes
Width=4800
Height=3600
Brush color=255 255 255
Fill Color=Yes
Pen=1 0 0, 0, 255
Shadow color=192 192 192
Shadow=No

[DisplayPreferences\Symbol\REFR]
DISPNAMEFont=arial,8,N
DISPNAMEFont color=0, 0, 0
CARDFont=arial,8,N
CARDFont color=0, 0, 0
Line style=0
Brush color=255 255 255
Fill Color=Yes
Pen=1 0 0, 0, 255
Shadow color=192 192 192
Shadow=No

[DisplayPreferences\Symbol\VREF]
DISPNAMEFont=arial,8,N
DISPNAMEFont color=0, 0, 0
Line style=0
Brush color=255 255 255
Fill Color=Yes
Pen=1 0 0, 0, 255
Shadow color=192 192 192
Shadow=No

[DisplayPreferences\Symbol\VIEW]
DISPNAMEFont=arial,8,N
DISPNAMEFont color=0, 0, 0
ViewColumnnFont=arial,8,N
ViewColumnnFont color=0, 0, 0
ViewTablesFont=arial,8,N
ViewTablesFont color=0, 0, 0
AutoAdjustToText=Yes
Width=4800
Height=3600
Brush color=255 255 255
Fill Color=Yes
Pen=1 0 0, 0, 255
Shadow color=192 192 192
Shadow=No

[DisplayPreferences\Symbol\FILO]
NAMEFont=arial,8,N
NAMEFont color=0, 0, 0
AutoAdjustToText=Yes
Width=2400
Height=2400
Brush color=255 255 255
Fill Color=No
Pen=1 0 0, 0, 255
Shadow color=192 192 192
Shadow=No

[DisplayPreferences\Symbol\USRDEPD]
OBJXSTRFont=arial,8,N
OBJXSTRFont color=0, 0, 0
Line style=0
Brush color=255 255 255
Fill Color=Yes
Pen=2 0 0 0 0
Shadow color=192 192 192
Shadow=No

[DisplayPreferences\Symbol\Free Symbol]
Free TextFont=arial,8,N
Free TextFont color=0, 0, 0
Line style=0
Brush color=255 255 255
Fill Color=Yes
Pen=1 0 0, 0, 255
Shadow color=192 192 192
Shadow=No
</a:DisplayPreferences>
<a:PaperSize>(8268, 11689)</a:PaperSize>
<a:PageMargins>((315,354), (433,354))</a:PageMargins>
<a:PageSize>9</a:PageSize>
<a:PaperSource>7</a:PaperSource>
<c:Symbols>
<o:ReferenceSymbol Id="o5">
<a:Rect>((-716818,685505), (-702978,708916))</a:Rect>
<a:ListOfPoints>((-702978,708916),(-716818,685505))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>16711680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Id="o6">
<a:Rect>((-705836,705729), (-699132,710625))</a:Rect>
<a:LineColor>16711680</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o7">
<a:ObjectID>69589AD2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_BOX</a:Name>
<a:Code>T_BOX</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o8">
<a:ObjectID>69589ABC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_BOX</a:Name>
<a:Code>CD_BOX</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o9">
<a:ObjectID>69589ABD-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_BOX</a:Name>
<a:Code>NR_BOX</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(4)</a:DataType>
<a:Length>4</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o10">
<a:ObjectID>69589ABE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_BOX</a:Name>
<a:Code>TP_BOX</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o11">
<a:ObjectID>69589ABF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>QT_BOX_PES</a:Name>
<a:Code>QT_BOX_PES</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_ZRO    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_ZRO As
0</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o12">
<a:ObjectID>69589AC0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_BOX_CON</a:Name>
<a:Code>FL_BOX_CON</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_ZRO    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_ZRO As
0</a:DefaultValue>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o13">
<a:ObjectID>69589AC1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_BOX_PAX</a:Name>
<a:Code>FL_BOX_PAX</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o14">
<a:ObjectID>69589AC2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_BOX_CRG</a:Name>
<a:Code>FL_BOX_CRG</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:DataType>bit</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o15">
<a:ObjectID>69589AC3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_DOM</a:Name>
<a:Code>FT_BOX_DOM</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o16">
<a:ObjectID>69589AC4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_INT</a:Name>
<a:Code>FT_BOX_INT</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o17">
<a:ObjectID>69589AC6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_REG</a:Name>
<a:Code>FT_BOX_REG</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o18">
<a:ObjectID>69589AC7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_PAX</a:Name>
<a:Code>FT_BOX_PAX</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o19">
<a:ObjectID>69589AC8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_CRG</a:Name>
<a:Code>FT_BOX_CRG</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o20">
<a:ObjectID>69589AC9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_MIS</a:Name>
<a:Code>FT_BOX_MIS</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o21">
<a:ObjectID>69589ACA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_TSL</a:Name>
<a:Code>FT_BOX_TSL</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o22">
<a:ObjectID>69589ACB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_RGL</a:Name>
<a:Code>FT_BOX_RGL</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o23">
<a:ObjectID>69589ACC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_CHT</a:Name>
<a:Code>FT_BOX_CHT</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o24">
<a:ObjectID>69589ACD-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_TEC</a:Name>
<a:Code>FT_BOX_TEC</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o25">
<a:ObjectID>69589ACE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_AVG</a:Name>
<a:Code>FT_BOX_AVG</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o26">
<a:ObjectID>69589ACF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_MLT</a:Name>
<a:Code>FT_BOX_MLT</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o27">
<a:ObjectID>69589AD0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_NRG</a:Name>
<a:Code>FT_BOX_NRG</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o28">
<a:ObjectID>69589AD1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FT_BOX_TXA</a:Name>
<a:Code>FT_BOX_TXA</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL0    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL0 As
@valor &gt;= 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o29">
<a:ObjectID>69589AD3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_AER</a:Name>
<a:Code>CD_AER</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o30">
<a:ObjectID>69589AD4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o31">
<a:ObjectID>69589ADE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_BOX</a:Name>
<a:Code>Pk_T_BOX</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_BOX</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o8"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o32">
<a:ObjectID>69589AD5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_BOX_AER</a:Name>
<a:Code>I_BOX_AER</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o33">
<a:ObjectID>69589AD6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o9"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o34">
<a:ObjectID>69589AD7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_1&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o29"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o35">
<a:ObjectID>69589AD9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_AER</a:Name>
<a:Code>I_AER</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o36">
<a:ObjectID>69589ADB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o29"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o37">
<a:ObjectID>69589ADC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_BOX_TP</a:Name>
<a:Code>I_BOX_TP</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o38">
<a:ObjectID>69589ADD-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o10"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Id="o39">
<a:ObjectID>69589A9B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>dbo</a:Name>
<a:Code>dbo</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
</o:User>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o40">
<a:ObjectID>69589A8A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_BOX_TRD</a:Name>
<a:Code>T_BOX_TRD</a:Code>
<a:Text>Create Trigger T_BOX_TRD On T_BOX
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Box»Chegadas - Mirror: Box da Chegada (Restrict) */
If (Select Count(*) From T_CHG_MIR dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Box&gt; está sendo referenciada na tabela &lt;Chegadas - Mirror&gt;&#39;
  Return
End
/* Box»Chegadas: Box da Chegada (Restrict) */
If (Select Count(*) From T_CHG dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Box&gt; está sendo referenciada na tabela &lt;Chegadas&gt;&#39;
  Return
End
/* Box»Hotran - Boxes: Box do Hotran (Restrict) */
If (Select Count(*) From T_HBX001 dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Box&gt; está sendo referenciada na tabela &lt;Hotran - Boxes&gt;&#39;
  Return
End
/* Box»Histórico de Permanência de Aeronaves - Mirror: Box do HPA (Restrict) */
If (Select Count(*) From T_HPA001_MIR dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Box&gt; está sendo referenciada na tabela &lt;Histórico de Permanência de Aeronaves - Mirror&gt;&#39;
  Return
End
/* Box»Histórico de Permanência de Aeronaves: Box do HPA (Restrict) */
If (Select Count(*) From T_HPA001 dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Box&gt; está sendo referenciada na tabela &lt;Histórico de Permanência de Aeronaves&gt;&#39;
  Return
End
/* Box»Boxes da Companhia Aérea: Boxes da Companhia Aérea (Restrict) */
If (Select Count(*) From T_BCO dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Box&gt; está sendo referenciada na tabela &lt;Boxes da Companhia Aérea&gt;&#39;
  Return
End
/* Box»Boxes do Equipamento: Boxes do Equipamento (Restrict) */
If (Select Count(*) From T_BEQ dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Box&gt; está sendo referenciada na tabela &lt;Boxes do Equipamento&gt;&#39;
  Return
End
/* Box»Hotran - Frequência: É Box da Frequencia (Restrict) */
If (Select Count(*) From T_HFR dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Box&gt; está sendo referenciada na tabela &lt;Hotran - Frequência&gt;&#39;
  Return
End
/* Box»Capacidades do Box: Box da Capacidade do Box (Cascade) */
Delete T_BCP From T_BCP dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX
/* Box»Hotran - Box x Vôo: Boxes do BOX x VÔO (Cascade) */
Delete T_HBV From T_HBV dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX
/* Box»Boxes Indisponíveis: Indisponibilidade de Box (Cascade) */
Delete T_BIN From T_BIN dep, Deleted pri
 Where dep.CD_BOX = pri.CD_BOX
End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o41">
<a:ObjectID>69589A8B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_BOX_TRI</a:Name>
<a:Code>T_BOX_TRI</a:Code>
<a:Text>Create Trigger T_BOX_TRI On T_BOX
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Aeroporto»Box: Aeroporto possui Boxes */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Box&gt; não está cadastrada&#39;
  Return
End
/* Domínio de: Tipo de Box */
/* 1 - Estadia */
/* 2 - Isento */
/* 3 - Pátio */
/* 9 - Controle */
If (Select Count(*) From Inserted
    Where TP_BOX In (1,2,3,9))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Tipo de Box&gt; que se deseja incluir na tabela &lt;Box&gt; não é uma opção válida&#39;
  Return
End
/* Regra de negócio */
/* Não pode existir mais de um box do tipo Controle (9) */
IF (	SELECT 	COUNT(*) 
	FROM 	T_BOX BOX,
		INSERTED INS
	WHERE 	BOX.CD_AER = INS.CD_AER AND
		INS.TP_BOX = 9 AND 
		BOX.TP_BOX = 9) &gt; 1
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Só pode existir um único box do tipo &lt;Controle&gt;.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o42">
<a:ObjectID>69589A8C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_BOX_TRU</a:Name>
<a:Code>T_BOX_TRU</a:Code>
<a:Text>Create Trigger T_BOX_TRU On T_BOX
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_BOX)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Box&gt; da tabela &lt;Box&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_AER)
/* Aeroporto»Box: Aeroporto possui Boxes */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Box&gt; não está cadastrada&#39;
  Return
End
If Update (TP_BOX)
/* Domínio de: Tipo de Box */
/* 1 - Estadia */
/* 2 - Isento */
/* 3 - Pátio */
/* 9 - Controle */
If (Select Count(*) From Inserted
    Where TP_BOX In (1,2,3,9))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Tipo de Box&gt; que se deseja incluir na tabela &lt;Box&gt; não é uma opção válida&#39;
  Return
End
/* Regra de negócio */
/* Não pode existir mais de um box do tipo Controle (9) */
IF (	SELECT 	COUNT(*) 
	FROM 	T_BOX BOX,
		INSERTED INS
	WHERE 	BOX.CD_AER = INS.CD_AER AND
		INS.TP_BOX = 9 AND 
		BOX.TP_BOX = 9) &gt; 1
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Só pode existir um único box do tipo &lt;Controle&gt;.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

IF UPDATE(NR_BOX)
BEGIN
	/* Incluir Registros em T_ACH */
	INSERT	T_ACH (DH_ACH, CD_CHG)
	Select 	GETDATE(), CHG.CD_CHG
	From 	T_CHG CHG, T_HPA001 HPA, INSERTED INS
	Where 	CHG.TP_CHG_STA = 1 AND
		CHG.CD_AER = (Select CD_AER From T_PSI) AND
		CHG.CD_CHG = HPA.CD_CHG AND
		HPA.NR_HPA_SEQ = 1 AND
		HPA.CD_BOX = INS.CD_BOX

	/* Incluir Registros em T_APA */
	INSERT	T_APA (DH_APA, CD_PAR)
	Select 	GETDATE(), PAR.CD_PAR
	From 	T_PAR PAR, T_HPA001 HPA, INSERTED INS
	Where 	PAR.TP_PAR_STA = 1 AND
		PAR.CD_AER = (Select CD_AER From T_PSI) AND
		PAR.CD_PAR = HPA.CD_PAR AND
		HPA.NR_HPA_SEQ = (SELECT MAX(NR_HPA_SEQ) FROM T_HPA001 WHERE CD_HPA = HPA.CD_HPA) AND
		HPA.CD_BOX = INS.CD_BOX

	/* Incluir Registros em T_AHO */
	INSERT	T_AHO (CD_HOT, DH_AHO)
	Select	DISTINCT CD_HOT, GETDATE()
	From	T_HFR HFR, INSERTED INS
	Where	HFR.CD_BOX = INS.CD_BOX
END

IF UPDATE(NR_BOX) OR UPDATE(TP_BOX)
BEGIN
	/* Incluir Registros em T_AHP */
	INSERT	T_AHP (CD_HPA, DH_AHP)
	Select	DISTINCT CD_HPA, GETDATE()
	From	T_HPA001 HPA, T_CHG CHG, T_SIT SIT, INSERTED INS
	Where	HPA.CD_CHG = CHG.CD_CHG AND
		SIT.CD_SIT = CHG.CD_SIT AND
		HPA.CD_AER = (Select CD_AER From T_PSI) AND
		(HPA.FL_HPA_ENT = 1 OR SIT.FL_SIT_AEN_PAT = 1) AND
		HPA.FL_HPA_SAI = 0 AND 
		HPA.CD_AEN IS NOT NULL AND
		HPA.CD_BOX = INS.CD_BOX
END

End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o31"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o43">
<a:Rect>((-720948,684711), (-714322,689257))</a:Rect>
<a:LineColor>16711680</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o44">
<a:ObjectID>69589AC5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_AER</a:Name>
<a:Code>T_AER</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o45">
<a:ObjectID>69589AB0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_AER</a:Name>
<a:Code>CD_AER</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o46">
<a:ObjectID>69589AB1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_AER</a:Name>
<a:Code>NM_AER</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(40)</a:DataType>
<a:Length>40</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o47">
<a:ObjectID>69589AB2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SG_AER_ICA</a:Name>
<a:Code>SG_AER_ICA</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(4)</a:DataType>
<a:Length>4</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o48">
<a:ObjectID>69589AB3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SG_AER_IAT</a:Name>
<a:Code>SG_AER_IAT</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(3)</a:DataType>
<a:Length>3</a:Length>
</o:Column>
<o:Column Id="o49">
<a:ObjectID>69589AB4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_AER_TEL_CHG</a:Name>
<a:Code>NR_AER_TEL_CHG</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o50">
<a:ObjectID>69589AB5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_AER_TEL_PAR</a:Name>
<a:Code>NR_AER_TEL_PAR</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o51">
<a:ObjectID>69589AB6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TP_AER_CTG</a:Name>
<a:Code>TP_AER_CTG</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o52">
<a:ObjectID>69589AB7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_CID</a:Name>
<a:Code>CD_CID</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o53">
<a:ObjectID>69589AB8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o54">
<a:ObjectID>69589ABB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_AER</a:Name>
<a:Code>Pk_T_AER</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_AER</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o45"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o55">
<a:ObjectID>69589AB9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_AER_ICA</a:Name>
<a:Code>I_AER_ICA</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o56">
<a:ObjectID>69589ABA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o47"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Ref="o39"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o57">
<a:ObjectID>69589A70-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_AER_TRD</a:Name>
<a:Code>T_AER_TRD</a:Code>
<a:Text>Create Trigger T_AER_TRD On T_AER
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Aeroporto»Chegadas - Mirror: Aeroporto da Chegada (Restrict) */
If (Select Count(*) From T_CHG_MIR dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Chegadas - Mirror&gt;&#39;
  Return
End
/* Aeroporto»Chegadas: Aeroporto da Chegada (Restrict) */
If (Select Count(*) From T_CHG dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Chegadas&gt;&#39;
  Return
End
/* Aeroporto»Escala da Chegada de Vôo - Mirror: Aeroporto da Escala de Partida (Restrict) */
If (Select Count(*) From T_ECC001_MIR dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Escala da Chegada de Vôo - Mirror&gt;&#39;
  Return
End
/* Aeroporto»Escala da Partida de Vôo - Mirror: Aeroporto da Escala de Partida (Restrict) */
If (Select Count(*) From T_ECP001_MIR dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Escala da Partida de Vôo - Mirror&gt;&#39;
  Return
End
/* Aeroporto»Partidas - Mirror: Aeroporto da Partida (Restrict) */
If (Select Count(*) From T_PAR_MIR dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Partidas - Mirror&gt;&#39;
  Return
End
/* Aeroporto»Partidas: Aeroporto da Partida (Restrict) */
If (Select Count(*) From T_PAR dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Partidas&gt;&#39;
  Return
End
/* Aeroporto»Tela: Aeroporto das Telas (Restrict) */
If (Select Count(*) From T_TEL dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Tela&gt;&#39;
  Return
End
/* Aeroporto»Hotran - Etapa: Aeroporto Destino (Restrict) */
If (Select Count(*) From T_HET dep, Deleted pri
 Where dep.SG_AER_DES = pri.SG_AER_ICA) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Hotran - Etapa&gt;&#39;
  Return
End
/* Aeroporto»Histórico de Permanência de Aeronaves - Mirror: Aeroporto do HPA (Restrict) */
If (Select Count(*) From T_HPA001_MIR dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Histórico de Permanência de Aeronaves - Mirror&gt;&#39;
  Return
End
/* Aeroporto»Histórico de Permanência de Aeronaves: Aeroporto do HPA (Restrict) */
If (Select Count(*) From T_HPA001 dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Histórico de Permanência de Aeronaves&gt;&#39;
  Return
End
/* Aeroporto»Dados Estatísticos de Partida - Mirror: Aeroporto está em (Restrict) */
If (Select Count(*) From T_DEP_MIR dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Dados Estatísticos de Partida - Mirror&gt;&#39;
  Return
End
/* Aeroporto»Escala da Chegada de Vôo: Aeroporto integra ECC (Restrict) */
If (Select Count(*) From T_ECC001 dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Escala da Chegada de Vôo&gt;&#39;
  Return
End
/* Aeroporto»Escala da Partida de Vôo: Aeroporto integra ECP (Restrict) */
If (Select Count(*) From T_ECP001 dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Escala da Partida de Vôo&gt;&#39;
  Return
End
/* Aeroporto»Parâmetros do Sistema: Aeroporto Integra Par. Sistema (Restrict) */
If (Select Count(*) From T_PSI dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Parâmetros do Sistema&gt;&#39;
  Return
End
/* Aeroporto»Hotran - Etapa: Aeroporto Origem (Restrict) */
If (Select Count(*) From T_HET dep, Deleted pri
 Where dep.SG_AER_ORI = pri.SG_AER_ICA) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Hotran - Etapa&gt;&#39;
  Return
End
/* Aeroporto»Propaganda: Aeroporto Possui Propagandas (Restrict) */
If (Select Count(*) From T_PRG dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Propaganda&gt;&#39;
  Return
End
/* Aeroporto»Dados Estatísticos de Partida: Está em (Restrict) */
If (Select Count(*) From T_DEP dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Aeroporto&gt; está sendo referenciada na tabela &lt;Dados Estatísticos de Partida&gt;&#39;
  Return
End
/* Aeroporto»Horário Comercial: Aer. possui Horário Comercial (Cascade) */
Delete T_HRC From T_HRC dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER
/* Aeroporto»Box: Aeroporto possui Boxes (Cascade) */
Delete T_BOX From T_BOX dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER
/* Aeroporto»Checkin: Aeroporto possui Checkins (Cascade) */
Delete T_CHK From T_CHK dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER
/* Aeroporto»Esteira: Aeroporto possui Esteiras (Cascade) */
Delete T_EST From T_EST dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER
/* Aeroporto»Pistas de Decolagem: Aeroporto possui Pista (Cascade) */
Delete T_PIS From T_PIS dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER
/* Aeroporto»Ponte de Embarque: Aeroporto possui Pista de Embarque (Cascade) */
Delete T_PON From T_PON dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER
/* Aeroporto»Portão: Aeroporto possui Portões (Cascade) */
Delete T_POR From T_POR dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER
/* Aeroporto»Sala de Desembarque: Aeroporto possui Sal.Desemb. (Cascade) */
Delete T_SAL From T_SAL dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER
/* Aeroporto»Sala de Embarque: Aeroporto possui SalasEmbarque (Cascade) */
Delete T_EMB From T_EMB dep, Deleted pri
 Where dep.CD_AER = pri.CD_AER
End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o58">
<a:ObjectID>69589A72-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_AER_TRI</a:Name>
<a:Code>T_AER_TRI</a:Code>
<a:Text>Create Trigger T_AER_TRI On T_AER
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Cidade»Aeroporto: Cidade possui Aeroportos */
If (Select Count(*) From T_CID, Inserted
Where T_CID.CD_CID = Inserted.CD_CID)
 &lt;&gt;(Select Count(CD_CID) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Cidade&gt; que se deseja incluir na tabela &lt;Aeroporto&gt; não está cadastrada&#39;
  Return
End
/* Domínio de: Categoria do Aeroporto */
/* 1 - Não se aplica */
/* 2 - 1ª Categoria */
/* 3 - 2ª Categoria */
/* 4 - 3ª Categoria */
/* 5 - 4ª Categoria */
If (Select Count(*) From Inserted
    Where TP_AER_CTG In (1,2,3,4,5))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Categoria do Aeroporto&gt; que se deseja incluir na tabela &lt;Aeroporto&gt; não é uma opção válida&#39;
  Return
End
/* Regra de negócio */
/* Verificar se já existe algum Aeroporto com a sigla IATA do Aeroporto que se está incluindo */
IF (	SELECT	COUNT(*)
	FROM	T_AER AER, 
		INSERTED INS
	WHERE	AER.CD_AER &lt;&gt; INS.CD_AER AND
		AER.SG_AER_IAT = INS.SG_AER_IAT AND
		INS.SG_AER_IAT IS NOT NULL) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Já existe um Aeroporto cadastrado com esta sigla IATA.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o59">
<a:ObjectID>69589A74-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_AER_TRU</a:Name>
<a:Code>T_AER_TRU</a:Code>
<a:Text>Create Trigger T_AER_TRU On T_AER
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_AER)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Aeroporto&gt; da tabela &lt;Aeroporto&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_CID)
/* Cidade»Aeroporto: Cidade possui Aeroportos */
If (Select Count(*) From T_CID, Inserted
Where T_CID.CD_CID = Inserted.CD_CID)
 &lt;&gt;(Select Count(CD_CID) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Cidade&gt; que se deseja incluir na tabela &lt;Aeroporto&gt; não está cadastrada&#39;
  Return
End
If Update (TP_AER_CTG)
/* Domínio de: Categoria do Aeroporto */
/* 1 - Não se aplica */
/* 2 - 1ª Categoria */
/* 3 - 2ª Categoria */
/* 4 - 3ª Categoria */
/* 5 - 4ª Categoria */
If (Select Count(*) From Inserted
    Where TP_AER_CTG In (1,2,3,4,5))
 &lt;&gt;(Select Count(*) From Inserted)
Begin
  RollBack Transaction
  RaisError 20004 &#39;Operação não executada: A informação &lt;Categoria do Aeroporto&gt; que se deseja incluir na tabela &lt;Aeroporto&gt; não é uma opção válida&#39;
  Return
End
/* Regra de negócio */
/* Verificar se já existe algum Aeroporto cadastrado com a sigla IATA do Aeroporto que se está alterando */
IF (	SELECT	COUNT(*)
	FROM	T_AER AER, 
		INSERTED INS
	WHERE	AER.CD_AER &lt;&gt; INS.CD_AER AND
		AER.SG_AER_IAT = INS.SG_AER_IAT AND
		INS.SG_AER_IAT IS NOT NULL) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Já existe um Aeroporto cadastrado com esta sigla IATA.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Caso a sigla ICAO do aeroporto seja alterada, alterar os campos SG_AER_DES E SG_AER_ORI da tabela T_HET */
IF UPDATE(SG_AER_ICA)
BEGIN
	UPDATE	HET
	SET	SG_AER_DES = INS.SG_AER_ICA
	FROM	T_HET HET, INSERTED INS, DELETED DEL
	WHERE	INS.CD_AER = DEL.CD_AER AND
		HET.SG_AER_DES = DEL.SG_AER_ICA

	UPDATE	HET
	SET	SG_AER_ORI = INS.SG_AER_ICA
	FROM	T_HET HET, INSERTED INS, DELETED DEL
	WHERE	INS.CD_AER = DEL.CD_AER AND
		HET.SG_AER_ORI = DEL.SG_AER_ICA
END

IF UPDATE(SG_AER_ICA) OR UPDATE(SG_AER_IAT)
BEGIN
	/* Incluir registros em T_ACH */
	INSERT	T_ACH (DH_ACH, CD_CHG)
	Select	GETDATE(), ECC.CD_CHG
	From	T_ECC001 ECC, T_AER AER, INSERTED INS
	Where	ECC.CD_CHG IN (	Select 	CD_CHG
				From 	T_CHG CHG
				Where	CHG.TP_CHG_STA = 1 And
					CHG.CD_AER = (Select CD_AER From T_PSI)) AND
		AER.CD_AER = ECC.CD_AER AND
		AER.CD_AER = INS.CD_AER

	/* Incluir registros em T_APA */
	INSERT	T_APA (DH_APA, CD_PAR)
	Select	GETDATE(), ECP.CD_PAR
	From	T_ECP001 ECP, T_AER AER, INSERTED INS
	Where	ECP.CD_PAR IN (	Select 	CD_PAR
				From 	T_PAR PAR
				Where	PAR.TP_PAR_STA = 1 And
					PAR.CD_AER = (Select CD_AER From T_PSI)) AND
		AER.CD_AER = ECP.CD_AER AND
		AER.CD_AER = INS.CD_AER
END

IF UPDATE(SG_AER_IAT)
BEGIN
	/* Incluir registros em T_AHO */
	INSERT	T_AHO (CD_HOT, DH_AHO)
	Select	DISTINCT CD_HOT, GETDATE()
	From	T_HET HET, INSERTED INS
	Where	HET.SG_AER_ORI = INS.SG_AER_ICA OR
		HET.SG_AER_DES = INS.SG_AER_ICA

	-- Alexei alterou em 05/01/00
	-- Não permitir a alteração da sigla IATA para NULO se o aeroporto estiver em alguma etapa de hotran
	IF (	Select	Count(*)
		from	T_Het Het
		,	Inserted Ins
		where	(Het.SG_AER_ORI = Ins.SG_AER_ICA
		or	Het.SG_AER_DES = Ins.SG_AER_ICA)
		and	Ins.SG_AER_IAT is NULL) &gt; 0
	BEGIN
		RAISERROR 20999 &#39;Operação não executada: O aeroporto não pode ter sigla IATA nula pois está sendo utilizado em etapa de hotran.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
	-- Fim Alteração Alexei em 05/01/00

END
End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o54"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o60">
<a:ObjectID>69589A69-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_1</a:Name>
<a:Code>REFERENCE_1</a:Code>
<a:CreationDate>1081528807</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528807</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o44"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o7"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o54"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o61">
<a:ObjectID>69589A6B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528807</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528807</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o45"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o29"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o62">
<a:CenterTextOffset>(7, 0)</a:CenterTextOffset>
<a:Rect>((-718860,660006), (-711136,687173))</a:Rect>
<a:ListOfPoints>((-712616,660006),(-717429,687173))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>16711680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Id="o63">
<a:Rect>((-715928,657732), (-709302,662278))</a:Rect>
<a:LineColor>16711680</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o64">
<a:ObjectID>69589AD8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_CHK</a:Name>
<a:Code>T_CHK</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o65">
<a:ObjectID>69589AE0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_CHK</a:Name>
<a:Code>CD_CHK</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o66">
<a:ObjectID>69589AE1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_CHK</a:Name>
<a:Code>NR_CHK</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(4)</a:DataType>
<a:Length>4</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o67">
<a:ObjectID>69589AE2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_CHK_ORD</a:Name>
<a:Code>NR_CHK_ORD</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o68">
<a:ObjectID>69589AE3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_AER</a:Name>
<a:Code>CD_AER</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o69">
<a:ObjectID>69589AE4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_COM</a:Name>
<a:Code>CD_COM</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o70">
<a:ObjectID>69589AE5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o71">
<a:ObjectID>69589AEA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_CHK</a:Name>
<a:Code>Pk_T_CHK</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_CHK</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o65"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o72">
<a:ObjectID>69589AE6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_CHK_AER</a:Name>
<a:Code>I_CHK_AER</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o73">
<a:ObjectID>69589AE8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o66"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o74">
<a:ObjectID>69589AE9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_1&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o68"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Ref="o39"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o75">
<a:ObjectID>69589A8D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_CHK_TRD</a:Name>
<a:Code>T_CHK_TRD</a:Code>
<a:Text>Create Trigger T_CHK_TRD On T_CHK
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Checkin»FIDS - IST Servidor de Informação: Check-in Associado ao IST (Restrict) */
If (Select Count(*) From T_FIDS_IST dep, Deleted pri
 Where dep.CD_CHK = pri.CD_CHK) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Checkin&gt; está sendo referenciada na tabela &lt;FIDS - IST Servidor de Informação&gt;&#39;
  Return
End
/* Checkin»Hotran - Check in: Check-in do Hotran (Restrict) */
If (Select Count(*) From T_HCK dep, Deleted pri
 Where dep.CD_CHK = pri.CD_CHK) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Checkin&gt; está sendo referenciada na tabela &lt;Hotran - Check in&gt;&#39;
  Return
End
/* Checkin»Checkin da Partida de Vôo - Mirror: Check-in integra Check-ins da Partida (Restrict) */
If (Select Count(*) From T_CKV001_MIR dep, Deleted pri
 Where dep.CD_CHK = pri.CD_CHK) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Checkin&gt; está sendo referenciada na tabela &lt;Checkin da Partida de Vôo - Mirror&gt;&#39;
  Return
End
/* Checkin»Checkin da Partida de Vôo: Checkin integra Checkins da Partida (Restrict) */
If (Select Count(*) From T_CKV001 dep, Deleted pri
 Where dep.CD_CHK = pri.CD_CHK) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Checkin&gt; está sendo referenciada na tabela &lt;Checkin da Partida de Vôo&gt;&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o76">
<a:ObjectID>69589A8E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_CHK_TRI</a:Name>
<a:Code>T_CHK_TRI</a:Code>
<a:Text>Create Trigger T_CHK_TRI On T_CHK
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Aeroporto»Checkin: Aeroporto possui Checkins */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Checkin&gt; não está cadastrada&#39;
  Return
End
/* Companhia Aérea»Checkin: Companhia Aér. possui Checkins */
If (Select Count(*) From T_COM, Inserted
Where T_COM.CD_COM = Inserted.CD_COM)
 &lt;&gt;(Select Count(CD_COM) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Companhia Aérea&gt; que se deseja incluir na tabela &lt;Checkin&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
/* -------------------- Colocado e Comentado por Milena em 22/06/99 --------------------

/* Declaração do cursor */
DECLARE INSCHK CURSOR FOR
	SELECT 	INS.CD_CHK,
		INS.NR_CHK_ORD,
		INS.CD_AER
	FROM	INSERTED INS
	ORDER BY NR_CHK_ORD

/* Declaração das variáveis  */
DECLARE	@CD_CHK	INT,
		@NR_CHK_ORD	INT,
	 	@CD_AER	INT,
		@CD_CHK_ATU 	INT
		 
/* Abertura do cursor */
OPEN INSCHK

/* Ir para o primeiro registro */
FETCH	INSCHK
INTO	@CD_CHK,
	@NR_CHK_ORD,
	@CD_AER

/* Processar todos os registros de INSCHK */
WHILE @@FETCH_STATUS = 0
BEGIN

	IF (	SELECT 	COUNT(*) 
		FROM 	T_CHK 
		WHERE 	CD_CHK &lt;&gt; @CD_CHK  AND NR_CHK_ORD = @NR_CHK_ORD AND CD_AER = @CD_AER) &gt; 0
	BEGIN
		SELECT	@CD_CHK_ATU = CD_CHK 
		FROM 	T_CHK
		WHERE 	CD_CHK &lt;&gt; @CD_CHK AND NR_CHK_ORD = @NR_CHK_ORD AND CD_AER = @CD_AER

		UPDATE	T_CHK
		SET	NR_CHK_ORD = NR_CHK_ORD + 1
		WHERE	CD_CHK = @CD_CHK_ATU

		SELECT @NR_CHK_ORD = @NR_CHK_ORD + 1, @CD_CHK = @CD_CHK_ATU
	END
	ELSE
	BEGIN
		/* Ir para o próximo registro */
		FETCH NEXT FROM INSCHK
		INTO	@CD_CHK,
			@NR_CHK_ORD,
			@CD_AER
	END

END
CLOSE INSCHK
DEALLOCATE INSCHK

-------------------- Colocado e Comentado por Milena em 22/06/99 -------------------- */

End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o77">
<a:ObjectID>69589A8F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_CHK_TRU</a:Name>
<a:Code>T_CHK_TRU</a:Code>
<a:Text>Create Trigger T_CHK_TRU On T_CHK
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_CHK)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Checkin&gt; da tabela &lt;Checkin&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_AER)
/* Aeroporto»Checkin: Aeroporto possui Checkins */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Checkin&gt; não está cadastrada&#39;
  Return
End
If Update (CD_COM)
/* Companhia Aérea»Checkin: Companhia Aér. possui Checkins */
If (Select Count(*) From T_COM, Inserted
Where T_COM.CD_COM = Inserted.CD_COM)
 &lt;&gt;(Select Count(CD_COM) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Companhia Aérea&gt; que se deseja incluir na tabela &lt;Checkin&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
IF UPDATE(NR_CHK) OR UPDATE(NR_CHK_ORD)
BEGIN
	/* Incluir registros em T_APA */
	INSERT	T_APA (DH_APA, CD_PAR)
	Select	GETDATE(), CKV.CD_PAR
	From	T_CKV001 CKV, T_CHK CHK, INSERTED INS
	Where	CKV.CD_PAR IN (	Select 	CD_PAR
				From 	T_PAR PAR
				Where	PAR.TP_PAR_STA = 1 And
					PAR.CD_AER = (Select CD_AER From T_PSI)) And
		CHK.CD_CHK = CKV.CD_CHK And
		CHK.CD_CHK = INS.CD_CHK

	/* Incluir registros em T_AHO */
	INSERT	T_AHO (CD_HOT, DH_AHO)
	Select	DISTINCT HCK.CD_HOT, GETDATE()
	From	T_HCK HCK, T_CHK CHK, INSERTED INS
	Where	CHK.CD_CHK = HCK.CD_CHK And
		CHK.CD_CHK = INS.CD_CHK
END

/* -------------------- Colocado e Comentado por Milena em 22/06/99 --------------------

/* Declaração do cursor */
DECLARE INSCHK CURSOR FOR
	SELECT 	INS.CD_CHK,
		INS.NR_CHK_ORD,
		INS.CD_AER
	FROM	INSERTED INS
	ORDER BY NR_CHK_ORD

/* Declaração das variáveis  */
DECLARE	@CD_CHK	INT,
		@NR_CHK_ORD	INT,
	 	@CD_AER	INT,
		@CD_CHK_ATU 	INT
		 
/* Abertura do cursor */
OPEN INSCHK

/* Ir para o primeiro registro */
FETCH	INSCHK
INTO	@CD_CHK,
	@NR_CHK_ORD,
	@CD_AER

/* Processar todos os registros de INSCHK */
WHILE @@FETCH_STATUS = 0
BEGIN

	IF (	SELECT 	COUNT(*) 
		FROM 	T_CHK 
		WHERE 	CD_CHK &lt;&gt; @CD_CHK  AND NR_CHK_ORD = @NR_CHK_ORD AND CD_AER = @CD_AER) &gt; 0
	BEGIN
		SELECT	@CD_CHK_ATU = CD_CHK 
		FROM 	T_CHK
		WHERE 	CD_CHK &lt;&gt; @CD_CHK AND NR_CHK_ORD = @NR_CHK_ORD AND CD_AER = @CD_AER

		UPDATE	T_CHK
		SET	NR_CHK_ORD = NR_CHK_ORD + 1
		WHERE	CD_CHK = @CD_CHK_ATU

		SELECT @NR_CHK_ORD = @NR_CHK_ORD + 1, @CD_CHK = @CD_CHK_ATU
	END
	ELSE
	BEGIN
		/* Ir para o próximo registro */
		FETCH NEXT FROM INSCHK
		INTO	@CD_CHK,
			@NR_CHK_ORD,
			@CD_AER
	END

END
CLOSE INSCHK
DEALLOCATE INSCHK

-------------------- Colocado e Comentado por Milena em 22/06/99 -------------------- */

End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o71"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o43"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o78">
<a:ObjectID>69589A6C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_2</a:Name>
<a:Code>REFERENCE_2</a:Code>
<a:CreationDate>1081528807</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528807</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o44"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o64"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o54"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o79">
<a:ObjectID>69589A6D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528807</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528807</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o45"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o68"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o80">
<a:CenterTextOffset>(7, -450)</a:CenterTextOffset>
<a:Rect>((-739277,685319), (-717522,687154))</a:Rect>
<a:ListOfPoints>((-739277,686872),(-717522,687154))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>16711680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Id="o81">
<a:Rect>((-742329,684850), (-735549,689400))</a:Rect>
<a:LineColor>16711680</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o82">
<a:ObjectID>69589AE7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_EMB</a:Name>
<a:Code>T_EMB</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o83">
<a:ObjectID>69589B09-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_EMB</a:Name>
<a:Code>CD_EMB</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o84">
<a:ObjectID>69589B0A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_EMB</a:Name>
<a:Code>NM_EMB</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(5)</a:DataType>
<a:Length>5</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o85">
<a:ObjectID>69589B0B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DS_EMB</a:Name>
<a:Code>DS_EMB</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(20)</a:DataType>
<a:Length>20</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o86">
<a:ObjectID>69589B0C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_EMB_TEL</a:Name>
<a:Code>NR_EMB_TEL</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o87">
<a:ObjectID>69589B0D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_AER</a:Name>
<a:Code>CD_AER</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o88">
<a:ObjectID>69589B0E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o89">
<a:ObjectID>69589B13-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_EMB</a:Name>
<a:Code>Pk_T_EMB</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_EMB</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o83"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o90">
<a:ObjectID>69589B10-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_EMBAER</a:Name>
<a:Code>I_EMBAER</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o91">
<a:ObjectID>69589B11-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o84"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o92">
<a:ObjectID>69589B12-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_1&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o87"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Ref="o39"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o93">
<a:ObjectID>69589AA1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_EMB_TRD</a:Name>
<a:Code>T_EMB_TRD</a:Code>
<a:Text>Create Trigger T_EMB_TRD On T_EMB
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Sala de Embarque»Portão: Sal.Emb. possui portões Emb. (Restrict) */
If (Select Count(*) From T_POR dep, Deleted pri
 Where dep.CD_EMB = pri.CD_EMB) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Sala de Embarque&gt; está sendo referenciada na tabela &lt;Portão&gt;&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o94">
<a:ObjectID>69589AA3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_EMB_TRI</a:Name>
<a:Code>T_EMB_TRI</a:Code>
<a:Text>Create Trigger T_EMB_TRI On T_EMB
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Aeroporto»Sala de Embarque: Aeroporto possui SalasEmbarque */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Sala de Embarque&gt; não está cadastrada&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o95">
<a:ObjectID>69589AA5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_EMB_TRU</a:Name>
<a:Code>T_EMB_TRU</a:Code>
<a:Text>Create Trigger T_EMB_TRU On T_EMB
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_EMB)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código da Sala de Embarque&gt; da tabela &lt;Sala de Embarque&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_AER)
/* Aeroporto»Sala de Embarque: Aeroporto possui SalasEmbarque */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Sala de Embarque&gt; não está cadastrada&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o89"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o43"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o96">
<a:ObjectID>69589A6E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_3</a:Name>
<a:Code>REFERENCE_3</a:Code>
<a:CreationDate>1081528807</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528807</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o44"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o82"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o54"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o97">
<a:ObjectID>69589A6F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528807</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528807</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o45"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o87"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o98">
<a:CenterTextOffset>(7, 0)</a:CenterTextOffset>
<a:Rect>((-725836,687554), (-717014,716807))</a:Rect>
<a:ListOfPoints>((-725836,716807),(-717014,687554))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>16711680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Id="o99">
<a:Rect>((-729149,714533), (-722523,719079))</a:Rect>
<a:LineColor>16711680</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o100">
<a:ObjectID>69589AEB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_EST</a:Name>
<a:Code>T_EST</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o101">
<a:ObjectID>69589B14-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_EST</a:Name>
<a:Code>CD_EST</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o102">
<a:ObjectID>69589B15-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_EST</a:Name>
<a:Code>NR_EST</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(4)</a:DataType>
<a:Length>4</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o103">
<a:ObjectID>69589B16-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_AER</a:Name>
<a:Code>CD_AER</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o104">
<a:ObjectID>69589B17-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_SAL</a:Name>
<a:Code>CD_SAL</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o105">
<a:ObjectID>69589B18-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o106">
<a:ObjectID>69589A3A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_EST</a:Name>
<a:Code>Pk_T_EST</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_EST</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o101"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o107">
<a:ObjectID>69589A34-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_EST_AER</a:Name>
<a:Code>I_EST_AER</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o108">
<a:ObjectID>69589A35-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o102"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o109">
<a:ObjectID>69589A36-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_1&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o104"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o110">
<a:ObjectID>69589A38-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_2&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o103"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Ref="o39"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o111">
<a:ObjectID>69589AAA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_EST_TRD</a:Name>
<a:Code>T_EST_TRD</a:Code>
<a:Text>Create Trigger T_EST_TRD On T_EST
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Esteira»Hotran - Frequência: É Esteira da Frequência (Restrict) */
If (Select Count(*) From T_HFR dep, Deleted pri
 Where dep.CD_EST = pri.CD_EST) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Esteira&gt; está sendo referenciada na tabela &lt;Hotran - Frequência&gt;&#39;
  Return
End
/* Esteira»FIDS - IST Servidor de Informação: Esteira Associada ao IST (Restrict) */
If (Select Count(*) From T_FIDS_IST dep, Deleted pri
 Where dep.CD_EST = pri.CD_EST) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Esteira&gt; está sendo referenciada na tabela &lt;FIDS - IST Servidor de Informação&gt;&#39;
  Return
End
/* Esteira»Esteira da Chegada de Vôo - Mirror: Esteira da Chegada (Restrict) */
If (Select Count(*) From T_ESV001_MIR dep, Deleted pri
 Where dep.CD_EST = pri.CD_EST) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Esteira&gt; está sendo referenciada na tabela &lt;Esteira da Chegada de Vôo - Mirror&gt;&#39;
  Return
End
/* Esteira»Esteira da Chegada de Vôo: Esteira integra ESV (Restrict) */
If (Select Count(*) From T_ESV001 dep, Deleted pri
 Where dep.CD_EST = pri.CD_EST) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Esteira&gt; está sendo referenciada na tabela &lt;Esteira da Chegada de Vôo&gt;&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o112">
<a:ObjectID>69589AAC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_EST_TRI</a:Name>
<a:Code>T_EST_TRI</a:Code>
<a:Text>Create Trigger T_EST_TRI On T_EST
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Aeroporto»Esteira: Aeroporto possui Esteiras */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Esteira&gt; não está cadastrada&#39;
  Return
End
/* Sala de Desembarque»Esteira: Sala Desemb. possui Esteiras */
If (Select Count(*) From T_SAL, Inserted
Where T_SAL.CD_SAL = Inserted.CD_SAL)
 &lt;&gt;(Select Count(CD_SAL) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Sala de Desembarque&gt; que se deseja incluir na tabela &lt;Esteira&gt; não está cadastrada&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o113">
<a:ObjectID>69589AAE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_EST_TRU</a:Name>
<a:Code>T_EST_TRU</a:Code>
<a:Text>Create Trigger T_EST_TRU On T_EST
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_EST)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código da Esteira&gt; da tabela &lt;Esteira&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_AER)
/* Aeroporto»Esteira: Aeroporto possui Esteiras */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Esteira&gt; não está cadastrada&#39;
  Return
End
If Update (CD_SAL)
/* Sala de Desembarque»Esteira: Sala Desemb. possui Esteiras */
If (Select Count(*) From T_SAL, Inserted
Where T_SAL.CD_SAL = Inserted.CD_SAL)
 &lt;&gt;(Select Count(CD_SAL) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Sala de Desembarque&gt; que se deseja incluir na tabela &lt;Esteira&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
IF UPDATE(NR_EST) OR UPDATE(CD_SAL)
BEGIN
	/* Incluir registros em T_ACH */
	INSERT	T_ACH (DH_ACH, CD_CHG)
	Select	GETDATE(), ESV.CD_CHG
	From	T_ESV001 ESV, T_EST EST, INSERTED INS
	Where	ESV.CD_CHG IN (	Select 	CD_CHG
				From 	T_CHG CHG
				Where	CHG.TP_CHG_STA = 1 And
					CHG.CD_AER = (Select CD_AER From T_PSI)) And
		EST.CD_EST = ESV.CD_EST And
		EST.CD_EST = INS.CD_EST

	/* Incluir Registros em T_AHO */
	INSERT	T_AHO (CD_HOT, DH_AHO)
	Select	DISTINCT CD_HOT, GETDATE()
	From	T_HFR HFR, INSERTED INS
	Where	HFR.CD_EST = INS.CD_EST

	/* Incluir Registros em T_AHP */
	INSERT	T_AHP (CD_HPA, DH_AHP)
	Select	DISTINCT CD_HPA, GETDATE()
	From	T_HPA001 HPA, T_CHG CHG, T_SIT SIT, T_ESV001 ESV, T_EST EST, INSERTED INS
	Where	HPA.CD_CHG = CHG.CD_CHG AND
		SIT.CD_SIT = CHG.CD_SIT AND
		HPA.CD_AER = (Select CD_AER From T_PSI) AND
		(HPA.FL_HPA_ENT = 1 OR SIT.FL_SIT_AEN_PAT = 1) AND
		HPA.FL_HPA_SAI = 0 AND
		HPA.CD_AEN IS NOT NULL AND
		ESV.CD_CHG = HPA.CD_CHG AND 
		EST.CD_EST = ESV.CD_EST And
		EST.CD_EST = INS.CD_EST
END

End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o106"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o43"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o114">
<a:ObjectID>69589A71-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_4</a:Name>
<a:Code>REFERENCE_4</a:Code>
<a:CreationDate>1081528807</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528807</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o44"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o100"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o54"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o115">
<a:ObjectID>69589A73-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528807</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528807</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o45"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o103"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o116">
<a:CenterTextOffset>(-2691, 3900)</a:CenterTextOffset>
<a:Rect>((-738555,687595), (-718380,716962))</a:Rect>
<a:ListOfPoints>((-738555,716962),(-718380,687595))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>16711680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Id="o117">
<a:Rect>((-742064,714518), (-735360,719064))</a:Rect>
<a:LineColor>16711680</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o118">
<a:ObjectID>69589A4B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_POR</a:Name>
<a:Code>T_POR</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o119">
<a:ObjectID>69589A4E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_POR</a:Name>
<a:Code>CD_POR</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o120">
<a:ObjectID>69589A4F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_POR</a:Name>
<a:Code>NR_POR</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(4)</a:DataType>
<a:Length>4</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o121">
<a:ObjectID>69589A50-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_EMB</a:Name>
<a:Code>CD_EMB</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o122">
<a:ObjectID>69589A51-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_AER</a:Name>
<a:Code>CD_AER</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o123">
<a:ObjectID>69589A52-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o124">
<a:ObjectID>69589A5C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_POR</a:Name>
<a:Code>Pk_T_POR</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_POR</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o119"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o125">
<a:ObjectID>69589A54-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_POR_AER</a:Name>
<a:Code>I_POR_AER</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o126">
<a:ObjectID>69589A56-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o120"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o127">
<a:ObjectID>69589A58-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_1&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o122"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o128">
<a:ObjectID>69589A59-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_2&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o121"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o129">
<a:ObjectID>69589A5A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_AER</a:Name>
<a:Code>I_AER</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o130">
<a:ObjectID>69589A5B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o122"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Ref="o39"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o131">
<a:ObjectID>69589A66-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_POR_TRD</a:Name>
<a:Code>T_POR_TRD</a:Code>
<a:Text>Create Trigger T_POR_TRD On T_POR
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Portão»Hotran - Frequência: É Portão da Frequencia (Restrict) */
If (Select Count(*) From T_HFR dep, Deleted pri
 Where dep.CD_POR = pri.CD_POR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Portão&gt; está sendo referenciada na tabela &lt;Hotran - Frequência&gt;&#39;
  Return
End
/* Portão»FIDS - IST Servidor de Informação: Portão Associado ao IST (Restrict) */
If (Select Count(*) From T_FIDS_IST dep, Deleted pri
 Where dep.CD_POR = pri.CD_POR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Portão&gt; está sendo referenciada na tabela &lt;FIDS - IST Servidor de Informação&gt;&#39;
  Return
End
/* Portão»Mensagem de Partida: Portão da Mensagem de Partida (Restrict) */
If (Select Count(*) From T_MPA dep, Deleted pri
 Where dep.CD_POR = pri.CD_POR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Portão&gt; está sendo referenciada na tabela &lt;Mensagem de Partida&gt;&#39;
  Return
End
/* Portão»Mensagem de Partida - Mirror: Portão da Mensagem de Partida (Restrict) */
If (Select Count(*) From T_MPA_MIR dep, Deleted pri
 Where dep.CD_POR = pri.CD_POR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Portão&gt; está sendo referenciada na tabela &lt;Mensagem de Partida - Mirror&gt;&#39;
  Return
End
/* Portão»Partidas: Portão da Partida (Restrict) */
If (Select Count(*) From T_PAR dep, Deleted pri
 Where dep.CD_POR = pri.CD_POR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Portão&gt; está sendo referenciada na tabela &lt;Partidas&gt;&#39;
  Return
End
/* Portão»Partidas - Mirror: Portão da Partida (Restrict) */
If (Select Count(*) From T_PAR_MIR dep, Deleted pri
 Where dep.CD_POR = pri.CD_POR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Portão&gt; está sendo referenciada na tabela &lt;Partidas - Mirror&gt;&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o132">
<a:ObjectID>69589A68-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_POR_TRI</a:Name>
<a:Code>T_POR_TRI</a:Code>
<a:Text>Create Trigger T_POR_TRI On T_POR
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Aeroporto»Portão: Aeroporto possui Portões */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Portão&gt; não está cadastrada&#39;
  Return
End
/* Sala de Embarque»Portão: Sal.Emb. possui portões Emb. */
If (Select Count(*) From T_EMB, Inserted
Where T_EMB.CD_EMB = Inserted.CD_EMB)
 &lt;&gt;(Select Count(CD_EMB) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Sala de Embarque&gt; que se deseja incluir na tabela &lt;Portão&gt; não está cadastrada&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o133">
<a:ObjectID>69589A6A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_POR_TRU</a:Name>
<a:Code>T_POR_TRU</a:Code>
<a:Text>Create Trigger T_POR_TRU On T_POR
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_POR)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Portão&gt; da tabela &lt;Portão&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_AER)
/* Aeroporto»Portão: Aeroporto possui Portões */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Portão&gt; não está cadastrada&#39;
  Return
End
If Update (CD_EMB)
/* Sala de Embarque»Portão: Sal.Emb. possui portões Emb. */
If (Select Count(*) From T_EMB, Inserted
Where T_EMB.CD_EMB = Inserted.CD_EMB)
 &lt;&gt;(Select Count(CD_EMB) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Sala de Embarque&gt; que se deseja incluir na tabela &lt;Portão&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
IF UPDATE(NR_POR) OR UPDATE(CD_EMB)
BEGIN
	/* Incluir Registros em T_APA */
	INSERT	T_APA (DH_APA, CD_PAR)
	Select 	GETDATE(), CD_PAR
	From 	T_PAR PAR, INSERTED INS
	Where	PAR.TP_PAR_STA = 1 AND
		PAR.CD_AER = (Select CD_AER From T_PSI) AND
		PAR.CD_POR = INS.CD_POR

	/* Incluir Registros em T_AHO */
	INSERT	T_AHO (CD_HOT, DH_AHO)
	Select	DISTINCT CD_HOT, GETDATE()
	From	T_HFR HFR, INSERTED INS
	Where	HFR.CD_POR = INS.CD_POR

	/* Incluir Registros em T_AHP */
	INSERT	T_AHP (CD_HPA, DH_AHP)
	Select 	DISTINCT CD_HPA, GETDATE()
	From 	T_HPA001 HPA, T_CHG CHG, T_SIT SIT, T_PAR PAR, INSERTED INS
	Where	HPA.CD_CHG = CHG.CD_CHG AND
		SIT.CD_SIT = CHG.CD_SIT AND
		HPA.CD_AER = (Select CD_AER From T_PSI) AND
		(HPA.FL_HPA_ENT = 1 OR SIT.FL_SIT_AEN_PAT = 1) AND
		HPA.FL_HPA_SAI = 0 AND
		HPA.CD_AEN IS NOT NULL AND
		PAR.CD_CHG_AEN_ANT = HPA.CD_CHG AND
		PAR.CD_POR = INS.CD_POR
END

End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o124"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o43"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o134">
<a:ObjectID>69589A75-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_5</a:Name>
<a:Code>REFERENCE_5</a:Code>
<a:CreationDate>1081528807</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528807</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o44"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o118"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o54"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o135">
<a:ObjectID>69589A76-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528807</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528807</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o45"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o122"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o136">
<a:CenterTextOffset>(757, 2400)</a:CenterTextOffset>
<a:Rect>((-716802,687931), (-709051,717112))</a:Rect>
<a:ListOfPoints>((-709051,717112),(-716600,687931))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>16711680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Id="o137">
<a:Rect>((-712325,714839), (-705777,719385))</a:Rect>
<a:LineColor>16711680</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o138">
<a:ObjectID>69589A53-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_SAL</a:Name>
<a:Code>T_SAL</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o139">
<a:ObjectID>69589A5D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_SAL</a:Name>
<a:Code>CD_SAL</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o140">
<a:ObjectID>69589A5E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_SAL</a:Name>
<a:Code>NM_SAL</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(5)</a:DataType>
<a:Length>5</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o141">
<a:ObjectID>69589A5F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>DS_SAL</a:Name>
<a:Code>DS_SAL</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(20)</a:DataType>
<a:Length>20</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o142">
<a:ObjectID>69589A60-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NR_SAL_TEL</a:Name>
<a:Code>NR_SAL_TEL</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DefaultValue>/****** Object:  Default dbo.DF_VAL_001    Script Date: 7/8/2000 12:14:36 ******/
Create Default        DF_VAL_001 As
1</a:DefaultValue>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o143">
<a:ObjectID>69589A61-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_AER</a:Name>
<a:Code>CD_AER</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o144">
<a:ObjectID>69589A62-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o145">
<a:ObjectID>69589A67-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_SAL</a:Name>
<a:Code>Pk_T_SAL</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_SAL</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o139"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o146">
<a:ObjectID>69589A63-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_SAL_AER</a:Name>
<a:Code>I_SAL_AER</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Unique>1</a:Unique>
<c:IndexColumns>
<o:IndexColumn Id="o147">
<a:ObjectID>69589A64-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o140"/>
</c:Column>
</o:IndexColumn>
<o:IndexColumn Id="o148">
<a:ObjectID>69589A65-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_1&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o143"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Ref="o39"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o149">
<a:ObjectID>69589A83-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_SAL_TRD</a:Name>
<a:Code>T_SAL_TRD</a:Code>
<a:Text>Create Trigger T_SAL_TRD On T_SAL
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Sala de Desembarque»Esteira: Sala Desemb. possui Esteiras (Restrict) */
If (Select Count(*) From T_EST dep, Deleted pri
 Where dep.CD_SAL = pri.CD_SAL) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Sala de Desembarque&gt; está sendo referenciada na tabela &lt;Esteira&gt;&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o150">
<a:ObjectID>69589A85-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_SAL_TRI</a:Name>
<a:Code>T_SAL_TRI</a:Code>
<a:Text>Create Trigger T_SAL_TRI On T_SAL
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Aeroporto»Sala de Desembarque: Aeroporto possui Sal.Desemb. */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Sala de Desembarque&gt; não está cadastrada&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o151">
<a:ObjectID>69589A87-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_SAL_TRU</a:Name>
<a:Code>T_SAL_TRU</a:Code>
<a:Text>Create Trigger T_SAL_TRU On T_SAL
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_SAL)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código da Sala de Desembarque&gt; da tabela &lt;Sala de Desembarque&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_AER)
/* Aeroporto»Sala de Desembarque: Aeroporto possui Sal.Desemb. */
If (Select Count(*) From T_AER, Inserted
Where T_AER.CD_AER = Inserted.CD_AER)
 &lt;&gt;(Select Count(CD_AER) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Aeroporto&gt; que se deseja incluir na tabela &lt;Sala de Desembarque&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
IF UPDATE(NM_SAL)
BEGIN
	/* Incluir registros em T_ACH */
	INSERT	T_ACH (DH_ACH, CD_CHG)
	Select 	GETDATE(), ESV.CD_CHG
	From	T_ESV001 ESV, T_EST EST, T_SAL SAL, INSERTED INS
	Where	ESV.CD_CHG IN (	Select 	CD_CHG
				From 	T_CHG CHG
				Where	CHG.TP_CHG_STA = 1 And
					CHG.CD_AER = (Select CD_AER From T_PSI)) And
		EST.CD_EST = ESV.CD_EST And
		SAL.CD_SAL = EST.CD_SAL And
		SAL.CD_SAL = INS.CD_SAL

	/* Incluir Registros em T_AHO */
	INSERT	T_AHO (CD_HOT, DH_AHO)
	Select	DISTINCT CD_HOT, GETDATE()
	From	T_HFR HFR, T_EST EST, INSERTED INS
	Where	HFR.CD_EST = EST.CD_EST AND
		EST.CD_SAL = INS.CD_SAL

	/* Incluir Registros em T_AHP */
	INSERT	T_AHP (CD_HPA, DH_AHP)
	Select 	DISTINCT CD_HPA, GETDATE()
	From	T_HPA001 HPA, T_CHG CHG, T_SIT SIT, T_ESV001 ESV, T_EST EST, T_SAL SAL, INSERTED INS
	Where	HPA.CD_CHG = CHG.CD_CHG AND
		SIT.CD_SIT = CHG.CD_SIT AND
		HPA.CD_AER = (Select CD_AER From T_PSI) AND
		(HPA.FL_HPA_ENT = 1 OR SIT.FL_SIT_AEN_PAT = 1) AND
		HPA.FL_HPA_SAI = 0 AND
		HPA.CD_AEN IS NOT NULL AND
		ESV.CD_CHG = HPA.CD_CHG AND
		EST.CD_EST = ESV.CD_EST And
		SAL.CD_SAL = EST.CD_SAL And
		SAL.CD_SAL = INS.CD_SAL
END

End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o145"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o43"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o152">
<a:ObjectID>69589A77-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_6</a:Name>
<a:Code>REFERENCE_6</a:Code>
<a:CreationDate>1081528807</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528807</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o44"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o138"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o54"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o153">
<a:ObjectID>69589A78-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528807</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528807</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o45"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o143"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o154">
<a:CenterTextOffset>(-598, -3000)</a:CenterTextOffset>
<a:Rect>((-723498,659981), (-716374,688121))</a:Rect>
<a:ListOfPoints>((-716393,688121),(-723210,659981))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>16711680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o43"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o155">
<a:Rect>((-726368,657707), (-720052,662253))</a:Rect>
<a:LineColor>16711680</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o156">
<a:ObjectID>69589ADA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_CID</a:Name>
<a:Code>T_CID</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o157">
<a:ObjectID>69589AEC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_CID</a:Name>
<a:Code>CD_CID</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o158">
<a:ObjectID>69589AED-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_CID</a:Name>
<a:Code>NM_CID</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(30)</a:DataType>
<a:Length>30</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o159">
<a:ObjectID>69589AEE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_CID_COM</a:Name>
<a:Code>NM_CID_COM</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(10)</a:DataType>
<a:Length>10</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o160">
<a:ObjectID>69589AEF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_PAI</a:Name>
<a:Code>CD_PAI</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o161">
<a:ObjectID>69589AF0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_HOR</a:Name>
<a:Code>CD_HOR</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o162">
<a:ObjectID>69589AF1-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o163">
<a:ObjectID>69589AF2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_CID</a:Name>
<a:Code>Pk_T_CID</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_CID</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o157"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Owner>
<o:User Ref="o39"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o164">
<a:ObjectID>69589A90-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_CID_TRD</a:Name>
<a:Code>T_CID_TRD</a:Code>
<a:Text>Create Trigger T_CID_TRD On T_CID
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Cidade»Aeroporto: Cidade possui Aeroportos (Restrict) */
If (Select Count(*) From T_AER dep, Deleted pri
 Where dep.CD_CID = pri.CD_CID) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Cidade&gt; está sendo referenciada na tabela &lt;Aeroporto&gt;&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o165">
<a:ObjectID>69589A91-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_CID_TRI</a:Name>
<a:Code>T_CID_TRI</a:Code>
<a:Text>Create Trigger T_CID_TRI On T_CID
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* País»Cidade: País possui Cidades */
If (Select Count(*) From T_PAI, Inserted
Where T_PAI.CD_PAI = Inserted.CD_PAI)
 &lt;&gt;(Select Count(CD_PAI) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;País&gt; que se deseja incluir na tabela &lt;Cidade&gt; não está cadastrada&#39;
  Return
End
/* Fuso Horário»Cidade: Fuso Horário Integra Cidades */
If (Select Count(*) From T_HOR, Inserted
Where T_HOR.CD_HOR = Inserted.CD_HOR)
 &lt;&gt;(Select Count(CD_HOR) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Fuso Horário&gt; que se deseja incluir na tabela &lt;Cidade&gt; não está cadastrada&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o166">
<a:ObjectID>69589A92-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_CID_TRU</a:Name>
<a:Code>T_CID_TRU</a:Code>
<a:Text>Create Trigger T_CID_TRU On T_CID
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_CID)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código da Cidade&gt; da tabela &lt;Cidade&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_PAI)
/* País»Cidade: País possui Cidades */
If (Select Count(*) From T_PAI, Inserted
Where T_PAI.CD_PAI = Inserted.CD_PAI)
 &lt;&gt;(Select Count(CD_PAI) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;País&gt; que se deseja incluir na tabela &lt;Cidade&gt; não está cadastrada&#39;
  Return
End
If Update (CD_HOR)
/* Fuso Horário»Cidade: Fuso Horário Integra Cidades */
If (Select Count(*) From T_HOR, Inserted
Where T_HOR.CD_HOR = Inserted.CD_HOR)
 &lt;&gt;(Select Count(CD_HOR) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Fuso Horário&gt; que se deseja incluir na tabela &lt;Cidade&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
IF UPDATE(NM_CID)
BEGIN
	/* Incluir registros em T_ACH */
	INSERT	T_ACH (DH_ACH, CD_CHG)
	Select	GETDATE(), ECC.CD_CHG
	From	T_ECC001 ECC, T_AER AER, T_CID CID, INSERTED INS
	Where	ECC.CD_CHG IN (	Select 	CD_CHG
				From 	T_CHG CHG
				Where	CHG.TP_CHG_STA = 1 And
					CHG.CD_AER = (Select CD_AER From T_PSI)) AND
		AER.CD_AER = ECC.CD_AER AND
		CID.CD_CID = AER.CD_CID AND
		CID.CD_CID = INS.CD_CID

	/* Incluir registros em T_APA */
	INSERT	T_APA (DH_APA, CD_PAR)
	Select	GETDATE(), ECP.CD_PAR
	From	T_ECP001 ECP, T_AER AER, T_CID CID, INSERTED INS
	Where	ECP.CD_PAR IN (	Select 	CD_PAR
				From 	T_PAR PAR
				Where	PAR.TP_PAR_STA = 1 And
					PAR.CD_AER = (Select CD_AER From T_PSI)) AND
		AER.CD_AER = ECP.CD_AER AND
		CID.CD_CID = AER.CD_CID AND
		CID.CD_CID = INS.CD_CID

END
End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o163"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o167">
<a:ObjectID>69589A79-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_7</a:Name>
<a:Code>REFERENCE_7</a:Code>
<a:CreationDate>1081528807</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528807</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o156"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o44"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o163"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o168">
<a:ObjectID>69589A7A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528807</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528807</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o157"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o52"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o169">
<a:CenterTextOffset>(1207, 525)</a:CenterTextOffset>
<a:Rect>((-712514,659646), (-703827,670065))</a:Rect>
<a:ListOfPoints>((-712514,659646),(-706079,670065))</a:ListOfPoints>
<a:ArrowStyle>4881</a:ArrowStyle>
<a:LineColor>16711680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o63"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o170">
<a:Rect>((-709447,667998), (-702589,672544))</a:Rect>
<a:LineColor>16711680</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o171">
<a:ObjectID>69589ADF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_COM</a:Name>
<a:Code>T_COM</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o172">
<a:ObjectID>69589AF3-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_COM</a:Name>
<a:Code>CD_COM</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o173">
<a:ObjectID>69589AF4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_COM</a:Name>
<a:Code>NM_COM</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(30)</a:DataType>
<a:Length>30</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o174">
<a:ObjectID>69589AF5-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SG_COM_IAT_003</a:Name>
<a:Code>SG_COM_IAT_003</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(3)</a:DataType>
<a:Length>3</a:Length>
</o:Column>
<o:Column Id="o175">
<a:ObjectID>69589AF6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SG_COM_IAT_002</a:Name>
<a:Code>SG_COM_IAT_002</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(2)</a:DataType>
<a:Length>2</a:Length>
</o:Column>
<o:Column Id="o176">
<a:ObjectID>69589AF7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_COM_GR1</a:Name>
<a:Code>FL_COM_GR1</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o177">
<a:ObjectID>69589AF8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_COM_GR2</a:Name>
<a:Code>FL_COM_GR2</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o178">
<a:ObjectID>69589AF9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>FL_COM_TAR_RED</a:Name>
<a:Code>FL_COM_TAR_RED</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>tinyint</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o179">
<a:ObjectID>69589AFA-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_COM_MAT</a:Name>
<a:Code>CD_COM_MAT</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o180">
<a:ObjectID>69589AFC-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o181">
<a:ObjectID>69589B08-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_COM</a:Name>
<a:Code>Pk_T_COM</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_COM</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o172"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Indexes>
<o:Index Id="o182">
<a:ObjectID>69589AFE-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_COM_GR1</a:Name>
<a:Code>I_COM_GR1</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o183">
<a:ObjectID>69589AFF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o176"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o184">
<a:ObjectID>69589B01-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_COM_GR2</a:Name>
<a:Code>I_COM_GR2</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o185">
<a:ObjectID>69589B02-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o177"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o186">
<a:ObjectID>69589B04-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_COM_IAT_002</a:Name>
<a:Code>I_COM_IAT_002</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o187">
<a:ObjectID>69589B05-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o175"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
<o:Index Id="o188">
<a:ObjectID>69589B06-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>I_COM_IAT_003</a:Name>
<a:Code>I_COM_IAT_003</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:IndexColumns>
<o:IndexColumn Id="o189">
<a:ObjectID>69589B07-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:IndexColumn.Expression>&lt;Index Expression_0&gt;</a:IndexColumn.Expression>
<c:Column>
<o:Column Ref="o174"/>
</c:Column>
</o:IndexColumn>
</c:IndexColumns>
</o:Index>
</c:Indexes>
<c:Owner>
<o:User Ref="o39"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o190">
<a:ObjectID>69589A93-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_COM_TRD</a:Name>
<a:Code>T_COM_TRD</a:Code>
<a:Text>Create Trigger T_COM_TRD On T_COM
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Companhia Aérea»Chegadas: Comapanhia Aérea da Chegada (Restrict) */
If (Select Count(*) From T_CHG dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;Chegadas&gt;&#39;
  Return
End
/* Companhia Aérea»Chegadas - Mirror: Companhia Aérea da Chegada (Restrict) */
If (Select Count(*) From T_CHG_MIR dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;Chegadas - Mirror&gt;&#39;
  Return
End
/* Companhia Aérea»Partidas - Mirror: Companhia Aérea da Partida (Restrict) */
If (Select Count(*) From T_PAR_MIR dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;Partidas - Mirror&gt;&#39;
  Return
End
/* Companhia Aérea»Partidas: Companhia Aérea da Partida (Restrict) */
If (Select Count(*) From T_PAR dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;Partidas&gt;&#39;
  Return
End
/* Companhia Aérea»FIDS - IST Companhia: Companhia do ISC (Restrict) */
If (Select Count(*) From T_FIDS_ISC dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;FIDS - IST Companhia&gt;&#39;
  Return
End
/* Companhia Aérea»FIDS - Usuário do Grupo de Displays: DGT-COM:R (Restrict) */
If (Select Count(*) From T_FIDS_DGU dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;FIDS - Usuário do Grupo de Displays&gt;&#39;
  Return
End
/* Companhia Aérea»Hotran: É Companhia do Hotran (Restrict) */
If (Select Count(*) From T_HOT001 dep, Deleted pri
 Where dep.SG_COM = pri.SG_COM_IAT_003) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;Hotran&gt;&#39;
  Return
End
/* Companhia Aérea»Companhia Aérea: É Matriz de (Restrict) */
If (Select Count(*) From T_COM dep, Deleted pri
 Where dep.CD_COM_MAT = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;Companhia Aérea&gt;&#39;
  Return
End
/* Companhia Aérea»Informante da Situação de Vôo: possui (Restrict) */
If (Select Count(*) From T_IFT dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;Informante da Situação de Vôo&gt;&#39;
  Return
End
/* Companhia Aérea»Tarifas Pagas no Bilhete: Se Relaciona (Restrict) */
If (Select Count(*) From T_TFB001 dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;Tarifas Pagas no Bilhete&gt;&#39;
  Return
End
/* Companhia Aérea»Tarifas Pagas no Bilhete - Mirror: Se relaciona (Restrict) */
If (Select Count(*) From T_TFB001_MIR dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Companhia Aérea&gt; está sendo referenciada na tabela &lt;Tarifas Pagas no Bilhete - Mirror&gt;&#39;
  Return
End
/* Companhia Aérea»Boxes da Companhia Aérea: Boxes da Companhia Aérea (Cascade) */
Delete T_BCO From T_BCO dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM
/* Companhia Aérea»Aeronave: Companh Aérea possui Aeronaves (Cascade) */
Delete T_AEN From T_AEN dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM
/* Companhia Aérea»Checkin: Companhia Aér. possui Checkins (Cascade) */
Delete T_CHK From T_CHK dep, Deleted pri
 Where dep.CD_COM = pri.CD_COM
End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o191">
<a:ObjectID>69589A94-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_COM_TRI</a:Name>
<a:Code>T_COM_TRI</a:Code>
<a:Text>Create Trigger T_COM_TRI On T_COM
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Companhia Aérea»Companhia Aérea: É Matriz de */
If (Select Count(*) From T_COM, Inserted
Where T_COM.CD_COM = Inserted.CD_COM_MAT)
 &lt;&gt;(Select Count(CD_COM_MAT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Companhia Aérea&gt; que se deseja incluir na tabela &lt;Companhia Aérea&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
/* Verificar se há alguma situação que não seja do Grupo 1 nem do Grupo 2 */
IF (	SELECT	COUNT(*)
	FROM	INSERTED INS,
		T_COM COM
	WHERE	COM.CD_COM = INS.CD_COM AND
		INS.FL_COM_GR1 = 0 AND 
		INS.FL_COM_GR2 = 0) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Uma Companhia Aérea deve pertencer a pelo menos um Grupo .&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Verificar se quando a companhia for do Grupo 1, existe sigla IATA-3 */
IF (	SELECT	COUNT(*)
	FROM	INSERTED INS,
		T_COM COM
	WHERE	COM.CD_COM = INS.CD_COM AND
		INS.FL_COM_GR1 = 1 AND 
		INS.SG_COM_IAT_003 = &#39;&#39;) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Uma Companhia Aérea do Grupo 1 deve possuir sigla IATA-3.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Verificar se quando a companhia for do Grupo 1, existe sigla IATA-2 */
IF (	SELECT	COUNT(*)
	FROM	INSERTED INS,
		T_COM COM
	WHERE	COM.CD_COM = INS.CD_COM AND
		INS.FL_COM_GR1 = 1 AND 
		INS.SG_COM_IAT_002 = &#39;&#39;) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Uma Companhia Aérea do Grupo 1 deve possuir sigla IATA-2.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Verificar se já existe alguma companhia cadastrada com a sigla IATA-3 da companhia que se está incluindo */
IF (	SELECT	COUNT(*)
	FROM	T_COM COM, 
		INSERTED INS
	WHERE	COM.CD_COM &lt;&gt; INS.CD_COM AND
		COM.SG_COM_IAT_003 = INS.SG_COM_IAT_003 AND
		INS.SG_COM_IAT_003 &lt;&gt; &#39;&#39;) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Já existe uma Companhia Áerea cadastrada com esta sigla IATA-3.&#39;
	ROLLBACK TRANSACTION
	RETURN
END


/* Verificar se já existe alguma companhia cadastrada com a sigla IATA-2 da companhia que se está incluindo */
IF (	SELECT	COUNT(*)
	FROM	T_COM COM, 
		INSERTED INS
	WHERE	COM.CD_COM &lt;&gt; INS.CD_COM AND
		COM.SG_COM_IAT_002 = INS.SG_COM_IAT_002 AND
		INS.SG_COM_IAT_002 &lt;&gt; &#39;&#39;) &gt; 0
BEGIN 
	RAISERROR 20310 &#39;Operação não executada: Já existe uma Companhia Áerea cadastrada com esta sigla IATA-2.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o192">
<a:ObjectID>69589A95-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_COM_TRU</a:Name>
<a:Code>T_COM_TRU</a:Code>
<a:Text>Create Trigger T_COM_TRU On T_COM
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_COM)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código da Companhia Aérea&gt; da tabela &lt;Companhia Aérea&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_COM_MAT)
/* Companhia Aérea»Companhia Aérea: É Matriz de */
If (Select Count(*) From T_COM, Inserted
Where T_COM.CD_COM = Inserted.CD_COM_MAT)
 &lt;&gt;(Select Count(CD_COM_MAT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Companhia Aérea&gt; que se deseja incluir na tabela &lt;Companhia Aérea&gt; não está cadastrada&#39;
  Return
End
/* Regra de negócio */
/* Verificar se há alguma Companhia que não seja do Grupo 1 nem do Grupo 2 */
IF (	SELECT	COUNT(*)
	FROM	INSERTED
	WHERE	FL_COM_GR1 = 0 AND FL_COM_GR2 = 0) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Uma Companhia Aérea deve pertencer a pelo menos um Grupo.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Verificar se quando a companhia for do Grupo 1, existe sigla IATA-3 */
IF (	SELECT	COUNT(*)
	FROM	INSERTED INS,
		T_COM COM
	WHERE	COM.CD_COM = INS.CD_COM AND
		INS.FL_COM_GR1 = 1 AND 
		INS.SG_COM_IAT_003 = &#39;&#39;) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Uma Companhia Aérea do Grupo 1 deve possuir sigla IATA-3.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Verificar se quando a companhia for do Grupo 1, existe sigla IATA-2 */
IF (	SELECT	COUNT(*)
	FROM	INSERTED INS,
		T_COM COM
	WHERE	COM.CD_COM = INS.CD_COM AND
		INS.FL_COM_GR1 = 1 AND 
		INS.SG_COM_IAT_002 = &#39;&#39;) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Uma Companhia Aérea do Grupo 1 deve possuir sigla IATA-2.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Não permitir que o campo SG_COM_IAT_003 seja alterado se existir alguma referência a esta sigla na tabela T_HOT001 */
IF UPDATE(SG_COM_IAT_003)
BEGIN
	IF (	SELECT	COUNT(*)
		FROM	DELETED DEL, T_HOT001 HOT
		WHERE	HOT.SG_COM = DEL.SG_COM_IAT_003) &gt; 0
	BEGIN 
		RAISERROR 20310 &#39;Operação não executada: A sigla IATA-3 dessa Companhia Aérea não pode ser alterada pois está sendo referenciada em pelo menos um Hotran.&#39;
		ROLLBACK TRANSACTION
		RETURN
	END
END

/* Verificar se já existe alguma companhia cadastrada com a sigla IATA-3 da companhia que se está alterando */
IF (	SELECT	COUNT(*)
	FROM	T_COM COM, 
		INSERTED INS
	WHERE	COM.CD_COM &lt;&gt; INS.CD_COM AND
		COM.SG_COM_IAT_003 = INS.SG_COM_IAT_003 AND
		INS.SG_COM_IAT_003 &lt;&gt; &#39;&#39;) &gt; 0
BEGIN
	RAISERROR 20310 &#39;Operação não executada: Já existe uma Companhia Áerea cadastrada com esta sigla IATA-3.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

/* Verificar se já existe alguma companhia cadastrada com a sigla IATA-2 da companhia que se está alterando */
IF (	SELECT	COUNT(*)
	FROM	T_COM COM, 
		INSERTED INS
	WHERE	COM.CD_COM &lt;&gt; INS.CD_COM AND
		COM.SG_COM_IAT_002 = INS.SG_COM_IAT_002 AND
		INS.SG_COM_IAT_002 &lt;&gt; &#39;&#39;) &gt; 0
BEGIN 
	RAISERROR 20310 &#39;Operação não executada: Já existe uma Companhia Áerea cadastrada com esta sigla IATA-2.&#39;
	ROLLBACK TRANSACTION
	RETURN
END

IF UPDATE(SG_COM_IAT_003)
BEGIN
	/* Incluir Registros em T_ACH */
	INSERT	T_ACH (DH_ACH, CD_CHG)
	Select 	GETDATE(), CD_CHG
	From 	T_CHG CHG, INSERTED INS
	Where	CHG.TP_CHG_STA = 1 AND
		CHG.CD_AER = (Select CD_AER From T_PSI) AND
		CHG.CD_COM = INS.CD_COM

	/* Incluir Registros em T_APA */
	INSERT	T_APA (DH_APA, CD_PAR)
	Select 	GETDATE(), CD_PAR
	From 	T_PAR PAR, INSERTED INS
	Where	PAR.TP_PAR_STA = 1 AND
		PAR.CD_AER = (Select CD_AER From T_PSI) AND
		PAR.CD_COM = INS.CD_COM

	/* Incluir Registros em T_AHP - Chegadas */
	INSERT	T_AHP (CD_HPA, DH_AHP)
	Select 	DISTINCT CD_HPA, GETDATE()
	From 	T_HPA001 HPA, T_CHG CHG, T_SIT SIT, INSERTED INS
	Where	HPA.CD_CHG = CHG.CD_CHG AND
		SIT.CD_SIT = CHG.CD_SIT AND
		HPA.CD_AER = (Select CD_AER From T_PSI) AND
		(HPA.FL_HPA_ENT = 1 OR SIT.FL_SIT_AEN_PAT = 1) AND
		HPA.FL_HPA_SAI = 0 AND
		HPA.CD_AEN IS NOT NULL AND
		CHG.CD_COM = INS.CD_COM

	/* Incluir Registros em T_AHP - Partidas */
	INSERT	T_AHP (CD_HPA, DH_AHP)
	Select 	DISTINCT CD_HPA, GETDATE()
	From 	T_HPA001 HPA, T_CHG CHG, T_SIT SIT, T_PAR PAR, INSERTED INS
	Where	HPA.CD_CHG = CHG.CD_CHG AND
		SIT.CD_SIT = CHG.CD_SIT AND
		HPA.CD_AER = (Select CD_AER From T_PSI) AND
		(HPA.FL_HPA_ENT = 1 OR SIT.FL_SIT_AEN_PAT = 1) AND
		HPA.FL_HPA_SAI = 0 AND
		HPA.CD_AEN IS NOT NULL AND
		PAR.CD_CHG_AEN_ANT = HPA.CD_CHG AND
		PAR.CD_COM = INS.CD_COM

END
End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o181"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o193">
<a:ObjectID>69589A7B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_8</a:Name>
<a:Code>REFERENCE_8</a:Code>
<a:CreationDate>1081528807</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528807</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o171"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o64"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o181"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o194">
<a:ObjectID>69589A7C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528807</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528807</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o172"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o69"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o195">
<a:CenterTextOffset>(2, 0)</a:CenterTextOffset>
<a:Rect>((-709964,670460), (-701790,689458))</a:Rect>
<a:ListOfPoints>((-705960,689458),(-705804,670460))</a:ListOfPoints>
<a:ArrowStyle>4881</a:ArrowStyle>
<a:LineColor>16711680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Id="o196">
<a:Rect>((-709097,686993), (-702857,691539))</a:Rect>
<a:LineColor>16711680</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o197">
<a:ObjectID>69589A33-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_IFT</a:Name>
<a:Code>T_IFT</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o198">
<a:ObjectID>69589A42-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_IFT</a:Name>
<a:Code>CD_IFT</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o199">
<a:ObjectID>69589A43-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_COM</a:Name>
<a:Code>CD_COM</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
</o:Column>
<o:Column Id="o200">
<a:ObjectID>69589A44-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TT_IFT</a:Name>
<a:Code>TT_IFT</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>varchar(255)</a:DataType>
<a:Length>255</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o201">
<a:ObjectID>69589A46-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o202">
<a:ObjectID>69589A47-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_IFT</a:Name>
<a:Code>Pk_T_IFT</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_IFT</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o198"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Owner>
<o:User Ref="o39"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o203">
<a:ObjectID>69589A37-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_IFT_TRD</a:Name>
<a:Code>T_IFT_TRD</a:Code>
<a:Text>Create Trigger T_IFT_TRD On T_IFT
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Informante da Situação de Vôo»Chamadas de Anuncio: Informante da Chamada (Restrict) */
If (Select Count(*) From T_CHA dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Chamadas de Anuncio&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Chamadas de Anuncio - Mirror: Informante da Chamada (Restrict) */
If (Select Count(*) From T_CHA_MIR dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Chamadas de Anuncio - Mirror&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Mensagem de Chegada - Mirror: Informante da Mensagem de Chegada (Restrict) */
If (Select Count(*) From T_MCH_MIR dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Mensagem de Chegada - Mirror&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Mensagem de Chegada: Informante da Mensagem de Chegada (Restrict) */
If (Select Count(*) From T_MCH dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Mensagem de Chegada&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Mensagem de Partida - Mirror: Informante da Mensagem de Partida (Restrict) */
If (Select Count(*) From T_MPA_MIR dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Mensagem de Partida - Mirror&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Mensagem de Partida: Informante da Mensagem de Partida (Restrict) */
If (Select Count(*) From T_MPA dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Mensagem de Partida&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Chegadas - Mirror: Informante da Situação de Chegada (Restrict) */
If (Select Count(*) From T_CHG_MIR dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Chegadas - Mirror&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Chegadas: Informante da Situação de Chegada (Restrict) */
If (Select Count(*) From T_CHG dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Chegadas&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Partidas - Mirror: Informante da Situação de Partida (Restrict) */
If (Select Count(*) From T_PAR_MIR dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Partidas - Mirror&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Partidas: Informante da Situação de Partida (Restrict) */
If (Select Count(*) From T_PAR dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Partidas&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Histórico de Situação de Vôo de Chegada - Mirror: Informante do HSC (Restrict) */
If (Select Count(*) From T_HSC_MIR dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Histórico de Situação de Vôo de Chegada - Mirror&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Histórico de Situação de Vôo de Chegada: Informante do HSC (Restrict) */
If (Select Count(*) From T_HSC dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Histórico de Situação de Vôo de Chegada&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Histórico de Situação de Vôo de Partida - Mirror: Informante do HSP (Restrict) */
If (Select Count(*) From T_HSP_MIR dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Histórico de Situação de Vôo de Partida - Mirror&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Histórico de Situação de Vôo de Partida: Informante do HSP (Restrict) */
If (Select Count(*) From T_HSP dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Informante da Situação de Vôo&gt; está sendo referenciada na tabela &lt;Histórico de Situação de Vôo de Partida&gt;&#39;
  Return
End
/* Informante da Situação de Vôo»Log da Programação de Anúncios: C:IFT-PRALOG (Cascade) */
Delete T_PRALOG From T_PRALOG dep, Deleted pri
 Where dep.CD_IFT = pri.CD_IFT
End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o204">
<a:ObjectID>69589A39-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_IFT_TRI</a:Name>
<a:Code>T_IFT_TRI</a:Code>
<a:Text>Create Trigger T_IFT_TRI On T_IFT
For Insert As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Companhia Aérea»Informante da Situação de Vôo: possui */
If (Select Count(*) From T_COM, Inserted
Where T_COM.CD_COM = Inserted.CD_COM)
 &lt;&gt;(Select Count(CD_COM) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Companhia Aérea&gt; que se deseja incluir na tabela &lt;Informante da Situação de Vôo&gt; não está cadastrada&#39;
  Return
End
/* Pessoas»Informante da Situação de Vôo: Pessoa do Informante */
If (Select Count(*) From T_PES, Inserted
Where T_PES.CD_PES = Inserted.CD_IFT)
 &lt;&gt;(Select Count(CD_IFT) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Pessoas&gt; que se deseja incluir na tabela &lt;Informante da Situação de Vôo&gt; não está cadastrada&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>I</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o205">
<a:ObjectID>69589A3B-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_IFT_TRU</a:Name>
<a:Code>T_IFT_TRU</a:Code>
<a:Text>Create Trigger T_IFT_TRU On T_IFT
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_IFT)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Informante da Situação de Vôo&gt; da tabela &lt;Informante da Situação de Vôo&gt; não pode ser alterada.&#39;
  Return
End
If Update (CD_COM)
/* Companhia Aérea»Informante da Situação de Vôo: possui */
If (Select Count(*) From T_COM, Inserted
Where T_COM.CD_COM = Inserted.CD_COM)
 &lt;&gt;(Select Count(CD_COM) From Inserted)
Begin
  RollBack Transaction
  RaisError 20001 &#39;Operação não executada: A informação &lt;Companhia Aérea&gt; que se deseja incluir na tabela &lt;Informante da Situação de Vôo&gt; não está cadastrada&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o202"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o170"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o206">
<a:ObjectID>69589A7D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_9</a:Name>
<a:Code>REFERENCE_9</a:Code>
<a:CreationDate>1081528807</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528807</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o171"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o197"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o181"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o207">
<a:ObjectID>69589A7E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528807</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528807</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o172"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o199"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o208">
<a:CenterTextOffset>(7, 0)</a:CenterTextOffset>
<a:Rect>((-742484,687461), (-734460,716982))</a:Rect>
<a:ListOfPoints>((-738502,716982),(-738460,687461))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>16711680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o117"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o81"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o209">
<a:ObjectID>69589A7F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_10</a:Name>
<a:Code>REFERENCE_10</a:Code>
<a:CreationDate>1081528807</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528807</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o82"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o118"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o89"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o210">
<a:ObjectID>69589A80-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528807</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528807</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o83"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o121"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o211">
<a:CenterTextOffset>(2, -2100)</a:CenterTextOffset>
<a:Rect>((-739077,657025), (-723136,659095))</a:Rect>
<a:ListOfPoints>((-723136,659095),(-739077,659010))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>16711680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o155"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o212">
<a:Rect>((-742428,656950), (-735724,661068))</a:Rect>
<a:LineColor>16711680</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o213">
<a:ObjectID>69589B0F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HOR</a:Name>
<a:Code>T_HOR</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o214">
<a:ObjectID>69589A3C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_HOR</a:Name>
<a:Code>CD_HOR</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o215">
<a:ObjectID>69589A3D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_HOR</a:Name>
<a:Code>NM_HOR</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(30)</a:DataType>
<a:Length>30</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o216">
<a:ObjectID>69589A3E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>HR_HOR_NRM</a:Name>
<a:Code>HR_HOR_NRM</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o217">
<a:ObjectID>69589A3F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>HR_HOR_VER</a:Name>
<a:Code>HR_HOR_VER</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o218">
<a:ObjectID>69589A40-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o219">
<a:ObjectID>69589A41-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_HOR</a:Name>
<a:Code>Pk_T_HOR</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_HOR</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o214"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Owner>
<o:User Ref="o39"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o220">
<a:ObjectID>69589AFB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HOR_TRD</a:Name>
<a:Code>T_HOR_TRD</a:Code>
<a:Text>Create Trigger T_HOR_TRD On T_HOR
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* Fuso Horário»Cidade: Fuso Horário Integra Cidades (Restrict) */
If (Select Count(*) From T_CID dep, Deleted pri
 Where dep.CD_HOR = pri.CD_HOR) &gt; 0
Begin
  RollBack Transaction
  RaisError 20003 &#39;Operação não executada: A informação que se deseja excluir da tabela &lt;Fuso Horário&gt; está sendo referenciada na tabela &lt;Cidade&gt;&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o221">
<a:ObjectID>69589AFD-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_HOR_TRU</a:Name>
<a:Code>T_HOR_TRU</a:Code>
<a:Text>Create Trigger T_HOR_TRU On T_HOR
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_HOR)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do Fuso Horário&gt; da tabela &lt;Fuso Horário&gt; não pode ser alterada.&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o219"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o222">
<a:ObjectID>69589A81-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_11</a:Name>
<a:Code>REFERENCE_11</a:Code>
<a:CreationDate>1081528807</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528807</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o213"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o156"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o219"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o223">
<a:ObjectID>69589A82-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528807</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528807</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o214"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o161"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o224">
<a:CenterTextOffset>(-1343, 3750)</a:CenterTextOffset>
<a:Rect>((-736743,661557), (-726287,675106))</a:Rect>
<a:ListOfPoints>((-726287,661557),(-736743,675106))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>16711680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o155"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Id="o225">
<a:Rect>((-741892,672655), (-735576,676255))</a:Rect>
<a:LineColor>16711680</a:LineColor>
<a:FillColor>16777215</a:FillColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N
TableColumns 0 arial,8,N
TablePkColumns 0 arial,8,N
TableKeys 0 arial,8,N
TableIndexs 0 arial,8,N
TableTriggers 0 arial,8,N</a:FontList>
<c:Object>
<o:Table Id="o226">
<a:ObjectID>69589A45-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_PAI</a:Name>
<a:Code>T_PAI</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Columns>
<o:Column Id="o227">
<a:ObjectID>69589A48-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>CD_PAI</a:Name>
<a:Code>CD_PAI</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:ServerCheckExpression>/****** Object:  Rule dbo.RU_VL1    Script Date: 7/8/2000 12:14:36 ******/
Create Rule        RU_VL1 As
@valor &gt; 0 and %MINMAX% and %LISTVAL% and %RULES%</a:ServerCheckExpression>
<a:DataType>int</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o228">
<a:ObjectID>69589A49-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>NM_PAI</a:Name>
<a:Code>NM_PAI</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(30)</a:DataType>
<a:Length>30</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o229">
<a:ObjectID>69589A4A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SG_PAI</a:Name>
<a:Code>SG_PAI</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>char(3)</a:DataType>
<a:Length>3</a:Length>
<a:Mandatory>1</a:Mandatory>
</o:Column>
<o:Column Id="o230">
<a:ObjectID>69589A4C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>TIMESTAMP</a:Name>
<a:Code>TIMESTAMP</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:DataType>timestamp</a:DataType>
<a:Mandatory>1</a:Mandatory>
</o:Column>
</c:Columns>
<c:Keys>
<o:Key Id="o231">
<a:ObjectID>69589A4D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Pk_T_PAI</a:Name>
<a:Code>Pk_T_PAI</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:PhysicalOptions>
clustered</a:PhysicalOptions>
<a:ConstraintName>Pk_T_PAI</a:ConstraintName>
<c:Key.Columns>
<o:Column Ref="o227"/>
</c:Key.Columns>
</o:Key>
</c:Keys>
<c:Owner>
<o:User Ref="o39"/>
</c:Owner>
<c:Triggers>
<o:Trigger Id="o232">
<a:ObjectID>69589A55-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_PAI_TRD</a:Name>
<a:Code>T_PAI_TRD</a:Code>
<a:Text>Create Trigger T_PAI_TRD On T_PAI
For Delete As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
/* País»Cidade: País possui Cidades (Cascade) */
Delete T_CID From T_CID dep, Deleted pri
 Where dep.CD_PAI = pri.CD_PAI
End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>D</a:Trigger.Type>
</o:Trigger>
<o:Trigger Id="o233">
<a:ObjectID>69589A57-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>T_PAI_TRU</a:Name>
<a:Code>T_PAI_TRU</a:Code>
<a:Text>Create Trigger T_PAI_TRU On T_PAI
For Update As
Begin
IF @@ROWCOUNT = 0 RETURN
SET NOCOUNT ON
If Update (CD_PAI)
Begin
  RollBack Transaction
  RaisError 20002 &#39;Operação não executada: A informação &lt;Código do País&gt; da tabela &lt;País&gt; não pode ser alterada.&#39;
  Return
End
End
go</a:Text>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Trigger.Type>U</a:Trigger.Type>
</o:Trigger>
</c:Triggers>
<c:PrimaryKey>
<o:Key Ref="o231"/>
</c:PrimaryKey>
</o:Table>
</c:Object>
</o:TableSymbol>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o234">
<a:ObjectID>69589A84-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_12</a:Name>
<a:Code>REFERENCE_12</a:Code>
<a:CreationDate>1081528807</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528807</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o226"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o156"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o231"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o235">
<a:ObjectID>69589A86-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528807</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528807</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o227"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o160"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o236">
<a:CenterTextOffset>(7, 0)</a:CenterTextOffset>
<a:Rect>((-725629,715953), (-708844,717413))</a:Rect>
<a:ListOfPoints>((-725629,716995),(-708844,717413))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>16711680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o99"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o137"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o237">
<a:ObjectID>69589A88-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_13</a:Name>
<a:Code>REFERENCE_13</a:Code>
<a:CreationDate>1081528807</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528807</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o138"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o100"/>
</c:Object2>
<c:ParentKey>
<o:Key Ref="o145"/>
</c:ParentKey>
<c:Joins>
<o:ReferenceJoin Id="o238">
<a:ObjectID>69589A89-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081528807</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528807</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o139"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o104"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:ReferenceSymbol Id="o239">
<a:CenterTextOffset>(-1500, 1950)</a:CenterTextOffset>
<a:Rect>((-705862,669850), (-693485,674487))</a:Rect>
<a:ListOfPoints>((-705862,670048),(-697160,669850),(-697160,671950),(-698960,671950),(-704660,671950))</a:ListOfPoints>
<a:ArrowStyle>4882</a:ArrowStyle>
<a:LineColor>16711680</a:LineColor>
<a:ShadowColor>12632256</a:ShadowColor>
<a:FontList>DISPNAME 0 arial,8,N</a:FontList>
<c:SourceSymbol>
<o:TableSymbol Ref="o170"/>
</c:SourceSymbol>
<c:DestinationSymbol>
<o:TableSymbol Ref="o170"/>
</c:DestinationSymbol>
<c:Object>
<o:Reference Id="o240">
<a:ObjectID>69589B00-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Reference_14</a:Name>
<a:Code>REFERENCE_14</a:Code>
<a:CreationDate>1081606436</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081606928</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Cardinality>0..*</a:Cardinality>
<a:UpdateConstraint>1</a:UpdateConstraint>
<a:DeleteConstraint>1</a:DeleteConstraint>
<c:Object1>
<o:Table Ref="o171"/>
</c:Object1>
<c:Object2>
<o:Table Ref="o171"/>
</c:Object2>
<c:Joins>
<o:ReferenceJoin Id="o241">
<a:ObjectID>69589B03-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:CreationDate>1081606525</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081606928</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<c:Object1>
<o:Column Ref="o172"/>
</c:Object1>
<c:Object2>
<o:Column Ref="o179"/>
</c:Object2>
</o:ReferenceJoin>
</c:Joins>
</o:Reference>
</c:Object>
</o:ReferenceSymbol>
<o:TableSymbol Ref="o43"/>
<o:TableSymbol Ref="o6"/>
<o:TableSymbol Ref="o63"/>
<o:TableSymbol Ref="o155"/>
<o:TableSymbol Ref="o170"/>
<o:TableSymbol Ref="o81"/>
<o:TableSymbol Ref="o99"/>
<o:TableSymbol Ref="o212"/>
<o:TableSymbol Ref="o196"/>
<o:TableSymbol Ref="o225"/>
<o:TableSymbol Ref="o117"/>
<o:TableSymbol Ref="o137"/>
</c:Symbols>
</o:PhysicalDiagram>
</c:PhysicalDiagrams>
<c:DefaultDiagram>
<o:PhysicalDiagram Ref="o4"/>
</c:DefaultDiagram>
<c:Users>
<o:User Ref="o39"/>
</c:Users>
<c:Procedures>
<o:Procedure Id="o242">
<a:ObjectID>69589A9C-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_BCL_DEL</a:Name>
<a:Code>SP_BCL_DEL</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_BCL_DEL    Script Date: 7/8/2000 12:15:32 ******/
Create Procedure SP_BCL_DEL
(@CD_BCP	INT, @CD_BCP_LIM	INT) As
/* Deletar todos os BCL  que sejam limitantes de CD_BCP de mesmo BOX e tipo e com valor menor que o deletado */
DELETE BCL
FROM	T_BCL BCL,
	T_BCP BCP,
	T_BCP BCPLIM
WHERE	BCL.CD_BCP = @CD_BCP AND
	BCL.CD_BCP_LIM = BCPLIM.CD_BCP AND
	BCP.CD_BCP = @CD_BCP_LIM AND
	BCPLIM.CD_BOX = BCP.CD_BOX AND
	BCPLIM.TP_BCP = BCP.TP_BCP AND
	BCPLIM.VL_BCP &lt; BCP.VL_BCP

/* Deletar todos os BCL  que sejam limitantes de CD_BCP_LIM de mesmo BOX e tipo e com valor menor que o deletado */
DELETE BCL
FROM	T_BCL BCL,
	T_BCP BCP,
	T_BCP BCPLIM
WHERE	BCL.CD_BCP = @CD_BCP_LIM AND
	BCL.CD_BCP_LIM = BCPLIM.CD_BCP AND
	BCP.CD_BCP = @CD_BCP AND
	BCPLIM.CD_BOX = BCP.CD_BOX AND
	BCPLIM.TP_BCP = BCP.TP_BCP AND
	BCPLIM.VL_BCP &lt; BCP.VL_BCP
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o39"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o243">
<a:ObjectID>69589A9D-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_BCL_INS</a:Name>
<a:Code>SP_BCL_INS</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_BCL_INS    Script Date: 7/8/2000 12:15:32 ******/
Create Procedure SP_BCL_INS
(@CD_BCP	INT, @CD_BCP_LIM	INT) As
/* Verificar se há BCLs cujos boxes de BCP e BCP_LIM sejam iguais */
IF	(SELECT COUNT(*) FROM T_BCP BCP, T_BCP BCPLIM
	WHERE	BCP.CD_BCP = @CD_BCP AND
		BCPLIM.CD_BCP = @CD_BCP_LIM AND
		BCP.CD_BOX = BCPLIM.CD_BOX) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: Um box não pode ser referenciado como limitante do próprio box&#39;
	RETURN
END

/* Inserir como limitante de CD_BCP todos os CD_BCP do mesmo tipo e de valor maior ao inserido */
INSERT INTO T_BCL(CD_BCP, CD_BCP_LIM)
SELECT 	@CD_BCP, BCPLIM.CD_BCP
FROM	T_BCP BCP,
	T_BCP BCPLIM
WHERE	BCP.CD_BCP = @CD_BCP_LIM AND
	BCPLIM.CD_BOX = BCP.CD_BOX AND
	BCPLIM.TP_BCP = BCP.TP_BCP AND
	BCPLIM.VL_BCP &gt; BCP.VL_BCP


/* Inserir como limitante de CD_BCP_LIM todos os CD_BCP do mesmo tipo e de valor maior ao inserido */
INSERT INTO T_BCL(CD_BCP, CD_BCP_LIM)
SELECT 	@CD_BCP_LIM, BCPLIM.CD_BCP
FROM	T_BCP BCP,
	T_BCP BCPLIM
WHERE	BCP.CD_BCP = @CD_BCP AND
	BCPLIM.CD_BOX = BCP.CD_BOX AND
	BCPLIM.TP_BCP = BCP.TP_BCP AND
	BCPLIM.VL_BCP &gt; BCP.VL_BCP
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o39"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o244">
<a:ObjectID>69589A9E-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_CriaStatus</a:Name>
<a:Code>SP_CriaStatus</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_CriaStatus    Script Date: 7/8/2000 12:15:31 ******/
Create Procedure SP_CriaStatus As
/* Verificar se existe algum registro em T_STA */
IF EXISTS (SELECT * FROM T_STA)
BEGIN
	RAISERROR 30000 &#39;OPERAÇÃO NÃO EXECUTADA: HÁ REGISTROS NA TABELA DE STATUS&#39;
	RETURN
END

/* CRIAR CURSOR COM OS DADOS PARA GERAÇÃO DOS STATUS */
/* Declaração do cursor */
/* Criar um cursor com dados do primeiro e do último registro de cada HPA cuja entrada 
   esteja concluída */
DECLARE CRIAR_STATUS CURSOR FOR
	SELECT	HPA1.CD_HPA,
		HPA1.DH_HPA_ENT,
		MA_STA_ABE = DATEADD(SS, -DATEPART(SS, HPA1.DH_HPA_ENT) - 60*DATEPART(MI, HPA1.DH_HPA_ENT) - 60*60*DATEPART(HH, HPA1.DH_HPA_ENT) - 24*60*60*DATEPART(DD, HPA1.DH_HPA_ENT) + 24*60*60, HPA1.DH_HPA_ENT),
		HPA2.DH_HPA_SAI,
		MA_STA_FEC = DATEADD(SS, -DATEPART(SS, HPA2.DH_HPA_SAI) - 60*DATEPART(MI, HPA2.DH_HPA_SAI) - 60*60*DATEPART(HH, HPA2.DH_HPA_SAI) - 24*60*60*DATEPART(DD, HPA2.DH_HPA_SAI) + 24*60*60, HPA2.DH_HPA_SAI),
		TP_STA = CONVERT(INT, HPA2.FL_HPA_SAI) + 1
	FROM	T_HPA001 HPA1,
		T_HPA001 HPA2
	WHERE	HPA2.CD_HPA = HPA1.CD_HPA AND
		HPA2.NR_HPA_SEQ = (SELECT MAX(NR_HPA_SEQ) FROM T_HPA001 HPA3 WHERE HPA3.CD_HPA = HPA1.CD_HPA) AND
		HPA1.NR_HPA_SEQ = 1 AND
		HPA1.FL_HPA_ENT = 1
	ORDER BY HPA1.DH_HPA_ENT


/* Declaração de variáveis */
DECLARE	@CD_HPA 	INT,
	@DH_STA_ABE	SMALLDATETIME,
	@MA_STA_ABE	SMALLDATETIME,
	@DH_STA_FEC	SMALLDATETIME,
	@MA_STA_FEC	SMALLDATETIME,
	@TP_STA		INT,
	@CD_STA		INT,
	@NR_STA		INT

/* Abrir cursor */
OPEN CRIAR_STATUS

/* Ir para o primeiro registro */
FETCH	CRIAR_STATUS
INTO	@CD_HPA,
	@DH_STA_ABE,
	@MA_STA_ABE,
	@DH_STA_FEC,
	@MA_STA_FEC,
	@TP_STA

/* Processar todos os registros de CRIAR_STATUS */
WHILE @@FETCH_STATUS = 0
BEGIN

	/* Anular @DH_STA_FEC e @MA_STA_FEC caso @TP_STA = 1 */
	IF @TP_STA = 1 	SELECT  @DH_STA_FEC = NULL, @MA_STA_FEC = NULL

	/* Identificar o próximo número de STATUS disponível */
	SELECT @CD_STA = (SELECT ISNULL(MAX(CD_STA),0) + 1 FROM T_STA)

	/* Incluir um novo status */
	INSERT	INTO T_STA (
		CD_STA,
		DH_STA_ABE,

		MA_STA_ABE,
		NR_STA,
		DH_STA_FEC,
		MA_STA_FEC,
		TP_STA)
	SELECT	@CD_STA,
		@DH_STA_ABE,
		@MA_STA_ABE,
		(SELECT ISNULL(MAX(NR_STA), 0) + 1 FROM T_STA WHERE MA_STA_ABE = @MA_STA_ABE),
		@DH_STA_FEC,
		@MA_STA_FEC,
		@TP_STA

	/* Atualizar HPA */
	UPDATE	T_HPA001
	SET	CD_STA = @CD_STA
	WHERE	CD_HPA = @CD_HPA

	/* Ir para o próximo registro */
	FETCH	NEXT FROM CRIAR_STATUS
	INTO	@CD_HPA,
		@DH_STA_ABE,
		@MA_STA_ABE,
		@DH_STA_FEC,
		@MA_STA_FEC,
		@TP_STA

END
CLOSE CRIAR_STATUS
DEALLOCATE CRIAR_STATUS
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o39"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o245">
<a:ObjectID>69589A9F-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_DIA</a:Name>
<a:Code>SP_DIA</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_DIA    Script Date: 7/8/2000 12:15:32 ******/
Create Procedure SP_DIA
(@DS_FRQ_IN CHAR(30), @DS_FRQ_OUT CHAR(30) OUTPUT, @DS_DIA CHAR(03) OUTPUT) As
DECLARE @NR_POS INTEGER

SELECT @DS_DIA = &#39;&#39;
SELECT @DS_FRQ_OUT = &#39;&#39;
SELECT @NR_POS = CHARINDEX(&#39;,&#39;, @DS_FRQ_IN)
IF (@NR_POS &gt; 0)
BEGIN
	SELECT @DS_DIA = SUBSTRING(@DS_FRQ_IN, 1, @NR_POS)
	SELECT @DS_FRQ_OUT = SUBSTRING(@DS_FRQ_IN, @NR_POS + 1, 30 - (@NR_POS + 1))
END
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o39"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o246">
<a:ObjectID>69589AA0-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_ExcTabPrincipal</a:Name>
<a:Code>SP_ExcTabPrincipal</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_ExcTabPrincipal    Script Date: 7/8/2000 12:15:32 ******/
Create Procedure SP_ExcTabPrincipal
(@pTipo INT) As
/* Objetivo:  Excluir das tabelas principais registros associados ao vôo de Chegada selecionado : 
T_CHG, T_CHA, T_HSC, T_DEC, T_ECC001, T_ESV001, T_CHGANT, T_STA, T_HPA001 */
   
/* Chegada com partida associada */
If @pTipo = 1
BEGIN
	/* &#39;Exclui vôos Codeshare ou Duplicate Leg vinculados ao vôo de Partida associado ao vôo de Chegada selecionado */
	Delete T_HSP Where CD_PAR IN (SELECT CD_PAR FROM T_MIR_LOG_PAR_001)
	IF @@ERROR &gt; 0 RETURN
       
         	/* Exclui vôos Codeshare ou Duplicate Leg vinculados ao vôo de Partida associado ao vôo de Chegada selecionado */
	Delete T_PAR Where CD_PAR IN (SELECT CD_PAR FROM T_MIR_LOG_PAR_001)
	IF @@ERROR &gt; 0 RETURN

	/* Exclui movimentação de situação dos vôos de Partida associadoS ao vôo de Chegada selecionado */
	Delete T_HSP Where CD_PAR IN (SELECT CD_PAR FROM T_MIR_LOG_PAR)
	IF @@ERROR &gt; 0 RETURN

	/* Exclui vôos de Partida associadoS ao vôo de Chegada selecionado */
	Delete T_PAR Where CD_PAR IN (SELECT CD_PAR FROM T_MIR_LOG_PAR)
	IF @@ERROR &gt; 0 RETURN
     
	/* Exclui histórico de situação dos vôos Codeshare ou Duplicate Leg vinculados ao vôo de Chegada selecionado */
	Delete T_HSC Where CD_CHG IN (SELECT CD_CHG FROM T_MIR_LOG_CHG_001)
	IF @@ERROR &gt; 0 RETURN

	/* Exclui vôos Codeshare ou Duplicate Leg vinculados ao vôo de Chegada selecionado */
	Delete T_CHG Where CD_CHG IN (SELECT CD_CHG FROM T_MIR_LOG_CHG_001)
	IF @@ERROR &gt; 0 RETURN

	/* Exclui movimentação de situação do vôo de Chegada selecionado */
	Delete T_HSC Where CD_CHG IN (SELECT CD_CHG FROM T_MIR_LOG_CHG)
	IF @@ERROR &gt; 0 RETURN

	/* Exclui vôo de Chegada selecionado */
	Delete T_CHG Where CD_CHG IN (SELECT CD_CHG FROM T_MIR_LOG_CHG)
	IF @@ERROR &gt; 0 RETURN
END
ELSE
BEGIN
	/* &#39;Vôos de Chegada Cancelados 2*/
	IF @pTipo = 2

	BEGIN
		/* Exclui movimentação de situação do vôo de Chegada selecionado */
		Delete T_HSC Where CD_CHG IN (SELECT CD_CHG FROM T_MIR_LOG_CHG_001)
		IF @@ERROR &gt; 0 RETURN

		/* Exclui vôo de Chegada selecionado */
		Delete T_CHG Where CD_CHG IN (SELECT CD_CHG FROM T_MIR_LOG_CHG_001)
		IF @@ERROR &gt; 0 RETURN
	END
	/* Vôos de Partida Cancelados 3*/
	ELSE
	BEGIN
		/* Exclui movimentação de situação do vôo de Partida selecionado */
		Delete T_HSP Where CD_PAR IN (SELECT CD_PAR FROM T_MIR_LOG_PAR_001)
		IF @@ERROR &gt; 0 RETURN

		/* Exclui vôo de Partida selecionado */
		Delete T_PAR Where CD_PAR IN (SELECT CD_PAR FROM T_MIR_LOG_PAR_001)
		IF @@ERROR &gt; 0 RETURN
	END
END
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o39"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o247">
<a:ObjectID>69589AA2-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_IncTabEspRelCHG</a:Name>
<a:Code>SP_IncTabEspRelCHG</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_IncTabEspRelCHG    Script Date: 7/8/2000 12:15:32 ******/
Create Procedure SP_IncTabEspRelCHG As
Insert Into T_CHG_MIR (
	CD_CHG
	, DT_CHG
	, CD_AER
	, NR_CHG_VOO
	, NR_CHG_HOT
	, TP_CHG_GRU
	, TP_CHG
	, TP_CHG_NAT
	, TP_CHG_CTG
	, CD_COM
	, CD_CHG_VIN
	, FL_CHG_TEL
	, CD_EQP_CHG
	, CD_AEN_CHG
	, CD_BOX
	, QT_CHG_PER_MIN
	, DH_CHG_NRM
	, DH_CHG_EFE
	, DH_CHG_EST
	, CD_SIT
	, NM_CHG_COM_SIT
	, DH_CHG_SIT

	, FL_CHG_CAN
	, TP_CHG_STA
	, CD_IFT
	, CD_USR
	, FL_CHG_PAR_ORI)
Select	CHG.CD_CHG
	, DT_CHG
	, CD_AER
	, NR_CHG_VOO
	, NR_CHG_HOT
	, TP_CHG_GRU
	, TP_CHG
	, TP_CHG_NAT
	, TP_CHG_CTG
	, CD_COM
	, CD_CHG_VIN
	, FL_CHG_TEL
	, CD_EQP_CHG
	, CD_AEN_CHG
	, CD_BOX
	, QT_CHG_PER_MIN
	, DH_CHG_NRM
	, DH_CHG_EFE
	, DH_CHG_EST
	, CD_SIT
	, NM_CHG_COM_SIT
	, DH_CHG_SIT
	, FL_CHG_CAN
	, TP_CHG_STA
	, CD_IFT
	, CD_USR
	, FL_CHG_PAR_ORI
From	T_CHG CHG, T_MIR_LOG_CHG CHGTMP
Where	CHG.CD_CHG = CHGTMP.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_CHA, associados ao vôo de Chegada selecionado, para a tabela T_CHA espelho */
Insert Into T_CHA_MIR (
	CD_CHA
	, CD_CHG
	, CD_PAR

	, CD_IFT
	, DH_CHA
	, CD_MSG
	, CD_USR)
Select	CD_CHA
	, CHA.CD_CHG
	, CD_PAR
	, CD_IFT
	, DH_CHA
	, CD_MSG
	, CD_USR
From	T_CHA CHA, T_MIR_LOG_CHG CHG
Where	CHA.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_HSC, associados ao vôo de Chegada selecionado, para a tabela T_HSC espelho */
Insert Into T_HSC_MIR (
	DH_HSC
	, CD_CHG
	, CD_IFT

	, CD_SIT
	, DH_HSC_CHG
	, CD_USR
	, NM_HSC_USR)
Select	DH_HSC
	, HSC.CD_CHG
	, CD_IFT
	, CD_SIT
	, DH_HSC_CHG

	, CD_USR
	, NM_HSC_USR
From	T_HSC HSC, T_MIR_LOG_CHG CHG
Where	HSC.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_DEC, associados ao vôo de Chegada selecionado, para a tabela T_DEC espelho */
Insert Into T_DEC_MIR (
	CD_CHG
	, QT_DEC_DES_DOM
	, QT_DEC_DES_INT
	, QT_DEC_DES_BAG_DOM
	, QT_DEC_DES_BAG_INT
	, QT_DEC_DES_CAR_DOM
	, QT_DEC_DES_CAR_INT
	, QT_DEC_DES_COR_DOM
	, QT_DEC_DES_COR_INT
	, QT_DEC_TRA_BAG_DOM
	, QT_DEC_TRA_BAG_INT
	, QT_DEC_TRA_CAR_DOM
	, QT_DEC_TRA_CAR_INT
	, QT_DEC_TRA_COR_DOM
	, QT_DEC_TRA_COR_INT)
Select	DEC.CD_CHG
	, QT_DEC_DES_DOM
	, QT_DEC_DES_INT
	, QT_DEC_DES_BAG_DOM
	, QT_DEC_DES_BAG_INT

	, QT_DEC_DES_CAR_DOM
	, QT_DEC_DES_CAR_INT
	, QT_DEC_DES_COR_DOM
	, QT_DEC_DES_COR_INT
	, QT_DEC_TRA_BAG_DOM
	, QT_DEC_TRA_BAG_INT
	, QT_DEC_TRA_CAR_DOM
	, QT_DEC_TRA_CAR_INT
	, QT_DEC_TRA_COR_DOM
	, QT_DEC_TRA_COR_INT
From	T_DEC DEC, T_MIR_LOG_CHG CHG
Where	DEC.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
  
/* Transfere dados da tabela T_ECC001, associados ao vôo de Chegada selecionado, para a tabela T_ECC001 espelho */
Insert Into T_ECC001_MIR (
	CD_CHG
	, CD_ECC
	, CD_AER)
Select	ECC.CD_CHG
	, CD_ECC
	, CD_AER
From	T_ECC001 ECC, T_MIR_LOG_CHG CHG
Where	ECC.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_ESV001, associados ao vôo de Chegada selecionado, para a tabela T_ESV001 espelho */
Insert Into T_ESV001_MIR (
	CD_CHG
	, CD_EST)
Select	ESV.CD_CHG
	, CD_EST
From	T_ESV001 ESV, T_MIR_LOG_CHG CHG
Where	ESV.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_CHGANT, associados ao vôo de Chegada selecionado, para a tabela T_CHGANT espelho */
Insert Into T_CHGANT_MIR (CD_CHG)
Select	CHGANT.CD_CHG
From	T_CHGANT CHGANT, T_MIR_LOG_CHG CHG
Where	CHGANT.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_STA, associados ao vôo de Chegada selecionado, para a tabela T_STA espelho */
Insert Into T_STA_MIR (
	CD_STA
	, DH_STA_ABE
	, MA_STA_ABE
	, NR_STA
	, DH_STA_FEC
	, MA_STA_FEC
	, CD_STA_ANT
	, TP_STA
	, FL_STA_AEN_ISE
	, FL_STA_COM_TAR_RED
	, QT_STA_PSI_ISE
	, QT_STA_PSI_TAR_RED)
Select	CD_STA
	, DH_STA_ABE
	, MA_STA_ABE
	, NR_STA
	, DH_STA_FEC
	, MA_STA_FEC
	, CD_STA_ANT
	, TP_STA
	, FL_STA_AEN_ISE
	, FL_STA_COM_TAR_RED
	, QT_STA_PSI_ISE
	, QT_STA_PSI_TAR_RED
From	T_STA
Where	CD_STA In (  Select CD_STA
	             From  T_HPA001 HPA, T_MIR_LOG_CHG CHG
	             Where HPA.CD_CHG = CHG.CD_CHG)
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_HPA001 associados ao vôo de Chegada selecionado, para a tabela T_HPA001 espelho */
Insert Into T_HPA001_MIR (
	CD_HPA

	, NR_HPA_SEQ
	, CD_AER
	, CD_EQP
	, CD_AEN
	, CD_BOX
	, CD_CHG
	, DH_HPA_ENT
	, CD_PAR
	, DH_HPA_SAI
	, FL_HPA_ENT
	, FL_HPA_SAI
	, FL_HPA_TOK
	, CD_STA)
Select	CD_HPA
	, NR_HPA_SEQ
	, CD_AER
	, CD_EQP

	, CD_AEN
	, CD_BOX
	, HPA.CD_CHG
	, DH_HPA_ENT
	, CD_PAR
	, DH_HPA_SAI
	, FL_HPA_ENT
	, FL_HPA_SAI
	, FL_HPA_TOK
	, CD_STA
From	T_HPA001 HPA, T_MIR_LOG_CHG CHG
Where	HPA.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_PRALOG, associados ao vôo de Chegada selecionado, para a tabela T_PRALOG espelho */
Insert Into T_PRALOG_MIR (
	CD_PRA
	, CD_CHG
	, CD_PAR
	, QT_LOG_POR)
Select  	CD_PRA
	, LOG.CD_CHG
	, CD_PAR
	, QT_LOG_POR
From	T_PRALOG LOG, T_MIR_LOG_CHG CHG
Where	LOG.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_MCH, associados ao vôo de Chegada selecionado, para a tabela T_MCH espelho */
Insert Into T_MCH_MIR (
	CD_MCH
	, CD_CHG
	, CD_USR
	, DH_MCH
	, DH_MCH_EFE
	, CD_SIT
	, NM_MCH_COM_SIT
	, CD_TPA
	, CD_IFT
	, DS_MCH_EST
	, DS_MCH_EST_001
	, NR_MCH_AEN
	, TT_MCH_OBS
	, TP_MCH
	, FL_MCH_TEL)
Select	CD_MCH
	, MCH.CD_CHG
	, CD_USR
	, DH_MCH
	, DH_MCH_EFE
	, CD_SIT
	, NM_MCH_COM_SIT
	, CD_TPA
	, CD_IFT
	, DS_MCH_EST
	, DS_MCH_EST_001
	, NR_MCH_AEN
	, TT_MCH_OBS
	, TP_MCH
	, FL_MCH_TEL
From	T_MCH MCH, T_MIR_LOG_CHG CHG
Where	MCH.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o39"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o248">
<a:ObjectID>69589AA4-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_IncTabEspRelCHG001</a:Name>
<a:Code>SP_IncTabEspRelCHG001</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_IncTabEspRelCHG001    Script Date: 7/8/2000 12:15:33 ******/
Create Procedure SP_IncTabEspRelCHG001 As
Insert Into T_CHG_MIR (
	CD_CHG
	, DT_CHG
	, CD_AER
	, NR_CHG_VOO
	, NR_CHG_HOT
	, TP_CHG_GRU
	, TP_CHG
	, TP_CHG_NAT
	, TP_CHG_CTG
	, CD_COM
	, CD_CHG_VIN
	, FL_CHG_TEL
	, CD_EQP_CHG
	, CD_AEN_CHG

	, CD_BOX
	, QT_CHG_PER_MIN
	, DH_CHG_NRM
	, DH_CHG_EFE
	, DH_CHG_EST
	, CD_SIT
	, NM_CHG_COM_SIT
	, DH_CHG_SIT

	, FL_CHG_CAN
	, TP_CHG_STA
	, CD_IFT
	, CD_USR
	, FL_CHG_PAR_ORI)
Select	CHG.CD_CHG
	, DT_CHG
	, CD_AER
	, NR_CHG_VOO
	, NR_CHG_HOT
	, TP_CHG_GRU
	, TP_CHG
	, TP_CHG_NAT
	, TP_CHG_CTG
	, CD_COM
	, CD_CHG_VIN
	, FL_CHG_TEL
	, CD_EQP_CHG
	, CD_AEN_CHG
	, CD_BOX
	, QT_CHG_PER_MIN
	, DH_CHG_NRM
	, DH_CHG_EFE
	, DH_CHG_EST
	, CD_SIT
	, NM_CHG_COM_SIT
	, DH_CHG_SIT
	, FL_CHG_CAN
	, TP_CHG_STA
	, CD_IFT
	, CD_USR
	, FL_CHG_PAR_ORI
From	T_CHG CHG, T_MIR_LOG_CHG_001 CHGTMP
Where	CHG.CD_CHG = CHGTMP.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_CHA, associados ao vôo de Chegada selecionado, para a tabela T_CHA espelho */
Insert Into T_CHA_MIR (
	CD_CHA
	, CD_CHG
	, CD_PAR

	, CD_IFT
	, DH_CHA
	, CD_MSG
	, CD_USR)
Select	CD_CHA
	, CHA.CD_CHG
	, CD_PAR
	, CD_IFT
	, DH_CHA
	, CD_MSG
	, CD_USR
From	T_CHA CHA, T_MIR_LOG_CHG_001 CHG
Where	CHA.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_HSC, associados ao vôo de Chegada selecionado, para a tabela T_HSC espelho */
Insert Into T_HSC_MIR (
	DH_HSC
	, CD_CHG
	, CD_IFT

	, CD_SIT
	, DH_HSC_CHG
	, CD_USR
	, NM_HSC_USR)
Select	DH_HSC
	, HSC.CD_CHG
	, CD_IFT
	, CD_SIT
	, DH_HSC_CHG

	, CD_USR
	, NM_HSC_USR
From	T_HSC HSC, T_MIR_LOG_CHG_001 CHG
Where	HSC.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_DEC, associados ao vôo de Chegada selecionado, para a tabela T_DEC espelho */
Insert Into T_DEC_MIR (
	CD_CHG
	, QT_DEC_DES_DOM
	, QT_DEC_DES_INT
	, QT_DEC_DES_BAG_DOM
	, QT_DEC_DES_BAG_INT
	, QT_DEC_DES_CAR_DOM
	, QT_DEC_DES_CAR_INT
	, QT_DEC_DES_COR_DOM
	, QT_DEC_DES_COR_INT
	, QT_DEC_TRA_BAG_DOM
	, QT_DEC_TRA_BAG_INT
	, QT_DEC_TRA_CAR_DOM
	, QT_DEC_TRA_CAR_INT
	, QT_DEC_TRA_COR_DOM
	, QT_DEC_TRA_COR_INT)
Select	DEC.CD_CHG
	, QT_DEC_DES_DOM
	, QT_DEC_DES_INT
	, QT_DEC_DES_BAG_DOM
	, QT_DEC_DES_BAG_INT
	, QT_DEC_DES_CAR_DOM
	, QT_DEC_DES_CAR_INT
	, QT_DEC_DES_COR_DOM
	, QT_DEC_DES_COR_INT
	, QT_DEC_TRA_BAG_DOM
	, QT_DEC_TRA_BAG_INT
	, QT_DEC_TRA_CAR_DOM
	, QT_DEC_TRA_CAR_INT
	, QT_DEC_TRA_COR_DOM
	, QT_DEC_TRA_COR_INT
From	T_DEC DEC, T_MIR_LOG_CHG_001 CHG
Where	DEC.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_ECC001, associados ao vôo de Chegada selecionado, para a tabela T_ECC001 espelho 	*/
Insert Into T_ECC001_MIR (
	CD_CHG
	, CD_ECC
	, CD_AER)
Select	ECC.CD_CHG
	, CD_ECC
	, CD_AER
From	T_ECC001 ECC, T_MIR_LOG_CHG_001 CHG
Where	ECC.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_ESV001, associados ao vôo de Chegada selecionado, para a tabela T_ESV001 espelho */
Insert Into T_ESV001_MIR (
	CD_CHG
	, CD_EST)
Select	ESV.CD_CHG
	, CD_EST
From	T_ESV001 ESV, T_MIR_LOG_CHG_001 CHG
Where	ESV.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_CHGANT, associados ao vôo de Chegada selecionado, para a tabela T_CHGANT espelho */
Insert Into T_CHGANT_MIR (CD_CHG)
Select	CHGANT.CD_CHG
From	T_CHGANT CHGANT, T_MIR_LOG_CHG_001 CHG
Where	CHGANT.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_STA, associados ao vôo de Chegada selecionado, para a tabela T_STA espelho */
Insert Into T_STA_MIR (
	CD_STA
	, DH_STA_ABE
	, MA_STA_ABE
	, NR_STA
	, DH_STA_FEC
	, MA_STA_FEC
	, CD_STA_ANT
	, TP_STA
	, FL_STA_AEN_ISE
	, FL_STA_COM_TAR_RED
	, QT_STA_PSI_ISE
	, QT_STA_PSI_TAR_RED)
Select	CD_STA
	, DH_STA_ABE
	,MA_STA_ABE
	, NR_STA
	, DH_STA_FEC
	, MA_STA_FEC
	, CD_STA_ANT
	, TP_STA
	, FL_STA_AEN_ISE
	, FL_STA_COM_TAR_RED
	, QT_STA_PSI_ISE
	, QT_STA_PSI_TAR_RED
From	T_STA
Where	CD_STA In (  Select CD_STA
	             From  T_HPA001 HPA, T_MIR_LOG_CHG_001 CHG
	             Where HPA.CD_CHG = CHG.CD_CHG)
IF @@ERROR &gt; 0 RETURN
  
/* Transfere dados da tabela T_HPA001 associados ao vôo de Chegada selecionado, para a tabela T_HPA001 espelho */
Insert Into T_HPA001_MIR (
	CD_HPA

	, NR_HPA_SEQ
	, CD_AER
	, CD_EQP
	, CD_AEN
	, CD_BOX
	, CD_CHG
	, DH_HPA_ENT
	, CD_PAR
	, DH_HPA_SAI
	, FL_HPA_ENT
	, FL_HPA_SAI
	, FL_HPA_TOK
	, CD_STA)
Select	CD_HPA
	, NR_HPA_SEQ
	, CD_AER
	, CD_EQP

	, CD_AEN
	, CD_BOX
	, HPA.CD_CHG
	, DH_HPA_ENT
	, CD_PAR
	, DH_HPA_SAI
	, FL_HPA_ENT
	, FL_HPA_SAI
	, FL_HPA_TOK
	, CD_STA
From	T_HPA001 HPA, T_MIR_LOG_CHG_001 CHG
Where	HPA.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_PRALOG, associados ao vôo de Chegada selecionado, para a tabela T_PRALOG espelho */
Insert Into T_PRALOG_MIR (
	CD_PRA
	, CD_CHG
	, CD_PAR
	, QT_LOG_POR)
Select  CD_PRA
	, LOG.CD_CHG

	, CD_PAR
	, QT_LOG_POR
From	T_PRALOG LOG, T_MIR_LOG_CHG_001 CHG
Where	LOG.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_MCH, associados ao vôo de Chegada selecionado, para a tabela T_MCH espelho */

Insert Into T_MCH_MIR (
	CD_MCH
	, CD_CHG
	, CD_USR
	, DH_MCH
	, DH_MCH_EFE
	, CD_SIT
	, NM_MCH_COM_SIT
	, CD_TPA
	, CD_IFT
	, DS_MCH_EST
	, DS_MCH_EST_001
	, NR_MCH_AEN
	, TT_MCH_OBS
	, TP_MCH
	, FL_MCH_TEL)
Select	CD_MCH
	, MCH.CD_CHG
	, CD_USR
	, DH_MCH
	, DH_MCH_EFE
	, CD_SIT
	, NM_MCH_COM_SIT
	, CD_TPA
	, CD_IFT
	, DS_MCH_EST
	, DS_MCH_EST_001
	, NR_MCH_AEN
	, TT_MCH_OBS
	, TP_MCH
	, FL_MCH_TEL
From	T_MCH MCH, T_MIR_LOG_CHG_001 CHG
Where	MCH.CD_CHG = CHG.CD_CHG
IF @@ERROR &gt; 0 RETURN
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o39"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o249">
<a:ObjectID>69589AA6-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_IncTabEspRelPAR</a:Name>
<a:Code>SP_IncTabEspRelPAR</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_IncTabEspRelPAR    Script Date: 7/8/2000 12:15:33 ******/
Create Procedure SP_IncTabEspRelPAR As
/* Objetivo: Incluir registros associados ao vôo de Partida selecionado nas tabelas espelho relacionadas: 
T_PAR, T_CHA, T_CKV001, T_DEP, T_ECP001, T_HSP, T_TFB001, T_PRALOG, T_MPA */   
   
/* Transfere dados da tabela T_PAR, associados ao vôo de Partida selecionado, para a tabela T_PAR espelho */
Insert Into T_PAR_MIR (
	CD_PAR
	, DT_PAR
	, CD_AER
	, NR_PAR_VOO
	, NR_PAR_HOT
	, TP_PAR_GRU
	, TP_PAR
	, TP_PAR_NAT
	, TP_PAR_CTG
	, CD_COM
	, CD_CHG_ANT
	, CD_CHG_AEN_ANT
	, CD_PAR_VIN
	, FL_PAR_TEL
	, DH_PAR_NRM
	, DH_PAR_EFE
	, DH_PAR_EST
	, CD_SIT
	, NM_PAR_COM_SIT
	, DH_PAR_SIT
	, CD_POR
	, FL_PAR_CAN
	, TP_PAR_STA
	, CD_IFT
	, CD_USR)
 Select 	PAR.CD_PAR
	, DT_PAR
	, CD_AER
	, NR_PAR_VOO
	, NR_PAR_HOT
	, TP_PAR_GRU
	, TP_PAR
	, TP_PAR_NAT
	, TP_PAR_CTG
	, CD_COM
	, CD_CHG_ANT
	, CD_CHG_AEN_ANT
	, CD_PAR_VIN
	, FL_PAR_TEL
	, DH_PAR_NRM
	, DH_PAR_EFE
	, DH_PAR_EST
	, CD_SIT
	, NM_PAR_COM_SIT
	, DH_PAR_SIT
	, CD_POR
	, FL_PAR_CAN
	, TP_PAR_STA
	, CD_IFT
	, CD_USR
From	T_PAR PAR, T_MIR_LOG_PAR PARLOG
Where	PAR.CD_PAR = PARLOG.CD_PAR
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_CHA, associados ao vôo de Partida selecionado, para a tabela T_CHA espelho */
Insert Into T_CHA_MIR (
	CD_CHA
	, CD_CHG
	, CD_PAR
	, CD_IFT
	, DH_CHA
	, CD_MSG
	, CD_USR)
Select	CD_CHA
	, CD_CHG
	, CHA.CD_PAR
	, CD_IFT
	, DH_CHA
	, CD_MSG
	, CD_USR
From	T_CHA CHA, T_MIR_LOG_PAR PAR
Where	CHA.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_CKV001, associados ao vôo de Partida selecionado, para a tabela T_CKV001 espelho */
Insert Into T_CKV001_MIR (
	CD_PAR
	, CD_CHK
	, CD_CLS)
Select	CKV.CD_PAR
	, CD_CHK
	, CD_CLS
From	T_CKV001 CKV, T_MIR_LOG_PAR PAR
Where	CKV.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_DEP, associados ao vôo de Partida selecionado, para a tabela T_DEP espelho */
Insert Into T_DEP_MIR (
	CD_PAR

	, CD_AER
	, QT_DEP_TFB_DOM
	, QT_DEP_TFB_INT
	, QT_DEP_TFC_DOM
	, QT_DEP_TFC_INT
	, QT_DEP_ISE_COL
	, QT_DEP_ISE_TRA
	, QT_DEP_ISE_CON_DOM
	, QT_DEP_ISE_CON_INT
	, QT_DEP_ISE_OUT
	, QT_DEP_EMB_BAG_DOM
	, QT_DEP_EMB_BAG_INT

	, QT_DEP_EMB_CAR_DOM
	, QT_DEP_EMB_CAR_INT

	, QT_DEP_EMB_COR_DOM
	, QT_DEP_EMB_COR_INT)
Select	DEP.CD_PAR
	, CD_AER
	, QT_DEP_TFB_DOM
	, QT_DEP_TFB_INT
	, QT_DEP_TFC_DOM
	, QT_DEP_TFC_INT
	, QT_DEP_ISE_COL
	, QT_DEP_ISE_TRA
	, QT_DEP_ISE_CON_DOM
	, QT_DEP_ISE_CON_INT
	, QT_DEP_ISE_OUT
	, QT_DEP_EMB_BAG_DOM
	, QT_DEP_EMB_BAG_INT
	, QT_DEP_EMB_CAR_DOM
	, QT_DEP_EMB_CAR_INT
	, QT_DEP_EMB_COR_DOM
	, QT_DEP_EMB_COR_INT
From	T_DEP DEP, T_MIR_LOG_PAR PAR
Where	DEP.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_ECP001, associados ao vôo de Partida selecionado, para a tabela T_ECP001 espelho */
Insert Into T_ECP001_MIR (
	CD_PAR
	, CD_ECP
	, CD_AER)
Select	ECP.CD_PAR
	, CD_ECP
	, CD_AER
From	T_ECP001 ECP, T_MIR_LOG_PAR PAR
Where	ECP.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_TFB001, associados ao vôo de Partida selecionado, para a tabela T_TFB001 espelho */
Insert Into T_TFB001_MIR (
	CD_TFB
	, CD_COM
	, CD_HTE
	, QT_TFB
	, CD_PAR)
Select	 CD_TFB
	, CD_COM
	, CD_HTE
	, QT_TFB
	, TFB.CD_PAR
From	T_TFB001 TFB, T_MIR_LOG_PAR PAR
Where	TFB.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_HSP, associados ao vôo de Partida selecionado, para a tabela T_HSP espelho */
Insert Into T_HSP_MIR (
	DH_HSP
	, CD_PAR
	, CD_IFT
	, CD_SIT
	, DH_HSP_PAR
	, CD_USR
	, NM_HSP_USR)
Select	DH_HSP
	, HSP.CD_PAR
	, CD_IFT
	, CD_SIT
	, DH_HSP_PAR
	, CD_USR
	, NM_HSP_USR
From	T_HSP HSP, T_MIR_LOG_PAR PAR
Where	HSP.CD_PAR = PAR.CD_PAR

IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_PRALOG, associados ao vôo de Partida selecionado, para a tabela T_PRALOG espelho */
Insert Into T_PRALOG_MIR (CD_PRA
	, CD_CHG
	, CD_PAR
	, QT_LOG_POR)
Select	CD_PRA
	, CD_CHG
	, LOG.CD_PAR
	, QT_LOG_POR
From	T_PRALOG LOG, T_MIR_LOG_PAR PAR
Where	LOG.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_MPA, associados ao vôo de Partida selecionado, para a tabela T_MPA espelho */
Insert Into T_MPA_MIR (
	CD_MPA
	, CD_PAR
	, CD_USR
	, DH_MPA
	, DH_MPA_EFE
	, CD_SIT
	, NM_MPA_COM_SIT
	, CD_TPA
	, CD_IFT
	, CD_POR
	, DS_MPA_CHK
	, DS_MPA_CHK_001
	, TT_MPA_OBS
	, TP_MPA
	, FL_MPA_TEL)
Select	CD_MPA
	, MPA.CD_PAR
	, CD_USR
	, DH_MPA
	, DH_MPA_EFE
	, CD_SIT
	, NM_MPA_COM_SIT
	, CD_TPA

	, CD_IFT
	, CD_POR
	, DS_MPA_CHK
	, DS_MPA_CHK_001
	, TT_MPA_OBS
	, TP_MPA
	, FL_MPA_TEL
From	T_MPA MPA, T_MIR_LOG_PAR PAR
Where	MPA.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o39"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o250">
<a:ObjectID>69589AA7-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_IncTabEspRelPAR001</a:Name>
<a:Code>SP_IncTabEspRelPAR001</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_IncTabEspRelPAR001    Script Date: 7/8/2000 12:15:33 ******/
Create Procedure SP_IncTabEspRelPAR001 As
/* Objetivo: Incluir registros associados ao vôo de Partida selecionado nas tabelas espelho relacionadas:
T_PAR. T_CHA, T_CKV001, T_DEP, T_ECP001, T_HSP, T_TFB001, T_PRALOG, T_MPA */   
   
/* Transfere dados da tabela T_PAR, associados ao vôo de Partida selecionado, para a tabela T_PAR espelho */
Insert Into T_PAR_MIR (
	CD_PAR
	, DT_PAR
	, CD_AER
	, NR_PAR_VOO
	, NR_PAR_HOT
	, TP_PAR_GRU
	, TP_PAR
	, TP_PAR_NAT
	, TP_PAR_CTG
	, CD_COM
	, CD_CHG_ANT
	, CD_CHG_AEN_ANT
	, CD_PAR_VIN
	, FL_PAR_TEL
	, DH_PAR_NRM
	, DH_PAR_EFE
	, DH_PAR_EST
	, CD_SIT
	, NM_PAR_COM_SIT
	, DH_PAR_SIT
	, CD_POR
	, FL_PAR_CAN
	, TP_PAR_STA
	, CD_IFT
	, CD_USR)
 Select 	PAR.CD_PAR
	, DT_PAR
	, CD_AER
	, NR_PAR_VOO
	, NR_PAR_HOT
	, TP_PAR_GRU
	, TP_PAR
	, TP_PAR_NAT
	, TP_PAR_CTG
	, CD_COM
	, CD_CHG_ANT
	, CD_CHG_AEN_ANT
	, CD_PAR_VIN
	, FL_PAR_TEL
	, DH_PAR_NRM
	, DH_PAR_EFE
	, DH_PAR_EST
	, CD_SIT
	, NM_PAR_COM_SIT
	, DH_PAR_SIT
	, CD_POR
	, FL_PAR_CAN
	, TP_PAR_STA
	, CD_IFT
	, CD_USR
From	T_PAR PAR, T_MIR_LOG_PAR_001 PARLOG
Where	PAR.CD_PAR = PARLOG.CD_PAR
IF @@ERROR &gt; 0 RETURN
   
/* Transfere dados da tabela T_CHA, associados ao vôo de Partida selecionado, para a tabela T_CHA espelho */
Insert Into T_CHA_MIR (
	CD_CHA
	, CD_CHG
	, CD_PAR
	, CD_IFT
	, DH_CHA
	, CD_MSG
	, CD_USR)
Select	CD_CHA
	, CD_CHG
	, CHA.CD_PAR
	, CD_IFT
	, DH_CHA
	, CD_MSG
	, CD_USR
From	T_CHA CHA, T_MIR_LOG_PAR_001 PAR

Where	CHA.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_CKV001, associados ao vôo de Partida selecionado, para a tabela T_CKV001 espelho */
Insert Into T_CKV001_MIR (
	CD_PAR
	, CD_CHK
	, CD_CLS)
Select	CKV.CD_PAR
	, CD_CHK
	, CD_CLS
From	T_CKV001 CKV, T_MIR_LOG_PAR_001 PAR
Where	CKV.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_DEP, associados ao vôo de Partida selecionado, para a tabela T_DEP espelho */
Insert Into T_DEP_MIR (
	CD_PAR

	, CD_AER
	, QT_DEP_TFB_DOM
	, QT_DEP_TFB_INT
	, QT_DEP_TFC_DOM
	, QT_DEP_TFC_INT
	, QT_DEP_ISE_COL
	, QT_DEP_ISE_TRA
	, QT_DEP_ISE_CON_DOM
	, QT_DEP_ISE_CON_INT
	, QT_DEP_ISE_OUT
	, QT_DEP_EMB_BAG_DOM
	, QT_DEP_EMB_BAG_INT
	, QT_DEP_EMB_CAR_DOM
	, QT_DEP_EMB_CAR_INT
	, QT_DEP_EMB_COR_DOM
	, QT_DEP_EMB_COR_INT)
Select	DEP.CD_PAR
	, CD_AER
	, QT_DEP_TFB_DOM
	, QT_DEP_TFB_INT
	, QT_DEP_TFC_DOM
	, QT_DEP_TFC_INT
	, QT_DEP_ISE_COL
	, QT_DEP_ISE_TRA
	, QT_DEP_ISE_CON_DOM
	, QT_DEP_ISE_CON_INT
	, QT_DEP_ISE_OUT
	, QT_DEP_EMB_BAG_DOM
	, QT_DEP_EMB_BAG_INT
	, QT_DEP_EMB_CAR_DOM
	, QT_DEP_EMB_CAR_INT
	, QT_DEP_EMB_COR_DOM
	, QT_DEP_EMB_COR_INT
From	T_DEP DEP, T_MIR_LOG_PAR_001 PAR
Where	DEP.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_ECP001, associados ao vôo de Partida selecionado, para a tabela T_ECP001 espelho */
Insert Into T_ECP001_MIR (
	CD_PAR
	, CD_ECP
	, CD_AER)
Select	ECP.CD_PAR
	, CD_ECP
	, CD_AER
From	T_ECP001 ECP, T_MIR_LOG_PAR_001 PAR
Where	ECP.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_TFB001, associados ao vôo de Partida selecionado, para a tabela T_TFB001 espelho */
Insert Into T_TFB001_MIR (
	CD_TFB
	, CD_COM
	, CD_HTE
	, QT_TFB
	, CD_PAR)
Select	 CD_TFB
	, CD_COM
	, CD_HTE
	, QT_TFB
	, TFB.CD_PAR
From	T_TFB001 TFB, T_MIR_LOG_PAR_001 PAR
Where	TFB.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_HSP, associados ao vôo de Partida selecionado, para a tabela T_HSP espelho */
Insert Into T_HSP_MIR (
	DH_HSP
	, CD_PAR
	, CD_IFT
	, CD_SIT
	, DH_HSP_PAR
	, CD_USR
	, NM_HSP_USR)
Select	DH_HSP
	, HSP.CD_PAR
	, CD_IFT
	, CD_SIT
	, DH_HSP_PAR
	, CD_USR
	, NM_HSP_USR
From	T_HSP HSP, T_MIR_LOG_PAR_001 PAR
Where	HSP.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_PRALOG, associados ao vôo de Partida selecionado, para a tabela T_PRALOG espelho */
Insert Into T_PRALOG_MIR (
	CD_PRA
	, CD_CHG
	, CD_PAR
	, QT_LOG_POR)
Select	CD_PRA
	, CD_CHG
	, LOG.CD_PAR
	, QT_LOG_POR
From	T_PRALOG LOG, T_MIR_LOG_PAR_001 PAR
Where	LOG.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN

/* Transfere dados da tabela T_MPA, associados ao vôo de Partida selecionado, para a tabela T_MPA espelho */
Insert Into T_MPA_MIR (
	CD_MPA
	, CD_PAR
	, CD_USR
	, DH_MPA
	, DH_MPA_EFE
	, CD_SIT
	, NM_MPA_COM_SIT
	, CD_TPA
	, CD_IFT
	, CD_POR
	, DS_MPA_CHK
	, DS_MPA_CHK_001
	, TT_MPA_OBS
	, TP_MPA
	, FL_MPA_TEL)
Select	CD_MPA
	, MPA.CD_PAR
	, CD_USR
	, DH_MPA
	, DH_MPA_EFE
	, CD_SIT
	, NM_MPA_COM_SIT
	, CD_TPA

	, CD_IFT
	, CD_POR
	, DS_MPA_CHK
	, DS_MPA_CHK_001
	, TT_MPA_OBS
	, TP_MPA
	, FL_MPA_TEL
From	T_MPA MPA, T_MIR_LOG_PAR_001 PAR
Where	MPA.CD_PAR = PAR.CD_PAR
IF @@ERROR &gt; 0 RETURN
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o39"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o251">
<a:ObjectID>69589AA8-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_MONITOR</a:Name>
<a:Code>SP_MONITOR</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>CREATE PROCEDURE SP_MONITOR AS
/*	CHEGADAS
	Atualizar os vôos de chegada cuja situaçao atual tem uma situaçao sucessora e
	o tempo para atualizaçao é o TEMPO ANTES e que a diferença entre a hora
	prevista e a hora atual é menor ou igual que o TEMPO ANTES
*/

UPDATE	T_CHG
SET	CD_SIT = CD_SIT_SUC,
	CD_USR = NULL
FROM  	T_CHG CHG, T_SSU SSU   
WHERE 	SSU.CD_SIT = CHG.CD_SIT AND
	SSU.TP_SSU = 1 AND
	CHG.TP_CHG_STA = 1 AND
	DATEDIFF(MI, GETDATE(), DH_CHG_EFE) &lt;= SSU.QT_SSU AND
	CHG.TP_CHG_CTG NOT IN (3, 4) AND
	NOT EXISTS (	SELECT 	CD_CHG = CHG001.CD_CHG 
			FROM 	T_CHG CHG001,
				T_SSU SSU001,
				T_SIT SIT001
			WHERE 	CHG001.CD_CHG = CHG.CD_CHG AND
				SSU001.CD_SIT = CHG001.CD_SIT AND
				SIT001.CD_SIT = SSU001.CD_SIT_SUC AND
				SIT001.FL_SIT_CON_VOO = 1 AND
				CHG001.CD_AEN_CHG IS NULL)


/*	Atualizar os vôos de chegada cuja situaçao atual tem uma situaçao sucessora e
	o tempo para atualizaçao é o TEMPO APOS e que a diferença entre a hora da
	atualizaçao da situaçao e a hora atual é maior ou igual que o TEMPO APOS
*/
UPDATE	T_CHG
SET	CD_SIT = CD_SIT_SUC,
	CD_USR = NULL
FROM  	T_CHG CHG, T_SSU SSU   
WHERE 	SSU.CD_SIT = CHG.CD_SIT AND
	SSU.TP_SSU = 2 AND
	CHG.TP_CHG_STA = 1 AND
	DATEDIFF(MI, DH_CHG_SIT, GETDATE()) &gt;= SSU.QT_SSU AND
	CHG.TP_CHG_CTG NOT IN (3, 4) AND
	NOT EXISTS (	SELECT 	CD_CHG = CHG001.CD_CHG 
			FROM 	T_CHG CHG001,
				T_SSU SSU001,
				T_SIT SIT001
			WHERE 	CHG001.CD_CHG = CHG.CD_CHG AND
				SSU001.CD_SIT = CHG001.CD_SIT AND
				SIT001.CD_SIT = SSU001.CD_SIT_SUC AND
				SIT001.FL_SIT_CON_VOO = 1 AND
				CHG001.CD_AEN_CHG IS NULL)

/*	Atualizar os vôos de chegada cuja situaçao atual tem uma situaçao sucessora e
	o tempo para atualizaçao é o TEMPO MINIMO DE PERMANENCIA e que a diferença entre
	a hora prevista e a hora atual é menor ou igual que o TEMPO MINIMO DE PERMANENCIA
*/

UPDATE	T_CHG
SET	CD_SIT = CD_SIT_SUC,
	CD_USR = NULL
FROM  	T_CHG CHG, T_SSU SSU   
WHERE 	SSU.CD_SIT = CHG.CD_SIT AND
	SSU.TP_SSU = 3 AND
	CHG.TP_CHG_STA = 1 AND
	DATEDIFF(MI, GETDATE(), DH_CHG_EFE) &lt;= CHG.QT_CHG_PER_MIN AND
	CHG.TP_CHG_CTG NOT IN (3, 4) AND
	NOT EXISTS (	SELECT 	CD_CHG = CHG001.CD_CHG 
			FROM 	T_CHG CHG001,
				T_SSU SSU001,
				T_SIT SIT001
			WHERE 	CHG001.CD_CHG = CHG.CD_CHG AND
				SSU001.CD_SIT = CHG001.CD_SIT AND
				SIT001.CD_SIT = SSU001.CD_SIT_SUC AND
				SIT001.FL_SIT_CON_VOO = 1 AND
				CHG001.CD_AEN_CHG IS NULL)

/*	Atualizar os vôos de partida cuja situaçao atual tem uma situaçao sucessora e
	o tempo para atualizaçao é o TEMPO ANTES e que a diferença entre a hora
	prevista e a hora atual é menor ou igual que o TEMPO ANTES e que os vôos antecessores
	estao nas situaçoes condicionantes, caso existam
*/

UPDATE	T_PAR
SET	CD_SIT = CD_SIT_SUC,
	CD_USR = NULL
FROM  	T_PAR PAR, T_CHG CHGAENANT, T_SSU SSU, T_SIT SIT   
WHERE 	SSU.CD_SIT = PAR.CD_SIT AND
	SIT.CD_SIT = PAR.CD_SIT AND
	CHGAENANT.CD_CHG = PAR.CD_CHG_AEN_ANT AND
	PAR.TP_PAR_STA = 1 AND
	SSU.TP_SSU = 1 AND /* TEMPO ANTES */
	DATEDIFF(MI, GETDATE(), PAR.DH_PAR_EFE) &lt;= SSU.QT_SSU AND
   	(	/* não existe situação condicionante ou a situação do vôo de chegada é uma das situações condicionantes */
		NOT EXISTS (SELECT *  FROM T_SCA SCA WHERE SCA.CD_SIT = SSU.CD_SIT_SUC)  OR
		CHGAENANT.CD_SIT IN (SELECT CD_SIT_ANT FROM T_SCA SCA WHERE SCA.CD_SIT = SSU.CD_SIT_SUC)
	)

/*	Atualizar os vôos de partida cuja situaçao atual tem uma situaçao sucessora e
	o tempo para atualizaçao é o TEMPO APOS e que a diferença entre a hora
	prevista e a hora atual é maior ou igual que o TEMPO APOS e que os vôos antecessores
	estao nas situaçoes condicionantes, caso existam
*/

UPDATE 	T_PAR
SET	CD_SIT = CD_SIT_SUC,
	CD_USR = NULL
FROM  	T_PAR PAR, T_CHG CHGAENANT, T_SSU SSU, T_SIT SIT   
WHERE 	SSU.CD_SIT = PAR.CD_SIT AND
	SIT.CD_SIT = PAR.CD_SIT AND
	CHGAENANT.CD_CHG = PAR.CD_CHG_AEN_ANT AND
	PAR.TP_PAR_STA = 1 AND
	SSU.TP_SSU = 2 AND /* TEMPO APÓS */
	DATEDIFF(MI, PAR.DH_PAR_SIT, GETDATE()) &gt;= SSU.QT_SSU AND
   	(	/* não existe situação condicionante ou a situação do vôo de chegada é uma das situações condicionantes */
		NOT EXISTS (SELECT *  FROM T_SCA SCA WHERE SCA.CD_SIT = SSU.CD_SIT_SUC)  OR
		CHGAENANT.CD_SIT IN (SELECT CD_SIT_ANT FROM T_SCA SCA WHERE SCA.CD_SIT = SSU.CD_SIT_SUC)
	)

/*	Atualizar os vôos de partida cuja situaçao atual tem uma situaçao sucessora e
	o tempo para atualizaçao é o TEMPO MINIMO DE PERMANENCIA e que a diferença entre a hora
	prevista e a hora atual é menor ou igual que o TEMPO MINIMO DE PERMANENCIA e que os vôos antecessores
	estao nas situaçoes condicionantes, caso existam
*/

UPDATE 	T_PAR
SET	CD_SIT = CD_SIT_SUC,
	CD_USR = NULL
FROM  	T_PAR PAR, T_CHG CHGAENANT, T_SSU SSU, T_SIT SIT   
WHERE 	SSU.CD_SIT = PAR.CD_SIT AND
	SIT.CD_SIT = PAR.CD_SIT AND
	CHGAENANT.CD_CHG = PAR.CD_CHG_AEN_ANT AND
	PAR.TP_PAR_STA = 1 AND
	SSU.TP_SSU = 3 AND /* TEMPO MÍNIMO DE PERMANÊNCIA */
	DATEDIFF(MI, GETDATE(), PAR.DH_PAR_EFE) &lt;= CHGAENANT.QT_CHG_PER_MIN AND
   	(	/* não existe situação condicionante ou a situação do vôo de chegada é uma das situações condicionantes */
		NOT EXISTS (SELECT *  FROM T_SCA SCA WHERE SCA.CD_SIT = SSU.CD_SIT_SUC)  OR
		CHGAENANT.CD_SIT IN (SELECT CD_SIT_ANT FROM T_SCA SCA WHERE SCA.CD_SIT = SSU.CD_SIT_SUC)
	)
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o39"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o252">
<a:ObjectID>69589AA9-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_SOMA_DIA</a:Name>
<a:Code>SP_SOMA_DIA</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_SOMA_DIA    Script Date: 7/8/2000 12:15:32 ******/
Create Procedure SP_SOMA_DIA
(@DS_DIA VARCHAR(04), @NR_DIA INTEGER, @DS_SOMA_DIA VARCHAR(04) OUTPUT) As
DECLARE @DIA INTEGER
DECLARE @NR_POS INTEGER

SELECT @NR_POS = CHARINDEX(&#39;,&#39;, @DS_DIA)
SELECT @DIA = @NR_DIA + CONVERT(INTEGER, SUBSTRING(@DS_DIA, 1, @NR_POS - 1))
SELECT @DS_SOMA_DIA = CONVERT(VARCHAR, @DIA) + &#39;,&#39;
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o39"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o253">
<a:ObjectID>69589AAB-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_TransfereEspelho</a:Name>
<a:Code>SP_TransfereEspelho</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_TransfereEspelho    Script Date: 7/8/2000 12:15:34 ******/
Create Procedure SP_TransfereEspelho
(@pQtDt INT) As
IF @pQtDt &lt; (SELECT QT_PSI_MIR_TEM FROM T_PSI)
BEGIN
	RollBack Transaction
	RaisError 20003 &#39;Operação não executada: Data Limite para Espelhamento é menor que a data requerida&#39;
	Return
END

/* Monta recordset com vôos de Chegada cancelados que ocorreram até a data especificada */
DELETE T_MIR_LOG_CHG_001

Insert into T_MIR_LOG_CHG_001 (CD_CHG)
Select	CD_CHG 
From	T_CHG CHG
Where	TP_CHG_STA = 2
And 	FL_CHG_CAN = 1
And 	DATEDIFF(DD, DH_CHG_EFE, GETDATE()) &gt; @pQtDt

IF (SELECT COUNT(*) FROM T_MIR_LOG_CHG_001) &gt; 0
BEGIN

	Begin Transaction

	/* Inclui registros associados ao vôo de Chegada selecionado nas tabelas espelhos relacionadas */

	EXEC SP_IncTabEspRelCHG001

	IF @@ERROR &gt; 0

	BEGIN
		RollBack Transaction
		RaisError 20003 &#39;Operação não executada: SP_TransfereEspelho&#39;
		Return
	END

      
	/* Excluir registros das Tabelas Principais */
	EXEC SP_ExcTabPrincipal 2

	IF @@ERROR &gt; 0
	BEGIN

		RollBack Transaction
		RaisError 20003 &#39;Operação não executada: SP_TransfereEspelho&#39;
		Return
	END

	Commit Transaction
END


/* Monta recordset com vôos de Partida cancelados que ocorreram até a data especificada */
DELETE T_MIR_LOG_PAR_001

Insert into T_MIR_LOG_PAR_001 (CD_PAR)
Select	CD_PAR 
From	T_PAR PAR
Where	TP_PAR_STA = 2
And 	FL_PAR_CAN =1
And	DATEDIFF(DD, DH_PAR_EFE, GETDATE()) &gt; @pQtDt

IF (SELECT COUNT(*) FROM T_MIR_LOG_PAR_001) &gt; 0 
BEGIN
	Begin Transaction


	/* Inclui registros associados ao vôo de Chegada selecionado nas tabelas espelhos relacionadas */
	EXEC SP_IncTabEspRelPAR001
	IF @@ERROR &gt; 0
	BEGIN

		RollBack Transaction
		RaisError 20003 &#39;Operação não executada: SP_TransfereEspelho&#39;
		Return
	END


	/* Excluir registros das Tabelas Principais */
	EXEC SP_ExcTabPrincipal 3
	IF @@ERROR &gt; 0
	BEGIN
		RollBack Transaction

		RaisError 20003 &#39;Operação não executada: SP_TransfereEspelho&#39;
		Return
	END


	Commit Transaction
END

/* Monta recordset com vôos de Chegada associados aos vôos de Partida cujas decolagens aconteceram até a data especificada */

DELETE T_MIR_LOG_CHG

Insert into T_MIR_LOG_CHG (CD_CHG)
Select	CD_CHG 
From	T_CHG CHG
Where	CD_CHG In (	Select 	CD_CHG_AEN_ANT
			From  	T_PAR PAR
			Where 	PAR.TP_PAR_STA = 2

			And   	PAR.CD_AER = (SELECT CD_AER FROM T_PSI)
			And   	PAR.TP_PAR_CTG NOT IN (3,4)

			And   	DATEDIFF(DD, DH_PAR_EFE, GETDATE()) &gt; @pQtDt
			And   	PAR.FL_PAR_CAN = 0)

IF (SELECT COUNT(*) FROM T_MIR_LOG_CHG) &gt; 0
BEGIN


	Begin Transaction

	/* Inclui registros associados ao vôo de Chegada selecionado nas tabelas espelhos relacionadas */
	EXEC SP_IncTabEspRelCHG 

	IF @@ERROR &gt; 0
	BEGIN

		RollBack Transaction
		RaisError 20003 &#39;Operação não executada: SP_TransfereEspelho&#39;
		Return
	END

	/* Seleciona vôos de Chegada Codeshare ou Duplicate Leg vinculados ao vôo de Chegada selecionado */
	DELETE T_MIR_LOG_CHG_001

	Insert into T_MIR_LOG_CHG_001 (CD_CHG)
	Select	CHGVIN.CD_CHG 

	From	T_CHG CHGVIN, T_MIR_LOG_CHG CHG
	Where	CHGVIN.CD_CHG_VIN = CHG.CD_CHG
	Order By CHGVIN.CD_CHG

	/* Percorre vetor com vôos de Chegada vinculados a serem processados */
	EXEC SP_IncTabEspRelCHG001
	IF @@ERROR &gt; 0
	BEGIN
		RollBack Transaction
		RaisError 20003 &#39;Operação não executada: SP_TransfereEspelho&#39;
		Return
	END

	/* Seleciona vôos de Partida associados ao vôo de Chegada selecionado */

	DELETE T_MIR_LOG_PAR

	Insert into T_MIR_LOG_PAR (CD_PAR)
        	Select	PAR.CD_PAR
	From	T_PAR PAR, T_MIR_LOG_CHG CHG
	Where	PAR.CD_CHG_AEN_ANT = CHG.CD_CHG
	Order By PAR.CD_PAR


	/* Inclui registros associados ao vôo de Partida selecionado nas tabelas espelhos relacionadas */
	EXEC SP_IncTabEspRelPAR 
	IF @@ERROR &gt; 0

	BEGIN
		RollBack Transaction
		RaisError 20003 &#39;Operação não executada: SP_TransfereEspelho&#39;
		Return
	END

	/* Seleciona vôos de Partida Codeshare ou Duplicate Leg vinculados ao vôo de Partida selecionado */
	DELETE T_MIR_LOG_PAR_001
		Insert into T_MIR_LOG_PAR_001 (CD_PAR)
	Select	PARVIN.CD_PAR 
	From	T_PAR PARVIN, T_MIR_LOG_PAR PAR
	Where	PARVIN.CD_PAR_VIN = PAR.CD_PAR
	Order By PARVIN.CD_PAR

	/* Percorre vetor com vôos de Chegada vinculados a serem processados */
	EXEC SP_IncTabEspRelPAR001
	IF @@ERROR &gt; 0
	BEGIN
		RollBack Transaction
		RaisError 20003 &#39;Operação não executada: SP_TransfereEspelho&#39;
		Return
	END


       	/* Excluir Tabela Principal */
	EXEC SP_ExcTabPrincipal 1
	IF @@ERROR &gt; 0
	BEGIN
		RollBack Transaction
		RaisError 20003 &#39;Operação não executada: SP_TransfereEspelho&#39;
		Return
	END

	Commit Transaction
END
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o39"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o254">
<a:ObjectID>69589AAD-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_VerificaCodeShare</a:Name>
<a:Code>SP_VerificaCodeShare</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_VerificaCodeShare    Script Date: 7/8/2000 12:15:34 ******/
CREATE Procedure SP_VerificaCodeShare
(@CD_HOT_INS CHAR(7), @CD_HVE_INS CHAR(3), @CD_HFR_INS CHAR(1), @TP_HET_CTG_INS TINYINT) As
/* Declaração das variáveis que receberão o cursor */
DECLARE @CD_HOT			CHAR(7),
	 @CD_HVE			CHAR(3),
	 @CD_HFR			CHAR(1),
	 @CD_HET			CHAR(2),
	 @DS_HFR_CSH			CHAR(7),
	 @QT_HET_DIA_PAR_CSH		INT,
	 @QT_HET_DIA_CHG_CSH		INT,
	 @DS_HFR_NRM			CHAR(7),
	 @QT_HET_DIA_PAR_NRM		INT,
	 @QT_HET_DIA_CHG_NRM		INT,
	 @CD_HET_CORRENTE		CHAR(13),
	 @QT_NOK			TINYINT,
	 @FL_OK				BIT,
	 @FL_OK_TOTAL			BIT,
	 @NR_POS			TINYINT,
	 @DS_HFR_Descoberta 		CHAR(7),
	 @CD_HOT_NRM			CHAR(10),
	 @CD_HOT_NRM_CORRENTE	CHAR(10)

IF @TP_HET_CTG_INS IN (3, 4)
BEGIN
/* Verificar todas as etapas do tipo Code-Share ou Duplicate Leg pertencentes à mesma freqüencia das etapas alteradas, 
    se no Hotran Vinculado existe alguma etapa com a mesma origem e destino e 
    cujo período de validade abranja o período de validade do vôo code-share/duplicate leg */
IF (	SELECT	COUNT(*) FROM T_HVE HVEINS, T_HET HETINS
	WHERE	HETINS.CD_HOT + HETINS.CD_HVE + HETINS.CD_HFR = @CD_HOT_INS + @CD_HVE_INS + @CD_HFR_INS AND
		HVEINS.CD_HOT + HVEINS.CD_HVE = @CD_HOT_INS + @CD_HVE_INS AND
		HETINS.TP_HET_CTG IN (3, 4) AND
		NOT EXISTS (	SELECT * FROM T_HVE HVE, T_HET HET
				WHERE	HET.CD_HOT = HETINS.CD_HOT_VIN AND
					HVE.CD_HOT + HVE.CD_HVE = HET.CD_HOT + HET.CD_HVE AND
					HET.SG_AER_ORI = HETINS.SG_AER_ORI AND
					HET.SG_AER_DES = HETINS.SG_AER_DES AND
					HVE.DT_HVE_INI &lt;= HVEINS.DT_HVE_INI AND
					(HVE.DT_HVE_FIM &gt;= HVEINS.DT_HVE_FIM OR HVE.DT_HVE_FIM IS NULL))) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: Um vôo Code-Share ou Duplicate Leg tem de estar associado a um Hotran que possua pelo menos uma etapa com a mesma origem e destino e cujo período de validade abranja o período de validade.&#39;
	RETURN
END

/* Verificar entre as etapas do Hotran Vinculado válidas pela condição anterior, isto é, têm a mesma origem e destino desta etapa e com período de validade
    compreendido pelo período de validade da etapa vinculada, se há alguma etapa cuja freqüência abranja a freqüência do vôo code-share que está sendo alterado. */

/* Declaração do cursor */
DECLARE SP_CURSOR CURSOR FOR
	SELECT 	DISTINCT 
		HETCSH.CD_HOT,
		HETCSH.CD_HVE,
		HETCSH.CD_HFR,
		HETCSH.CD_HET,
		HET.CD_HOT + HET.CD_HVE,
		DS_HFR_CSH = HFRCSH.DS_HFR,
		QT_HET_DIA_PAR_CSH = CONVERT(INT, HETCSH.QT_HET_DIA_PAR),
		QT_HET_DIA_CHG_CSH = CONVERT(INT, HETCSH.QT_HET_DIA_CHG),
		DS_HFR_NRM = HFR.DS_HFR,

		QT_HET_DIA_PAR_NRM = CONVERT(INT, HET.QT_HET_DIA_PAR),
		QT_HET_DIA_CHG_NRM = CONVERT(INT, HET.QT_HET_DIA_CHG)
	FROM	T_HVE HVECSH, T_HFR HFRCSH, T_HET HETCSH, T_HVE HVE, T_HFR HFR, T_HET HET
	WHERE	HVECSH.CD_HOT + HVECSH.CD_HVE = HETCSH.CD_HOT + HETCSH.CD_HVE AND
		HFRCSH.CD_HOT + HFRCSH.CD_HVE + HFRCSH.CD_HFR = HETCSH.CD_HOT + HETCSH.CD_HVE + HETCSH.CD_HFR AND
		HETCSH.CD_HOT + HETCSH.CD_HVE + HETCSH.CD_HFR = @CD_HOT_INS + @CD_HVE_INS + @CD_HFR_INS AND
		HETCSH.TP_HET_CTG IN (3, 4) AND
		HVE.CD_HOT + HVE.CD_HVE = HET.CD_HOT + HET.CD_HVE AND
		HFR.CD_HOT + HFR.CD_HVE + HFR.CD_HFR = HET.CD_HOT + HET.CD_HVE + HET.CD_HFR AND
		HET.CD_HOT = HETCSH.CD_HOT_VIN AND
		HET.SG_AER_ORI = HETCSH.SG_AER_ORI AND
		HET.SG_AER_DES = HETCSH.SG_AER_DES AND


		HVE.DT_HVE_INI &lt;= HVECSH.DT_HVE_INI AND
		(HVE.DT_HVE_FIM &gt;= HVECSH.DT_HVE_FIM OR HVE.DT_HVE_FIM IS NULL)
	ORDER BY HETCSH.CD_HOT, HETCSH.CD_HVE, HETCSH.CD_HFR, HETCSH.CD_HET, HET.CD_HOT + HET.CD_HVE

SELECT @FL_OK_TOTAL = 1

/* Abertura do cursor */
OPEN SP_CURSOR

/* Ir para o primeiro registro */
FETCH	SP_CURSOR
INTO	@CD_HOT,
	@CD_HVE,
	@CD_HFR,
	@CD_HET,
	@CD_HOT_NRM,
	@DS_HFR_CSH,
	@QT_HET_DIA_PAR_CSH,
	@QT_HET_DIA_CHG_CSH,
	@DS_HFR_NRM,
	@QT_HET_DIA_PAR_NRM,
	@QT_HET_DIA_CHG_NRM

/* Processar todos os registros de SP_CURSOR */
WHILE @@FETCH_STATUS = 0
BEGIN

	SELECT	@CD_HET_CORRENTE = @CD_HOT + @CD_HVE + @CD_HFR + @CD_HET, 
		@FL_OK = 0

	/* Verificar todos os hotrans normais possivelmente válidos para esta etapa */


	WHILE @@FETCH_STATUS = 0 AND @CD_HOT + @CD_HVE + @CD_HFR + @CD_HET = @CD_HET_CORRENTE
	BEGIN


		SELECT 	@CD_HOT_NRM_CORRENTE = @CD_HOT_NRM,
			@DS_HFR_Descoberta = @DS_HFR_CSH

		/* Processar todas as frequüências deste hotran normal */
		WHILE @@FETCH_STATUS = 0 AND @CD_HOT + @CD_HVE + @CD_HFR + @CD_HET = @CD_HET_CORRENTE AND @CD_HOT_NRM = @CD_HOT_NRM_CORRENTE
		BEGIN

			SELECT	@DS_HFR_CSH = @DS_HFR_Descoberta,
				@DS_HFR_Descoberta = &#39;&#39;,
				@NR_POS = 1

			/* Varrer @DS_HFR_CSH para verificar se cada dia desta freqüência está contido na freqüência da etapa normal */
			WHILE SUBSTRING(RTRIM(@DS_HFR_CSH) + &#39;X&#39;, @NR_POS, 1) &lt;&gt; &#39;X&#39;
			BEGIN

				    /* Verificar se este dia da freqüência de partida do vôo codeshare/duplicate está na freqüência de partida do vôo vinculado */
				IF PATINDEX(&#39;%&#39; + CONVERT(CHAR(1), (((CONVERT(INT, SUBSTRING(@DS_HFR_CSH, @NR_POS, 1)) - ( ISNULL(@QT_HET_DIA_PAR_NRM,0) - ISNULL(@QT_HET_DIA_PAR_CSH,0) ) - 1) % 7) + 7) % 7 + 1) + &#39;%&#39;, @DS_HFR_NRM) = 0
				    OR
				   /* Verificar se este dia da freqüência de chegada do vôo codeshare/duplicate está na freqüência de chegada do vôo vinculado */
				    PATINDEX(&#39;%&#39; + CONVERT(CHAR(1), (((CONVERT(INT, SUBSTRING(@DS_HFR_CSH, @NR_POS, 1)) - ( ISNULL(@QT_HET_DIA_CHG_NRM,0) - ISNULL(@QT_HET_DIA_CHG_CSH,0) ) - 1) % 7) + 7) % 7 + 1) + &#39;%&#39;, @DS_HFR_NRM) = 0
					SELECT @DS_HFR_Descoberta = RTRIM(@DS_HFR_Descoberta) + SUBSTRING(@DS_HFR_CSH, @NR_POS, 1)

				SELECT @NR_POS = @NR_POS + 1

			END

			/* Ir para o próximo registro */
			FETCH	NEXT FROM SP_CURSOR
			INTO	@CD_HOT,
				@CD_HVE,
				@CD_HFR,
				@CD_HET,
				@CD_HOT_NRM,
				@DS_HFR_CSH,
				@QT_HET_DIA_PAR_CSH,
				@QT_HET_DIA_CHG_CSH,
				@DS_HFR_NRM,
				@QT_HET_DIA_PAR_NRM,
				@QT_HET_DIA_CHG_NRM

		END

		IF RTRIM(@DS_HFR_Descoberta) + &#39;X&#39; = &#39;X&#39; SELECT @FL_OK = 1

	END

	IF @FL_OK = 0 SELECT @FL_OK_TOTAL = 0

END
CLOSE SP_CURSOR
DEALLOCATE SP_CURSOR


IF @FL_OK_TOTAL = 0
BEGIN
	RAISERROR 20001 &#39;Operação não executada:Um vôo CodeShare ou DuplicateLeg tem de estar associado a um Hotran que possua pelo menos uma etapa com a mesma origem e destino e cuja freqüência e período de validade abranjam sua freqüência e período de validade, respectivamente.&#39;
	RETURN
END

END
ELSE
BEGIN

/* VERIFICAR SE ALTERAÇÕES NAS ETAPAS NORMAIS AFETAM AS ETAPAS CODE-SHARE/DUPLICATE LEG */

/* Verificar se, após a alteração, as etapas do tipo Code-Share ou Duplicate Leg que têm o hotran desta etapa como hotran vinculado,
    se no Hotran Vinculado continua existindo alguma etapa com a mesma origem e destino e cujo período de validade abranja o 
    período de validade da etapa CS/DL */
IF (	SELECT	COUNT(*) FROM T_HVE HVECSH, T_HET HETCSH
	WHERE	HVECSH.CD_HOT + HVECSH.CD_HVE = HETCSH.CD_HOT + HETCSH.CD_HVE AND
		HETCSH.CD_HOT_VIN = @CD_HOT_INS AND
		NOT EXISTS (	SELECT * FROM T_HVE HVE, T_HET HET
				WHERE	HVE.CD_HOT + HVE.CD_HVE = HET.CD_HOT + HET.CD_HVE AND
					HET.CD_HOT = HETCSH.CD_HOT_VIN AND
					HET.SG_AER_ORI = HETCSH.SG_AER_ORI AND
					HET.SG_AER_DES = HETCSH.SG_AER_DES AND
					HVE.DT_HVE_INI &lt;= HVECSH.DT_HVE_INI AND
					(HVE.DT_HVE_FIM &gt;= HVECSH.DT_HVE_FIM OR HVE.DT_HVE_FIM IS NULL))) &gt; 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: Há vôos Code-Share ou Duplicate Leg associados a este Hotran que impedem esta alteração.&#39;
	RETURN
END



/* Verificar se após esta alteração, as etapas code-share ou duplicate leg vinculadas a este hotran continuaram válildas quanto à freqüência */

/* Declaração do cursor */
DECLARE SP_CURSOR CURSOR FOR
	SELECT 	DISTINCT 
		HETCSH.CD_HOT,
		HETCSH.CD_HVE,
		HETCSH.CD_HFR,
		HETCSH.CD_HET,
		HET.CD_HOT + HET.CD_HVE,
		DS_HFR_CSH = HFRCSH.DS_HFR,
		QT_HET_DIA_PAR_CSH = CONVERT(INT, HETCSH.QT_HET_DIA_PAR),
		QT_HET_DIA_CHG_CSH = CONVERT(INT, HETCSH.QT_HET_DIA_CHG),
		DS_HFR_NRM = HFR.DS_HFR,
		QT_HET_DIA_PAR_NRM = CONVERT(INT, HET.QT_HET_DIA_PAR),
		QT_HET_DIA_CHG_NRM = CONVERT(INT, HET.QT_HET_DIA_CHG)

	FROM	T_HVE HVECSH, T_HFR HFRCSH, T_HET HETCSH, T_HVE HVE, T_HFR HFR, T_HET HET
	WHERE	HVECSH.CD_HOT + HVECSH.CD_HVE = HETCSH.CD_HOT + HETCSH.CD_HVE AND
		HFRCSH.CD_HOT + HFRCSH.CD_HVE + HFRCSH.CD_HFR = HETCSH.CD_HOT + HETCSH.CD_HVE + HETCSH.CD_HFR AND
		HETCSH.CD_HOT_VIN = @CD_HOT_INS AND
		HVE.CD_HOT + HVE.CD_HVE = HET.CD_HOT + HET.CD_HVE AND
		HFR.CD_HOT + HFR.CD_HVE + HFR.CD_HFR = HET.CD_HOT + HET.CD_HVE + HET.CD_HFR AND
		HET.CD_HOT = HETCSH.CD_HOT_VIN AND
		HET.SG_AER_ORI = HETCSH.SG_AER_ORI AND
		HET.SG_AER_DES = HETCSH.SG_AER_DES AND
		HVE.DT_HVE_INI &lt;= HVECSH.DT_HVE_INI AND
		(HVE.DT_HVE_FIM &gt;= HVECSH.DT_HVE_FIM OR HVE.DT_HVE_FIM IS NULL)

	ORDER BY HETCSH.CD_HOT, HETCSH.CD_HVE, HETCSH.CD_HFR, HETCSH.CD_HET, HET.CD_HOT + HET.CD_HVE

SELECT @FL_OK_TOTAL = 1

/* Abertura do cursor */
OPEN SP_CURSOR

/* Ir para o primeiro registro */
FETCH	SP_CURSOR
INTO	@CD_HOT,
	@CD_HVE,
	@CD_HFR,
	@CD_HET,
	@CD_HOT_NRM,
	@DS_HFR_CSH,
	@QT_HET_DIA_PAR_CSH,
	@QT_HET_DIA_CHG_CSH,
	@DS_HFR_NRM,
	@QT_HET_DIA_PAR_NRM,
	@QT_HET_DIA_CHG_NRM


/* Processar todos os registros de SP_CURSOR */
WHILE @@FETCH_STATUS = 0
BEGIN

	SELECT	@CD_HET_CORRENTE = @CD_HOT + @CD_HVE + @CD_HFR + @CD_HET, 
		@FL_OK = 0

	/* Verificar todos os hotrans normais possivelmente válidos para esta etapa */
	WHILE @@FETCH_STATUS = 0 AND @CD_HOT + @CD_HVE + @CD_HFR + @CD_HET = @CD_HET_CORRENTE
	BEGIN

		SELECT 	@CD_HOT_NRM_CORRENTE = @CD_HOT_NRM,
			@DS_HFR_Descoberta = @DS_HFR_CSH

		/* Processar todas as frequüências deste hotran normal */
		WHILE @@FETCH_STATUS = 0 AND @CD_HOT + @CD_HVE + @CD_HFR + @CD_HET = @CD_HET_CORRENTE AND @CD_HOT_NRM = @CD_HOT_NRM_CORRENTE
		BEGIN

			SELECT	@DS_HFR_CSH = @DS_HFR_Descoberta,
				@DS_HFR_Descoberta = &#39;&#39;,
				@NR_POS = 1

			/* Varrer @DS_HFR_CSH para verificar se cada dia desta freqüência está contido na freqüência da etapa normal */
			WHILE SUBSTRING(RTRIM(@DS_HFR_CSH) + &#39;X&#39;, @NR_POS, 1) &lt;&gt; &#39;X&#39;
			BEGIN

				    /* Verificar se este dia da freqüência de partida do vôo codeshare/duplicate está na freqüência de partida do vôo vinculado */
				IF PATINDEX(&#39;%&#39; + CONVERT(CHAR(1), (((CONVERT(INT, SUBSTRING(@DS_HFR_CSH, @NR_POS, 1)) - ( ISNULL(@QT_HET_DIA_PAR_NRM,0) - ISNULL(@QT_HET_DIA_PAR_CSH,0) ) - 1) % 7) + 7) % 7 + 1) + &#39;%&#39;, @DS_HFR_NRM) = 0
				    OR

				   /* Verificar se este dia da freqüência de chegada do vôo codeshare/duplicate está na freqüência de chegada do vôo vinculado */
				    PATINDEX(&#39;%&#39; + CONVERT(CHAR(1), (((CONVERT(INT, SUBSTRING(@DS_HFR_CSH, @NR_POS, 1)) - ( ISNULL(@QT_HET_DIA_CHG_NRM,0) - ISNULL(@QT_HET_DIA_CHG_CSH,0) ) - 1) % 7) + 7) % 7 + 1) + &#39;%&#39;, @DS_HFR_NRM) = 0
					SELECT @DS_HFR_Descoberta = RTRIM(@DS_HFR_Descoberta) + SUBSTRING(@DS_HFR_CSH, @NR_POS, 1)

				SELECT @NR_POS = @NR_POS + 1

			END

			/* Ir para o próximo registro */
			FETCH	NEXT FROM SP_CURSOR
			INTO	@CD_HOT,
				@CD_HVE,
				@CD_HFR,
				@CD_HET,
				@CD_HOT_NRM,
				@DS_HFR_CSH,
				@QT_HET_DIA_PAR_CSH,
				@QT_HET_DIA_CHG_CSH,
				@DS_HFR_NRM,
				@QT_HET_DIA_PAR_NRM,
				@QT_HET_DIA_CHG_NRM

		END

		IF RTRIM(@DS_HFR_Descoberta) + &#39;X&#39; = &#39;X&#39; SELECT @FL_OK = 1

	END

	IF @FL_OK = 0 SELECT @FL_OK_TOTAL = 0

END
CLOSE SP_CURSOR
DEALLOCATE SP_CURSOR


IF @FL_OK_TOTAL = 0
BEGIN
	RAISERROR 20999 &#39;Operação não executada: Há vôos Code-Share ou Duplicate Leg associados a este Hotran que impedem esta alteração.&#39;
	RETURN
END

END
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o39"/>
</c:Procedure.Owner>
</o:Procedure>
<o:Procedure Id="o255">
<a:ObjectID>69589AAF-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>SP_VerificaIP</a:Name>
<a:Code>SP_VerificaIP</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:Procedure.Text>/****** Object:  Stored Procedure dbo.SP_VerificaIP    Script Date: 7/8/2000 12:15:32 ******/
Create Procedure SP_VerificaIP
(@pIP VARCHAR(15)) As
DECLARE @i INT
DECLARE @lIPPart VARCHAR(3)
DECLARE @lChar CHAR(1)
DECLARE @lPontos INT
DECLARE @lLenIP INT
DECLARE @lNumeros INT

select @lIPPart = &#39;&#39;
select @lPontos = 0
select @i = 1
IF PATINDEX(&#39;%@%&#39;, @pIP) &gt; 0 
BEGIN
	RAISERROR 20999 &#39;Operação não executada: IP Inválido.&#39;
	RETURN
END
SELECT @lLenIP = PATINDEX (&#39;%@%&#39;,@pIP + &#39;@&#39;) - 1

SELECT @lNumeros = 0

while @i &lt;= @lLenIP

BEGIN
	select @lChar = substring(@pIP, @i, 1)

	if @lChar = &#39;.&#39;
	BEGIN
		SELECT @lNumeros = 0
	END

        If @lChar &lt;&gt; &#39;.&#39; 
	BEGIN
		select @lNumeros = @lNumeros + 1
                
  	        IF @LCHAR &lt; &#39;0&#39; OR @LCHAR &gt; &#39;9&#39; OR @lNumeros &gt; 3
		BEGIN
			RAISERROR 20999 &#39;Operação não executada: IP Inválido.&#39;
			RETURN
		END
		select @lIPPart = LTRIM(@lIPPart) + @lChar
	END

	If (@lChar = &#39;.&#39; Or @i = @lLenIP) And @lIPPart &lt;&gt; &#39;&#39;
	BEGIN
		select @lPontos = @lPontos + 1
		If Not (CONVERT(INT, @lIPPart) &gt;= 0 and CONVERT(INT, @lippart) &lt;= 255)
		BEGIN
			RAISERROR 20999 &#39;Operação não executada: IP Inválido.&#39;
			RETURN
		END
		select @lIPPart = &#39;&#39;
	END
	select @i = @i + 1
END   

If @lPontos &lt;&gt; 4
BEGIN
	RAISERROR 20999 &#39;Operação não executada: IP Inválido.&#39;
	RETURN
END
go</a:Procedure.Text>
<c:Procedure.Owner>
<o:User Ref="o39"/>
</c:Procedure.Owner>
</o:Procedure>
</c:Procedures>
<c:Tables>
<o:Table Ref="o44"/>
<o:Table Ref="o7"/>
<o:Table Ref="o64"/>
<o:Table Ref="o156"/>
<o:Table Ref="o171"/>
<o:Table Ref="o82"/>
<o:Table Ref="o100"/>
<o:Table Ref="o213"/>
<o:Table Ref="o197"/>
<o:Table Ref="o226"/>
<o:Table Ref="o118"/>
<o:Table Ref="o138"/>
</c:Tables>
<c:References>
<o:Reference Ref="o60"/>
<o:Reference Ref="o78"/>
<o:Reference Ref="o96"/>
<o:Reference Ref="o114"/>
<o:Reference Ref="o134"/>
<o:Reference Ref="o152"/>
<o:Reference Ref="o167"/>
<o:Reference Ref="o193"/>
<o:Reference Ref="o206"/>
<o:Reference Ref="o209"/>
<o:Reference Ref="o222"/>
<o:Reference Ref="o234"/>
<o:Reference Ref="o237"/>
<o:Reference Ref="o240"/>
</c:References>
<c:TargetModels>
<o:TargetModel Id="o256">
<a:ObjectID>69589A98-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Microsoft SQL Server 7.x</a:Name>
<a:Code>SQL SERVER 7</a:Code>
<a:CreationDate>1081528635</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528635</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:TargetModelURL>file:///%_DBMS%/sqlserv7.xdb</a:TargetModelURL>
<a:TargetModelID>986CB218-1936-4245-823C-883D7AF59B86</a:TargetModelID>
<a:TargetModelClassID>4BA9F647-DAB1-11D1-9944-006097355D9B</a:TargetModelClassID>
<c:SessionShortcuts>
<o:Shortcut Ref="o3"/>
<o:Shortcut Id="o257">
<a:ObjectID>69589A9A-8FBB-11D8-B6CA-00024416849C</a:ObjectID>
<a:Name>Microsoft SQL Server 7.x</a:Name>
<a:Code>SQL SERVER 7</a:Code>
<a:CreationDate>1081528636</a:CreationDate>
<a:Creator>prsi_ronei</a:Creator>
<a:ModificationDate>1081528636</a:ModificationDate>
<a:Modifier>prsi_ronei</a:Modifier>
<a:TargetID>986CB218-1936-4245-823C-883D7AF59B86</a:TargetID>
<a:TargetClassID>4BA9F647-DAB1-11D1-9944-006097355D9B</a:TargetClassID>
<a:TargetPackagePath/>
</o:Shortcut>
</c:SessionShortcuts>
</o:TargetModel>
</c:TargetModels>
</o:Model>
</c:Children>
</o:RootObject>

</Model>