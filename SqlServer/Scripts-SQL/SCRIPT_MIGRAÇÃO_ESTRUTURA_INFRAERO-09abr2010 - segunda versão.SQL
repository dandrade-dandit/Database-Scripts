--*********************************************************************************************************
--dependencias
--*********************************************************************************************************
INSERT INTO DEPENDENCIAS (DEP_CODIGO,DEP_TIPO,DEP_NOME,DEP_SIGLA,DEP_ENDERECO_LOGRADOURO,DEP_ENDERECO_BAIRRO,DEP_ENDERECO_MUNICIPIO,DEP_UFE_SIGLA,DEP_ENDERECO_CEP,DEP_NUMERO_TELEFONE_1,DEP_NUMERO_TELEFONE_2,DEP_NUMERO_FAX,DEP_NUMERO_CGC,DEP_ABA_BAN_CODIGO,DEP_ABA_CODIGO,DEP_DEP_CODIGO,DEP_CODIGO_UGD,DEP_RGE_CODIGO,CD_DEPENDENCIA_CHAVE,DEP_IN_CATEGORIA_AEROPORTO,DEP_DATA_CRIACAO,DEP_DS_DOCUMENTO_CRIACAO,DEP_DATA_EXTINCAO,DEP_DS_DOCUMENTO_EXTINCAO,DEP_MSG_CNTCHQUE,DEP_DEP_CODIGO_VINCULA_PGTO,DEP_MUN_CODIGO,DEP_GRUPOS_DEPENDENCIAS,IN_OPB_AUTOMATICA,DEP_SIGLA_ANTERIOR,DEP_IND_RECOLH_SAL_EDUCACAO,DEP_IND_ORCAMENTO,DEP_ADM_MATERIAL,DEP_COMAR,DEP_DENOMINACAO_COMPLETA,DEP_DENOMINACAO_ABREVIADA,DEP_ID_CENT_EMPRESA,DEP_IE,DEP_HORARIA_ADMINISTRATIVO,DEP_FUSO_HORARIO_BRASILIA,DEP_DT_ABSORCAO_INFRAERO,DEP_TEL_ACHADOS_PERDIDOS,DEP_TEL_BALCAO_INFORMACAO,DEP_TEL_COMUNICACAO_SOCIAL,DEP_NUMERO_TELEFONE_DDD)
VALUES(162,2,'SUPERINTENDÊNCIA REGIONAL DO NORTE','SRNO','AV. JULIO CESAR S/Nº - 1º ANDAR','VAL-DE-CANS',NULL,'PA',66115970,9132106011,9132106000,9132571577,'352294016203',NULL,NULL,1,NULL,NULL,NULL,NULL,TO_DATE('2010-02-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'),'ATO ADM 572/PR/2010 E IP 035/PRPG/2010',NULL,NULL,NULL,NULL,1402,0,NULL,'SRNO','N',NULL,NULL,NULL,'SUPERINTENDÊNCIA REGIONAL DO NROTE','SUPERINT. REGIONAL DO NORTE',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL);
INSERT INTO DEPENDENCIAS (DEP_CODIGO,DEP_TIPO,DEP_NOME,DEP_SIGLA,DEP_ENDERECO_LOGRADOURO,DEP_ENDERECO_BAIRRO,DEP_ENDERECO_MUNICIPIO,DEP_UFE_SIGLA,DEP_ENDERECO_CEP,DEP_NUMERO_TELEFONE_1,DEP_NUMERO_TELEFONE_2,DEP_NUMERO_FAX,DEP_NUMERO_CGC,DEP_ABA_BAN_CODIGO,DEP_ABA_CODIGO,DEP_DEP_CODIGO,DEP_CODIGO_UGD,DEP_RGE_CODIGO,CD_DEPENDENCIA_CHAVE,DEP_IN_CATEGORIA_AEROPORTO,DEP_DATA_CRIACAO,DEP_DS_DOCUMENTO_CRIACAO,DEP_DATA_EXTINCAO,DEP_DS_DOCUMENTO_EXTINCAO,DEP_MSG_CNTCHQUE,DEP_DEP_CODIGO_VINCULA_PGTO,DEP_MUN_CODIGO,DEP_GRUPOS_DEPENDENCIAS,IN_OPB_AUTOMATICA,DEP_SIGLA_ANTERIOR,DEP_IND_RECOLH_SAL_EDUCACAO,DEP_IND_ORCAMENTO,DEP_ADM_MATERIAL,DEP_COMAR,DEP_DENOMINACAO_COMPLETA,DEP_DENOMINACAO_ABREVIADA,DEP_ID_CENT_EMPRESA,DEP_IE,DEP_HORARIA_ADMINISTRATIVO,DEP_FUSO_HORARIO_BRASILIA,DEP_DT_ABSORCAO_INFRAERO,DEP_TEL_ACHADOS_PERDIDOS,DEP_TEL_BALCAO_INFORMACAO,DEP_TEL_COMUNICACAO_SOCIAL,DEP_NUMERO_TELEFONE_DDD)
VALUES(163,2,'SUPERINTENDÊNCIA REGIONAL DO SUL','SRSU','AVENIDA DOS ESTADOS, 747','SÃO JOÃO',NULL,'RS',90200000,5133714076,5133712000,5133714461,'352294016386',NULL,NULL,1,NULL,NULL,NULL,NULL,TO_DATE('2010-01-25 00:00:00', 'YYYY-MM-DD HH24:MI:SS'),'ATO ADM 240/PR/2010 E IP Nº 22/PRPG/2010',NULL,NULL,NULL,NULL,14902,0,NULL,'SRSU','N',NULL,NULL,NULL,'SUPERINTENDÊNCIA REGIONAL DO SUL','SUPERINT. REGIONAL DO SUL',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL);
INSERT INTO DEPENDENCIAS (DEP_CODIGO,DEP_TIPO,DEP_NOME,DEP_SIGLA,DEP_ENDERECO_LOGRADOURO,DEP_ENDERECO_BAIRRO,DEP_ENDERECO_MUNICIPIO,DEP_UFE_SIGLA,DEP_ENDERECO_CEP,DEP_NUMERO_TELEFONE_1,DEP_NUMERO_TELEFONE_2,DEP_NUMERO_FAX,DEP_NUMERO_CGC,DEP_ABA_BAN_CODIGO,DEP_ABA_CODIGO,DEP_DEP_CODIGO,DEP_CODIGO_UGD,DEP_RGE_CODIGO,CD_DEPENDENCIA_CHAVE,DEP_IN_CATEGORIA_AEROPORTO,DEP_DATA_CRIACAO,DEP_DS_DOCUMENTO_CRIACAO,DEP_DATA_EXTINCAO,DEP_DS_DOCUMENTO_EXTINCAO,DEP_MSG_CNTCHQUE,DEP_DEP_CODIGO_VINCULA_PGTO,DEP_MUN_CODIGO,DEP_GRUPOS_DEPENDENCIAS,IN_OPB_AUTOMATICA,DEP_SIGLA_ANTERIOR,DEP_IND_RECOLH_SAL_EDUCACAO,DEP_IND_ORCAMENTO,DEP_ADM_MATERIAL,DEP_COMAR,DEP_DENOMINACAO_COMPLETA,DEP_DENOMINACAO_ABREVIADA,DEP_ID_CENT_EMPRESA,DEP_IE,DEP_HORARIA_ADMINISTRATIVO,DEP_FUSO_HORARIO_BRASILIA,DEP_DT_ABSORCAO_INFRAERO,DEP_TEL_ACHADOS_PERDIDOS,DEP_TEL_BALCAO_INFORMACAO,DEP_TEL_COMUNICACAO_SOCIAL,DEP_NUMERO_TELEFONE_DDD)
VALUES(164,2,'SUPERINTENDENCIA REGIONAL DO CENTRO-LESTE','SRCE','PC GAGO COUTINHO, S/N','AEROPORTO',NULL,'BA',41520970,7132041130,7132041010,7132041030,'352294016467',NULL,NULL,1,NULL,NULL,NULL,NULL,TO_DATE('2010-03-31 00:00:00', 'YYYY-MM-DD HH24:MI:SS'),'ATO ADM 965/PR/2010 E IP 061/PRPG/2010',NULL,NULL,NULL,NULL,27408,0,NULL,'SRCE','N',NULL,NULL,NULL,'SUPERINTENDENCIA REGIONAL DO CENTRO-LESTE','SEPERINTENDENCIA REGIONAL DO CENTRO-LESTE',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL);


SELECT  'UPDATE DEPENDENCIAS SET dep_sigla = '''|| dep_sigla || ''', dep_numero_cgc = '''|| dep_numero_cgc || ''', dep_in_categoria_aeroporto = ' || NVL(dep_in_categoria_aeroporto, 'NULL') || ', dep_numero_telefone_2 = ' || NVL(TO_CHAR(dep_numero_telefone_2), 'NULL') || ', dep_grupos_dependencias= ' || NVL(TO_CHAR(dep_grupos_dependencias), 'NULL') || ', cd_dependencia_chave = ''' || cd_dependencia_chave || ''', DEP_DEP_CODIGO = ' || DEP_DEP_CODIGO || ', DEP_NOME = ''' || DEP_NOME || ''', DEP_DATA_CRIACAO = TO_DATE('''|| TO_CHAR(DEP_DATA_CRIACAO, 'DD/MM/YYYY') || ''', ''DD/MM/YYYY''), DEP_DS_DOCUMENTO_CRIACAO = ''' || DEP_DS_DOCUMENTO_CRIACAO || ''', DEP_DENOMINACAO_COMPLETA = ''' || DEP_DENOMINACAO_COMPLETA || ''', DEP_DENOMINACAO_ABREVIADA = ''' || DEP_DENOMINACAO_ABREVIADA || ''' WHERE DEP_CODIGO= '|| DEP_CODIGO || ' AND DEP_DATA_EXTINCAO IS NULL ;'
FROM    IFRDBA2.TMP_DEP
WHERE   DEP_CODIGO NOT IN (1, 7,8,9,12,13,34,35,36,51,52,53,117,24,26,33,57,71,72,74,97,149,10,22,28,15,16,20,50,54,80,86,93)
  AND   DEP_DATA_EXTINCAO IS NULL
  AND   DEP_DATA_CRIACAO >= TO_DATE('10/01/2010','DD/MM/YYYY')
/



SELECT  *
FROM    IFRDBA2.TMP_DEP
WHERE   DEP_CODIGO NOT IN (1, 7,8,9,12,13,34,35,36,51,52,53,117,24,26,33,57,71,72,74,97,149,10,22,28,15,16,20,50,54,80,86,93)
  AND   DEP_DATA_EXTINCAO IS NULL
  AND   DEP_DATA_CRIACAO >= TO_DATE('10/01/2010','DD/MM/YYYY')
MINUS
SELECT  *
FROM    DEPENDENCIAS
--WHERE   DEP_CODIGO IN (158,159)
WHERE   DEP_CODIGO NOT IN (1, 7,8,9,12,13,34,35,36,51,52,53,117,24,26,33,57,71,72,74,97,149,10,22,28,15,16,20,50,54,80,86,93)
AND     DEP_DATA_EXTINCAO IS NULL
/

--*********************************************************************************************************
--encerrar as uor ativas
--*********************************************************************************************************
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 158/PR/2010 E IP Nº 007/PRPG/2010' WHERE UOR_DEP_CODIGO = 2 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');     
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 158/PR/2010, IP 007/PRPG/2010' WHERE UOR_DEP_CODIGO = 2 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');         
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 361/PR/2010 E IP Nº 23/PRPG/2010' WHERE UOR_DEP_CODIGO = 4 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');      
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 158/PR/2010, IP 007/PRPG/2010' WHERE UOR_DEP_CODIGO = 5 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');         
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM Nº 361/PR/2010 E IP Nº 023/PRPG/2010' WHERE UOR_DEP_CODIGO = 6 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');  
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 158/PR/2010, IP 007/PRPG/2010' WHERE UOR_DEP_CODIGO = 11 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');        
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 362/PR/2010, IP 027/PRPG/2010' WHERE UOR_DEP_CODIGO = 14 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');        
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 158/PR/2010, IP 007/PRPG/2010' WHERE UOR_DEP_CODIGO = 17 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');        
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 462/PR/2010' WHERE UOR_DEP_CODIGO = 17 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');                          
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 158/PR/2010, IP 007/PRPG/2010' WHERE UOR_DEP_CODIGO = 18 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');        
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 158/PR/2010, IP 007/PRPG/2010' WHERE UOR_DEP_CODIGO = 19 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');        
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 361/PR/2010 E IP Nº 23/PRPG/2010' WHERE UOR_DEP_CODIGO = 21 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');     
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 158/PR/2010, IP 007/PRPG/2010' WHERE UOR_DEP_CODIGO = 23 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');        
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM Nº 361/PR/2010 E IP Nº 023/PRPG/2010' WHERE UOR_DEP_CODIGO = 25 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY'); 
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 158/PR/2010 E IP Nº 007/PRPG/2010' WHERE UOR_DEP_CODIGO = 27 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');    
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM Nº 361/PR/2010 E IP Nº 023/PRPG/2010' WHERE UOR_DEP_CODIGO = 29 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY'); 
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM Nº 361/PR/2010 E IP Nº 023/PRPG/2010' WHERE UOR_DEP_CODIGO = 30 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY'); 
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 361/PR/2010 E IP Nº 23/PRPG/2010' WHERE UOR_DEP_CODIGO = 31 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');     
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 362/PR/2010, IP 027/PRPG/2010' WHERE UOR_DEP_CODIGO = 32 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');        
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 158/PR/2010 E IP Nº 007/PRPG/2010' WHERE UOR_DEP_CODIGO = 37 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');    
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 158/PR/2010 E IP Nº 007/PRPG/2010' WHERE UOR_DEP_CODIGO = 38 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');    
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 158/PR/2010 E IP Nº 007/PRPG/2010' WHERE UOR_DEP_CODIGO = 39 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');    
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 361/PR/2010 E IP Nº 23/PRPG/2010' WHERE UOR_DEP_CODIGO = 40 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');     
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 361/PR/2010 E IP Nº 23/PRPG/2010' WHERE UOR_DEP_CODIGO = 41 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');     
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM Nº 361/PR/2010 E IP Nº 023/PRPG/2010' WHERE UOR_DEP_CODIGO = 42 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY'); 
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM Nº 361/PR/2010 E IP Nº 023/PRPG/2010' WHERE UOR_DEP_CODIGO = 43 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY'); 
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM Nº 361/PR/2010 E IP Nº 023/PRPG/2010' WHERE UOR_DEP_CODIGO = 44 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY'); 
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 361/PR/2010 E IP Nº 23/PRPG/2010' WHERE UOR_DEP_CODIGO = 45 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');     
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 361/PR/2010 E IP Nº 23/PRPG/2010' WHERE UOR_DEP_CODIGO = 46 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');     
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 361/PR/2010 E IP Nº 23/PRPG/2010' WHERE UOR_DEP_CODIGO = 47 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');     
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 158/PR/2010, IP 007/PRPG/2010' WHERE UOR_DEP_CODIGO = 48 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');        
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 362/PR/2010, IP 027/PRPG/2010' WHERE UOR_DEP_CODIGO = 49 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');        
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 362/PR/2010, IP 027/PRPG/2010' WHERE UOR_DEP_CODIGO = 56 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');        
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 158/PR/2010 E IP Nº 007/PRPG/2010' WHERE UOR_DEP_CODIGO = 58 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');    
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 361/PR/2010 E IP Nº 23/PRPG/2010' WHERE UOR_DEP_CODIGO = 60 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');     
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 158/PR/2010, IP 007/PRPG/2010' WHERE UOR_DEP_CODIGO = 61 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');        
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 158/PR/2010 E IP Nº 007/PRPG/2010' WHERE UOR_DEP_CODIGO = 62 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');    
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 158/PR/2010 E IP Nº 007/PRPG/2010' WHERE UOR_DEP_CODIGO = 63 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');    
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 158/PR/2010, IP 007/PRPG/2010' WHERE UOR_DEP_CODIGO = 64 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');        
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 158/PR/2010 E IP Nº 007/PRPG/2010' WHERE UOR_DEP_CODIGO = 65 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');    
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 158/PR/2010 E IP Nº 007/PRPG/2010' WHERE UOR_DEP_CODIGO = 73 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');    
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 361/PR/2010 E IP Nº 23/PRPG/2010' WHERE UOR_DEP_CODIGO = 75 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');     
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 361/PR/2010 E IP Nº 23/PRPG/2010' WHERE UOR_DEP_CODIGO = 76 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');     
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 158/PR/2010, IP 007/PRPG/2010' WHERE UOR_DEP_CODIGO = 78 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');        
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 361/PR/2010 E IP Nº 23/PRPG/2010' WHERE UOR_DEP_CODIGO = 79 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');     
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 361/PR/2010 E IP Nº 23/PRPG/2010' WHERE UOR_DEP_CODIGO = 81 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');     
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 361/PR/2010 E IP Nº 23/PRPG/2010' WHERE UOR_DEP_CODIGO = 83 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');     
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM Nº 361/PR/2010 E IP Nº 023/PRPG/2010' WHERE UOR_DEP_CODIGO = 84 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY'); 
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 361/PR/2010 E IP Nº 23/PRPG/2010' WHERE UOR_DEP_CODIGO = 87 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');     
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 362/PR/2010, IP 027/PRPG/2010' WHERE UOR_DEP_CODIGO = 88 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');        
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM Nº 361/PR/2010 E IP Nº 023/PRPG/2010' WHERE UOR_DEP_CODIGO = 89 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY'); 
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 362/PR/2010, IP 027/PRPG/2010' WHERE UOR_DEP_CODIGO = 90 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');        
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 158/PR/2010 E IP Nº 007/PRPG/2010' WHERE UOR_DEP_CODIGO = 91 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');    
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 158/PR/2010, IP 007/PRPG/2010' WHERE UOR_DEP_CODIGO = 92 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');        
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM Nº 361/PR/2010 E IP Nº 023/PRPG/2010' WHERE UOR_DEP_CODIGO = 94 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY'); 
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 361/PR/2010 E IP Nº 23/PRPG/2010' WHERE UOR_DEP_CODIGO = 95 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');     
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM Nº 361/PR/2010 E IP Nº 023/PRPG/2010' WHERE UOR_DEP_CODIGO = 96 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY'); 
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM Nº 361/PR/2010 E IP Nº 023/PRPG/2010' WHERE UOR_DEP_CODIGO = 98 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY'); 
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM Nº 361/PR/2010 E IP Nº 023/PRPG/2010' WHERE UOR_DEP_CODIGO = 99 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY'); 
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 362/PR/2010, IP 027/PRPG/2010' WHERE UOR_DEP_CODIGO = 113 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');       
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 158/PR/2010, IP 007/PRPG/2010' WHERE UOR_DEP_CODIGO = 152 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');       
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 158/PR/2010 E IP Nº 007/PRPG/2010' WHERE UOR_DEP_CODIGO = 154 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');   
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 158/PR/2010, IP 007/PRPG/2010' WHERE UOR_DEP_CODIGO = 155 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');       
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 158/PR/2010 E IP Nº 007/PRPG/2010' WHERE UOR_DEP_CODIGO = 156 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');   
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 240/PR/2010 E IP Nº 022/PRPG/2010' WHERE UOR_DEP_CODIGO = 157 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');   
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 158/PR/2010 E IP Nº 007/PRPG/2010' WHERE UOR_DEP_CODIGO = 158 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');   
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 361/PR/2010 E IP 023/PRPG/2010' WHERE UOR_DEP_CODIGO = 159 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');      
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 362/PR/2010, IP 027/PRPG/2010' WHERE UOR_DEP_CODIGO = 160 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');       
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 158/PR/2010 E IP Nº 007/PRPG/2010' WHERE UOR_DEP_CODIGO = 161 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');  
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 361/PR/2010 E IP Nº 23/PRPG/2010' WHERE UOR_DEP_CODIGO = 162 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');    
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 240/PR/2010, IP 022/PRPG/2010' WHERE UOR_DEP_CODIGO = 163 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');       
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM Nº 362/PR/2010 E IP Nº 027/PRPG/2010' WHERE UOR_DEP_CODIGO = 164 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 361/PR/2010 E IP Nº 23/PRPG/2010' WHERE UOR_CODIGO = 11322;
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM Nº 362/PR/2010 E IP Nº 027/PRPG/2010' WHERE UOR_CODIGO = 11323;
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 240/PR/2010, IP 022/PRPG/2010' WHERE UOR_DEP_CODIGO = 13 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');        
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM Nº 362/PR/2010 E IP Nº 027/PRPG/2010' WHERE UOR_DEP_CODIGO = 15 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY'); 

UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM Nº 362/PR/2010 E IP Nº 027/PRPG/2010' WHERE UOR_DEP_CODIGO = 16 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY'); 
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM Nº 362/PR/2010 E IP Nº 027/PRPG/2010' WHERE UOR_DEP_CODIGO = 20 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY'); 
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM Nº 362/PR/2010 E IP Nº 027/PRPG/2010' WHERE UOR_DEP_CODIGO = 50 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY'); 
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM Nº 362/PR/2010 E IP Nº 027/PRPG/2010' WHERE UOR_DEP_CODIGO = 54 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY'); 
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM Nº 362/PR/2010 E IP Nº 027/PRPG/2010' WHERE UOR_DEP_CODIGO = 80 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY'); 
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM Nº 362/PR/2010 E IP Nº 027/PRPG/2010' WHERE UOR_DEP_CODIGO = 86 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY'); 
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM Nº 362/PR/2010 E IP Nº 027/PRPG/2010' WHERE UOR_DEP_CODIGO = 93 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY'); 

UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 362/PR/2010, IP 027/PRPG/2010' WHERE UOR_DEP_CODIGO = 10 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');        
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 362/PR/2010, IP 027/PRPG/2010' WHERE UOR_DEP_CODIGO = 22 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');        
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 362/PR/2010, IP 027/PRPG/2010' WHERE UOR_DEP_CODIGO = 28 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');        


--*********************************************************************************************************
--copiar as novas uor
--*********************************************************************************************************
select  *
--delete
from    unidades_organizacionais
--UPDATE unidades_organizacionais SET uor_data_extincao=NULL, uor_ds_documento_extincao = NULL
where   uor_data_extincao is not null
and     uor_data_criacao >= to_date('14/01/2010','DD/MM/YYYY')
and     uor_dep_codigo not in (1, 7,8,9,12,13,34,35,36,51,52,53,117,24,26,33,57,71,72,74,97,149,10,22,28,15,16,20,50,54,80,86,93)
and     uor_codigo != 10983
and     uor_ds_documento_extincao like 'EXTINTA A PEDIDO DA DARH%'

EXECUTAR UOR2.SQL
--***********
select  *
from    ifrdba2.tmp_uor
where   uor_data_extincao is null
and     uor_data_criacao >= to_date('14/01/2010','DD/MM/YYYY')
and     uor_dep_codigo in (13);
--*******


with tmp as (
SELECT  uor_codigo
FROM    IFRDBA2.TMP_UOR
WHERE   uor_data_extincao is null
and     UOR_DEP_CODIGO not in (1, 7,8,9,12,13,34,35,36,51,52,53,117,24,26,33,57,71,72,74,97,149,10,22,28,15,16,20,50,54,80,86,93)
AND     UOR_DATA_CRIACAO >= TO_DATE('14/01/2010','DD/MM/YYYY')
MINUS
select  uor_codigo
from    unidades_organizacionais
where   uor_data_extincao is null
and     uor_data_criacao >= to_date('14/01/2010','DD/MM/YYYY')
and     uor_dep_codigo not in (1, 7,8,9,12,13,34,35,36,51,52,53,117,24,26,33,57,71,72,74,97,149,10,22,28,15,16,20,50,54,80,86,93) )
select  *
from    IFRDBA2.TMP_UOR
where uor_codigo in ( select uor_codigo from tmp )


SELECT 'UPDATE unidades_organizacionais SET UOR_SIGLA = '''||UOR_SIGLA ||''', uor_endereco_bairro = ''' || uor_endereco_bairro || ''', uor_endereco_municipio = ''' || uor_endereco_municipio || ''', uor_dep_codigo_vincula_pgto = ' || uor_dep_codigo_vincula_pgto || ', uor_tipo_unidad_org= ' || uor_tipo_unidad_org || ',UOR_NOME = '''|| UOR_NOME || ''', uor_dep_codigo = ' || uor_dep_codigo || ', uor_nome_abreviado = ''' || uor_nome_abreviado || ''', uor_data_criacao = TO_DATE(''' || TO_CHAR(uor_data_criacao, 'DD/MM/YYYY') || ''', ''DD/MM/YYYY''), uor_ds_documento_criacao =''' || uor_ds_documento_criacao || ''' WHERE UOR_CODIGO = ' ||UOR_CODIGO||';' 
FROM ( 
select  *
from    IFRDBA2.TMP_UOR2
MINUS
select  *
from    unidades_organizacionais
where   uor_data_extincao is null
and     uor_data_criacao >= to_date('14/01/2010','DD/MM/YYYY')
and     uor_dep_codigo not in (1, 7,8,9,12,13,34,35,36,51,52,53,117,24,26,33,57,71,72,74,97,149,10,22,28,15,16,20,50,54,80,86,93) )



select  *
from    unidades_organizacionais
where   uor_data_extincao is null
and     uor_data_criacao >= to_date('14/01/2010','DD/MM/YYYY')
and     uor_dep_codigo not in (1, 7,8,9,12,13,34,35,36,51,52,53,117,24,26,33,57,71,72,74,97,149,10,22,28,15,16,20,50,54,80,86,93)
MINUS
select  *
from    IFRDBA2.TMP_UOR
where		uor_dep_codigo not in (1, 7,8,9,12,13,34,35,36,51,52,53,117,24,26,33,57,71,72,74,97,149,10,22,28,15,16,20,50,54,80,86,93)

--*********************************************************************************************************
--HISTORICO DEPENDENCIAS
--*********************************************************************************************************
DELETE FROM HISTORICO_DEPENDENCIAS
WHERE   HDE_DEP_CODIGO NOT IN (1, 7,8,9,12,13,34,35,36,51,52,53,117,24,26,33,57,71,72,74,97,149,10,22,28,15,16,20,50,54,80,86,93)
/

INSERT INTO HISTORICO_DEPENDENCIAS
SELECT * FROM IFRDBA2.TMP_HIST_DEP
WHERE   HDE_DEP_CODIGO NOT IN (1, 7,8,9,12,13,34,35,36,51,52,53,117,24,26,33,57,71,72,74,97,149,10,22,28,15,16,20,50,54,80,86,93)
/

--*********************************************************************************************************
--AREA DE ATUAÇÃO UOR
--*********************************************************************************************************
executar auo_uor.sql

--*********************************************************************************************************
--caso seja necessário extiguir UOR
--*********************************************************************************************************
SELECT 'UPDATE unidades_organizacionais SET  uor_data_extincao = TO_DATE(''' || TO_CHAR(uor_data_extincao, 'DD/MM/YYYY') || ''', ''DD/MM/YYYY''), uor_ds_documento_extincao =''' || uor_ds_documento_extincao || ''' WHERE UOR_CODIGO = ' ||UOR_CODIGO||';' 
FROM ( 
select  *
from    IFRDBA2.TMP_UOR
WHERE UOR_CODIGO IN (11097,11321,11575,12360)
)

SELECT  'UPDATE DEPENDENCIAS SET dep_data_extincao=NULL, dep_ds_documento_extincao=NULL WHERE DEP_CODIGO= '|| DEP_CODIGO || ';'
FROM    IFRDBA2.TMP_DEP
WHERE   DEP_CODIGO IN (17)
  AND   DEP_DATA_CRIACAO >= TO_DATE('10/01/2010','DD/MM/YYYY')
/

--*******************************************************************************************************
--QUADRO FUNCOES
--*******************************************************************************************************

select * from ifrsrh.historicos_funcoes_lotacoes 
where hfl_uor_codigo  in (
select  uor_codigo
from    ifrdba2.tmp_uor
where   uor_data_extincao is null
and     uor_data_criacao >= to_date('14/01/2010','DD/MM/YYYY')
and     uor_dep_codigo in (13)
);

select * from quadro_funcoes
where qfu_hfl_uor_codigo  in (
select  uor_codigo
from    ifrdba2.tmp_uor
where   uor_data_extincao is null
and     uor_data_criacao >= to_date('14/01/2010','DD/MM/YYYY')
and     uor_dep_codigo in (13)
);

----migração de uma UOR
UPDATE  UNIDADES_ORGANIZACIONAIS 
SET     uor_data_extincao = SYSDATE
  ,     uor_ds_documento_extincao = 'ATO ADM 965/PR/2010 E IP 061/PRPG/2010' 
WHERE   UOR_DEP_CODIGO = 15 
  AND   UOR_DATA_EXTINCAO IS NULL; 


select  DISTINCT *
from    ifrdba2.tmp_uor
where   uor_data_extincao is null
and     uor_data_criacao >= to_date('14/01/2010','DD/MM/YYYY')
and     uor_dep_codigo in (15);


DELETE FROM HISTORICO_DEPENDENCIAS
WHERE   HDE_DEP_CODIGO IN (15)
/

INSERT INTO HISTORICO_DEPENDENCIAS
SELECT * FROM IFRDBA2.TMP_HIST_DEP
WHERE   HDE_DEP_CODIGO IN (15)
/

select * 
from quadros_funcoes_dependencias
where qfd_hfd_dep_codigo = 15

select * from ifrsrh.historicos_funcoes_lotacoes 
where hfl_uor_codigo  in (
select  uor_codigo
from    ifrdba2.tmp_uor
where   uor_data_extincao is null
and     uor_data_criacao >= to_date('14/01/2010','DD/MM/YYYY')
and     uor_dep_codigo in (15)
);

select * from quadro_funcoes
where qfu_hfl_uor_codigo  in (
select  uor_codigo
from    ifrdba2.tmp_uor
where   uor_data_extincao is null
and     uor_data_criacao >= to_date('14/01/2010','DD/MM/YYYY')
and     uor_dep_codigo in (15)
);

--CHECK
select  *
from    unidades_organizacionais
where   uor_data_extincao is null
--and     uor_data_criacao >= to_date('14/01/2010','DD/MM/YYYY')
and     uor_dep_codigo in (15)

--*****************************************************************************************************************
--********************************
--*****************************************************************************************************************
--********************************
--*****************************************************************************************************************
SELECT  'UPDATE DEPENDENCIAS SET dep_sigla = '''|| dep_sigla || ''', dep_numero_cgc = '''|| dep_numero_cgc || ''', dep_in_categoria_aeroporto = ' || NVL(dep_in_categoria_aeroporto, 'NULL') || ', dep_numero_telefone_2 = ' || NVL(TO_CHAR(dep_numero_telefone_2), 'NULL') || ', dep_grupos_dependencias= ' || NVL(TO_CHAR(dep_grupos_dependencias), 'NULL') || ', cd_dependencia_chave = ''' || cd_dependencia_chave || ''', DEP_NOME = ''' || DEP_NOME || ''', DEP_DATA_CRIACAO = TO_DATE('''|| TO_CHAR(DEP_DATA_CRIACAO, 'DD/MM/YYYY') || ''', ''DD/MM/YYYY''), DEP_DS_DOCUMENTO_CRIACAO = ''' || DEP_DS_DOCUMENTO_CRIACAO || ''', DEP_DENOMINACAO_COMPLETA = ''' || DEP_DENOMINACAO_COMPLETA || ''', DEP_DENOMINACAO_ABREVIADA = ''' || DEP_DENOMINACAO_ABREVIADA || ''' WHERE DEP_CODIGO= '|| DEP_CODIGO || ' AND DEP_DATA_EXTINCAO IS NULL ;'
FROM    IFRDBA2.TMP_DEP
WHERE   DEP_CODIGO in (7,8,9,12,34,35,36,51,52,53,117,57,24,26,33,71,72,74,97,149)
  AND   DEP_DATA_EXTINCAO IS NULL
  AND   DEP_DATA_CRIACAO >= TO_DATE('10/01/2010','DD/MM/YYYY')
/


UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 240/PR/2010 E IP Nº 22/PRPG/2010' WHERE UOR_DEP_CODIGO = 7 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');         
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 240/PR/2010 E IP Nº 22/PRPG/2010' WHERE UOR_DEP_CODIGO = 8 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');         
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 240/PR/2010 E IP Nº 22/PRPG/2010' WHERE UOR_DEP_CODIGO = 9 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');         
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 240/PR/2010 E IP Nº 22/PRPG/2010' WHERE UOR_DEP_CODIGO = 12 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');        
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 240/PR/2010 E IP Nº 22/PRPG/2010' WHERE UOR_DEP_CODIGO = 34 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');        
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 240/PR/2010 E IP Nº 22/PRPG/2010' WHERE UOR_DEP_CODIGO = 35 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');        
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 240/PR/2010 E IP Nº 22/PRPG/2010' WHERE UOR_DEP_CODIGO = 36 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');        
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 240/PR/2010 E IP Nº 22/PRPG/2010' WHERE UOR_DEP_CODIGO = 51 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');        
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 240/PR/2010 E IP Nº 22/PRPG/2010' WHERE UOR_DEP_CODIGO = 52 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');        
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 240/PR/2010 E IP Nº 22/PRPG/2010' WHERE UOR_DEP_CODIGO = 53 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');        
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 240/PR/2010 E IP Nº 22/PRPG/2010' WHERE UOR_DEP_CODIGO = 117 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');       
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 240/PR/2010 E IP Nº 22/PRPG/2010' WHERE UOR_DEP_CODIGO = 57 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');    
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 240/PR/2010 E IP Nº 22/PRPG/2010' WHERE UOR_DEP_CODIGO = 24 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');    
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 240/PR/2010 E IP Nº 22/PRPG/2010' WHERE UOR_DEP_CODIGO = 26 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');        
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 240/PR/2010 E IP Nº 22/PRPG/2010' WHERE UOR_DEP_CODIGO = 33 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');    
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 240/PR/2010 E IP Nº 22/PRPG/2010' WHERE UOR_DEP_CODIGO = 71 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');    
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 240/PR/2010 E IP Nº 22/PRPG/2010' WHERE UOR_DEP_CODIGO = 72 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');    
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 240/PR/2010 E IP Nº 22/PRPG/2010' WHERE UOR_DEP_CODIGO = 74 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');    
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 240/PR/2010 E IP Nº 22/PRPG/2010' WHERE UOR_DEP_CODIGO = 97 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');    
UPDATE UNIDADES_ORGANIZACIONAIS SET uor_data_extincao = SYSDATE,  uor_ds_documento_extincao = 'ATO ADM 240/PR/2010 E IP Nº 22/PRPG/2010' WHERE UOR_DEP_CODIGO = 149 AND     UOR_DATA_EXTINCAO IS NULL AND     UOR_DATA_CRIACAO < TO_DATE('14/01/2010','DD/MM/YYYY');   




select  *
from    ifrdba2.tmp_uor
where   uor_data_extincao is null
and     uor_data_criacao >= to_date('14/01/2010','DD/MM/YYYY')
and     uor_dep_codigo in (7,8,9,12,34,35,36,51,52,53,117,57,24,26,33,71,72,74,97,149);


select  *
--delete
from    unidades_organizacionais
--UPDATE unidades_organizacionais SET uor_data_extincao=NULL, uor_ds_documento_extincao = NULL
where   uor_data_extincao is not null
and     uor_data_criacao >= to_date('14/01/2010','DD/MM/YYYY')
and     uor_dep_codigo in (7,8,9,12,34,35,36,51,52,53,117,57,24,26,33,71,72,74,97,149)
and     uor_ds_documento_extincao like 'EXTINTA A PEDIDO DA DARH%'



DELETE FROM HISTORICO_DEPENDENCIAS
WHERE   HDE_DEP_CODIGO IN (7,8,9,12,34,35,36,51,52,53,117,57,24,26,33,71,72,74,97,149);


INSERT INTO HISTORICO_DEPENDENCIAS
SELECT * FROM IFRDBA2.TMP_HIST_DEP
WHERE   HDE_DEP_CODIGO IN (7,8,9,12,34,35,36,51,52,53,117,57,24,26,33,71,72,74,97,149);


SELECT a.hfd_dep_codigo, a.hfd_data_vigencia, a.hfd_documento_legal
  FROM ifrsrh.historicos_funcoes_dependencia a
  WHERE a.hfd_dep_codigo IN (7,8,9,12,34,35,36,51,52,53,117,57,24,26,33,71,72,74,97,149);

select * 
from quadros_funcoes_dependencias
where qfd_hfd_dep_codigo IN (7,8,9,12,34,35,36,51,52,53,117,57,24,26,33,71,72,74,97,149);


  
select * from ifrsrh.historicos_funcoes_lotacoes 
where hfl_uor_codigo  in (
select  uor_codigo
from    ifrdba2.tmp_uor
where   uor_data_extincao is null
and     uor_data_criacao >= to_date('14/01/2010','DD/MM/YYYY')
and     uor_dep_codigo IN (7,8,9,12,34,35,36,51,52,53,117,57,24,26,33,71,72,74,97,149)
);

select * from quadro_funcoes
where qfu_hfl_uor_codigo  in (
select  uor_codigo
from    ifrdba2.tmp_uor
where   uor_data_extincao is null
and     uor_data_criacao >= to_date('14/01/2010','DD/MM/YYYY')
and     uor_dep_codigo IN (7,8,9,12,34,35,36,51,52,53,117,57,24,26,33,71,72,74,97,149)
);

