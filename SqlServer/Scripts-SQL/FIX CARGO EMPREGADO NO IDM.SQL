DECLARE

CURSOR C1 IS
SELECT  CAD.EMP_NUMERO_CPF
     ,  CAD.EMP_NUMERO_MATRICULA
     ,  IDM.NME_CARGO NOME_CARGO_ANTIGO
     ,  REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(INITCAP(DECODE(CAD.EMP_QFU_FUN_CODIGO, NULL, (SELECT CAR_NOME FROM CARGOS WHERE CAR_CODIGO = CAD.EMP_QLP_CAR_CODIGO AND CAR_CODIGO_NIVEL = CAD.EMP_QLP_CAR_CODIGO_NIVEL AND CAR_OCC_CODIGO = CAD.EMP_QLP_CAR_OCC_CODIGO) , (SELECT FUN_NOME FROM CARGOS_CONFIANCA WHERE FUN_CODIGO = CAD.EMP_QFU_FUN_CODIGO))), ' Da ', ' da '), ' De ', ' de '), ' Do ', ' do '), ' Dos ', ' dos '), ' Das ', ' das '), ' E ', ' e '), 'Ii', 'II'), 'Iii', 'III'), 'iV', 'IV'), 'IIi', 'III'), 'Iv', 'IV') NOME_CARGO_NOVO
FROM    CADASTROS CAD
   ,    TAB_INTERFACE_IDM IDM
WHERE   CAD.EMP_NUMERO_CPF = TO_NUMBER(IDM.NUM_CPF)
  AND   CAD.EMP_STATUS IN (0,1)
  AND   IDM.DSC_SITUACAO_FUNCIONAL = 'A'
  AND   DECODE(CAD.EMP_QFU_FUN_CODIGO, NULL, (SELECT CAR_NOME FROM CARGOS WHERE CAR_CODIGO = CAD.EMP_QLP_CAR_CODIGO AND CAR_CODIGO_NIVEL = CAD.EMP_QLP_CAR_CODIGO_NIVEL AND CAR_OCC_CODIGO = CAD.EMP_QLP_CAR_OCC_CODIGO) , (SELECT FUN_NOME FROM CARGOS_CONFIANCA WHERE FUN_CODIGO = CAD.EMP_QFU_FUN_CODIGO)) != UPPER(IDM.NME_CARGO);
  
  
BEGIN

	FOR X IN C1 LOOP
			  
			 UPDATE  IFRCORP.TAB_INTERFACE_IDM
			    SET  NME_CARGO = X.NOME_CARGO_NOVO
			  WHERE  TO_NUMBER(NUM_CPF) = X.EMP_NUMERO_CPF;
	END LOOP;
	
END;
/

--COMMIT;