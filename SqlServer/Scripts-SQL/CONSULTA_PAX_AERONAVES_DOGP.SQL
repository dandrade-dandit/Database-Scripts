--CONSULTA DE PAX POR PERÍODO
DECLARE		@ANO_REF INT
,			@MES_REF SMALLINT
,			@DIA_INI_REF TINYINT
,			@DIA_FIM_REF TINYINT

SELECT		@ANO_REF = 2007
,			@MES_REF = 4
,			@DIA_INI_REF = 2
,			@DIA_FIM_REF = 9


SELECT		DES.SIGLA_AEROPORTO
,			DES.MES
,			DES.DIA
,			DES.QTD_PAX_DESEMBARQUE
,			DES.QTD_PAX_CONEXAO_DESEMBARQUE
,			EMB.QTD_PAX_EMBARQUE
,			EMB.QTD_PAX_ISENTO_COLO_EMBARQUE
,			EMB.QTD_PAX_ISENTA_TRANSITO_EMBARQUE
,			EMB.QTD_PAX_CONEXAO_EMBARQUE
,			EMB.QTD_PAX_ISENTA_OUTRAS_EMBARQUE
  FROM		(
			SELECT		SIGLA_AEROPORTO
			,			MONTH(DATA_HORA_EFETIVA_POUSO) AS MES
			,			DAY(DATA_HORA_EFETIVA_POUSO) AS DIA
			,			SUM(DESEMB_PASSAGEIRO_DOM+DESEMB_PASSAGEIRO_INT) AS QTD_PAX_DESEMBARQUE
			,			SUM(TRANSITO_CONEXAO_DOM+TRANSITO_CONEXAO_INT) AS QTD_PAX_CONEXAO_DESEMBARQUE
			  FROM		BIOGER.dbo.BIOGER_RPE_DES
			 WHERE		YEAR(DATA_HORA_EFETIVA_POUSO) = @ANO_REF
			   AND		MONTH(DATA_HORA_EFETIVA_POUSO) = @MES_REF
			   AND		DAY(DATA_HORA_EFETIVA_POUSO) BETWEEN @DIA_INI_REF AND @DIA_FIM_REF
			 GROUP
				BY      SIGLA_AEROPORTO
			,			MONTH(DATA_HORA_EFETIVA_POUSO)
			,			DAY(DATA_HORA_EFETIVA_POUSO)
			) AS DES
,			(
			SELECT		SIGLA_AEROPORTO
			,			MONTH(DATA_HORA_EFETIVA_DECOLAGEM) AS MES
			,			DAY(DATA_HORA_EFETIVA_DECOLAGEM) AS DIA
			,			SUM(EMB_TARIFA_PAGA_BILHETE_DOM+EMB_TARIFA_PAGA_BILHETE_INT+EMB_TARIFA_PAGA_CHECKIN_DOM+EMB_TARIFA_PAGA_CHECKIN_INT) AS QTD_PAX_EMBARQUE
			,			SUM(EMB_ISENTA_COLO) AS QTD_PAX_ISENTO_COLO_EMBARQUE
			,			SUM(EMB_ISENTA_TRANSITO) AS QTD_PAX_ISENTA_TRANSITO_EMBARQUE
			,			SUM(EMB_ISENTA_CONEXAO_DOM+EMB_ISENTA_CONEXAO_INT) AS QTD_PAX_CONEXAO_EMBARQUE
			,			SUM(EMB_ISENTA_OUTRAS) AS QTD_PAX_ISENTA_OUTRAS_EMBARQUE
			  FROM		BIOGER.dbo.BIOGER_RPE_EMB
			 WHERE		YEAR(DATA_HORA_EFETIVA_DECOLAGEM) = @ANO_REF
			   AND		MONTH(DATA_HORA_EFETIVA_DECOLAGEM) = @MES_REF
			   AND		DAY(DATA_HORA_EFETIVA_DECOLAGEM) BETWEEN @DIA_INI_REF AND @DIA_FIM_REF
			 GROUP
				BY      SIGLA_AEROPORTO
			,			MONTH(DATA_HORA_EFETIVA_DECOLAGEM)
			,			DAY(DATA_HORA_EFETIVA_DECOLAGEM)
			) AS EMB
 WHERE		DES.SIGLA_AEROPORTO	=	EMB.SIGLA_AEROPORTO
   AND		DES.MES				=	EMB.MES
   AND		DES.DIA				=	EMB.DIA
 ORDER
    BY		DES.SIGLA_AEROPORTO
,			DES.MES
,			DES.DIA




--CONSULTA DE AERONAVES POR PERÍODO
DECLARE		@ANO_REF INT
,			@MES_REF SMALLINT
,			@DIA_INI_REF TINYINT
,			@DIA_FIM_REF TINYINT

SELECT		@ANO_REF = 2007
,			@MES_REF = 4
,			@DIA_INI_REF = 2
,			@DIA_FIM_REF = 9


SELECT		DES.SIGLA_AEROPORTO
,			DES.MES
,			DES.DIA
,			DES.QTD_POUSO_DESEMBARQUE
,			EMB.QTD_POUSO_EMBARQUE
  FROM		(
			SELECT		SIGLA_AEROPORTO
			,			MONTH(DATA_HORA_EFETIVA_POUSO) AS MES
			,			DAY(DATA_HORA_EFETIVA_POUSO) AS DIA
			,			COUNT(1) AS QTD_POUSO_DESEMBARQUE
			  FROM		BIOGER.dbo.BIOGER_RPE_DES
			 WHERE		YEAR(DATA_HORA_EFETIVA_POUSO) = @ANO_REF
			   AND		MONTH(DATA_HORA_EFETIVA_POUSO) = @MES_REF
			   AND		DAY(DATA_HORA_EFETIVA_POUSO) BETWEEN @DIA_INI_REF AND @DIA_FIM_REF
			 GROUP
				BY      SIGLA_AEROPORTO
			,			MONTH(DATA_HORA_EFETIVA_POUSO)
			,			DAY(DATA_HORA_EFETIVA_POUSO)
			) AS DES
,			(
			SELECT		SIGLA_AEROPORTO
			,			MONTH(DATA_HORA_EFETIVA_DECOLAGEM) AS MES
			,			DAY(DATA_HORA_EFETIVA_DECOLAGEM) AS DIA
			,			COUNT(1) AS QTD_POUSO_EMBARQUE
			  FROM		BIOGER.dbo.BIOGER_RPE_EMB
			 WHERE		YEAR(DATA_HORA_EFETIVA_DECOLAGEM) = @ANO_REF
			   AND		MONTH(DATA_HORA_EFETIVA_DECOLAGEM) = @MES_REF
			   AND		DAY(DATA_HORA_EFETIVA_DECOLAGEM) BETWEEN @DIA_INI_REF AND @DIA_FIM_REF
			 GROUP
				BY      SIGLA_AEROPORTO
			,			MONTH(DATA_HORA_EFETIVA_DECOLAGEM)
			,			DAY(DATA_HORA_EFETIVA_DECOLAGEM)
			) AS EMB
 WHERE		DES.SIGLA_AEROPORTO	=	EMB.SIGLA_AEROPORTO
   AND		DES.MES				=	EMB.MES
   AND		DES.DIA				=	EMB.DIA
 ORDER
    BY		DES.SIGLA_AEROPORTO
,			DES.MES
,			DES.DIA