
DTH_PRI_ENT_MOV  --   @DTH_PRI_ENT_MOV

DTH_ULT_SAI_MOV  --   @DTH_ULT_SAI_MOV


SELECT COUNT(1)
  FROM [IEOP].[dbo].[IEOP_DESEMBARQUE]
  WHERE DTH_MIGRACAO > '20150917'
    AND [DTH_ULT_SAI_MOV] IS NULL

SELECT COUNT(1)
  FROM [IEOP].[dbo].[IEOP_EMBARQUE]
  WHERE DTH_MIGRACAO > '20150917'
    AND DTH_PRI_ENT_MOV IS NULL
    
    
/****** Script for SelectTopNRows command from SSMS  ******/
SELECT COUNT(1)
  FROM [dbo].[IEOP_EMBARQUE_TEMP]
 WHERE FLG_MIGRADO = 1

SELECT COUNT(1)
  FROM [dbo].[IEOP_DESEMBARQUE_TEMP]
 WHERE FLG_MIGRADO = 1

SELECT COUNT(1)
  FROM [dbo].[IEOP_MOVIMENTACAO_TEMP]
 WHERE FLG_MIGRADO = 1
 
 
--BEGIN TRAN
SELECT	DES.COD_STATUS
     ,	DES.SIG_AEROPORTO
	 ,	DES.DTH_PRI_MOV
	 ,	DES.DTH_PRI_ENT_MOV
	 ,  DES.DTH_ULT_SAI_MOV
	 ,  EMB.DTH_ULT_SAI_MOV
	 ,  DES.DTH_ULT_MOV
	 --UPDATE [dbo].[IEOP_DESEMBARQUE] SET DTH_ULT_SAI_MOV = EMB.DTH_ULT_SAI_MOV
  FROM	[dbo].[IEOP_DESEMBARQUE] DES
     ,	[dbo].[IEOP_EMBARQUE] EMB
 WHERE	DES.SIG_AEROPORTO = EMB.SIG_AEROPORTO
   AND  DES.COD_STATUS = EMB.COD_STATUS
   AND  DES.DTH_ULT_SAI_MOV IS NULL

SELECT	EMB.COD_STATUS
     ,	EMB.SIG_AEROPORTO
	 ,	EMB.DTH_PRI_MOV
	 ,	EMB.DTH_PRI_ENT_MOV
	 ,	DES.DTH_PRI_ENT_MOV
	 ,  EMB.DTH_ULT_SAI_MOV
	 ,  EMB.DTH_ULT_MOV
	 --UPDATE [dbo].[IEOP_EMBARQUE] SET DTH_PRI_ENT_MOV = DES.DTH_PRI_ENT_MOV
  FROM	[dbo].[IEOP_DESEMBARQUE] DES
     ,	[dbo].[IEOP_EMBARQUE] EMB
 WHERE	DES.SIG_AEROPORTO = EMB.SIG_AEROPORTO
   AND  DES.COD_STATUS = EMB.COD_STATUS
   AND  EMB.DTH_PRI_ENT_MOV IS NULL

--COMMIT TRAN
--ROLLBACK TRAN


--EMBARCADOS
/*

/****** Script for SelectTopNRows command from SSMS  ******/
SELECT  
       [SIG_AEROPORTO] AS SIGLA_AEROPORTO_OPERACAO
      ,[NUM_VOO] AS NUMERO_DO_VOO
      ,[DTH_NORMAL_DECOLAGEM] AS DATA_HORA_PROGRAMADA_DECOLAGEM
      ,[DTH_EFETIVA_DECOLAGEM] AS DATA_HORA_EFETIA_DECOLAGEM
      ,[SIG_CIA_AEREA_IATA] AS SIGLA_IATA_CIA_AEREA
      ,[NME_CIA_AEREA] AS NOME_CIA_AEREA
      ,[COD_MATRICULA_AERONAVE] AS MATRICULA_AERONAVE
      ,[SIG_EQUIPAMENTO] AS SIGLA_EQUIPAMENTO
      ,[NME_EQUIPAMENTO] AS NOME_EQUIPAMENTO
      ,([QTD_TARIFA_PAGA_BILHETE_DOM_EMB] + [QTD_TARIFA_PAGA_CHECKIN_DOM_EMB]) AS QTDE_PAX_EMBARCADOS_DOMENSTICO
      ,([QTD_TARIFA_PAGA_BILHETE_INT_EMB] + [QTD_TARIFA_PAGA_CHECKIN_INT_EMB]) AS QTDE_PAX_EMBARCADOS_INTERNACIONAL
	  ,[QTD_ISENTA_CONEXAO_EMB_DOM] AS QTDE_PAX_EMBARCADOS_EM_CONEXAO_DOMENSTICO
	  ,[QTD_ISENTA_CONEXAO_EMB_INT] AS QTDE_PAX_EMBARCADOS_EM_CONEXAO_INTERNACIONAL
      ,([QTD_ISENTA_COLO_EMB] + [QTD_ISENTA_TRANSITO_EMB] + [QTD_ISENTA_OUTRAS_EMB]) AS QTDE_PAX_EMBARCADOS_ISENTOS
      ,[SIG_AEROPORTO_DESTINO] AS SIGLA_AEROPORTO_DESTINO
      ,[NUM_BOX] AS POSICAO_BOX_UTILIZADO
      ,CASE [NME_PONTE] 
		WHEN '' THEN 'POSIÇÃO REMOTA'
		ELSE [NME_PONTE]
	   END AS PONTE_EMBARQUE_UTILIZADO
      ,CASE ISNULL([NUM_PORTAO], '0')
		WHEN '0' THEN 'NÃO INFORMADO'
		ELSE [NUM_PORTAO]
	   END AS PONTAO_DE_EMBARQUE_UTILIZADO
      ,[DSC_PISTA_DECOLAGEM] AS CABECEIRA_PARA_DECOLAGEM
	  ,[DTH_PRI_MOV] AS DATA_HORA_POUSO
      ,[DTH_PRI_ENT_MOV] AS DATA_HORA_ENTRADA_CALCO
      ,[DTH_ULT_SAI_MOV] AS DATA_HORA_SAIDA_CALCO
	  ,[DTH_ULT_MOV] AS DATA_HORA_DECOLAGEM
	  ,CASE ISNULL([NUM_CATEGORIA_VOO_EMB_VINCULADO], '0')
	      WHEN '0' THEN 'VOO PRINCIPAL'
		  ELSE 'CODESHARE'
	  END VOO_VINCULADO
	  ,[COD_STATUS] AS CODIGO_INTERNO_SISTEMA_PARA_UNIR_POUSO_DECOLAGENS
  FROM [IEOP].[dbo].[IEOP_EMBARQUE]
 WHERE [SIG_AEROPORTO] = 'SBSP'
   AND YEAR([DTH_NORMAL_DECOLAGEM]) = 2015
   AND MONTH([DTH_NORMAL_DECOLAGEM]) = 7
   AND [NUM_GRUPO_VOO_EMB] = 1
   AND [TIP_STATUS] <> 3

*/

--DESEMBARCADOS
/*

/****** Script for SelectTopNRows command from SSMS  ******/
SELECT  
       [SIG_AEROPORTO] AS SIGLA_AEROPORTO_OPERACAO
      ,[NUM_VOO] AS NUMERO_DO_VOO
      ,[DTH_NORMAL_POUSO] AS DATA_HORA_PROGRAMADA_POUSO
      ,[DTH_EFETIVA_POUSO] AS DATA_HORA_EFETIA_POUSO
      ,[SIG_CIA_AEREA_IATA] AS SIGLA_IATA_CIA_AEREA
      ,[NME_CIA_AEREA] AS NOME_CIA_AEREA
      ,[COD_MATRICULA_AERONAVE] AS MATRICULA_AERONAVE
      ,[SIG_EQUIPAMENTO] AS SIGLA_EQUIPAMENTO
      ,[NME_EQUIPAMENTO] AS NOME_EQUIPAMENTO
      ,[QTD_PAX_DESEMB_DOM] AS QTDE_PAX_DESEMBARCADOS_DOMENSTICO
      ,[QTD_PAX_DESEMB_INT] AS QTDE_PAX_DESEMBARCADOS_INTERNACIONAL
      ,[QTD_CON_TRANSITO_DOM] AS QTDE_PAX_DESEMBARCADOS_EM_CONEXAO_DOMENSTICO
      ,[QTD_CON_TRANSITO_INT] AS QTDE_PAX_DESEMBARCADOS_EM_CONEXAO_INTERNACIONAL
      ,[SIG_AEROPORTO_PROCEDENCIA] AS SIGLA_AEROPORTO_PROCEDENCIA
      ,[NUM_BOX] AS POSICAO_BOX_UTILIZADO
      ,CASE [NME_PONTE] 
		WHEN '' THEN 'POSIÇÃO REMOTA'
		ELSE [NME_PONTE]
	   END AS PONTE_EMBARQUE_UTILIZADO
      ,CASE ISNULL([NUM_ESTEIRA], '0')
		WHEN '0' THEN 'NÃO INFORMADO'
		ELSE [NUM_ESTEIRA]
	   END AS ESTEIRA_UTILIZADA
      ,[DSC_PISTA_POUSO] AS CABECEIRA_PARA_POUSO
	  ,[DTH_PRI_MOV] AS DATA_HORA_POUSO
      ,[DTH_PRI_ENT_MOV] AS DATA_HORA_ENTRADA_CALCO
      ,[DTH_ULT_SAI_MOV] AS DATA_HORA_SAIDA_CALCO
	  ,[DTH_ULT_MOV] AS DATA_HORA_DECOLAGEM
	  ,CASE ISNULL([NUM_CATEGORIA_VOO_DESEMB_VINCULADO], '0')
	      WHEN '0' THEN 'VOO PRINCIPAL'
		  ELSE 'CODESHARE'
	   END VOO_VINCULADO
	  ,[COD_STATUS] AS CODIGO_INTERNO_SISTEMA_PARA_UNIR_POUSO_DECOLAGENS
  FROM [IEOP].[dbo].[IEOP_DESEMBARQUE]
 WHERE [SIG_AEROPORTO] = 'SBSP'
   AND YEAR([DTH_NORMAL_POUSO]) = 2015
   AND MONTH([DTH_NORMAL_POUSO]) = 7
   AND [NUM_GRUPO_VOO_DESEMB] = 1
   AND [TIP_STATUS] <> 3


*/