teca


SELECT aer_cod AS COD_DEP, 
       TO_CHAR (data_recebimento, 'mm') AS MES,
       TO_CHAR (data_recebimento, 'rrrr') AS ANO, 
       MODALIDADE,
       SUM (peso) / 1000 AS PESO 
  FROM viw_tempo_medio_recebimento 
 WHERE data_recebimento >= TO_DATE('01/01/2012', 'DD/MM/RRRR')
 GROUP BY aer_cod , TO_CHAR (data_recebimento, 'mm'), TO_CHAR (data_recebimento, 'rrrr'), MODALIDADE
 
 
 *********************

--GRANT DE SELECT NO ORACLE PARA O USUÁRIO: USR_CORP_SQLSERVER

--DELETE FROM IFRCORP..CIA_TRANSP_PASSAGEIROS

--INSERT INTO IFRCORP..CIA_TRANSP_PASSAGEIROS
SELECT 	COD_VEICULO,
  			COD_AEROPORTO,
  			(SELECT DSC_VEICULO FROM IFRCIA.TAB_TIPOS_VEICULOS WHERE COD_VEICULO = DESC_TIPO_VEIC) DESC_TIPO_VEIC,
  			QTD_VEIC,
  			NOM_EMP_RESP
	-- INTO	CIA_TRANSP_PASSAGEIROS
FROM  	IFRCIA.CAD_TRANSP_PASSAGEIROS 
ORDER 
   BY 	COD_AEROPORTO; --CORPORATIVO..



--DELETE FROM IFRCORP..CIA_AEROPORTOS

--INSERT INTO IFRCORP..CIA_AEROPORTOS
SELECT  A.COD_AEROPORTO,   -- CODIGO DO AEROPORTO
        NOM_AEROPORTO,	-- NOME DO AEROPORTO  
        SIG_ICAO,   -- SIGLA ICAO DO AEROPORTO
        SIG_IATA,   -- SIGLA IATA DO AEROPORTO
        DSC_DOC_DESIG,   -- DOCUMENTO DE DESIGNAÇÃO
        DAT_DOC_DESIG,   -- DATA DO DOCUMENTO DE DESIGNAÇÃO
        DSC_ORG_ADMIN,   -- ORGÃOS ADMINISTRATIVOS
				NOM_PROPRIET,   -- PROPRIETÁRIO DO AEROPORTO
				DSC_ORG_OFICIAIS,   -- ORGÃO OFICIAIS
				DSC_DOC_HOMOLOG,   -- DOCUMENTO DE HOMOLOGAÇÃO
				ARP_DAT_DOC_HOMOLOG,   -- DATA DO DOCUMENTO DE HOMOLOGAÇÃO
        HOR_FUNCION,   -- HORÁRIO DE FUNCIONAMENTO
        HOR_OPERAC,   -- HORÁRIO DE FUNCIONAMENTO OPERACIONAL  
        HOR_ADM,   -- HORÁRIO DE FUNCIONAMENTO DA ADMINISTRAÇÃO
        HOR_COMERC,   -- HORÁRIO DE FUNCIONAMENTO COMERCIAL
        TAM_TOT_AREA,   -- AREA TOTAL DO AEROPORTO
        TAM_AREA_CIVIL,   -- AREA CIVIL CONFORME ANEXO 14 OACI
        TAM_AREA_A_LEGALIZ,   -- AREA A LEGALIZAR
        TAM_AREA_MILITAR,   -- AREA MILITAR
        TAM_AREA_NAO_LEGALIZ,   -- AREA NÃO LEGALIZADA
        TAM_AREA_EM_REGULARIZ,   -- AREA EMREGULARIZAÇÃO
        TAM_AREA_LEGALIZ,   -- AREA LEGALIZADA
        TAM_AREA_REGULARIZ,   -- AREA REGULARIZADA
        TIP_REFER_PISTA_NUM_CLAS,   -- NUMERO DA CLASSE DE REFERÊNCIA DA PISTA
				TIP_REFER_PISTA_LETRA_CLAS,   -- LETRA DA CLASSE DE REFERÊNCIA DA PISTA
				DSC_CLAS_COM_AERON,   -- CLASSE DE COMUNICAÇÃO AERONÁUTICA
				DSC_DOC_CLAS_COM_AERON,   -- DOCUMENTO DA CLASSE DE COMUNICAÇÃO AERONÁUTICA
				DAT_CLAS_COM_AERON,   -- DATA DO DOCUMENTO DA CLASSE DE COMUNICAÇÃO AERONAUTIC
        TIP_CATEG_TARIF,   -- CATEGORIA TARIFARIA
        DSC_DOC_CATEG_TARIF,   -- DOCUMENTO DA CATEGORIA TARIFÁRIA
				DAT_CATEG_TARIF,   -- DATA DO DOCUMENTO DA CATEGORIA TARIFARIA
				DSC_PLAN_ZONEAM_RUIDO,   -- PLANO DE ZONEAMENTO DE RUIDO
				DSC_DOC_PLAN_ZONEAM_RUIDO,   -- DOCUMENTO DE PLANO DE ZONEAMENTO E RUIDO
				DSC_PLAN_ZONEAM_PROTEC,   -- PLANO DE ZONEMANTO DE PROTEÇÃO
				DSC_DOC_PLAN_ZONEAM_PROTEC,   -- DOCUMENTO DE PLANO  ZONEAMENTO DE PROTEÇÃO
				DSC_CATEG_CONT_INCED_DISP,   -- CATEGORIA CONTRA INCENDIO DISPONÍVEL
				DSC_DOC_CATEG_CONT_INCED_DISP,   -- DOCUMENTO DE CATEGORIA CONTRA INCENDIO DISPONÍVEL
				DSC_UTIL_AEROD,   -- UTILIZAÇÃO DO AERÓDROMO
        TIP_OPERACAO,   -- TIPO DE OPERAÇÕES
        DSC_DOC_TIP_OPERAC,   -- DOCUMENTO TIPO OPERACIONAL
        DSC_DIST_DIREC_AEROP_CID,   -- CATEGORIA CONTRA INCÊNDIO DISPONÍVEL
        DSC_TIP_MED_PERC,   -- TEMPO MÉDIO DE PERCURSO
        TIP_AV_DOM,   -- AVIAÇÃO DOMÉSTICA
        ARP_AV_INT,   -- AVIAÇÃO INTERNACIONAL
        TIP_AV_REGION,   -- AVIAÇÃO REGIONAL
        TIP_AV_GERAL,   -- AVIAÇÃO GERAL
        TIP_AV_MILITAR,   -- AVIAÇÃO MILITAR
        DSC_PONTO_REF,   -- PONTO DE REFERÊNCIA
        DSC_ALTITUDE,   -- ALTITUDE DO AEROPORTO
        QTD_FUNC_EFET_ADM,   --	QUANTIDADE DE FUNCIONÁRIOS EFETIVOS DA ÁREA ADMINISTRATIVA
				QTD_FUNC_EFET_OPER,   --	QUANTIDADE DE FUNCIONÁRIOS EFETIVOS DA ÁREA DE OPERAÇÃO
				QTD_FUNC_EFET_MANUT,   --	QUANTIDADE DE FUNCIONÁRIOS EFETIVOS DA ÁREA DE MANUTENÇÃO
				QTD_FUNC_PREST_SERV,   --	QUANTIDADE DE FUNCIONÁRIOS PRESTADORES DE SERVIÇOS
				QTD_FUNC_CRED_CIAS_AER,   --	QUANTIDADE DE FUNCIONÁRIOS CREDENCIADOS DAS CIAS. AÉREAS
				QTD_FUNC_CRED_COMERC,   --	QUANTIDADE DE FUNCIONÁRIOS CREDENCIADOS DA ÁREA COMERCIAL
				QTD_FUNC_CRED_OUT,   --	QUANTIDADE DE FUNCIONÁRIOS CREDENCIADOS OUTROS
				TAM_COMP_VIAS_ACESSO_DEM_ED,   -- COMPRIMENTO DAS VIAS DE ACESSO AS DEMAIS EDIFICAÇÕES
				TAM_LARG_VIAS_ACESSO_DEM_ED,   -- LARGURA DA VIA DE ACESSO DAS DEMAIS  EDIFICAÇÕES
				DSC_OBS_SISTEM_VIARIO,   -- OBSERVAÇÕES RELATIVAS AO  SISTEMA VIÁRIO
				QTD_PONTES_EMB,   -- QUANTIDADE DE PONTES DE EMBARQUE
				QTD_PAVIMENTOS,   -- QUANTIDADE DE PAVIMENTOS
				TAM_AREA_PONTES_EMB,   -- AREA DE PONTES DE EMBARQUE
				TAM_AREA_PAVIMENTOS,   -- AREA DE PAVIMENTOS
				QTD_NIVEIS_OPER,   -- QUANTIDADE DE NÍVEIS OPERACIONAIS
				TAM_AREA_NIVEIS_OPER,   -- AREA NIVEIS OPERACIONAIS
				QTD_PISO_TECNICO,   -- QUANTIDADE DE PISO TÉCNICO
				TAM_AREA_PISO_TECNICO,   -- AREA DO PISO TECNICO
				QTD_PISO_OPER_DESEMB,   -- UANTIDADE DE PISO OPERACIONAL NO DESEMBARQUE
				TAM_AREA_PISO_OPER_DESEMB,   -- AREA DO PISO OPERACIONAL DE DESEMBARQUE
				QTD_PISO_OPER_EMB,   -- QUANTIDADE DE PISO OPERACIONAL NO EMBARQUE
				TAM_AREA_PISO_OPER_EMB,   -- AREA DO PISO OPERCIONAL DE EMBARQUE
				QTD_PISO_TERR_PANOR,   -- QUANTIDADE DE PISO TERRAÇO PANORÂMICO
				TAM_AREA_PISO_TERR_PANOR,   -- AREA DO PISO DE TERRAÇO PANORÂMICO
				QTD_TOT_AREA_CONST,   -- AREA TOTAL CONTRUIDA
				QTD_MONIT_SAG_DESEMB,   -- QUANTIDADE DE MONITOR DE PLASMA NO SAGUÃO DE DESEMBARQUE
				QTD_MONIT_SL_DESEMB_DOM,   -- QUANTIDADE  DE MONITOR DE PLASMA NA SALA DE DESEMBARQUE DOMÉSTICO
				QTD_MONIT_SL_DESEMB_INT,   -- QUANTIDADE  DE MONITOR DE PLASMA NA SALA DE DESEMBARQUE INTERNACIONAL
				QTD_MONIT_SAG_EMB,   -- QUANTIDADE DE MONITOR DE PLASMA NO SAGUÃO DE EMBARQUE
				QTD_MONIT_SL_EMB_DOM,   -- QUANTIDADE DE MONITOR DE PLASMA NA SALA DE EMBARQUE DOMÉSTICO
				QTD_MONIT_SL_EMB_INT,   -- QUANTIDADE DE MONITOR DE PLASMA NA SALA DE EMBARQUE INTERNACIONAL
				QTD_MONIT_EMB_REV_DOMINT,   -- QUANTIDADE DE MONITOR PLASMA NO SAGUÃO DE EMBARQUE REVERSÍVEL DOMÉSTICO INTERNACIONAL
				QTD_MONIT_TERR_PANOM,   -- QUANTIDADE DE MONITOR NO TERRAÇO PANORÂMICO
				FLG_SINAL_VERT_PORT_EMB,   -- SINAL VERTICAL DE PORTÃO DE EMBARQUE
				FLG_SINAL_VERT_EMB_DOMINT,   -- SINAL VERTICAL DE EMBARQUE DOMÉSTICO INTERNACIONAL
				FLG_SINAL_VERT_DESEMB_DOMINT,   --	SINAL VERTICAL DE DESEMBARQUE DOMÉSTICO E INTERNACIONAL
				FLG_SINAL_VERT_INDIC_CIAS_AER,   --	SINAL VERTICAL DE CIAS AÉREAS
				FLG_SINAL_VERT_ESTACION,   -- SINAL VERTICAL DE ESTACIONAMENTO
				FLG_SINAL_VERT_EMB_DESEMB,   --	SINAL VERTICAL DE EMBARQUE E DESEMBARQUE
				FLG_SINAL_VERT_RESTAUT,   -- SINAL VERTICAL DE RESTAURANTES
				FLG_SINAL_VERT_LANCHONETE,   -- SINAL VERTICAL DE LANCHONETE
				FLG_SINAL_VERT_CAMBIO,   -- SINAL VERTICAL DE CAMBIO
				FLG_SINAL_VERT_FARMACIA,   --	SINAL VERTICAL DE FARMÁCIA
				FLG_SINAL_VERT_BALC_INF,   --	SINAL VERTICAL DO BALCÃO DE INFORMAÇÕES
				FLG_SINAL_VERT_SERV_PUBLICO,   --	SINAL VERTICAL DE SERVIÇO PÚBLICO
				FLG_SINAL_VERT_CORREIOS,   -- SINAL VERTICAL DE CORREIOS
				FLG_SINAL_VERT_TELEFONES,   -- SINAL VERTICAL DE TELEFONES
				FLG_SINAL_VERT_ACH_PERD,   --	SINAL VERTICAL DE ACHADOS E PERDIDOS
				FLG_SINAL_VERT_GUARD_VOL,   --	SINAL VERTICAL DE GUARDA VOLUME
				FLG_SINAL_VERT_SANIT_FEM,   --	SINAL VERTICAL DE SANITARIO FEMININO
				FLG_SINAL_VERT_SANIT_MASC,   --	SINAL VERTICAL DE SANITARIO MASCULINO
				FLG_SINAL_VERT_INF_DEFICIENT,   -- SINAL VERTICAL DE INFORMAÇÕES A DEFICIENTES
				FLG_SINAL_VERT_PROIB_FUMAR,   --	SINAL VERTICAL DE PROIBIDO  FUMAR
				FLG_SINAL_VERT_ACESS_REST,   --	SIANL VERTICAL DE ACESSO AO RESTAURANTE
				FLG_SINAL_VERT_ENT_PROIB,   --	SINAL VERTICAL DE ENTRADA PROIBIDA
				VOL_CARR_BAG_DESEMB_DOM_QTD,   --	QUANTIDADE DE CARROSSEL DE BAGAGEM DE DESEMBARQUE DOMÉSTICO
				VOL_CARR_BAG_DESEMB_DOM_DIAM,   --	DIAMETRO DA AREA DE CARROSSEL DE BAGAGENS DESEMBARQUE DOMÉSTICO
				VOL_CARR_BAG_DESEMB_INTER_QTD,   -- QUANTIDADE DE CARROSSEL DE BAGAGEM DE DESEMBARQUE INTERNACIONAL
				VOL_CARR_BAG_DESEMB_INTER_DIAM,   -- DIAMETRO DA AREA DE CARROSSEL DE BAGAGENS DESEMBARQUE INTERNACIONAL
				TAM_AREA_TRIAG_MAN_EMB_DOM,   -- AREA DE TRIAGEM E MANUSEIO DE BAGAGENS NO EMBARQUE DOMÉSTICO
				TAM_AREA_TRIAG_MAN_EMB_INT,   -- AREA DE TRIAGEM E MANUSEIO DE BAGAGENS NO EMBARQUE INTERNACIONAL
				TAM_AREA_TRIAG_MAN_DESEMB_DOM,   --	AREA DE TRIAGEM E MANUSEIO DE BAGAGENS NO DESEMBARQUE DOMÉSTICO
				TAM_AREA_TRIAG_MAN_DESEMB_INT,   --	AREA DE TRIAGEM E MANUSEIO DE BAGAGENS NO DESEMBARQUE INTERNACIONAL
				ARP_PONT_EMB_FIXA_QTD,   --	QUANTIDADE DE PONTE DE EMBARQUE FIXA
				ARP_PONT_EMB_MOV_QTD,   -- QUANTIDADE DE PONTE DE EMBARQUE MOVEL
				TAM_AREA_ARM_CARG_IMP,   -- AREA DE CARGAS DE IMPORTAÇÃO
				TAM_AREA_ARM_CARG_EXP,   -- AREA DE CARGA  ESPECIAL EXPLOSIVA
				TAM_AREA_ARM_PERDIM,   -- AREA DE CARGA DE PERDIMENTO
				TAM_AREA_ARM_CARG_ESP_PEREC,   -- AREA DE ARMAZENAGEM DE CARGAS ESPECIAIS PERECIVEIS
				TAM_AREA_ARM_CARG_ESP_VIVA,   -- AREA DE CARGA ESPECIAL VIVA
				TAM_AREA_ARM_CARG_ESP_REST,   -- AREA DE ARMAZENAGEM DE CARGA ESPECIAL RESTRITA
				TAM_AREA_DEP_CARG_PERIG_RADIO,   -- AREA DE DEPOSITO DE CARGAS RADIOATIVAS PERIGOSAS
				TAM_AREA_DEP_CARG_PERIG_EXPL,   -- AREA DE DEPOSITO DE CARGAS EXPLOSIVAS PERIGOSAS
				TAM_AREA_DEP_CARG_PERIG_ION,   -- AERA DE DEPOSITO DE CARGAS IONIZANTES PERIGOSAS
				TAM_AREA_MOV_RECEB_DIVERSOS,   -- AREA DE RECEBIMENTO DIVERSOS
				TAM_AREA_MOV_ENTREGA,   -- AREA DE MOVIMENTAÇÃO E ENTREGA
				TAM_AREA_ESC_ADM_RECEIT_INFRA,   -- AREA DO ESCRITORIO DA RECEITA FEDERAL
				TAM_AREA_REC_FEDERAL,   -- AREA DA RECEITA FEDERAL
				TAM_AREA_ESC_ANVISA,   -- AREA DO ESCRITORIA DA ANVISA
				TAM_AREA_DOCAS,   -- AREA DE DOCAS
				TAM_AREA_CARGA_TRANS,   -- AREA DE TRANSPORTE DE CARGAS
				TAM_AREA_CIRC,   -- AREA CIRCULAÇÃO
				FLG_ABAST,   -- TIPO DE ABASTECIMENTO
				DSC_OUTROS_TP_ABAST,   -- DESCRIÇÃO DE OUTROS TIPOS DE ABASTECIMENTOS
				TAM_CORREIOS_AREA_EDIF,   -- AREA EDIFICADA DOS CORREIOS
				TAM_CORREIOS_AREA_ESTC_VEIC,   -- AREA DO ESTACIONAMENTO DE VEICULOS DOS CORREIOS
				TAM_CORREIOS_AREA_LOTE,   -- AREA DO LOTE DOS CORREIOS
				FLG_CLIM_SAGUAO_REFRIG,   -- CLIMATIZAÇÃO DO SAGUÃO REFRIGERAÇÃO
				ARP_CLIM_SAGUAO_CALFEF,   -- CLIMATIZAÇÃO DO SAGUÃO CALEFAÇÃO
				FLG_CLIM_SAGUAO_VENT_MEC,   -- 	CLIMATIZAÇÃO DO SAGUÃO VENTILAÇÃO MECÂNICA
				FLG_CLIM_SLEMB_REFRIG,   -- CLIMATIZAÇÃO DA SALA DE EMBARQUE REFRIGERAÇÃO
				FLG_CLIM_SLEMB_CALEF,   -- CLIMATIZAÇÃO DA SALA DE EMBARQUE CALEFAÇÃO
				FLG_CLIM_SLEMB_VENT_MEC,   -- CLIMATIZAÇÃO DA SALA DE EMBARQUE VENTILAÇÃO MECANICA
				FLG_CLIM_SLDESEMB_REFRIG,   -- CLIMATIZAÇÃO DA SALA DE DESEMBARQUE REFRIGERAÇÃO
				FLG_CLIM_SLDESEMB_CALEF,   -- CLIMATIZAÇÃO DA SALA DE DESEMBARQUE CALEFAÇÃO
				FLG_CLIM_SLDESEMB_VENT_MEC,   -- CLIMATIZAÇÃO DA SALA DE DESEMBARQUE VENTILAÇÃO MECÂNICA
				QTD_ELEVADORES_PUB,   -- QUANTIDADE DE ELEVADORES PÚBLICOS
				QTD_ELEVADORES_SERV,   -- QUANTIDADE DE ELEVADORES DE SERVIÇO
				QTD_ESCAD_ROLANTES,   -- QUANTIDADE DE ESCADAS ROLANTES
				QTD_PORT_AUTOM,   -- QUANTIDADE DE PORTAS AUTMÁTICAS
				QTD_TRANSP_BAG_PADRAO,   -- QUANTIDADE DE TRANSPORTADOR DE BAGAGEM PADRÃO
				QTD_TRANSP_BAG_FORA_PADRAO,   -- QUANTIDADE DE TRANSPORTADOR DE BAGAGEM FORA PADRÃO
				QTD_CARRINHOS_BEBE,   -- QUANTIDADE DE CAIXA PARA PRIMEIROS SOCORROS
				QTD_BEBED_PAD,   -- QUANTIDADE DE BEBEDOUROS PADRÃO
				QTD_BEBED_DEF,   -- QUANTIDADE DE BEBEDOUROS PARA DEFICIENTES
				QTD_TEL_PADRAO,   -- TELEFONES PADRÕES
				QTD_TEL_DEF_LOCOM,   -- TELEFONES PARA DEFICIENTES DE LOCOMOÇÃO
				QTD_TEL_DEF_VISUAL,   -- TELEFONES PARA DEFICIENTES VISUAIS
				QTD_TEL_DEF_AUDIT,   -- TELEFONE PARA DEFICIENTES AUDITIVOS
				QTD_RAMPA_ACESSO_PNE,   -- QUANTIDADE DE RAMPAS DE ACESSO PARA DEFICIENTES
				QTD_CAD_RODAS_PNE,   -- QUANTIDADE DE CADEIRA DE RODAS PARA DEFICIENTES
				QTD_SIST_ELEV_EMBDESEMB,   -- QUANTIDADE DE SISTEMA ELEVATÓRIO EMBARQUE E DESEMBARQUE
				FLG_PESS_ATEND_MED,   -- TIPO DE PESSOAL PARA ATENDIMENTO MÉDICO
				TAM_AREA_ATEND_MED,   -- AREA DO POSTO DE ATENDIMENTO MÉDICO
				NOM_EMP_RESP_ATEND_MED,   -- EMPRESA RESPONSÁVEL PELO ATENDIMENTO MÉDICO
				QTD_UTI_MOVEL,   -- QUANTIDADE DE UTI MÓVEL
				TAM_AREA_UTI_MOVEL,   -- AREA DE UTI MOVEL
				QTD_INSTRUM_MEDICO,   -- QUANTIDADE DE INSTRUMENTOS MÉDICOS
				TAM_AREA_INSTRUM_MEDICO,   -- AREA DE INSTRUMENTOS MÉDICOS
				QTD_SL_PEQ_CIRURG,   -- QUANTIDADE DE SALAS PARA PEQUENAS CIRURGIAS
				TAM_AREA_SL_PEQ_CIRURG,   -- AREA DA SALA DE PEQUENAS CIRURGIAS
				QTD_SL_CURATIVOS,   -- QUANTIDADE DE SALA DE CURATIVOS
				TAM_AREA_SL_CURATIVOS,   -- AREA DA SALA DE CURATIVOS
				QTD_ENFERMARIA,   -- QUANTIDADE DE EMFERMARIA
				TAM_AREA_ENFERMARIA,   -- AREA DE EMFERMARIA
				QTD_CX_PRIM_SOCORR,   -- QUANTIDADE DE ELEVADORES PÚBLICOS
				TAM_AREA_CX_PRIM_SOCORR,   -- AREA DE CAIXA DE PRIMEIROS SOCORROS
				TAM_AREA_REM_EMERG_MED,   -- AREA DE REMOÇÃO DE EMERGÊNCIA MÉDICA
				QTD_AMBUL_COMUM,   -- QUANTIDADE DE AMBULÂNCIA COMUM
				QTD_AMBUL_UTI,   -- QUANTIDADE DE AMBULÂNCIA UTI
				FLG_INDIC_DIR_VENTO_CONV,   -- INDICADOR DE DIREÇÃO DO VENTO CONVENCIONAL
				FLG_INDIC_DIR_VENTO_ILUM,   -- INDICADOR DE DIREÇÃO DO VENTO ILUMINADO
				FLG_LANTERN_SINAL_TORRE,   -- LANTERNA DE SINALIZAÇÃO DE TORRE
				FLG_BALIZ_BORDO_PISTA_NAO_PAV,   -- BALIZAMENTO DE PORTO DE PISTA NÃO PAVIMENTADO
				FLG_BALIZ_BORDO_ZONA_PARADA,   -- BALIZAMENTO DE ZONA DE PARADA
				FLG_BALIZ_BORDO_PTAXI_NAO_PAV,   -- BALIZAMENTO DE PORTO DE TAXI NÃO PAVIMENTADO
				FLG_SERV_LIMPEZA_PISTA,   -- POSSUI SERVIÇO DE LIMPEZA DE PISTA
				NOM_EMP_RESP_SERV_LIMPEZA,   -- EMPRESA RESPONSÁVEL PELO SERVIÇO DE LIMPEZA
				QTD_CARRO_LIMPA_PISTA,   -- QUANTIDADE DE CARRO LIMPA PISTA
				QTD_ROCADEIRA,   -- POSSUI ROÇADEIRA
				QTD_VARREDOURA,   -- POSSUI VARRDOURA
				QTD_REABAST_AGUA_POTAVEL,   -- REABASTECIMENTO DE ÁGUA POTÁVEL
				QTD_ENERG_PATIO_MANOBRAS,   -- FONTES DE ENERGIA NO PATIO DE MANOBRAS
				QTD_REABAST_AR_REFRIG,   -- REABASTECIMENTO DE AR REFRIGERADO
				QTD_POS_DOT_SIST_OTICO_ATRAC,   -- POSIÇÕES DOTADAS DE SISTEMA OTICO DE ATRAÇÃO
				ARP_POS_DOT_SIST_ELET_MEC_ATRA,   -- POSIÇÕES DOTADAS DE SISTEMA ELETRO MECANICO DE ATRAÇÃO
				FLG_SNLZH_PAT_POS_ESTACION,   -- SINALIZAÇÃO DE POSICIONAMENTO DE ESTAÇÃO
				FLG_SNLZH_PAT_AREA_SERV,   -- SINALIZAÇÃO DE LOCALIZAÇÃO DE AREA DE SERVIÇO
				FLG_SNLZH_PAT_VIAS_SERV,   -- SINALIZAÇÃO DE VIAS DE SERVIÇO
				FLG_ARRUAM_INT_VIAS_SERV_ACESS,   -- AREA DE ARRUAMENTO INTERNO DE VIAS DE SERVICO DE ACESSO
				DSC_DIM_ARRUAM_INT_VIAS_ACESS,   -- DIMENSÃO DO ARRUAMENTO DE ACESSO DAS VIAS DE SERVIÇO
				FLG_ARRUAM_INT_ACESS_INTERN,   -- AREA DE ARRUAMENTO INTRNO DE ACESSO INTERNACIONAL
				DSC_DIM_ARRUAM_INT_ACESS_INT,   -- DIMENSÃO DO ARRUAMENTO DE ACESSO INTERNO
				DSC_RAMPA_ACESSO_PNE_RESP,   -- RESPONSÁVEL PELA RAMPA DE ACESSO PARA DEFICIENTES
				DSC_CAD_RODAS_PNE_RESP,   -- RESPONSÁVEL PELAS CADEIRAS DE RODAS
				DSC_SIST_ELEV_EMBDESEMB_RESP,   -- RESPONSÁVEL PELO SISTEMA ELEVATÓRIO DE EMBARQUE E DESEMBARQUE
				DSC_HISTORICO,	-- DESCRICAO DO HISTORICO DO AEROPORTO
				TIP_CERTIFICACAO,   -- TIPO DE CERTIFICACAO DA ANAC
				DSC_DOC_TIP_CERTIFICACAO,  -- DESCRICAO DO DOCUMENTO DO TIPO DA CERTIFICACAO
				(QTD_BALC_CHECK_AUT_DOM_INT + QTD_BALC_CHECK_AUT_TRANSF + QTD_BALC_CHECK_AUT_MEIO_FIO + QTD_BALC_CHECK_NAO_AUT_DOM + QTD_BALC_CHECK_NAO_AUT_INT) as QTD_TOTAL_BALC_CHECK_IN, -- QUANTIDADE TOTAL DE CHECK-INS NO AEROPORTO
			  (TAM_CHECK_AUT_DOM_INT + TAM_CHECK_AUT_TRANSF + TAM_CHECK_AUT_MEIO_FIO + TAM_CHECK_NAO_AUT_DOM + TAM_CHECK_NAO_AUT_INT) as TAM_TOTAL_BALC_CHECK_IN, -- TAMANHO TOTAL DE CHECK-INS NO AEROPORTO
			  QTD_CHECK_BALANC_DOM_INT, -- QUANTIDADE TOTAL DE BALANÇAS DE CHECK-INS NO AEROPORTO
			  QTD_CHECK_BALANC_DOM_INT_CAPAC -- CAPACIDADE TOTAL(EM KG) DAS BALANÇAS DE CHECK-INS NO AEROPORTO
	-- INTO	CIA_AEROPORTOS
  FROM  IFRCIA.CAD_AEROPORTOS A 
     ,	IFRCIA.CAD_CHECK_IN C
 WHERE 	A.COD_AEROPORTO = C.COD_AEROPORTO; --CORPORATIVO..

  
--DELETE FROM IFRCORP..CIA_PARQUE_ABASTECIMENTO

--INSERT INTO IFRCORP..CIA_PARQUE_ABASTECIMENTO
SELECT 	ABS.COD_EMP_ABAST, -- CODIGO DA EMPRESA DE ABASTECIMENTO
			  EMP.DSC_EMP_ABAST, -- NOME DA EMPRESA DE ABASTECIMENTO
			  ABS.COD_AEROPORTO, -- CODIGO DO AEROPORTO
			  ABS.TIP_COMBUSTIVEL_ABAST, -- TIPO DE COMBUSTIVEL
			  ABS.VOL_TANCAGEM_ABAST, -- ABASTECIMENTO E TANCAGEM DA EMPRESA
			  ABS.TAM_AREA_LOTE_ABAST -- LOTE DA AREA DE ABASTECIMENTO DA EMPRESA
 -- INTO	CIA_PARQUE_ABASTECIMENTO
 FROM 	IFRCIA.CAD_PARQUE_ABASTECIMENTO ABS
    , 	IFRCIA.TAB_EMP_ABASTECIMENTO EMP
WHERE 	ABS.COD_EMP_ABAST = EMP.COD_EMP_ABAST; --CORPORATIVO..

--DELETE FROM IFRCORP..CIA_CABEC_PISTA_POUSO_DEC

--INSERT INTO IFRCORP..CIA_CABEC_PISTA_POUSO_DEC
SELECT 	COD_AEROPORTO, -- CODIGO DO AEROPORTO
			  DSC_IDENTI_CABEC_PISTA, -- IDENTIFICAÇÃO DA CABECEIRA
			  TAM_DIMENS_STOPWAY, -- DIMENSÃO DA STOPWAY
			  QTD_NAT_PISO_STOPWAY, -- NATUREZA DO PISO DA STOPWAY
			  TAM_DIMENS_CLEARWAY, -- DIMESÃO DA CLEARWAY
			  DSC_DIMENS_FAIXA_PISTA, -- DIMENSÃO DA FAIXA DE PISTA
			  TAM_DIST_EIXOPIST_BORDAPAT, -- DISTANCIA  DO EIXO DA PISTA E BORDA DO PÁTIO
			  DSC_DIMENS_STOPWAY_FONTE, -- FONTE DA DIMENSÃO DA STOPWAY
			  DSC_NAT_PISO_STOPWAY_FONTE, -- FONTE DA NATUREZA DO PISO DA STOPWAY
			  DSC_DIMENS_CLEARWAY_FONTE, -- FONTE DA DIMENSÃO DA CLEARWAY
			  DSC_DIMENS_FX_PISTA_FONTE, -- FONTE DA DIMENSÃO DE FAIXA DE PISTA
			  DSC_DIST_EIXO_BORDA_FONTE, -- FONTE DA DISTANCIA DO EIXO E BORDA
			  TAM_TORA, -- TORA DA CABCEIRA
			  TAM_ASDA, -- DISTANCIA DECLARADA ASDA
			  TAM_TODA, -- TODA DA CABECEIRA
			  TAM_LDA, -- LDA CA CABECEIRA
			  DSC_TORA_FONTE, -- FONTE DA DISTANCIA DECLARADA TORA
			  DSC_ASDA_FONTE, -- FONTE DA DISTANCIA ASDA
			  DSC_TODA_FONTE, -- FONTE DA DISTANCIA DECLARADA TODA
			  DSC_LDA_FONTE, -- FONTE LDA
			  TAM_AREA_GIRO_RAIO, -- RAIO DA ÁREA DE GIRO DA CABECEIRA
			  DSC_AREA_GIRO_OBS, -- OBSERVAÇÃO DA AREA DE GIRO DA CABECEIRA
			  TAM_DIST_CABECEIRA, -- DISTANCIA DA CABECEIRA
			  TAM_DIST_CABEC_RAIO, -- DISTANCIA DA CABECEIRA E O RAIO
			  FLG_VFR, -- VFR DA CABECEIRA
			  FLG_IFR, -- IFR DA CABECEIRA
			  FLG_CATEG_IFR_PREC, -- CATEGORIA IFR DE PRECISÃO
			  CABEC.COD_NAT_PISO, -- CÓDIGO DA NATUREZA DO PISO
			  DESC_NAT.DSC_NAT_PISO -- DESC. DA NATUREZA DO PISO
 -- INTO	CIA_CABEC_PISTA_POUSO_DEC
 FROM 	IFRCIA.CAD_CABEC_PISTA_POUSO_DEC CABEC
    , 	IFRCIA.TAB_NAT_PISO DESC_NAT
WHERE 	CABEC.COD_NAT_PISO = DESC_NAT.COD_NAT_PISO; --CORPORATIVO..
 
 
--DELETE FROM IFRCORP..CIA_PISTAS_POUSO_DEC

--INSERT INTO IFRCORP..CIA_PISTAS_POUSO_DEC 
SELECT 	COD_AEROPORTO, -- CODIGO DO AEROPORTO
			  COD_PISTA_IDENT,  -- IDENTIFICAÇÃO DA PISTA
			  TAM_COMPRIMENTO_PISTA,  -- COMPRIMENTO DA PISTA
			  TAM_LARGURA_PISTA,  -- LARGURA DA PISTA
			  TIP_PISO_PISTA,  -- TIPO DO PISO
			  DSC_RESIST_PISTA,  -- RESISTÊNCIA DA PISTA
			  TAM_ACOST_LARGURA,  -- LARGURA DO ACOSTAMENTO
			  TAM_ACOST_NAT_PISO,  -- NATUREZA DO PISO DO ACOSTAMENTO
			  PISTA.COD_NAT_PISO,  -- CÓDIGO DA NATUREZA DO PISO
			  DESC_NAT.DSC_NAT_PISO  -- DESC. DA NATUREZA DO PISO
 -- INTO	CIA_PISTAS_POUSO_DEC
 FROM 	IFRCIA.CAD_PISTAS_POUSO_DEC PISTA
    , 	IFRCIA.TAB_NAT_PISO DESC_NAT
WHERE  	PISTA.COD_NAT_PISO = DESC_NAT.COD_NAT_PISO;  --CORPORATIVO..
  


/*
SELECT COD_AEROPORTO,  SIG_ICAO,  SIG_IATA,  DAT_DOC_DESIG,  DSC_ORG_ADMIN,  HOR_FUNCION,  HOR_OPERAC,  HOR_ADM,  HOR_COMERC,  TAM_TOT_AREA,  TAM_AREA_CIVIL,  TAM_AREA_A_LEGALIZ,  TAM_AREA_MILITAR,  TAM_AREA_NAO_LEGALIZ,  TAM_AREA_EM_REGULARIZ,
  TAM_AREA_LEGALIZ,  TAM_AREA_REGULARIZ,  TIP_CATEG_TARIF,  DSC_DOC_CATEG_TARIF,  TIP_OPERACAO,  DSC_DOC_TIP_OPERAC,  DSC_DIST_DIREC_AEROP_CID,  DSC_TIP_MED_PERC,  TIP_AV_DOM,  ARP_AV_INT,  TIP_AV_REGION,  TIP_AV_GERAL,  TIP_AV_MILITAR,  DSC_PONTO_REF,
  DSC_ALTITUDE,  QTD_PONTES_EMB,  QTD_PAVIMENTOS,  TAM_AREA_PONTES_EMB,  TAM_AREA_PAVIMENTOS,  QTD_NIVEIS_OPER,  TAM_AREA_NIVEIS_OPER,  QTD_PISO_TECNICO,  TAM_AREA_PISO_TECNICO,  QTD_PISO_OPER_DESEMB,  TAM_AREA_PISO_OPER_DESEMB,  QTD_PISO_OPER_EMB,
  TAM_AREA_PISO_OPER_EMB,  QTD_PISO_TERR_PANOR,  TAM_AREA_PISO_TERR_PANOR,  QTD_TOT_AREA_CONST,  DSC_HISTORICO,  TIP_CERTIFICACAO,  DSC_DOC_TIP_CERTIFICACAO
  INTO CIA_AEROPORTOS
FROM CORPORATIVO..IFRCIA.CAD_AEROPORTOS ;


SELECT COD_AEROPORTO,  COD_PISTA_IDENT,  TAM_COMPRIMENTO_PISTA,  TAM_LARGURA_PISTA,  TIP_PISO_PISTA,  DSC_RESIST_PISTA,  TAM_ACOST_LARGURA,  TAM_ACOST_NAT_PISO,  N.DSC_NAT_PISO
INTO CIA_PISTAS_POUSO_DEC
FROM CORPORATIVO..IFRCIA.CAD_PISTAS_POUSO_DEC P
   , CORPORATIVO..IFRCIA.TAB_NAT_PISO N
WHERE P.COD_NAT_PISO = N.COD_NAT_PISO;


SELECT COD_AEROPORTO,  DSC_IDENTI_CABEC_PISTA,  TAM_DIMENS_STOPWAY,  QTD_NAT_PISO_STOPWAY,  TAM_DIMENS_CLEARWAY,  DSC_DIMENS_FAIXA_PISTA,  TAM_DIST_EIXOPIST_BORDAPAT,  DSC_DIMENS_STOPWAY_FONTE,  DSC_NAT_PISO_STOPWAY_FONTE,  DSC_DIMENS_CLEARWAY_FONTE,  DSC_DIMENS_FX_PISTA_FONTE,  DSC_DIST_EIXO_BORDA_FONTE,  TAM_TORA,  TAM_ASDA,  TAM_TODA,  TAM_LDA,  DSC_TORA_FONTE,  DSC_ASDA_FONTE,
  DSC_TODA_FONTE,  DSC_LDA_FONTE,  TAM_AREA_GIRO_RAIO,  DSC_AREA_GIRO_OBS,  TAM_DIST_CABECEIRA,  TAM_DIST_CABEC_RAIO,  FLG_VFR
  ,  FLG_IFR,  FLG_CATEG_IFR_PREC,  N.DSC_NAT_PISO
  INTO CIA_CABEC_PISTA_POUCO_DEC
FROM CORPORATIVO..IFRCIA.CAD_CABEC_PISTA_POUSO_DEC P
   , CORPORATIVO..IFRCIA.TAB_NAT_PISO N
WHERE P.COD_NAT_PISO = N.COD_NAT_PISO;

SELECT  COD_AEROPORTO
     ,  DSC_DESIG_PATIO
	 ,  DSC_LOCALIZACAO_PATIO
	 ,  DSC_PROFUND_PATIO
	 ,  DSC_AREA
	 ,  DSC_PCN
	 ,  N.DSC_NAT_PISO
	 INTO CIA_PATIOS
FROM CORPORATIVO..IFRCIA.PATIOS  P
   , CORPORATIVO..IFRCIA.TAB_NAT_PISO N
WHERE P.COD_NAT_PISO = N.COD_NAT_PISO;

SELECT  COD_AEROPORTO
     ,  DSC_IDENT_PISTA_TAX
	 ,  TAM_LARG_PISTA_TAX
	 ,  TAM_COMP_PISTA_TAX
	 ,  TAM_ACOSTAM_LARG
	 ,  QTD_ACOSTAM_NAT_PISO
	 ,  DSC_ANG_REL_PISTA_POUSO
	 ,  DSC_RESIST_PAVIM
	 ,  FLG_PISTA_ALTERN
	 ,  DSC_DIST_REL_CABEC
	 ,  N.DSC_NAT_PISO
	 INTO CIA_PISTAS_TAXI
FROM CORPORATIVO..IFRCIA.CAD_PISTAS_TAXI P
   , CORPORATIVO..IFRCIA.TAB_NAT_PISO N
WHERE P.COD_NAT_PISO = N.COD_NAT_PISO;

*/


/*


SELECT	cod_aeroporto,
        (SELECT DEP_SIGLA FROM IFRCORP..DEPENDENCIAS WHERE [DEP_CODIGO] = cod_aeroporto) as sgl_aeroporto,
		ano_recebimento,
		SUM(peso)/1000 peso_total
		INTO TAB_TECA_PESO_ANO
  FROM (
			SELECT	crg_termo.aer_cod cod_aeroporto,
					YEAR(crte_dat_rec) AS ano_recebimento,
					SUM(CASE crte_tip
						WHEN '4' THEN  CONVERT(FLOAT,REPLACE(crte_pes_saldo,',','.')) 
						ELSE  CONVERT(FLOAT,REPLACE(crte_pes_rec,',','.')) 
					END) AS peso
					FROM TECAMANAGER..IFRTECABC.CRG_TERMO
			WHERE	crg_termo.aer_cod NOT IN('002', '026','057')
					AND crte_dat_rec >= '20120101' 
					AND CRTE_VOL_REC > 0
					AND crte_tip <> '5'
					 AND (FLG_REGISTRO_ATIVO = 'S' or FLG_REGISTRO_ATIVO IS NULL)         
			GROUP BY crg_termo.aer_cod,
					 YEAR(crte_dat_rec)
			UNION
			SELECT	aer_cod cod_aeroporto,
					YEAR(crg_dat_rec) AS ano_recebimento,
					 SUM (( CONVERT(FLOAT,REPLACE(crg_pes_ret,',','.'))  + CONVERT(FLOAT,REPLACE(crg_pes,',','.')) )) peso
			FROM	TECAMANAGER..IFRTECABC.CRG_EXPO
			WHERE	crg_dat_rec >= '20120101' 
			  AND	aer_cod NOT IN('002', '026','057')
			GROUP BY aer_cod,
					YEAR(crg_dat_rec)
			UNION
			SELECT	aer_cod cod_aeroporto,
					YEAR(crg_dat_rec) AS ano_recebimento,
					SUM ( CONVERT(FLOAT,REPLACE(crg_pes_rec,',','.')) ) peso
			FROM	TECAMANAGER..IFRTECABC.CRG_HAWB_COURIER
			WHERE	crg_dat_rec >= '20120101' 
			  AND	aer_cod NOT IN('002', '026','057')
			GROUP BY aer_cod,
					YEAR(crg_dat_rec)
			UNION
			SELECT	aer_cod cod_aeroporto,
					YEAR(crg_dat_rec) AS ano_recebimento,
					SUM ( CONVERT(FLOAT,REPLACE(crg_pes_rec,',','.')) ) peso 
			FROM	TECAMANAGER..IFRTECABC.CRG_NAC
			WHERE	aer_cod NOT IN('002', '026','057')
			  AND	crg_dat_rec >= '20120101' 
			GROUP BY aer_cod,
					YEAR(crg_dat_rec)
		) CARGA
GROUP
	BY	cod_aeroporto,
		ano_recebimento
ORDER
	BY	cod_aeroporto,
		ano_recebimento
		
		
		
		CREATE OR REPLACE FORCE VIEW "TECA"."VIW_TEMPO_MEDIO_RECEBIMENTO" ("CRG_AER_COD", "PCG_AER_COD", "CRTE_DAT_REC", "CRG_NUM_TERMO", "PCG_NUM_TERMO", "CRG_HCRG_NUM", "PCG_HCRG_NUM", "DTH_CHEGADA_MANTRA", "CRTE_PES_REC", "CRG_CRG_NUM", "PCG_CRG_NUM", "DATA_REC") AS 
  SELECT crg.aer_cod crg_aer_cod, pcg.aer_cod pcg_aer_cod, crg.crte_dat_rec,
        crg.num_termo crg_num_termo,  pcg.num_termo pcg_num_termo, 
        crg.hcrg_num crg_hcrg_num , pcg.hcrg_num pcg_hcrg_num ,
        crg.dth_chegada_mantra, crte_pes_rec,
        crg.crg_num crg_crg_num, pcg.crg_num pcg_crg_num,data_rec
        FROM crg_termo crg, pcg_imp pcg;

--------------------------------------------------------
--  DDL for View VIW_TEMPO_MEDIO_RECEBIMENTO
--------------------------------------------------------

  CREATE OR REPLACE FORCE VIEW "IFRTECABC"."VIW_TEMPO_MEDIO_RECEBIMENTO" ("MODALIDADE", "CARGA", "HOUSE", "TERMO", "DATA_RECEBIMENTO", "PESO", "AER_COD", "CHEGADA_MANTRA") AS 
  (SELECT   'I' modalidade, crg_termo.crg_num carga,
             crg_termo.hcrg_num house, crg_termo.num_termo termo,
             TO_DATE (crte_dat_rec || ' ' || crte_hor_rec,
                      'DD/MM/YY HH24:mi'
                     ) data_recebimento,
             sum (decode (crte_tip, '4', crte_pes_saldo, crte_pes_rec)) peso, crg_termo.aer_cod aer_cod,
             dth_chegada_mantra chegada_mantra
        FROM crg_termo
       WHERE crg_termo.aer_cod NOT IN('002', '026','057')
         AND crte_dat_rec >= TO_DATE ('01/01/2012', 'DD/MM/YYYY')
         AND CRTE_VOL_REC > 0
         AND crte_tip <> '5'
         AND (FLG_REGISTRO_ATIVO = 'S' or FLG_REGISTRO_ATIVO IS NULL)         
    GROUP BY crg_termo.crg_num,
             crg_termo.hcrg_num,
             crg_termo.num_termo,
             crte_dat_rec,
             crg_termo.aer_cod,
             dth_chegada_mantra,
             crte_hor_rec)
   UNION ALL
   (SELECT   'E' modalidade, crg_num carga, hcrg_num house, crg_dat_rec termo,
             TO_DATE (crg_dat_rec, 'YYYYMMDD') data_recebimento,
             SUM ((crg_pes_ret + crg_pes)) peso, aer_cod, TO_DATE (NULL) chegada_mantra
        FROM crg_expo
       WHERE TO_DATE (crg_dat_rec, 'YYYYMMDD') >=
                                          TO_DATE ('01/01/2012', 'DD/MM/YYYY')
         AND aer_cod NOT IN('002', '026','057')
    GROUP BY crg_num,
             hcrg_num,
             TO_DATE (crg_dat_rec, 'YYYYMMDD'),
             crg_dat_rec,
             aer_cod)
   UNION ALL
   (SELECT   'U' modalidade, TO_CHAR (seq_carga) carga, num_hawb house,
             '' termo, crg_dat_rec data_recebimento, SUM (crg_pes_rec) peso,
             aer_cod, TO_DATE (NULL) chegada_mantra
        FROM crg_hawb_courier
       WHERE crg_dat_rec >= TO_DATE ('01/01/2012 00:00', 'dd/mm/yyyy hh24:mi')
         AND aer_cod NOT IN('002', '026','057')
    GROUP BY TO_CHAR (seq_carga), num_hawb, crg_dat_rec, aer_cod)
   UNION ALL
   (SELECT   'W' modalidade, crg_facn carga, '' house, '' termo,
             crg_dat_rec data_recebimento, SUM (crg_pes_rec) peso, aer_cod,
             TO_DATE (NULL) chegada_mantra
        FROM crg_nac
       WHERE aer_cod NOT IN('002', '026','057')
         AND crg_dat_rec >= TO_DATE ('01/01/2012', 'DD/MM/YYYY')
    GROUP BY crg_facn, crg_dat_rec, aer_cod) ;


*/

--FINCANCEIRO TECA
/*

SELECT	TECA.ano
	 ,	(SELECT DEP_SIGLA FROM IFRCORP..DEPENDENCIAS WHERE [DEP_CODIGO] = TECA.dependencia) as sgl_aeroporto
	 ,	SUM ( vl_jan + vl_fev + vl_mar + vl_abr + vl_mai + vl_jun + vl_jul + vl_ago + vl_set + vl_out + vl_nov + vl_dez ) as total_teca
FROM	(
		Select 
			   convert(char(4),processing_yr) as ano,
			   dependencia,
			   CASE conta
					WHEN '411070014' THEN	'DAI - FATURADA'
					WHEN '411070025' THEN	'DAI - A VISTA'
					WHEN '411080018' THEN	'DAPE - FATURADA'
					WHEN '411080029' THEN	'DAPE - A VISTA'
					WHEN '411090012' THEN	'DAE - FATURADA'
					WHEN '411090023' THEN	'DAE - A VISTA'
					WHEN '411150011' THEN	'TECA - CARGA NACIONAL FATURADA'
					WHEN '411150022' THEN	'TECA - CARGA NACIONAL A VISTA'
					WHEN '411160015' THEN	'TECA - INTERNAÇÃO FATURADA'
					WHEN '411160026' THEN	'TECA - INTERNAÇÃO A VISTA'
					WHEN '413010012' THEN	'(-) ARMAZENAGEM E CAPATAZIA EXPORTAÇÃO'
					WHEN '413010023' THEN	'(-) ARMAZENAGEM E CAPATAZIA IMPORTAÇÃO'
					WHEN '413010249' THEN	'(-) TECA - DAPE'
					WHEN '413010330' THEN	'(-) TECA - DAPE CARGA EXPORTAÇÃO'
					WHEN '413010341' THEN	'(-) TECA - CARGA NACIONAL'
					WHEN '413010352' THEN	'(-) TECA - INTERNAÇÃO'
					ELSE 'OUTRA CONTAS'
				END conta
			   ,sum(ldr_amt_1)*-1 as vl_jan,sum(ldr_amt_2)*-1 as vl_fev,sum(ldr_amt_3)*-1 as vl_mar,sum(ldr_amt_4)*-1 as vl_abr
			   ,sum(ldr_amt_5)*-1 as vl_mai,sum(ldr_amt_6)*-1 as vl_jun,sum(ldr_amt_7)*-1 as vl_jul,sum(ldr_amt_8)*-1 as vl_ago
			   ,sum(ldr_amt_9)*-1 as vl_set,sum(ldr_amt_10)*-1 as vl_out,sum(ldr_amt_11)*-1 as vl_nov,sum(ldr_amt_12)*-1 as vl_dez
		From DBSglep.dbo.ldr_acct_bal (nolock)
		Where ldr_entity_id = 'INFRA'
		   and amt_class_type = 'ACTUAL'
		   and processing_yr IN ('2011','2012','2013','2014','2015','2016','2017','2018')
		   and curr_type = 'E1'
		   and curr_code = 'R$' 
		   and left(conta,1) = '4'   
		   group by processing_yr,dependencia,
					CASE conta
						WHEN '411070014' THEN	'DAI - FATURADA'
						WHEN '411070025' THEN	'DAI - A VISTA'
						WHEN '411080018' THEN	'DAPE - FATURADA'
						WHEN '411080029' THEN	'DAPE - A VISTA'
						WHEN '411090012' THEN	'DAE - FATURADA'
						WHEN '411090023' THEN	'DAE - A VISTA'
						WHEN '411150011' THEN	'TECA - CARGA NACIONAL FATURADA'
						WHEN '411150022' THEN	'TECA - CARGA NACIONAL A VISTA'
						WHEN '411160015' THEN	'TECA - INTERNAÇÃO FATURADA'
						WHEN '411160026' THEN	'TECA - INTERNAÇÃO A VISTA'
						WHEN '413010012' THEN	'(-) ARMAZENAGEM E CAPATAZIA EXPORTAÇÃO'
						WHEN '413010023' THEN	'(-) ARMAZENAGEM E CAPATAZIA IMPORTAÇÃO'
						WHEN '413010249' THEN	'(-) TECA - DAPE'
						WHEN '413010330' THEN	'(-) TECA - DAPE CARGA EXPORTAÇÃO'
						WHEN '413010341' THEN	'(-) TECA - CARGA NACIONAL'
						WHEN '413010352' THEN	'(-) TECA - INTERNAÇÃO'
						ELSE 'OUTRA CONTAS'
					END
	) AS TECA
WHERE TECA.ano = 2014
  AND TECA.conta != 'OUTRA CONTAS'
GROUP BY TECA.ano, TECA.dependencia
ORDER BY 1, 2


*/


--HORA PICO PAX - IEOP/BIOGER
/*

USE [IEOP]
GO

ALTER VIEW [dbo].[VIW_HORA_PICO_PAX_EMBARQUE] AS
SELECT	[SIGLA_AEROPORTO]
      , YEAR([DATA_HORA_EFETIVA_DECOLAGEM]) AS ANO
	  ,	MONTH([DATA_HORA_EFETIVA_DECOLAGEM]) AS MES
	  ,	DAY([DATA_HORA_EFETIVA_DECOLAGEM]) AS DIA
	  ,	DATEPART(HOUR, [DATA_HORA_EFETIVA_DECOLAGEM]) AS HORA
      ,	SUM([EMB_TARIFA_PAGA_BILHETE_DOM] + [EMB_TARIFA_PAGA_CHECKIN_DOM] + 
	        [EMB_TARIFA_PAGA_BILHETE_INT] + [EMB_TARIFA_PAGA_CHECKIN_INT] +
			[EMB_ISENTA_COLO] + [EMB_ISENTA_TRANSITO] + [EMB_ISENTA_CONEXAO_DOM] + 
			[EMB_ISENTA_CONEXAO_INT] + [EMB_ISENTA_OUTRAS]) AS SUM_QTD_PAX_EMBARQUE
      ,	RANK() OVER (PARTITION BY [SIGLA_AEROPORTO], YEAR([DATA_HORA_EFETIVA_DECOLAGEM]), MONTH([DATA_HORA_EFETIVA_DECOLAGEM]), DAY([DATA_HORA_EFETIVA_DECOLAGEM]) 
													ORDER BY SUM([EMB_TARIFA_PAGA_BILHETE_DOM] + [EMB_TARIFA_PAGA_CHECKIN_DOM] + 
																[EMB_TARIFA_PAGA_BILHETE_INT] + [EMB_TARIFA_PAGA_CHECKIN_INT] +
																[EMB_ISENTA_COLO] + [EMB_ISENTA_TRANSITO] + [EMB_ISENTA_CONEXAO_DOM] + 
																[EMB_ISENTA_CONEXAO_INT] + [EMB_ISENTA_OUTRAS]) DESC) AS RANK_QTDE_PAX_DESEMB
  FROM	[BIOGER].[dbo].[VIW_BIOGER_DADOS_EMB]
 WHERE	GRUPO_VOO = 1
   --AND  [SIGLA_AEROPORTO] = 'SBSP'
   --AND  [DATA_HORA_EFETIVA_DECOLAGEM] >= CONVERT(VARCHAR(4), YEAR(DATEADD(MONTH,-11,GETDATE()))) + RIGHT('00'+ CONVERT(VARCHAR(2),MONTH(DATEADD(MONTH,-11,GETDATE()))),2) + '01'
   AND  YEAR([DATA_HORA_EFETIVA_DECOLAGEM]) =  YEAR(DATEADD(YEAR,-1,GETDATE()))
 GROUP
    BY	[SIGLA_AEROPORTO]
      ,	YEAR([DATA_HORA_EFETIVA_DECOLAGEM])
	  ,	MONTH([DATA_HORA_EFETIVA_DECOLAGEM])
	  , DAY([DATA_HORA_EFETIVA_DECOLAGEM])
	  ,	DATEPART(HOUR, [DATA_HORA_EFETIVA_DECOLAGEM])

--GRANT SELECT ON VIW_HORA_PICO_PAX_EMBARQUE TO usr_bi_da


USE [IEOP]
GO

ALTER VIEW VIW_HORA_PICO_PAX_DESEMBARQUE AS
SELECT	[SIGLA_AEROPORTO]
      ,	YEAR([DATA_HORA_EFETIVA_POUSO]) AS ANO
	  ,	MONTH([DATA_HORA_EFETIVA_POUSO]) AS MES
	  ,	DAY([DATA_HORA_EFETIVA_POUSO]) AS DIA
	  ,	DATEPART(HOUR, [DATA_HORA_EFETIVA_POUSO]) AS HORA
	  ,	SUM([DESEMB_PASSAGEIRO_DOM] + [DESEMB_PASSAGEIRO_INT] + [TRANSITO_CONEXAO_DOM] + [TRANSITO_CONEXAO_INT]) AS SUM_QTDE_PAX_DESEMB
	  , RANK() OVER (PARTITION BY [SIGLA_AEROPORTO], YEAR([DATA_HORA_EFETIVA_POUSO]), MONTH([DATA_HORA_EFETIVA_POUSO]),	DAY([DATA_HORA_EFETIVA_POUSO]) 
								ORDER BY SUM([DESEMB_PASSAGEIRO_DOM] + [DESEMB_PASSAGEIRO_INT] + [TRANSITO_CONEXAO_DOM] + [TRANSITO_CONEXAO_INT]) DESC) AS RANK_QTDE_PAX_DESEMB
  FROM	[BIOGER].[dbo].[VIW_BIOGER_DADOS_DES]
 WHERE	GRUPO_VOO = 1
   AND  YEAR([DATA_HORA_EFETIVA_POUSO]) =  YEAR(DATEADD(YEAR,-1,GETDATE()))
   --AND  [SIGLA_AEROPORTO] = 'SBSP'
   --AND  [DATA_HORA_EFETIVA_POUSO] >= CONVERT(VARCHAR(4), YEAR(DATEADD(MONTH,-11,GETDATE()))) + RIGHT('00'+ CONVERT(VARCHAR(2),MONTH(DATEADD(MONTH,-11,GETDATE()))),2) + '01'
 GROUP 
     BY	[SIGLA_AEROPORTO]
      ,	YEAR([DATA_HORA_EFETIVA_POUSO])
	  ,	MONTH([DATA_HORA_EFETIVA_POUSO])
	  ,	DAY([DATA_HORA_EFETIVA_POUSO])
	  ,	DATEPART(HOUR, [DATA_HORA_EFETIVA_POUSO])
GO


--GRANT SELECT ON VIW_HORA_PICO_PAX_DESEMBARQUE TO usr_bi_da



--AND  [DATA_HORA_EFETIVA_POUSO] >= CONVERT(VARCHAR(4), YEAR(DATEADD(MONTH,-11,GETDATE()))) + RIGHT('00'+ CONVERT(VARCHAR(2),MONTH(DATEADD(MONTH,-11,GETDATE()))),2) + '01'
*/

/*

USE [IEOP]
GO

SELECT	*
  FROM	VIW_HORA_PICO_PAX_EMBARQUE
 ORDER
    BY  SIGLA_AEROPORTO, ANO, MES, HORA


*/